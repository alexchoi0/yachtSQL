-- ============================================================================
-- Joins - GoogleSQL/BigQuery
-- ============================================================================
-- Source: Migrated from int64_overflow_comprehensive_tdd.rs, numeric_coercion_edge_cases_tdd.rs
-- Description: JOIN operations including INNER, LEFT, RIGHT, FULL, and CROSS joins
--
-- PostgreSQL: Limited or no support
-- BigQuery: Full support
-- SQL Standard: GoogleSQL/BigQuery specific
-- ============================================================================

DROP TABLE IF EXISTS floats;
CREATE TABLE floats (id INT64, value FLOAT64);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (id INT64, value INT64);
INSERT INTO floats VALUES (1, 42.0), (2, 1e20);
INSERT INTO ints VALUES (1, 42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 100.0), (2, 1e20), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1e20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (1e20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
INSERT INTO data VALUES ('99999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (9223372036854775807);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (NULL);

SELECT f.id FROM floats f JOIN ints i ON TRY_CAST(f.value AS INT64) = i.value;
SELECT id FROM data ORDER BY TRY_CAST(value AS INT64) NULLS LAST;
SELECT COALESCE(TRY_CAST(value AS INT64), 0) as safe_value FROM data;
SELECT CAST(value AS INT64) FROM data;
SELECT CAST(value AS INT64) FROM data;
SELECT value + 1 FROM data;
SELECT COUNT(*) as total, COUNT(TRY_CAST(value AS INT64)) as valid FROM data;
SELECT CAST(value AS INT64) as int_val FROM data;
SELECT TRY_CAST(value AS INT64) as int_val FROM data;

-- ============================================================================
-- Test: test_cast_int64_to_numeric_positive
-- Source: numeric_coercion_edge_cases_tdd.rs:28
-- ============================================================================
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (12345);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (-98765);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (9223372036854775807);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (-9223372036854775808);
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (val FLOAT64);
INSERT INTO floats VALUES (123.456);
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (val FLOAT64);
INSERT INTO floats VALUES (0.123456789012345678);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('456.789');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('00123.450');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('1.5e3');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_a_number');
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (-456.999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99999999999999999999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM ints;
SELECT CAST(val AS NUMERIC) FROM ints;
SELECT CAST(val AS NUMERIC) FROM ints;
SELECT CAST(val AS NUMERIC) FROM ints;
SELECT CAST(val AS NUMERIC) FROM floats;
SELECT CAST(val AS NUMERIC) FROM floats;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_int64_to_numeric_negative
-- Source: numeric_coercion_edge_cases_tdd.rs:53
-- ============================================================================
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (-98765);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (9223372036854775807);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (-9223372036854775808);
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (val FLOAT64);
INSERT INTO floats VALUES (123.456);
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (val FLOAT64);
INSERT INTO floats VALUES (0.123456789012345678);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('456.789');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('00123.450');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('1.5e3');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_a_number');
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (-456.999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99999999999999999999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM ints;
SELECT CAST(val AS NUMERIC) FROM ints;
SELECT CAST(val AS NUMERIC) FROM ints;
SELECT CAST(val AS NUMERIC) FROM floats;
SELECT CAST(val AS NUMERIC) FROM floats;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_int64_max_to_numeric
-- Source: numeric_coercion_edge_cases_tdd.rs:78
-- ============================================================================
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (9223372036854775807);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (-9223372036854775808);
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (val FLOAT64);
INSERT INTO floats VALUES (123.456);
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (val FLOAT64);
INSERT INTO floats VALUES (0.123456789012345678);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('456.789');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('00123.450');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('1.5e3');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_a_number');
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (-456.999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99999999999999999999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM ints;
SELECT CAST(val AS NUMERIC) FROM ints;
SELECT CAST(val AS NUMERIC) FROM floats;
SELECT CAST(val AS NUMERIC) FROM floats;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_int64_min_to_numeric
-- Source: numeric_coercion_edge_cases_tdd.rs:103
-- ============================================================================
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (-9223372036854775808);
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (val FLOAT64);
INSERT INTO floats VALUES (123.456);
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (val FLOAT64);
INSERT INTO floats VALUES (0.123456789012345678);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('456.789');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('00123.450');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('1.5e3');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_a_number');
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (-456.999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99999999999999999999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM ints;
SELECT CAST(val AS NUMERIC) FROM floats;
SELECT CAST(val AS NUMERIC) FROM floats;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_float64_to_numeric_simple
-- Source: numeric_coercion_edge_cases_tdd.rs:128
-- ============================================================================
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (val FLOAT64);
INSERT INTO floats VALUES (123.456);
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (val FLOAT64);
INSERT INTO floats VALUES (0.123456789012345678);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('456.789');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('00123.450');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('1.5e3');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_a_number');
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (-456.999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99999999999999999999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM floats;
SELECT CAST(val AS NUMERIC) FROM floats;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_float64_to_numeric_precision_loss
-- Source: numeric_coercion_edge_cases_tdd.rs:154
-- ============================================================================
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (val FLOAT64);
INSERT INTO floats VALUES (0.123456789012345678);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('456.789');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('00123.450');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('1.5e3');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_a_number');
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (-456.999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99999999999999999999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM floats;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_string_to_numeric_valid
-- Source: numeric_coercion_edge_cases_tdd.rs:182
-- ============================================================================
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('456.789');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('00123.450');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('1.5e3');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_a_number');
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (-456.999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99999999999999999999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_string_to_numeric_leading_zeros
-- Source: numeric_coercion_edge_cases_tdd.rs:207
-- ============================================================================
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('00123.450');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('1.5e3');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_a_number');
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (-456.999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99999999999999999999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_string_to_numeric_scientific_notation
-- Source: numeric_coercion_edge_cases_tdd.rs:233
-- ============================================================================
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('1.5e3');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_a_number');
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (-456.999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99999999999999999999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_string_to_numeric_invalid
-- Source: numeric_coercion_edge_cases_tdd.rs:265
-- ============================================================================
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_a_number');
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (-456.999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99999999999999999999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM strings;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_numeric_to_int64_truncation
-- Source: numeric_coercion_edge_cases_tdd.rs:288
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (-456.999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99999999999999999999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_numeric_to_int64_negative_truncation
-- Source: numeric_coercion_edge_cases_tdd.rs:307
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (-456.999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99999999999999999999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_numeric_to_int64_overflow
-- Source: numeric_coercion_edge_cases_tdd.rs:327
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99999999999999999999);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS INT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_numeric_to_float64
-- Source: numeric_coercion_edge_cases_tdd.rs:349
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (789.012);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_numeric_to_float64_high_precision_loss
-- Source: numeric_coercion_edge_cases_tdd.rs:368
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (1234567890123456789012345678);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS FLOAT64) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_numeric_to_string
-- Source: numeric_coercion_edge_cases_tdd.rs:390
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.456);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS STRING) FROM nums;
SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_numeric_to_string_trailing_zeros
-- Source: numeric_coercion_edge_cases_tdd.rs:410
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (100.5000);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS STRING) FROM nums;
SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_implicit_int64_to_numeric_in_arithmetic
-- Source: numeric_coercion_edge_cases_tdd.rs:435
-- ============================================================================
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC);
INSERT INTO mixed VALUES (10, 20.5);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT i + n FROM mixed;
SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_implicit_numeric_to_float64_in_comparison
-- Source: numeric_coercion_edge_cases_tdd.rs:462
-- ============================================================================
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (n NUMERIC, f FLOAT64);
INSERT INTO mixed VALUES (10.5, 10.5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT n = f FROM mixed;
SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_implicit_coercion_in_insert
-- Source: numeric_coercion_edge_cases_tdd.rs:482
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT val FROM nums;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_float64_infinity_to_numeric
-- Source: numeric_coercion_edge_cases_tdd.rs:511
-- ============================================================================
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (1e308 * 2);
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_float64_nan_to_numeric
-- Source: numeric_coercion_edge_cases_tdd.rs:530
-- ============================================================================
DROP TABLE IF EXISTS specials;
CREATE TABLE specials (val FLOAT64);
INSERT INTO specials VALUES (0.0 / 0.0);
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM specials;
SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_float64_negative_zero_to_numeric
-- Source: numeric_coercion_edge_cases_tdd.rs:549
-- ============================================================================
DROP TABLE IF EXISTS zeros;
CREATE TABLE zeros (val FLOAT64);
INSERT INTO zeros VALUES (-0.0);
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM zeros;
SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_numeric_max_to_int64_overflow
-- Source: numeric_coercion_edge_cases_tdd.rs:575
-- ============================================================================
DROP TABLE IF EXISTS maxes;
CREATE TABLE maxes (val NUMERIC);
INSERT INTO maxes VALUES (79228162514264337593543950335);
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS INT64) FROM maxes;
SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_numeric_to_int64_rounds_towards_zero
-- Source: numeric_coercion_edge_cases_tdd.rs:595
-- ============================================================================
DROP TABLE IF EXISTS rounding;
CREATE TABLE rounding (val NUMERIC);
INSERT INTO rounding VALUES (5.9), (-5.9);
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS INT64) FROM rounding ORDER BY val;
SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_float64_imprecise_to_numeric
-- Source: numeric_coercion_edge_cases_tdd.rs:617
-- ============================================================================
DROP TABLE IF EXISTS imprecise;
CREATE TABLE imprecise (val FLOAT64);
INSERT INTO imprecise VALUES (0.1);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM imprecise;
SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_null_to_numeric
-- Source: numeric_coercion_edge_cases_tdd.rs:653
-- ============================================================================
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val INT64);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS NUMERIC) FROM nulls;
SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_cast_numeric_null_to_string
-- Source: numeric_coercion_edge_cases_tdd.rs:672
-- ============================================================================
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (val NUMERIC);
INSERT INTO nulls VALUES (NULL);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT CAST(val AS STRING) FROM nulls;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_try_cast_invalid_string_to_numeric_returns_null
-- Source: numeric_coercion_edge_cases_tdd.rs:695
-- ============================================================================
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('invalid');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;

-- ============================================================================
-- Test: test_safe_cast_invalid_string_to_numeric_returns_null
-- Source: numeric_coercion_edge_cases_tdd.rs:717
-- ============================================================================
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('not_numeric');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (val STRING);
INSERT INTO strings VALUES ('999999999999999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING, int_val INT64);
INSERT INTO data VALUES ('10.5', 10), ('20.5', 20), ('30.5', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (price_str STRING, quantity INT64);
INSERT INTO sales VALUES ('10.5', 1), ('10.5', 2), ('20.5', 3);
DROP TABLE IF EXISTS table_a;
CREATE TABLE table_a (id_str STRING, name STRING);
DROP TABLE IF EXISTS table_b;
CREATE TABLE table_b (id_num NUMERIC, value INT64);
INSERT INTO table_a VALUES ('1', 'Alice'), ('2', 'Bob');
INSERT INTO table_b VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (123.789);
DROP TABLE IF EXISTS ints;
CREATE TABLE ints (val INT64);
INSERT INTO ints VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (val NUMERIC);
INSERT INTO nums VALUES (99.99);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (i INT64, n NUMERIC, s STRING);
INSERT INTO mixed VALUES (42, 3.14, '100');

SELECT SAFE_CAST(val AS NUMERIC) FROM strings;
SELECT TRY_CAST(val AS NUMERIC) FROM strings;
SELECT int_val FROM data WHERE CAST(str_val AS NUMERIC) > 15 ORDER BY int_val;
SELECT CAST(price_str AS NUMERIC) as price, SUM(quantity) FROM sales GROUP BY CAST(price_str AS NUMERIC) ORDER BY price;
SELECT name, value FROM table_a JOIN table_b ON CAST(id_str AS NUMERIC) = id_num ORDER BY name;
SELECT CAST(CAST(val AS INT64) AS NUMERIC) FROM nums;
SELECT val::NUMERIC FROM ints;
SELECT val::INT64 FROM nums;
SELECT CAST(i AS NUMERIC), CAST(n AS INT64), CAST(s AS NUMERIC), CAST(n AS STRING) FROM mixed;
