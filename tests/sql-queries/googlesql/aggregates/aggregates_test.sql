-- ============================================================================
-- Aggregates - GoogleSQL/BigQuery
-- ============================================================================
-- Source: Migrated from conditional_expressions_extreme_edge_cases_tdd.rs, int64_overflow_comprehensive_tdd.rs, numeric_decimal_extreme_edge_cases_tdd.rs, safe_functions_comprehensive_tdd.rs, tablesample_comprehensive_tdd.rs
-- Description: Aggregate function operations and grouping
--
-- PostgreSQL: Limited or no support
-- BigQuery: Full support
-- SQL Standard: GoogleSQL/BigQuery specific
-- ============================================================================

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);

SELECT CASE WHEN denominator = 0 THEN 0 ELSE 10 / denominator END as safe_div FROM t;

-- ============================================================================
-- Test: test_overflow_in_order_by
-- Source: int64_overflow_comprehensive_tdd.rs:656
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 100.0), (2, 1e20), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1e20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (1e20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
INSERT INTO data VALUES ('99999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (9223372036854775807);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (NULL);

SELECT id FROM data ORDER BY TRY_CAST(value AS INT64) NULLS LAST;
SELECT COALESCE(TRY_CAST(value AS INT64), 0) as safe_value FROM data;
SELECT CAST(value AS INT64) FROM data;
SELECT CAST(value AS INT64) FROM data;
SELECT value + 1 FROM data;
SELECT COUNT(*) as total, COUNT(TRY_CAST(value AS INT64)) as valid FROM data;
SELECT CAST(value AS INT64) as int_val FROM data;
SELECT TRY_CAST(value AS INT64) as int_val FROM data;

-- ============================================================================
-- Test: test_overflow_with_coalesce
-- Source: int64_overflow_comprehensive_tdd.rs:674
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1e20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (1e20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
INSERT INTO data VALUES ('99999999999999999999');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (9223372036854775807);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (NULL);

SELECT COALESCE(TRY_CAST(value AS INT64), 0) as safe_value FROM data;
SELECT CAST(value AS INT64) FROM data;
SELECT CAST(value AS INT64) FROM data;
SELECT value + 1 FROM data;
SELECT COUNT(*) as total, COUNT(TRY_CAST(value AS INT64)) as valid FROM data;
SELECT CAST(value AS INT64) as int_val FROM data;
SELECT TRY_CAST(value AS INT64) as int_val FROM data;

-- ============================================================================
-- Test: test_numeric_maximum_precision_38_digits
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:34
-- ============================================================================
DROP TABLE IF EXISTS max_values;
CREATE TABLE max_values (id INT64, amount NUMERIC(38, 0));
INSERT INTO max_values VALUES (1, 99999999999999999999999999999999999999);
DROP TABLE IF EXISTS precise;
CREATE TABLE precise (id INT64, value NUMERIC(38, 9));
INSERT INTO precise VALUES (1, 99999999999999999999999999999.999999999);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, amount NUMERIC(38, 0));
INSERT INTO test VALUES (1, 999999999999999999999999999999999999999);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, amount NUMERIC(5, 10));
DROP TABLE IF EXISTS negatives;
CREATE TABLE negatives (id INT64, amount NUMERIC(38, 0));
INSERT INTO negatives VALUES (1, -99999999999999999999999999999999999999);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 2.5);
INSERT INTO test VALUES (2, 3.5);
INSERT INTO test VALUES (3, 4.5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, dividend NUMERIC(10, 2), divisor NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00, 3.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 12.34, 56.78);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 123.456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 0.00);
INSERT INTO test VALUES (2, -0.00);
DROP TABLE IF EXISTS exchange;
CREATE TABLE exchange (id INT64, usd NUMERIC(15, 2), rate NUMERIC(10, 4));
INSERT INTO exchange VALUES (1, 100.00, 110.2500);
DROP TABLE IF EXISTS savings;
CREATE TABLE savings (id INT64, principal NUMERIC(15, 2), rate NUMERIC(5, 4), years INT64);
INSERT INTO savings VALUES (1, 1000.00, 0.0525, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT amount FROM max_values WHERE id = 1;
SELECT id, CAST(value AS NUMERIC(10, 0)) as rounded FROM test ORDER BY id;
SELECT dividend / divisor as quotient FROM test;
SELECT a * b as product FROM test;
SELECT value FROM test;
SELECT value FROM test ORDER BY id;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;
SELECT CAST(usd * rate AS NUMERIC(15, 0)) as jpy FROM exchange;
SELECT principal * (1 + rate) as year1 FROM savings;
SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_maximum_scale_9_decimal_places
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:61
-- ============================================================================
DROP TABLE IF EXISTS precise;
CREATE TABLE precise (id INT64, value NUMERIC(38, 9));
INSERT INTO precise VALUES (1, 99999999999999999999999999999.999999999);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, amount NUMERIC(38, 0));
INSERT INTO test VALUES (1, 999999999999999999999999999999999999999);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, amount NUMERIC(5, 10));
DROP TABLE IF EXISTS negatives;
CREATE TABLE negatives (id INT64, amount NUMERIC(38, 0));
INSERT INTO negatives VALUES (1, -99999999999999999999999999999999999999);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 2.5);
INSERT INTO test VALUES (2, 3.5);
INSERT INTO test VALUES (3, 4.5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, dividend NUMERIC(10, 2), divisor NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00, 3.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 12.34, 56.78);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 123.456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 0.00);
INSERT INTO test VALUES (2, -0.00);
DROP TABLE IF EXISTS exchange;
CREATE TABLE exchange (id INT64, usd NUMERIC(15, 2), rate NUMERIC(10, 4));
INSERT INTO exchange VALUES (1, 100.00, 110.2500);
DROP TABLE IF EXISTS savings;
CREATE TABLE savings (id INT64, principal NUMERIC(15, 2), rate NUMERIC(5, 4), years INT64);
INSERT INTO savings VALUES (1, 1000.00, 0.0525, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT id, CAST(value AS NUMERIC(10, 0)) as rounded FROM test ORDER BY id;
SELECT dividend / divisor as quotient FROM test;
SELECT a * b as product FROM test;
SELECT value FROM test;
SELECT value FROM test ORDER BY id;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;
SELECT CAST(usd * rate AS NUMERIC(15, 0)) as jpy FROM exchange;
SELECT principal * (1 + rate) as year1 FROM savings;
SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_overflow_beyond_38_digits
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:81
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, amount NUMERIC(38, 0));
INSERT INTO test VALUES (1, 999999999999999999999999999999999999999);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, amount NUMERIC(5, 10));
DROP TABLE IF EXISTS negatives;
CREATE TABLE negatives (id INT64, amount NUMERIC(38, 0));
INSERT INTO negatives VALUES (1, -99999999999999999999999999999999999999);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 2.5);
INSERT INTO test VALUES (2, 3.5);
INSERT INTO test VALUES (3, 4.5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, dividend NUMERIC(10, 2), divisor NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00, 3.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 12.34, 56.78);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 123.456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 0.00);
INSERT INTO test VALUES (2, -0.00);
DROP TABLE IF EXISTS exchange;
CREATE TABLE exchange (id INT64, usd NUMERIC(15, 2), rate NUMERIC(10, 4));
INSERT INTO exchange VALUES (1, 100.00, 110.2500);
DROP TABLE IF EXISTS savings;
CREATE TABLE savings (id INT64, principal NUMERIC(15, 2), rate NUMERIC(5, 4), years INT64);
INSERT INTO savings VALUES (1, 1000.00, 0.0525, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT id, CAST(value AS NUMERIC(10, 0)) as rounded FROM test ORDER BY id;
SELECT dividend / divisor as quotient FROM test;
SELECT a * b as product FROM test;
SELECT value FROM test;
SELECT value FROM test ORDER BY id;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;
SELECT CAST(usd * rate AS NUMERIC(15, 0)) as jpy FROM exchange;
SELECT principal * (1 + rate) as year1 FROM savings;
SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_scale_exceeds_precision
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:109
-- ============================================================================
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, amount NUMERIC(5, 10));
DROP TABLE IF EXISTS negatives;
CREATE TABLE negatives (id INT64, amount NUMERIC(38, 0));
INSERT INTO negatives VALUES (1, -99999999999999999999999999999999999999);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 2.5);
INSERT INTO test VALUES (2, 3.5);
INSERT INTO test VALUES (3, 4.5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, dividend NUMERIC(10, 2), divisor NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00, 3.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 12.34, 56.78);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 123.456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 0.00);
INSERT INTO test VALUES (2, -0.00);
DROP TABLE IF EXISTS exchange;
CREATE TABLE exchange (id INT64, usd NUMERIC(15, 2), rate NUMERIC(10, 4));
INSERT INTO exchange VALUES (1, 100.00, 110.2500);
DROP TABLE IF EXISTS savings;
CREATE TABLE savings (id INT64, principal NUMERIC(15, 2), rate NUMERIC(5, 4), years INT64);
INSERT INTO savings VALUES (1, 1000.00, 0.0525, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT id, CAST(value AS NUMERIC(10, 0)) as rounded FROM test ORDER BY id;
SELECT dividend / divisor as quotient FROM test;
SELECT a * b as product FROM test;
SELECT value FROM test;
SELECT value FROM test ORDER BY id;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;
SELECT CAST(usd * rate AS NUMERIC(15, 0)) as jpy FROM exchange;
SELECT principal * (1 + rate) as year1 FROM savings;
SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_minimum_negative_value
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:120
-- ============================================================================
DROP TABLE IF EXISTS negatives;
CREATE TABLE negatives (id INT64, amount NUMERIC(38, 0));
INSERT INTO negatives VALUES (1, -99999999999999999999999999999999999999);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 2.5);
INSERT INTO test VALUES (2, 3.5);
INSERT INTO test VALUES (3, 4.5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, dividend NUMERIC(10, 2), divisor NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00, 3.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 12.34, 56.78);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 123.456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 0.00);
INSERT INTO test VALUES (2, -0.00);
DROP TABLE IF EXISTS exchange;
CREATE TABLE exchange (id INT64, usd NUMERIC(15, 2), rate NUMERIC(10, 4));
INSERT INTO exchange VALUES (1, 100.00, 110.2500);
DROP TABLE IF EXISTS savings;
CREATE TABLE savings (id INT64, principal NUMERIC(15, 2), rate NUMERIC(5, 4), years INT64);
INSERT INTO savings VALUES (1, 1000.00, 0.0525, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT id, CAST(value AS NUMERIC(10, 0)) as rounded FROM test ORDER BY id;
SELECT dividend / divisor as quotient FROM test;
SELECT a * b as product FROM test;
SELECT value FROM test;
SELECT value FROM test ORDER BY id;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;
SELECT CAST(usd * rate AS NUMERIC(15, 0)) as jpy FROM exchange;
SELECT principal * (1 + rate) as year1 FROM savings;
SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_banker_rounding_half_even
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:143
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 2.5);
INSERT INTO test VALUES (2, 3.5);
INSERT INTO test VALUES (3, 4.5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, dividend NUMERIC(10, 2), divisor NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00, 3.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 12.34, 56.78);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 123.456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 0.00);
INSERT INTO test VALUES (2, -0.00);
DROP TABLE IF EXISTS exchange;
CREATE TABLE exchange (id INT64, usd NUMERIC(15, 2), rate NUMERIC(10, 4));
INSERT INTO exchange VALUES (1, 100.00, 110.2500);
DROP TABLE IF EXISTS savings;
CREATE TABLE savings (id INT64, principal NUMERIC(15, 2), rate NUMERIC(5, 4), years INT64);
INSERT INTO savings VALUES (1, 1000.00, 0.0525, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT id, CAST(value AS NUMERIC(10, 0)) as rounded FROM test ORDER BY id;
SELECT dividend / divisor as quotient FROM test;
SELECT a * b as product FROM test;
SELECT value FROM test;
SELECT value FROM test ORDER BY id;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;
SELECT CAST(usd * rate AS NUMERIC(15, 0)) as jpy FROM exchange;
SELECT principal * (1 + rate) as year1 FROM savings;
SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_division_scale_expansion
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:177
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, dividend NUMERIC(10, 2), divisor NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00, 3.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 12.34, 56.78);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 123.456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 0.00);
INSERT INTO test VALUES (2, -0.00);
DROP TABLE IF EXISTS exchange;
CREATE TABLE exchange (id INT64, usd NUMERIC(15, 2), rate NUMERIC(10, 4));
INSERT INTO exchange VALUES (1, 100.00, 110.2500);
DROP TABLE IF EXISTS savings;
CREATE TABLE savings (id INT64, principal NUMERIC(15, 2), rate NUMERIC(5, 4), years INT64);
INSERT INTO savings VALUES (1, 1000.00, 0.0525, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT dividend / divisor as quotient FROM test;
SELECT a * b as product FROM test;
SELECT value FROM test;
SELECT value FROM test ORDER BY id;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;
SELECT CAST(usd * rate AS NUMERIC(15, 0)) as jpy FROM exchange;
SELECT principal * (1 + rate) as year1 FROM savings;
SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_multiplication_scale_addition
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:202
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 12.34, 56.78);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 123.456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 0.00);
INSERT INTO test VALUES (2, -0.00);
DROP TABLE IF EXISTS exchange;
CREATE TABLE exchange (id INT64, usd NUMERIC(15, 2), rate NUMERIC(10, 4));
INSERT INTO exchange VALUES (1, 100.00, 110.2500);
DROP TABLE IF EXISTS savings;
CREATE TABLE savings (id INT64, principal NUMERIC(15, 2), rate NUMERIC(5, 4), years INT64);
INSERT INTO savings VALUES (1, 1000.00, 0.0525, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT a * b as product FROM test;
SELECT value FROM test;
SELECT value FROM test ORDER BY id;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;
SELECT CAST(usd * rate AS NUMERIC(15, 0)) as jpy FROM exchange;
SELECT principal * (1 + rate) as year1 FROM savings;
SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_scale_truncation_on_insert
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:226
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 123.456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 0.00);
INSERT INTO test VALUES (2, -0.00);
DROP TABLE IF EXISTS exchange;
CREATE TABLE exchange (id INT64, usd NUMERIC(15, 2), rate NUMERIC(10, 4));
INSERT INTO exchange VALUES (1, 100.00, 110.2500);
DROP TABLE IF EXISTS savings;
CREATE TABLE savings (id INT64, principal NUMERIC(15, 2), rate NUMERIC(5, 4), years INT64);
INSERT INTO savings VALUES (1, 1000.00, 0.0525, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT value FROM test;
SELECT value FROM test ORDER BY id;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;
SELECT CAST(usd * rate AS NUMERIC(15, 0)) as jpy FROM exchange;
SELECT principal * (1 + rate) as year1 FROM savings;
SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_trailing_zeros_preserved
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:252
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 0.00);
INSERT INTO test VALUES (2, -0.00);
DROP TABLE IF EXISTS exchange;
CREATE TABLE exchange (id INT64, usd NUMERIC(15, 2), rate NUMERIC(10, 4));
INSERT INTO exchange VALUES (1, 100.00, 110.2500);
DROP TABLE IF EXISTS savings;
CREATE TABLE savings (id INT64, principal NUMERIC(15, 2), rate NUMERIC(5, 4), years INT64);
INSERT INTO savings VALUES (1, 1000.00, 0.0525, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT value FROM test ORDER BY id;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;
SELECT CAST(usd * rate AS NUMERIC(15, 0)) as jpy FROM exchange;
SELECT principal * (1 + rate) as year1 FROM savings;
SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_negative_zero
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:279
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 0.00);
INSERT INTO test VALUES (2, -0.00);
DROP TABLE IF EXISTS exchange;
CREATE TABLE exchange (id INT64, usd NUMERIC(15, 2), rate NUMERIC(10, 4));
INSERT INTO exchange VALUES (1, 100.00, 110.2500);
DROP TABLE IF EXISTS savings;
CREATE TABLE savings (id INT64, principal NUMERIC(15, 2), rate NUMERIC(5, 4), years INT64);
INSERT INTO savings VALUES (1, 1000.00, 0.0525, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT COUNT(DISTINCT value) as distinct_count FROM test;
SELECT CAST(usd * rate AS NUMERIC(15, 0)) as jpy FROM exchange;
SELECT principal * (1 + rate) as year1 FROM savings;
SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_currency_precision_loss_usd_jpy
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:315
-- ============================================================================
DROP TABLE IF EXISTS exchange;
CREATE TABLE exchange (id INT64, usd NUMERIC(15, 2), rate NUMERIC(10, 4));
INSERT INTO exchange VALUES (1, 100.00, 110.2500);
DROP TABLE IF EXISTS savings;
CREATE TABLE savings (id INT64, principal NUMERIC(15, 2), rate NUMERIC(5, 4), years INT64);
INSERT INTO savings VALUES (1, 1000.00, 0.0525, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT CAST(usd * rate AS NUMERIC(15, 0)) as jpy FROM exchange;
SELECT principal * (1 + rate) as year1 FROM savings;
SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_interest_calculation_compound
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:338
-- ============================================================================
DROP TABLE IF EXISTS savings;
CREATE TABLE savings (id INT64, principal NUMERIC(15, 2), rate NUMERIC(5, 4), years INT64);
INSERT INTO savings VALUES (1, 1000.00, 0.0525, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT principal * (1 + rate) as year1 FROM savings;
SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_tax_calculation_rounding
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:364
-- ============================================================================
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, subtotal NUMERIC(10, 2), tax_rate NUMERIC(5, 4));
INSERT INTO sales VALUES (1, 10.00, 0.08875);
INSERT INTO sales VALUES (2, 15.99, 0.08875);
INSERT INTO sales VALUES (3, 99.99, 0.08875);
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT id, subtotal, CAST(subtotal * tax_rate AS NUMERIC(10, 2)) as tax FROM sales ORDER BY id;
SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_split_bill_edge_case
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:397
-- ============================================================================
DROP TABLE IF EXISTS bill;
CREATE TABLE bill (total NUMERIC(10, 2), people INT64);
INSERT INTO bill VALUES (10.00, 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT total / people as per_person FROM bill;
SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_null_arithmetic
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:424
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00, NULL);
INSERT INTO test VALUES (2, NULL, 50.00);
INSERT INTO test VALUES (3, 25.00, 75.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT id, a + b as sum FROM test ORDER BY id;
SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_null_comparison
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:458
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT COUNT(*) as count FROM test WHERE value = NULL;
SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_numeric_coalesce_with_null
-- Source: numeric_decimal_extreme_edge_cases_tdd.rs:491
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 20.00);
INSERT INTO test VALUES (3, 30.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 10.00);
INSERT INTO test VALUES (2, 10.00);
INSERT INTO test VALUES (3, 10.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, big_int INT64);
INSERT INTO test VALUES (1, 9223372036854775807);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, float_val FLOAT64);
INSERT INTO test VALUES (1, 123.456789012345);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(15, 9));
INSERT INTO test VALUES (1, 123.123456789);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), int_val INT64);
INSERT INTO test VALUES (1, 100.50, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, num NUMERIC(10, 2), float_val FLOAT64);
INSERT INTO test VALUES (1, 100.00, 0.1);
DROP TABLE IF EXISTS large_data;
CREATE TABLE large_data (id INT64, amount NUMERIC(15, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, price NUMERIC(10, 2));
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.00);
INSERT INTO test VALUES (2, 100.10);
INSERT INTO test VALUES (3, 100.01);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, '123.45');
INSERT INTO test VALUES (2, '0.99');
INSERT INTO test VALUES (3, '1000');
INSERT INTO test VALUES (4, '.5');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, str STRING);
INSERT INTO test VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a NUMERIC(10, 1), b NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100.0, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, -100.00);
INSERT INTO test VALUES (2, -0.01);
INSERT INTO test VALUES (3, 0.00);
INSERT INTO test VALUES (4, 0.01);
INSERT INTO test VALUES (5, 100.00);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value NUMERIC(10, 2));
INSERT INTO test VALUES (1, 100);
INSERT INTO test VALUES (2, 100.0);
INSERT INTO test VALUES (3, 100.00);

SELECT id, COALESCE(price, 0.00) as safe_price FROM test ORDER BY id;
SELECT SUM(amount) as total FROM transactions;
SELECT AVG(value) as average FROM test;
SELECT AVG(value) as average FROM test;
SELECT CAST(big_int AS NUMERIC(38, 0)) as num FROM test;
SELECT CAST(float_val AS NUMERIC(10, 2)) as num FROM test;
SELECT CAST(num AS FLOAT64) as float_val FROM test;
SELECT num + int_val as sum FROM test;
SELECT num + float_val as sum FROM test;
SELECT SUM(amount) as total FROM large_data;
SELECT COUNT(*) as count FROM test WHERE price > 50.00 AND price < 75.00;
SELECT id, CAST(value AS STRING) as str_value FROM test ORDER BY id;
SELECT id, CAST(str AS NUMERIC(10, 2)) as num FROM test ORDER BY id;
SELECT CAST(str AS NUMERIC(10, 2)) as num FROM test;
SELECT COUNT(*) as count FROM test WHERE a = b;
SELECT value FROM test ORDER BY value ASC;
SELECT COUNT(DISTINCT value) as distinct_count FROM test;

-- ============================================================================
-- Test: test_safe_divide_normal
-- Source: safe_functions_comprehensive_tdd.rs:29
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a FLOAT64, b FLOAT64);
INSERT INTO nums VALUES (10.0, 4.0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a FLOAT64, b FLOAT64);
INSERT INTO nums VALUES (10.0, 0.0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (0, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, numerator INT64, denominator INT64);
INSERT INTO data VALUES (1, 10, 2), (2, 10, 0), (3, 15, 3), (4, 7, 0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 20);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT id, SAFE_DIVIDE(numerator, denominator) as result FROM data ORDER BY id;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_divide_by_zero
-- Source: safe_functions_comprehensive_tdd.rs:48
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a FLOAT64, b FLOAT64);
INSERT INTO nums VALUES (10.0, 4.0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a FLOAT64, b FLOAT64);
INSERT INTO nums VALUES (10.0, 0.0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (0, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, numerator INT64, denominator INT64);
INSERT INTO data VALUES (1, 10, 2), (2, 10, 0), (3, 15, 3), (4, 7, 0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 20);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT id, SAFE_DIVIDE(numerator, denominator) as result FROM data ORDER BY id;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_divide_float
-- Source: safe_functions_comprehensive_tdd.rs:68
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a FLOAT64, b FLOAT64);
INSERT INTO nums VALUES (10.0, 4.0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a FLOAT64, b FLOAT64);
INSERT INTO nums VALUES (10.0, 0.0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (0, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, numerator INT64, denominator INT64);
INSERT INTO data VALUES (1, 10, 2), (2, 10, 0), (3, 15, 3), (4, 7, 0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 20);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT id, SAFE_DIVIDE(numerator, denominator) as result FROM data ORDER BY id;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_divide_float_by_zero
-- Source: safe_functions_comprehensive_tdd.rs:87
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a FLOAT64, b FLOAT64);
INSERT INTO nums VALUES (10.0, 0.0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (0, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, numerator INT64, denominator INT64);
INSERT INTO data VALUES (1, 10, 2), (2, 10, 0), (3, 15, 3), (4, 7, 0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 20);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT id, SAFE_DIVIDE(numerator, denominator) as result FROM data ORDER BY id;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_divide_null_inputs
-- Source: safe_functions_comprehensive_tdd.rs:106
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (0, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, numerator INT64, denominator INT64);
INSERT INTO data VALUES (1, 10, 2), (2, 10, 0), (3, 15, 3), (4, 7, 0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 20);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT id, SAFE_DIVIDE(numerator, denominator) as result FROM data ORDER BY id;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_divide_zero_divided_by_nonzero
-- Source: safe_functions_comprehensive_tdd.rs:125
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (0, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, numerator INT64, denominator INT64);
INSERT INTO data VALUES (1, 10, 2), (2, 10, 0), (3, 15, 3), (4, 7, 0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 20);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_DIVIDE(a, b) as result FROM nums;
SELECT id, SAFE_DIVIDE(numerator, denominator) as result FROM data ORDER BY id;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_divide_in_table
-- Source: safe_functions_comprehensive_tdd.rs:145
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, numerator INT64, denominator INT64);
INSERT INTO data VALUES (1, 10, 2), (2, 10, 0), (3, 15, 3), (4, 7, 0);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 20);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT id, SAFE_DIVIDE(numerator, denominator) as result FROM data ORDER BY id;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_multiply_normal
-- Source: safe_functions_comprehensive_tdd.rs:174
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 20);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_multiply_overflow
-- Source: safe_functions_comprehensive_tdd.rs:193
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 20);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_multiply_negative_overflow
-- Source: safe_functions_comprehensive_tdd.rs:214
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 20);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_multiply_null_inputs
-- Source: safe_functions_comprehensive_tdd.rs:233
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5), (10, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 20);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_MULTIPLY(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_add_normal
-- Source: safe_functions_comprehensive_tdd.rs:256
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 20);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_add_overflow
-- Source: safe_functions_comprehensive_tdd.rs:275
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_add_large_values
-- Source: safe_functions_comprehensive_tdd.rs:294
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775806, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_ADD(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_subtract_normal
-- Source: safe_functions_comprehensive_tdd.rs:318
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (30, 10);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_subtract_underflow
-- Source: safe_functions_comprehensive_tdd.rs:337
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (-9223372036854775808, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_subtract_large_negative
-- Source: safe_functions_comprehensive_tdd.rs:357
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, -1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_SUBTRACT(a, b) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_negate_normal
-- Source: safe_functions_comprehensive_tdd.rs:385
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (42);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_negate_min_int
-- Source: safe_functions_comprehensive_tdd.rs:404
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (-9223372036854775808);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_negate_null
-- Source: safe_functions_comprehensive_tdd.rs:425
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (value INT64);
INSERT INTO nums VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT SAFE_NEGATE(value) as result FROM nums;
SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_functions_in_where
-- Source: safe_functions_comprehensive_tdd.rs:448
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 2), (10, 0), (15, 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT a, b FROM data WHERE SAFE_DIVIDE(a, b) IS NOT NULL ORDER BY b;
SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_safe_divide_in_aggregate
-- Source: safe_functions_comprehensive_tdd.rs:469
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, numerator INT64, denominator INT64);
INSERT INTO data VALUES ('A', 10, 2), ('A', 10, 0), ('B', 15, 3), ('B', 20, 4);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (9223372036854775807, 1);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (NULL, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (10, 2), (10, 5);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (a INT64, b INT64);
INSERT INTO nums VALUES (5, 10), (3, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
INSERT INTO data VALUES ('abc');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '100'), (2, 'invalid'), (3, '200'), (4, 'xyz');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);

SELECT category, AVG(SAFE_DIVIDE(numerator, denominator)) as avg_result FROM data GROUP BY category ORDER BY category;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), SAFE_SUBTRACT(a, b)) as result FROM nums;
SELECT SAFE_MULTIPLY(SAFE_ADD(a, b), 2) as result FROM nums;
SELECT SAFE_ADD(a, b) as add_result, SAFE_MULTIPLY(a, b) as mul_result, SAFE_DIVIDE(a, b) as div_result FROM nums;
SELECT a / b as result FROM nums ORDER BY b;
SELECT SAFE_DIVIDE(a, b) as result FROM nums ORDER BY b;
SELECT a * b as result FROM nums ORDER BY a;
SELECT SAFE_MULTIPLY(a, b) as result FROM nums ORDER BY a;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT TRY_CAST(text AS INT64) as result FROM data;
SELECT id, TRY_CAST(text AS INT64) as num FROM data ORDER BY id;
SELECT id, SAFE_DIVIDE(id, value) as result FROM data WHERE id < 50;

-- ============================================================================
-- Test: test_tablesample_multiple_tables
-- Source: tablesample_comprehensive_tdd.rs:721
-- ============================================================================
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (id INT64);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, data STRING);

SELECT id FROM table1 TABLESAMPLE SYSTEM (20) REPEATABLE (1)
UNION ALL
SELECT id FROM table2 TABLESAMPLE SYSTEM (20) REPEATABLE (2);
SELECT COUNT(*) FROM large TABLESAMPLE SYSTEM (1);

-- ============================================================================
-- Test: test_tablesample_performance_large_table
-- Source: tablesample_comprehensive_tdd.rs:768
-- ============================================================================
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, data STRING);

SELECT COUNT(*) FROM large TABLESAMPLE SYSTEM (1);
