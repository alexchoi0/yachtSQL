-- Window Functions Operators - SQL:2023
-- Description: Window functions with logical operators
--
-- PostgreSQL: Full support
-- BigQuery: Full support
-- SQL Standard: SQL:2023

DROP TABLE IF EXISTS nullable_scores;
CREATE TABLE nullable_scores ( id INT64, score INT64 );
INSERT INTO nullable_scores VALUES (1, 100);
INSERT INTO nullable_scores VALUES (2, NULL);
INSERT INTO nullable_scores VALUES (3, 200);
INSERT INTO nullable_scores VALUES (4, NULL);
DROP TABLE IF EXISTS single_value;
CREATE TABLE single_value ( value FLOAT64 );
INSERT INTO single_value VALUES (42.0);
DROP TABLE IF EXISTS two_values;
CREATE TABLE two_values ( value FLOAT64 );
INSERT INTO two_values VALUES (10.0);
INSERT INTO two_values VALUES (20.0);
DROP TABLE IF EXISTS identical;
CREATE TABLE identical ( value FLOAT64 );
INSERT INTO identical VALUES (42.0);
DROP TABLE IF EXISTS even_count;
CREATE TABLE even_count ( value FLOAT64 );
INSERT INTO even_count VALUES (1.0);
INSERT INTO even_count VALUES (2.0);
INSERT INTO even_count VALUES (3.0);
INSERT INTO even_count VALUES (4.0);
DROP TABLE IF EXISTS odd_count;
CREATE TABLE odd_count ( value FLOAT64 );
INSERT INTO odd_count VALUES (1.0);
INSERT INTO odd_count VALUES (2.0);
INSERT INTO odd_count VALUES (3.0);
INSERT INTO odd_count VALUES (4.0);
INSERT INTO odd_count VALUES (5.0);
DROP TABLE IF EXISTS with_nulls;
CREATE TABLE with_nulls ( value FLOAT64 );
INSERT INTO with_nulls VALUES (1.0);
INSERT INTO with_nulls VALUES (NULL);
INSERT INTO with_nulls VALUES (2.0);
INSERT INTO with_nulls VALUES (NULL);
INSERT INTO with_nulls VALUES (3.0);
DROP TABLE IF EXISTS extreme_values;
CREATE TABLE extreme_values ( value FLOAT64 );
INSERT INTO extreme_values VALUES (1.0);
INSERT INTO extreme_values VALUES (1000000.0);
DROP TABLE IF EXISTS empty_table;
CREATE TABLE empty_table ( value FLOAT64 );
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions ( id INT64, account STRING, amount NUMERIC(10, 2), date DATE );
INSERT INTO transactions VALUES (1, 'A', 100.50, '2025-01-01');
INSERT INTO transactions VALUES (2, 'A', 200.25, '2025-01-02');
INSERT INTO transactions VALUES (3, 'B', 150.00, '2025-01-01');
INSERT INTO transactions VALUES (4, 'B', 300.75, '2025-01-02');
DROP TABLE IF EXISTS salaries;
CREATE TABLE salaries ( id INT64, department STRING, salary FLOAT64 );
INSERT INTO salaries VALUES (1, 'Engineering', 100000);
INSERT INTO salaries VALUES (2, 'Engineering', 105000);
INSERT INTO salaries VALUES (3, 'Engineering', 102000);
INSERT INTO salaries VALUES (4, 'Sales', 50000);
INSERT INTO salaries VALUES (5, 'Sales', 150000);
DROP TABLE IF EXISTS product_sales;
CREATE TABLE product_sales ( product_id INT64, category STRING, sales FLOAT64 );
INSERT INTO product_sales VALUES (1, 'Electronics', 1000);
INSERT INTO product_sales VALUES (2, 'Electronics', 2000);
INSERT INTO product_sales VALUES (3, 'Electronics', 1500);
INSERT INTO product_sales VALUES (4, 'Clothing', 500);
INSERT INTO product_sales VALUES (5, 'Clothing', 800);
DROP TABLE IF EXISTS division;
CREATE TABLE division ( numerator NUMERIC(10, 2), denominator NUMERIC(10, 2) );
INSERT INTO division VALUES (100.00, 0.00);
DROP TABLE IF EXISTS data;
CREATE TABLE data ( id INT64, value INT64 );
INSERT INTO data VALUES (1, 100);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( category STRING, amount FLOAT64 );
INSERT INTO sales VALUES ('A', 100);

-- Tag: window_functions_window_functions_operators_test_select_001
SELECT id, score, RANK() OVER (ORDER BY score DESC) as rank
FROM nullable_scores;
-- Tag: window_functions_window_functions_operators_test_select_002
SELECT STDDEV_POP(value) as pop_stddev FROM single_value;
-- Tag: window_functions_window_functions_operators_test_select_003
SELECT STDDEV_SAMP(value) as sample_stddev FROM two_values;
-- Tag: window_functions_window_functions_operators_test_select_004
SELECT VAR_POP(value) as pop_var, VAR_SAMP(value) as samp_var FROM identical;
-- Tag: window_functions_window_functions_operators_test_select_005
SELECT MEDIAN(value) as median FROM even_count;
-- Tag: window_functions_window_functions_operators_test_select_006
SELECT MEDIAN(value) as median FROM odd_count;
-- Tag: window_functions_window_functions_operators_test_select_007
SELECT MEDIAN(value) as median FROM with_nulls;
-- Tag: window_functions_window_functions_operators_test_select_008
SELECT STDDEV_SAMP(value) as stddev FROM extreme_values;
-- Tag: window_functions_window_functions_operators_test_select_009
SELECT STDDEV_POP(value) as stddev,
VAR_POP(value) as variance,
MEDIAN(value) as median
FROM empty_table;
-- Tag: window_functions_window_functions_operators_test_select_010
SELECT account,
amount,
SUM(amount) OVER (PARTITION BY account ORDER BY date) as running_total,
RANK() OVER (PARTITION BY account ORDER BY amount DESC) as amount_rank
FROM transactions
ORDER BY account, date;
-- Tag: window_functions_window_functions_operators_test_select_011
SELECT department,
STDDEV_POP(salary) as stddev,
VAR_POP(salary) as variance
FROM salaries
GROUP BY department
HAVING STDDEV_POP(salary) > 10000
ORDER BY stddev DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_012
SELECT product_id,
category,
sales,
RANK() OVER (PARTITION BY category ORDER BY sales DESC) as rank
FROM product_sales
)
-- Tag: window_functions_window_functions_operators_test_select_013
SELECT product_id, category, sales, rank
FROM ranked
WHERE rank <= 2
ORDER BY category, rank;
-- Tag: window_functions_window_functions_operators_test_select_014
SELECT numerator / denominator FROM division;
-- Tag: window_functions_window_functions_operators_test_select_015
SELECT RANK() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_016
SELECT category FROM sales WHERE SUM(amount) > 50;

DROP TABLE IF EXISTS salaries;
CREATE TABLE salaries ( id INT64, department STRING, salary FLOAT64 );
INSERT INTO salaries VALUES (1, 'Engineering', 100000);
INSERT INTO salaries VALUES (2, 'Engineering', 105000);
INSERT INTO salaries VALUES (3, 'Engineering', 102000);
INSERT INTO salaries VALUES (4, 'Sales', 50000);
INSERT INTO salaries VALUES (5, 'Sales', 150000);
DROP TABLE IF EXISTS product_sales;
CREATE TABLE product_sales ( product_id INT64, category STRING, sales FLOAT64 );
INSERT INTO product_sales VALUES (1, 'Electronics', 1000);
INSERT INTO product_sales VALUES (2, 'Electronics', 2000);
INSERT INTO product_sales VALUES (3, 'Electronics', 1500);
INSERT INTO product_sales VALUES (4, 'Clothing', 500);
INSERT INTO product_sales VALUES (5, 'Clothing', 800);
DROP TABLE IF EXISTS division;
CREATE TABLE division ( numerator NUMERIC(10, 2), denominator NUMERIC(10, 2) );
INSERT INTO division VALUES (100.00, 0.00);
DROP TABLE IF EXISTS data;
CREATE TABLE data ( id INT64, value INT64 );
INSERT INTO data VALUES (1, 100);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( category STRING, amount FLOAT64 );
INSERT INTO sales VALUES ('A', 100);

-- Tag: window_functions_window_functions_operators_test_select_017
SELECT department,
STDDEV_POP(salary) as stddev,
VAR_POP(salary) as variance
FROM salaries
GROUP BY department
HAVING STDDEV_POP(salary) > 10000
ORDER BY stddev DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_018
SELECT product_id,
category,
sales,
RANK() OVER (PARTITION BY category ORDER BY sales DESC) as rank
FROM product_sales
)
-- Tag: window_functions_window_functions_operators_test_select_019
SELECT product_id, category, sales, rank
FROM ranked
WHERE rank <= 2
ORDER BY category, rank;
-- Tag: window_functions_window_functions_operators_test_select_020
SELECT numerator / denominator FROM division;
-- Tag: window_functions_window_functions_operators_test_select_021
SELECT RANK() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_022
SELECT category FROM sales WHERE SUM(amount) > 50;

DROP TABLE IF EXISTS product_sales;
CREATE TABLE product_sales ( product_id INT64, category STRING, sales FLOAT64 );
INSERT INTO product_sales VALUES (1, 'Electronics', 1000);
INSERT INTO product_sales VALUES (2, 'Electronics', 2000);
INSERT INTO product_sales VALUES (3, 'Electronics', 1500);
INSERT INTO product_sales VALUES (4, 'Clothing', 500);
INSERT INTO product_sales VALUES (5, 'Clothing', 800);
DROP TABLE IF EXISTS division;
CREATE TABLE division ( numerator NUMERIC(10, 2), denominator NUMERIC(10, 2) );
INSERT INTO division VALUES (100.00, 0.00);
DROP TABLE IF EXISTS data;
CREATE TABLE data ( id INT64, value INT64 );
INSERT INTO data VALUES (1, 100);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( category STRING, amount FLOAT64 );
INSERT INTO sales VALUES ('A', 100);

WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_023
SELECT product_id,
category,
sales,
RANK() OVER (PARTITION BY category ORDER BY sales DESC) as rank
FROM product_sales
)
-- Tag: window_functions_window_functions_operators_test_select_024
SELECT product_id, category, sales, rank
FROM ranked
WHERE rank <= 2
ORDER BY category, rank;
-- Tag: window_functions_window_functions_operators_test_select_025
SELECT numerator / denominator FROM division;
-- Tag: window_functions_window_functions_operators_test_select_026
SELECT RANK() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_027
SELECT category FROM sales WHERE SUM(amount) > 50;

DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 2), (2, 4), (3, 6), (4, 8), (5, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 10), (2, 8), (3, 6), (4, 4), (5, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 5), (2, 3), (3, 8), (4, 2), (5, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 2), (2, 4), (3, 6), (4, 8), (5, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 2), (2, 4), (3, 6), (4, 8), (5, 10);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('A'), ('B'), ('B'), ('B'), ('C');
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('A'), (NULL), ('B'), (NULL), ('C');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (30), (10), (50), (20), (40);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('A'), ('B'), ('B'), ('C');
DROP TABLE IF EXISTS items;
CREATE TABLE items (value INT64);
INSERT INTO items VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS items;
CREATE TABLE items (value INT64);
INSERT INTO items VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (category STRING, value FLOAT64);
INSERT INTO measurements VALUES ('A', 10), ('A', 20), ('A', 30);
INSERT INTO measurements VALUES ('B', 100), ('B', 200), ('B', 300);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (student STRING, score FLOAT64);
INSERT INTO scores VALUES ('A', 85), ('A', 90), ('A', 95);
INSERT INTO scores VALUES ('B', 70), ('B', 75), ('B', 80);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES ('A', 100), ('A', 150), ('B', 200), ('B', 250);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (dept STRING, salary FLOAT64);
INSERT INTO employees VALUES ('Sales', 50000), ('Sales', 60000), ('Sales', 70000);
INSERT INTO employees VALUES ('Eng', 80000), ('Eng', 90000), ('Eng', 100000);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (42);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (42), (42), (42), (42), (42);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (10), (10), (20), (30), (30), (30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 2), (NULL, 4), (3, 6), (4, NULL), (5, 10);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (10), (20), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x STRING, y FLOAT64);
INSERT INTO data VALUES ('a', 1.0), ('b', 2.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('B'), ('C');

-- Tag: window_functions_window_functions_operators_test_select_028
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_029
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_030
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_031
SELECT COVAR_POP(x, y) AS covariance FROM data;
-- Tag: window_functions_window_functions_operators_test_select_032
SELECT COVAR_SAMP(x, y) AS covariance FROM data;
-- Tag: window_functions_window_functions_operators_test_select_033
SELECT COUNT(DISTINCT category) AS distinct_count FROM items;
-- Tag: window_functions_window_functions_operators_test_select_034
SELECT COUNT(DISTINCT category) AS distinct_count FROM items;
-- Tag: window_functions_window_functions_operators_test_select_035
SELECT COUNTIF(value > 25) AS count_gt_25 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_036
SELECT COUNTIF(value > 25) AS count FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_037
SELECT ARRAY_AGG(value ORDER BY value) AS sorted_array FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_038
SELECT ARRAY_AGG(value ORDER BY value LIMIT 3) AS top3 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_039
SELECT ARRAY_AGG(DISTINCT category) AS categories FROM items;
-- Tag: window_functions_window_functions_operators_test_select_040
SELECT ARRAY_AGG(value IGNORE NULLS) AS non_null_array FROM items;
-- Tag: window_functions_window_functions_operators_test_select_041
SELECT ARRAY_AGG(value RESPECT NULLS) AS all_values FROM items;
-- Tag: window_functions_window_functions_operators_test_select_042
SELECT category, STDDEV(value) AS stddev FROM measurements GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_043
SELECT student, PERCENTILE_CONT(score, 0.5) AS median_score FROM scores GROUP BY student ORDER BY student;
-- Tag: window_functions_window_functions_operators_test_select_001
SELECT
AVG(value) AS mean,
STDDEV(value) AS stddev,
VARIANCE(value) AS variance,
MEDIAN(value) AS median,
MIN(value) AS min,
MAX(value) AS max
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_002
SELECT
product,
amount,
STDDEV(amount) OVER (PARTITION BY product) AS product_stddev
FROM sales
ORDER BY product, amount;
-- Tag: window_functions_window_functions_operators_test_select_003
SELECT
dept,
salary,
PERCENTILE_CONT(salary, 0.5) OVER (PARTITION BY dept) AS dept_median
FROM employees
ORDER BY dept, salary;
-- Tag: window_functions_window_functions_operators_test_select_044
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_045
SELECT PERCENTILE_CONT(value, 0.5) AS median FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_046
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_047
SELECT PERCENTILE_CONT(value, 0.5) AS median FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_004
SELECT
AVG(value) AS mean,
STDDEV(value) AS stddev,
MEDIAN(value) AS median
FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_048
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_049
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_050
SELECT PERCENTILE_CONT(value, 1.5) AS result FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_051
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_052
SELECT APPROX_TOP_COUNT(category, -1) AS result FROM items;

DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 10), (2, 8), (3, 6), (4, 4), (5, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 5), (2, 3), (3, 8), (4, 2), (5, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 2), (2, 4), (3, 6), (4, 8), (5, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 2), (2, 4), (3, 6), (4, 8), (5, 10);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('A'), ('B'), ('B'), ('B'), ('C');
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('A'), (NULL), ('B'), (NULL), ('C');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (30), (10), (50), (20), (40);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('A'), ('B'), ('B'), ('C');
DROP TABLE IF EXISTS items;
CREATE TABLE items (value INT64);
INSERT INTO items VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS items;
CREATE TABLE items (value INT64);
INSERT INTO items VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (category STRING, value FLOAT64);
INSERT INTO measurements VALUES ('A', 10), ('A', 20), ('A', 30);
INSERT INTO measurements VALUES ('B', 100), ('B', 200), ('B', 300);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (student STRING, score FLOAT64);
INSERT INTO scores VALUES ('A', 85), ('A', 90), ('A', 95);
INSERT INTO scores VALUES ('B', 70), ('B', 75), ('B', 80);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES ('A', 100), ('A', 150), ('B', 200), ('B', 250);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (dept STRING, salary FLOAT64);
INSERT INTO employees VALUES ('Sales', 50000), ('Sales', 60000), ('Sales', 70000);
INSERT INTO employees VALUES ('Eng', 80000), ('Eng', 90000), ('Eng', 100000);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (42);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (42), (42), (42), (42), (42);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (10), (10), (20), (30), (30), (30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 2), (NULL, 4), (3, 6), (4, NULL), (5, 10);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (10), (20), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x STRING, y FLOAT64);
INSERT INTO data VALUES ('a', 1.0), ('b', 2.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('B'), ('C');

-- Tag: window_functions_window_functions_operators_test_select_053
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_054
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_055
SELECT COVAR_POP(x, y) AS covariance FROM data;
-- Tag: window_functions_window_functions_operators_test_select_056
SELECT COVAR_SAMP(x, y) AS covariance FROM data;
-- Tag: window_functions_window_functions_operators_test_select_057
SELECT COUNT(DISTINCT category) AS distinct_count FROM items;
-- Tag: window_functions_window_functions_operators_test_select_058
SELECT COUNT(DISTINCT category) AS distinct_count FROM items;
-- Tag: window_functions_window_functions_operators_test_select_059
SELECT COUNTIF(value > 25) AS count_gt_25 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_060
SELECT COUNTIF(value > 25) AS count FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_061
SELECT ARRAY_AGG(value ORDER BY value) AS sorted_array FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_062
SELECT ARRAY_AGG(value ORDER BY value LIMIT 3) AS top3 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_063
SELECT ARRAY_AGG(DISTINCT category) AS categories FROM items;
-- Tag: window_functions_window_functions_operators_test_select_064
SELECT ARRAY_AGG(value IGNORE NULLS) AS non_null_array FROM items;
-- Tag: window_functions_window_functions_operators_test_select_065
SELECT ARRAY_AGG(value RESPECT NULLS) AS all_values FROM items;
-- Tag: window_functions_window_functions_operators_test_select_066
SELECT category, STDDEV(value) AS stddev FROM measurements GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_067
SELECT student, PERCENTILE_CONT(score, 0.5) AS median_score FROM scores GROUP BY student ORDER BY student;
-- Tag: window_functions_window_functions_operators_test_select_005
SELECT
AVG(value) AS mean,
STDDEV(value) AS stddev,
VARIANCE(value) AS variance,
MEDIAN(value) AS median,
MIN(value) AS min,
MAX(value) AS max
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_006
SELECT
product,
amount,
STDDEV(amount) OVER (PARTITION BY product) AS product_stddev
FROM sales
ORDER BY product, amount;
-- Tag: window_functions_window_functions_operators_test_select_007
SELECT
dept,
salary,
PERCENTILE_CONT(salary, 0.5) OVER (PARTITION BY dept) AS dept_median
FROM employees
ORDER BY dept, salary;
-- Tag: window_functions_window_functions_operators_test_select_068
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_069
SELECT PERCENTILE_CONT(value, 0.5) AS median FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_070
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_071
SELECT PERCENTILE_CONT(value, 0.5) AS median FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_008
SELECT
AVG(value) AS mean,
STDDEV(value) AS stddev,
MEDIAN(value) AS median
FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_072
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_073
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_074
SELECT PERCENTILE_CONT(value, 1.5) AS result FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_075
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_076
SELECT APPROX_TOP_COUNT(category, -1) AS result FROM items;

DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 5), (2, 3), (3, 8), (4, 2), (5, 7);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 2), (2, 4), (3, 6), (4, 8), (5, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 2), (2, 4), (3, 6), (4, 8), (5, 10);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('A'), ('B'), ('B'), ('B'), ('C');
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('A'), (NULL), ('B'), (NULL), ('C');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (30), (10), (50), (20), (40);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('A'), ('B'), ('B'), ('C');
DROP TABLE IF EXISTS items;
CREATE TABLE items (value INT64);
INSERT INTO items VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS items;
CREATE TABLE items (value INT64);
INSERT INTO items VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (category STRING, value FLOAT64);
INSERT INTO measurements VALUES ('A', 10), ('A', 20), ('A', 30);
INSERT INTO measurements VALUES ('B', 100), ('B', 200), ('B', 300);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (student STRING, score FLOAT64);
INSERT INTO scores VALUES ('A', 85), ('A', 90), ('A', 95);
INSERT INTO scores VALUES ('B', 70), ('B', 75), ('B', 80);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES ('A', 100), ('A', 150), ('B', 200), ('B', 250);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (dept STRING, salary FLOAT64);
INSERT INTO employees VALUES ('Sales', 50000), ('Sales', 60000), ('Sales', 70000);
INSERT INTO employees VALUES ('Eng', 80000), ('Eng', 90000), ('Eng', 100000);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (42);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (42), (42), (42), (42), (42);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (10), (10), (20), (30), (30), (30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 2), (NULL, 4), (3, 6), (4, NULL), (5, 10);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (10), (20), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x STRING, y FLOAT64);
INSERT INTO data VALUES ('a', 1.0), ('b', 2.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('B'), ('C');

-- Tag: window_functions_window_functions_operators_test_select_077
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_078
SELECT COVAR_POP(x, y) AS covariance FROM data;
-- Tag: window_functions_window_functions_operators_test_select_079
SELECT COVAR_SAMP(x, y) AS covariance FROM data;
-- Tag: window_functions_window_functions_operators_test_select_080
SELECT COUNT(DISTINCT category) AS distinct_count FROM items;
-- Tag: window_functions_window_functions_operators_test_select_081
SELECT COUNT(DISTINCT category) AS distinct_count FROM items;
-- Tag: window_functions_window_functions_operators_test_select_082
SELECT COUNTIF(value > 25) AS count_gt_25 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_083
SELECT COUNTIF(value > 25) AS count FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_084
SELECT ARRAY_AGG(value ORDER BY value) AS sorted_array FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_085
SELECT ARRAY_AGG(value ORDER BY value LIMIT 3) AS top3 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_086
SELECT ARRAY_AGG(DISTINCT category) AS categories FROM items;
-- Tag: window_functions_window_functions_operators_test_select_087
SELECT ARRAY_AGG(value IGNORE NULLS) AS non_null_array FROM items;
-- Tag: window_functions_window_functions_operators_test_select_088
SELECT ARRAY_AGG(value RESPECT NULLS) AS all_values FROM items;
-- Tag: window_functions_window_functions_operators_test_select_089
SELECT category, STDDEV(value) AS stddev FROM measurements GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_090
SELECT student, PERCENTILE_CONT(score, 0.5) AS median_score FROM scores GROUP BY student ORDER BY student;
-- Tag: window_functions_window_functions_operators_test_select_009
SELECT
AVG(value) AS mean,
STDDEV(value) AS stddev,
VARIANCE(value) AS variance,
MEDIAN(value) AS median,
MIN(value) AS min,
MAX(value) AS max
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_010
SELECT
product,
amount,
STDDEV(amount) OVER (PARTITION BY product) AS product_stddev
FROM sales
ORDER BY product, amount;
-- Tag: window_functions_window_functions_operators_test_select_011
SELECT
dept,
salary,
PERCENTILE_CONT(salary, 0.5) OVER (PARTITION BY dept) AS dept_median
FROM employees
ORDER BY dept, salary;
-- Tag: window_functions_window_functions_operators_test_select_091
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_092
SELECT PERCENTILE_CONT(value, 0.5) AS median FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_093
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_094
SELECT PERCENTILE_CONT(value, 0.5) AS median FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_012
SELECT
AVG(value) AS mean,
STDDEV(value) AS stddev,
MEDIAN(value) AS median
FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_095
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_096
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_097
SELECT PERCENTILE_CONT(value, 1.5) AS result FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_098
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_099
SELECT APPROX_TOP_COUNT(category, -1) AS result FROM items;

DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (30), (10), (50), (20), (40);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('A'), ('B'), ('B'), ('C');
DROP TABLE IF EXISTS items;
CREATE TABLE items (value INT64);
INSERT INTO items VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS items;
CREATE TABLE items (value INT64);
INSERT INTO items VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (category STRING, value FLOAT64);
INSERT INTO measurements VALUES ('A', 10), ('A', 20), ('A', 30);
INSERT INTO measurements VALUES ('B', 100), ('B', 200), ('B', 300);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (student STRING, score FLOAT64);
INSERT INTO scores VALUES ('A', 85), ('A', 90), ('A', 95);
INSERT INTO scores VALUES ('B', 70), ('B', 75), ('B', 80);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES ('A', 100), ('A', 150), ('B', 200), ('B', 250);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (dept STRING, salary FLOAT64);
INSERT INTO employees VALUES ('Sales', 50000), ('Sales', 60000), ('Sales', 70000);
INSERT INTO employees VALUES ('Eng', 80000), ('Eng', 90000), ('Eng', 100000);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (42);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (42), (42), (42), (42), (42);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (10), (10), (20), (30), (30), (30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 2), (NULL, 4), (3, 6), (4, NULL), (5, 10);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (10), (20), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x STRING, y FLOAT64);
INSERT INTO data VALUES ('a', 1.0), ('b', 2.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('B'), ('C');

-- Tag: window_functions_window_functions_operators_test_select_100
SELECT ARRAY_AGG(value ORDER BY value) AS sorted_array FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_101
SELECT ARRAY_AGG(value ORDER BY value LIMIT 3) AS top3 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_102
SELECT ARRAY_AGG(DISTINCT category) AS categories FROM items;
-- Tag: window_functions_window_functions_operators_test_select_103
SELECT ARRAY_AGG(value IGNORE NULLS) AS non_null_array FROM items;
-- Tag: window_functions_window_functions_operators_test_select_104
SELECT ARRAY_AGG(value RESPECT NULLS) AS all_values FROM items;
-- Tag: window_functions_window_functions_operators_test_select_105
SELECT category, STDDEV(value) AS stddev FROM measurements GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_106
SELECT student, PERCENTILE_CONT(score, 0.5) AS median_score FROM scores GROUP BY student ORDER BY student;
-- Tag: window_functions_window_functions_operators_test_select_013
SELECT
AVG(value) AS mean,
STDDEV(value) AS stddev,
VARIANCE(value) AS variance,
MEDIAN(value) AS median,
MIN(value) AS min,
MAX(value) AS max
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_014
SELECT
product,
amount,
STDDEV(amount) OVER (PARTITION BY product) AS product_stddev
FROM sales
ORDER BY product, amount;
-- Tag: window_functions_window_functions_operators_test_select_015
SELECT
dept,
salary,
PERCENTILE_CONT(salary, 0.5) OVER (PARTITION BY dept) AS dept_median
FROM employees
ORDER BY dept, salary;
-- Tag: window_functions_window_functions_operators_test_select_107
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_108
SELECT PERCENTILE_CONT(value, 0.5) AS median FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_109
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_110
SELECT PERCENTILE_CONT(value, 0.5) AS median FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_016
SELECT
AVG(value) AS mean,
STDDEV(value) AS stddev,
MEDIAN(value) AS median
FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_111
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_112
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_113
SELECT PERCENTILE_CONT(value, 1.5) AS result FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_114
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_115
SELECT APPROX_TOP_COUNT(category, -1) AS result FROM items;

DROP TABLE IF EXISTS items;
CREATE TABLE items (value INT64);
INSERT INTO items VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS items;
CREATE TABLE items (value INT64);
INSERT INTO items VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (category STRING, value FLOAT64);
INSERT INTO measurements VALUES ('A', 10), ('A', 20), ('A', 30);
INSERT INTO measurements VALUES ('B', 100), ('B', 200), ('B', 300);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (student STRING, score FLOAT64);
INSERT INTO scores VALUES ('A', 85), ('A', 90), ('A', 95);
INSERT INTO scores VALUES ('B', 70), ('B', 75), ('B', 80);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES ('A', 100), ('A', 150), ('B', 200), ('B', 250);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (dept STRING, salary FLOAT64);
INSERT INTO employees VALUES ('Sales', 50000), ('Sales', 60000), ('Sales', 70000);
INSERT INTO employees VALUES ('Eng', 80000), ('Eng', 90000), ('Eng', 100000);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (42);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (42), (42), (42), (42), (42);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (10), (10), (20), (30), (30), (30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 2), (NULL, 4), (3, 6), (4, NULL), (5, 10);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (10), (20), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x STRING, y FLOAT64);
INSERT INTO data VALUES ('a', 1.0), ('b', 2.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('B'), ('C');

-- Tag: window_functions_window_functions_operators_test_select_116
SELECT ARRAY_AGG(value IGNORE NULLS) AS non_null_array FROM items;
-- Tag: window_functions_window_functions_operators_test_select_117
SELECT ARRAY_AGG(value RESPECT NULLS) AS all_values FROM items;
-- Tag: window_functions_window_functions_operators_test_select_118
SELECT category, STDDEV(value) AS stddev FROM measurements GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_119
SELECT student, PERCENTILE_CONT(score, 0.5) AS median_score FROM scores GROUP BY student ORDER BY student;
-- Tag: window_functions_window_functions_operators_test_select_017
SELECT
AVG(value) AS mean,
STDDEV(value) AS stddev,
VARIANCE(value) AS variance,
MEDIAN(value) AS median,
MIN(value) AS min,
MAX(value) AS max
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_018
SELECT
product,
amount,
STDDEV(amount) OVER (PARTITION BY product) AS product_stddev
FROM sales
ORDER BY product, amount;
-- Tag: window_functions_window_functions_operators_test_select_019
SELECT
dept,
salary,
PERCENTILE_CONT(salary, 0.5) OVER (PARTITION BY dept) AS dept_median
FROM employees
ORDER BY dept, salary;
-- Tag: window_functions_window_functions_operators_test_select_120
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_121
SELECT PERCENTILE_CONT(value, 0.5) AS median FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_122
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_123
SELECT PERCENTILE_CONT(value, 0.5) AS median FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_020
SELECT
AVG(value) AS mean,
STDDEV(value) AS stddev,
MEDIAN(value) AS median
FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_124
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_125
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_126
SELECT PERCENTILE_CONT(value, 1.5) AS result FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_127
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_128
SELECT APPROX_TOP_COUNT(category, -1) AS result FROM items;

DROP TABLE IF EXISTS items;
CREATE TABLE items (value INT64);
INSERT INTO items VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (category STRING, value FLOAT64);
INSERT INTO measurements VALUES ('A', 10), ('A', 20), ('A', 30);
INSERT INTO measurements VALUES ('B', 100), ('B', 200), ('B', 300);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (student STRING, score FLOAT64);
INSERT INTO scores VALUES ('A', 85), ('A', 90), ('A', 95);
INSERT INTO scores VALUES ('B', 70), ('B', 75), ('B', 80);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES ('A', 100), ('A', 150), ('B', 200), ('B', 250);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (dept STRING, salary FLOAT64);
INSERT INTO employees VALUES ('Sales', 50000), ('Sales', 60000), ('Sales', 70000);
INSERT INTO employees VALUES ('Eng', 80000), ('Eng', 90000), ('Eng', 100000);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (42);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (42), (42), (42), (42), (42);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (10), (10), (20), (30), (30), (30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x FLOAT64, y FLOAT64);
INSERT INTO data VALUES (1, 2), (NULL, 4), (3, 6), (4, NULL), (5, 10);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value FLOAT64);
INSERT INTO numbers VALUES (10), (20), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (x STRING, y FLOAT64);
INSERT INTO data VALUES ('a', 1.0), ('b', 2.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING);
INSERT INTO items VALUES ('A'), ('B'), ('C');

-- Tag: window_functions_window_functions_operators_test_select_129
SELECT ARRAY_AGG(value RESPECT NULLS) AS all_values FROM items;
-- Tag: window_functions_window_functions_operators_test_select_130
SELECT category, STDDEV(value) AS stddev FROM measurements GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_131
SELECT student, PERCENTILE_CONT(score, 0.5) AS median_score FROM scores GROUP BY student ORDER BY student;
-- Tag: window_functions_window_functions_operators_test_select_021
SELECT
AVG(value) AS mean,
STDDEV(value) AS stddev,
VARIANCE(value) AS variance,
MEDIAN(value) AS median,
MIN(value) AS min,
MAX(value) AS max
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_022
SELECT
product,
amount,
STDDEV(amount) OVER (PARTITION BY product) AS product_stddev
FROM sales
ORDER BY product, amount;
-- Tag: window_functions_window_functions_operators_test_select_023
SELECT
dept,
salary,
PERCENTILE_CONT(salary, 0.5) OVER (PARTITION BY dept) AS dept_median
FROM employees
ORDER BY dept, salary;
-- Tag: window_functions_window_functions_operators_test_select_132
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_133
SELECT PERCENTILE_CONT(value, 0.5) AS median FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_134
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_135
SELECT PERCENTILE_CONT(value, 0.5) AS median FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_024
SELECT
AVG(value) AS mean,
STDDEV(value) AS stddev,
MEDIAN(value) AS median
FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_136
SELECT STDDEV(value) AS stddev FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_137
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_138
SELECT PERCENTILE_CONT(value, 1.5) AS result FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_139
SELECT CORR(x, y) AS correlation FROM data;
-- Tag: window_functions_window_functions_operators_test_select_140
SELECT APPROX_TOP_COUNT(category, -1) AS result FROM items;

DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (false), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (NULL), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', true), ('A', true), ('B', true), ('B', false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (false), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (true), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (NULL), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', false), ('A', false), ('B', false), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_141
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_142
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_143
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_144
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_145
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_146
SELECT BOOL_AND(value > 5) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_147
SELECT category, BOOL_AND(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_148
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_149
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_150
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_151
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_152
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_153
SELECT BOOL_OR(value > 25) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_154
SELECT category, BOOL_OR(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_155
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_156
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_157
SELECT EVERY(value > 0) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_158
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_159
SELECT BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true FROM test;
-- Tag: window_functions_window_functions_operators_test_select_160
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_161
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_162
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_163
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (false), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (NULL), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', true), ('A', true), ('B', true), ('B', false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (false), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (true), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (NULL), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', false), ('A', false), ('B', false), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_164
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_165
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_166
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_167
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_168
SELECT BOOL_AND(value > 5) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_169
SELECT category, BOOL_AND(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_170
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_171
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_172
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_173
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_174
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_175
SELECT BOOL_OR(value > 25) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_176
SELECT category, BOOL_OR(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_177
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_178
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_179
SELECT EVERY(value > 0) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_180
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_181
SELECT BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true FROM test;
-- Tag: window_functions_window_functions_operators_test_select_182
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_183
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_184
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_185
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (false), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (NULL), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', true), ('A', true), ('B', true), ('B', false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (false), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (true), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (NULL), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', false), ('A', false), ('B', false), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_186
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_187
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_188
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_189
SELECT BOOL_AND(value > 5) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_190
SELECT category, BOOL_AND(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_191
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_192
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_193
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_194
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_195
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_196
SELECT BOOL_OR(value > 25) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_197
SELECT category, BOOL_OR(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_198
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_199
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_200
SELECT EVERY(value > 0) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_201
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_202
SELECT BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true FROM test;
-- Tag: window_functions_window_functions_operators_test_select_203
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_204
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_205
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_206
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (NULL), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', true), ('A', true), ('B', true), ('B', false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (false), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (true), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (NULL), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', false), ('A', false), ('B', false), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_207
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_208
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_209
SELECT BOOL_AND(value > 5) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_210
SELECT category, BOOL_AND(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_211
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_212
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_213
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_214
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_215
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_216
SELECT BOOL_OR(value > 25) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_217
SELECT category, BOOL_OR(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_218
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_219
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_220
SELECT EVERY(value > 0) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_221
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_222
SELECT BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true FROM test;
-- Tag: window_functions_window_functions_operators_test_select_223
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_224
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_225
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_226
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', true), ('A', true), ('B', true), ('B', false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (false), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (true), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (NULL), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', false), ('A', false), ('B', false), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_227
SELECT BOOL_AND(value > 5) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_228
SELECT category, BOOL_AND(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_229
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_230
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_231
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_232
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_233
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_234
SELECT BOOL_OR(value > 25) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_235
SELECT category, BOOL_OR(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_236
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_237
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_238
SELECT EVERY(value > 0) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_239
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_240
SELECT BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true FROM test;
-- Tag: window_functions_window_functions_operators_test_select_241
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_242
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_243
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_244
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', true), ('A', true), ('B', true), ('B', false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (false), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (true), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (NULL), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', false), ('A', false), ('B', false), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_245
SELECT category, BOOL_AND(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_246
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_247
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_248
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_249
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_250
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_251
SELECT BOOL_OR(value > 25) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_252
SELECT category, BOOL_OR(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_253
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_254
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_255
SELECT EVERY(value > 0) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_256
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_257
SELECT BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true FROM test;
-- Tag: window_functions_window_functions_operators_test_select_258
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_259
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_260
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_261
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (false), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (true), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (NULL), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', false), ('A', false), ('B', false), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_262
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_263
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_264
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_265
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_266
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_267
SELECT BOOL_OR(value > 25) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_268
SELECT category, BOOL_OR(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_269
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_270
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_271
SELECT EVERY(value > 0) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_272
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_273
SELECT BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true FROM test;
-- Tag: window_functions_window_functions_operators_test_select_274
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_275
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_276
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_277
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (true), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (NULL), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', false), ('A', false), ('B', false), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_278
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_279
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_280
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_281
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_282
SELECT BOOL_OR(value > 25) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_283
SELECT category, BOOL_OR(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_284
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_285
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_286
SELECT EVERY(value > 0) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_287
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_288
SELECT BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true FROM test;
-- Tag: window_functions_window_functions_operators_test_select_289
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_290
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_291
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_292
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (NULL), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', false), ('A', false), ('B', false), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_293
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_294
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_295
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_296
SELECT BOOL_OR(value > 25) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_297
SELECT category, BOOL_OR(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_298
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_299
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_300
SELECT EVERY(value > 0) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_301
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_302
SELECT BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true FROM test;
-- Tag: window_functions_window_functions_operators_test_select_303
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_304
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_305
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_306
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (false), (NULL), (false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', false), ('A', false), ('B', false), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_307
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_308
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_309
SELECT BOOL_OR(value > 25) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_310
SELECT category, BOOL_OR(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_311
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_312
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_313
SELECT EVERY(value > 0) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_314
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_315
SELECT BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true FROM test;
-- Tag: window_functions_window_functions_operators_test_select_316
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_317
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_318
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_319
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', false), ('A', false), ('B', false), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_320
SELECT BOOL_OR(value > 25) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_321
SELECT category, BOOL_OR(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_322
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_323
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_324
SELECT EVERY(value > 0) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_325
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_326
SELECT BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true FROM test;
-- Tag: window_functions_window_functions_operators_test_select_327
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_328
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_329
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_330
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOLEAN);
INSERT INTO test VALUES ('A', false), ('A', false), ('B', false), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (true), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (20), (30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_331
SELECT category, BOOL_OR(flag) as result FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_332
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_333
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_334
SELECT EVERY(value > 0) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_335
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_336
SELECT BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true FROM test;
-- Tag: window_functions_window_functions_operators_test_select_337
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_338
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_339
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_340
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (true), (false), (true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_341
SELECT BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true FROM test;
-- Tag: window_functions_window_functions_operators_test_select_342
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_343
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_344
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_345
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);
INSERT INTO test VALUES (NULL), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_346
SELECT BOOL_AND(flag) as and_result, BOOL_OR(flag) as or_result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_347
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_348
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_349
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1), (0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_350
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_351
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_352
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('true');
DROP TABLE IF EXISTS test;
CREATE TABLE test (flag BOOLEAN);

-- Tag: window_functions_window_functions_operators_test_select_353
SELECT BOOL_OR(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_354
SELECT EVERY() FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, TRUE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_355
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_356
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_357
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_358
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_359
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_360
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_361
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_362
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_363
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_364
SELECT category, BOOL_AND(flag) as all_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_365
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_366
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_367
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_368
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_369
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_370
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_371
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_372
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_373
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_374
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_375
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_376
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_377
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_378
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_379
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_380
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_381
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_382
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_383
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_384
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_385
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_386
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_387
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_388
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_389
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_390
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_391
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_392
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_393
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_394
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_395
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_396
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_397
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_398
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, TRUE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_399
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_400
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_401
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_402
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_403
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_404
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_405
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_406
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_407
SELECT category, BOOL_AND(flag) as all_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_408
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_409
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_410
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_411
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_412
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_413
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_414
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_415
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_416
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_417
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_418
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_419
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_420
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_421
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_422
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_423
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_424
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_425
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_426
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_427
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_428
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_429
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_430
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_431
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_432
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_433
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_434
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_435
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_436
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_437
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_438
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_439
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_440
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_441
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, TRUE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_442
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_443
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_444
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_445
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_446
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_447
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_448
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_449
SELECT category, BOOL_AND(flag) as all_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_450
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_451
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_452
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_453
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_454
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_455
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_456
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_457
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_458
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_459
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_460
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_461
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_462
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_463
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_464
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_465
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_466
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_467
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_468
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_469
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_470
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_471
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_472
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_473
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_474
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_475
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_476
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_477
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_478
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_479
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_480
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_481
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_482
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_483
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, TRUE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_484
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_485
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_486
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_487
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_488
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_489
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_490
SELECT category, BOOL_AND(flag) as all_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_491
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_492
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_493
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_494
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_495
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_496
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_497
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_498
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_499
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_500
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_501
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_502
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_503
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_504
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_505
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_506
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_507
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_508
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_509
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_510
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_511
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_512
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_513
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_514
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_515
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_516
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_517
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_518
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_519
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_520
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_521
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_522
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_523
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_524
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, TRUE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_525
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_526
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_527
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_528
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_529
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_530
SELECT category, BOOL_AND(flag) as all_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_531
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_532
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_533
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_534
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_535
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_536
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_537
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_538
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_539
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_540
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_541
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_542
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_543
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_544
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_545
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_546
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_547
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_548
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_549
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_550
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_551
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_552
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_553
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_554
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_555
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_556
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_557
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_558
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_559
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_560
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_561
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_562
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_563
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_564
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, TRUE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_565
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_566
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_567
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_568
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_569
SELECT category, BOOL_AND(flag) as all_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_570
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_571
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_572
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_573
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_574
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_575
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_576
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_577
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_578
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_579
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_580
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_581
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_582
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_583
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_584
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_585
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_586
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_587
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_588
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_589
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_590
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_591
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_592
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_593
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_594
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_595
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_596
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_597
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_598
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_599
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_600
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_601
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_602
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_603
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, TRUE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_604
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_605
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_606
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_607
SELECT category, BOOL_AND(flag) as all_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_608
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_609
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_610
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_611
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_612
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_613
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_614
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_615
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_616
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_617
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_618
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_619
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_620
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_621
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_622
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_623
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_624
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_625
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_626
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_627
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_628
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_629
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_630
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_631
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_632
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_633
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_634
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_635
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_636
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_637
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_638
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_639
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_640
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_641
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, TRUE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_642
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_643
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_644
SELECT category, BOOL_AND(flag) as all_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_645
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_646
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_647
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_648
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_649
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_650
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_651
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_652
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_653
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_654
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_655
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_656
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_657
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_658
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_659
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_660
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_661
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_662
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_663
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_664
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_665
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_666
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_667
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_668
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_669
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_670
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_671
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_672
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_673
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_674
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_675
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_676
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_677
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_678
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, TRUE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_679
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_680
SELECT category, BOOL_AND(flag) as all_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_681
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_682
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_683
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_684
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_685
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_686
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_687
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_688
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_689
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_690
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_691
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_692
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_693
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_694
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_695
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_696
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_697
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_698
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_699
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_700
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_701
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_702
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_703
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_704
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_705
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_706
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_707
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_708
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_709
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_710
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_711
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_712
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_713
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_714
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, TRUE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_715
SELECT category, BOOL_AND(flag) as all_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_716
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_717
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_718
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_719
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_720
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_721
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_722
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_723
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_724
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_725
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_726
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_727
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_728
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_729
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_730
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_731
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_732
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_733
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_734
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_735
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_736
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_737
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_738
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_739
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_740
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_741
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_742
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_743
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_744
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_745
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_746
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_747
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_748
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_749
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, TRUE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_750
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_751
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_752
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_753
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_754
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_755
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_756
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_757
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_758
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_759
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_760
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_761
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_762
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_763
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_764
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_765
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_766
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_767
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_768
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_769
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_770
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_771
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_772
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_773
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_774
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_775
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_776
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_777
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_778
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_779
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_780
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_781
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_782
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_783
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, TRUE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_784
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_785
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_786
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_787
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_788
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_789
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_790
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_791
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_792
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_793
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_794
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_795
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_796
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_797
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_798
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_799
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_800
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_801
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_802
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_803
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_804
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_805
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_806
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_807
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_808
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_809
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_810
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_811
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_812
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_813
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_814
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_815
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_816
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, FALSE), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_817
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_818
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_819
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_820
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_821
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_822
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_823
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_824
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_825
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_826
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_827
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_828
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_829
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_830
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_831
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_832
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_833
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_834
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_835
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_836
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_837
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_838
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_839
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_840
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_841
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_842
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_843
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_844
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_845
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_846
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_847
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_848
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_849
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_850
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_851
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_852
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_853
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_854
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_855
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_856
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_857
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_858
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_859
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_860
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_861
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_862
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_863
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_864
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_865
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_866
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_867
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_868
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_869
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_870
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_871
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_872
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_873
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_874
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_875
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_876
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_877
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_878
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_879
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_880
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_881
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_882
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_883
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_884
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_885
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_886
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_887
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_888
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_889
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_890
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_891
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_892
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_893
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_894
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_895
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_896
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_897
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_898
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_899
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_900
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_901
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_902
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_903
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_904
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_905
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_906
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_907
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_908
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_909
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, FALSE), (2, NULL), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_910
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_911
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_912
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_913
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_914
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_915
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_916
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_917
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_918
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_919
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_920
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_921
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_922
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_923
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_924
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_925
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_926
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_927
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_928
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_929
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_930
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_931
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_932
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_933
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_934
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_935
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_936
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_937
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_938
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_939
SELECT BOOL_OR(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_940
SELECT EVERY(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_941
SELECT BOOL_AND(flag) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_942
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_943
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_944
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_945
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_946
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_947
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_948
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_949
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_950
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_951
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_952
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_953
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_954
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_955
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_956
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_957
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_958
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_959
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_960
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_961
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_962
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_963
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_964
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_965
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_966
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_967
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_968
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_969
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_970
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_971
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_972
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_973
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_974
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_975
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_976
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_977
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_978
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_979
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_980
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_981
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_982
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_983
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_984
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_985
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_986
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_987
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_988
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_989
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_990
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_991
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_992
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_993
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_994
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_995
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_996
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_997
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_998
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_999
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1000
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1001
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1002
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1003
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1004
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1005
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1006
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1007
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1008
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1009
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1010
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1011
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1012
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1013
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1014
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1015
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 15), (2, 0), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1016
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1017
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1018
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1019
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1020
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1021
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1022
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1023
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1024
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1025
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1026
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1027
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1028
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1029
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1030
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1031
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1032
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1033
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1034
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1035
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1036
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1037
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1038
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1039
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1040
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1041
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1042
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1043
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1044
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1045
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1046
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1047
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1048
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1049
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1050
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1051
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1052
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1053
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1054
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1055
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1056
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1057
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1058
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1059
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1060
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1061
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1062
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1063
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1064
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1065
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1066
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1067
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1068
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1069
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1070
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1071
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1072
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1073
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1074
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1075
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1076
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1077
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1078
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1079
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1080
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1081
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1082
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1083
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1084
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1085
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1086
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1087
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1088
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1089
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1090
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1091
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1092
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1093
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1094
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1095
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1096
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1097
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1098
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1099
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1100
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1101
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, -1), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1102
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1103
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1104
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1105
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1106
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1107
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1108
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1109
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1110
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1111
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1112
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1113
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1114
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1115
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1116
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1117
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1118
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1119
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1120
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, 2), (3, 1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1121
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1122
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1123
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1124
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1125
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1126
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1127
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1128
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1129
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1130
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1131
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1132
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1133
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1134
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1135
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1136
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1137
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1138
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 0), (3, 0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1139
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1140
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1141
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1142
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1143
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1144
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1145
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1146
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1147
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1148
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1149
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1150
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1151
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1152
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1153
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1154
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1155
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1156
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1157
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1158
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1159
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1160
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1161
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1162
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1163
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1164
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1165
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1166
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1167
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1168
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1169
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1170
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1171
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1172
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1173
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1174
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1175
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1176
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1177
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1178
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1179
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1180
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1181
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1182
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1183
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1184
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1185
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1186
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 4), (2, NULL), (3, 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1187
SELECT BIT_OR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1188
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1189
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1190
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1191
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1192
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1193
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1194
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1195
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1196
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1197
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1198
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1199
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1200
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 6);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1201
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1202
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1203
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1204
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1205
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1206
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1207
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1208
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1209
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1210
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1211
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1212
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1213
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1214
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1215
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1216
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1217
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1218
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1219
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1220
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1221
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1222
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1223
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1224
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1225
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 7), (2, 7), (3, 7);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1226
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1227
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1228
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1229
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1230
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1231
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1232
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1233
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1234
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1235
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1236
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1237
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1238
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1239
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1240
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1241
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1242
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1243
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1244
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1245
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1246
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1247
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1248
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1249
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1250
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1251
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1252
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1253
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1254
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1255
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, NULL), (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 12), (2, 10), (3, 14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1256
SELECT BIT_XOR(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1257
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or,
BIT_XOR(value) as bit_xor
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1258
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1259
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1260
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1261
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1262
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1263
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, flag BOOL);
INSERT INTO test VALUES
('A', TRUE), ('A', TRUE), ('A', TRUE),
('B', TRUE), ('B', FALSE), ('B', TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (category STRING, value INT64);
INSERT INTO test VALUES
('A', 12), ('A', 10), ('A', 14),
('B', 7), ('B', 3), ('B', 5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1264
SELECT category
FROM test
GROUP BY category
HAVING BOOL_AND(flag) = TRUE;
-- Tag: window_functions_window_functions_operators_test_select_1265
SELECT category,
BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_1266
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1267
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1268
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1269
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 2), (3, 4), (4, 8);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'hello');

-- Tag: window_functions_window_functions_operators_test_select_1270
SELECT BOOL_AND(flag) as bool_and,
BOOL_OR(NOT flag) as or_not
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1271
SELECT BIT_AND(value) as bit_and,
BIT_OR(value) as bit_or
FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1272
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_1273
SELECT BIT_AND(value) FROM test;

DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('A', 20),
('B', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('North', 'Widget', 2023, 100.0),
('North', 'Widget', 2024, 150.0),
('North', 'Gadget', 2023, 200.0),
('South', 'Widget', 2023, 120.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value INT64);
INSERT INTO data VALUES
(3, 'C', 30),
(1, 'A', 10),
(2, 'B', 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64, name STRING);
INSERT INTO data VALUES (10, 'A'), (30, 'C'), (20, 'B');
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, subcategory STRING, value INT64);
INSERT INTO data VALUES
('B', 'Y', 1),
('A', 'Z', 2),
('A', 'X', 3),
('B', 'X', 4);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES
('Alice', 100),
('Bob', 100),
('Charlie', 50),
('David', 100);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING, c INT64);
INSERT INTO data VALUES
(1, 'Z', 10),
(1, 'A', 20),
(2, 'Z', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (price FLOAT64, quantity INT64);
INSERT INTO data VALUES
(10.0, 5),
(20.0, 2),
(5.0, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, value INT64);
INSERT INTO data VALUES
('Alice', 10),
('alice', 20),
('Bob', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1274
SELECT UPPER(category) as cat_upper, SUM(value) as total
FROM data
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1275
SELECT region, product, year, SUM(amount) as total
FROM sales
GROUP BY 1, product, 3
ORDER BY 1, 2, 3;
-- Tag: window_functions_window_functions_operators_test_select_1276
SELECT id, name, value
FROM data
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1277
SELECT value, name
FROM data
ORDER BY 1 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1278
SELECT category, subcategory, value
FROM data
ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_1279
SELECT player, score
FROM scores
ORDER BY 2 DESC, 1 ASC;
-- Tag: window_functions_window_functions_operators_test_select_1280
SELECT a, b, c
FROM data
ORDER BY 1, b DESC, 3;
-- Tag: window_functions_window_functions_operators_test_select_1281
SELECT price, quantity, price * quantity as total
FROM data
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1282
SELECT UPPER(name) as name_upper, SUM(value) as total
FROM data
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1283
SELECT a, b FROM data ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1284
SELECT a, b FROM data ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1285
SELECT category, SUM(value) FROM data GROUP BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1286
SELECT category, SUM(value) FROM data GROUP BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1287
SELECT a FROM data ORDER BY -1;
-- Tag: window_functions_window_functions_operators_test_select_1288
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1289
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1290
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1291
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1292
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1293
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1294
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1295
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1296
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1297
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1298
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1299
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1300
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1301
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('North', 'Widget', 2023, 100.0),
('North', 'Widget', 2024, 150.0),
('North', 'Gadget', 2023, 200.0),
('South', 'Widget', 2023, 120.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value INT64);
INSERT INTO data VALUES
(3, 'C', 30),
(1, 'A', 10),
(2, 'B', 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64, name STRING);
INSERT INTO data VALUES (10, 'A'), (30, 'C'), (20, 'B');
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, subcategory STRING, value INT64);
INSERT INTO data VALUES
('B', 'Y', 1),
('A', 'Z', 2),
('A', 'X', 3),
('B', 'X', 4);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES
('Alice', 100),
('Bob', 100),
('Charlie', 50),
('David', 100);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING, c INT64);
INSERT INTO data VALUES
(1, 'Z', 10),
(1, 'A', 20),
(2, 'Z', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (price FLOAT64, quantity INT64);
INSERT INTO data VALUES
(10.0, 5),
(20.0, 2),
(5.0, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, value INT64);
INSERT INTO data VALUES
('Alice', 10),
('alice', 20),
('Bob', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1302
SELECT region, product, year, SUM(amount) as total
FROM sales
GROUP BY 1, product, 3
ORDER BY 1, 2, 3;
-- Tag: window_functions_window_functions_operators_test_select_1303
SELECT id, name, value
FROM data
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1304
SELECT value, name
FROM data
ORDER BY 1 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1305
SELECT category, subcategory, value
FROM data
ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_1306
SELECT player, score
FROM scores
ORDER BY 2 DESC, 1 ASC;
-- Tag: window_functions_window_functions_operators_test_select_1307
SELECT a, b, c
FROM data
ORDER BY 1, b DESC, 3;
-- Tag: window_functions_window_functions_operators_test_select_1308
SELECT price, quantity, price * quantity as total
FROM data
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1309
SELECT UPPER(name) as name_upper, SUM(value) as total
FROM data
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1310
SELECT a, b FROM data ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1311
SELECT a, b FROM data ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1312
SELECT category, SUM(value) FROM data GROUP BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1313
SELECT category, SUM(value) FROM data GROUP BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1314
SELECT a FROM data ORDER BY -1;
-- Tag: window_functions_window_functions_operators_test_select_1315
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1316
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1317
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1318
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1319
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1320
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1321
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1322
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1323
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1324
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1325
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1326
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1327
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1328
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value INT64);
INSERT INTO data VALUES
(3, 'C', 30),
(1, 'A', 10),
(2, 'B', 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64, name STRING);
INSERT INTO data VALUES (10, 'A'), (30, 'C'), (20, 'B');
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, subcategory STRING, value INT64);
INSERT INTO data VALUES
('B', 'Y', 1),
('A', 'Z', 2),
('A', 'X', 3),
('B', 'X', 4);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES
('Alice', 100),
('Bob', 100),
('Charlie', 50),
('David', 100);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING, c INT64);
INSERT INTO data VALUES
(1, 'Z', 10),
(1, 'A', 20),
(2, 'Z', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (price FLOAT64, quantity INT64);
INSERT INTO data VALUES
(10.0, 5),
(20.0, 2),
(5.0, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, value INT64);
INSERT INTO data VALUES
('Alice', 10),
('alice', 20),
('Bob', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1329
SELECT id, name, value
FROM data
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1330
SELECT value, name
FROM data
ORDER BY 1 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1331
SELECT category, subcategory, value
FROM data
ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_1332
SELECT player, score
FROM scores
ORDER BY 2 DESC, 1 ASC;
-- Tag: window_functions_window_functions_operators_test_select_1333
SELECT a, b, c
FROM data
ORDER BY 1, b DESC, 3;
-- Tag: window_functions_window_functions_operators_test_select_1334
SELECT price, quantity, price * quantity as total
FROM data
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1335
SELECT UPPER(name) as name_upper, SUM(value) as total
FROM data
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1336
SELECT a, b FROM data ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1337
SELECT a, b FROM data ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1338
SELECT category, SUM(value) FROM data GROUP BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1339
SELECT category, SUM(value) FROM data GROUP BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1340
SELECT a FROM data ORDER BY -1;
-- Tag: window_functions_window_functions_operators_test_select_1341
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1342
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1343
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1344
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1345
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1346
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1347
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1348
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1349
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1350
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1351
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1352
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1353
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1354
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64, name STRING);
INSERT INTO data VALUES (10, 'A'), (30, 'C'), (20, 'B');
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, subcategory STRING, value INT64);
INSERT INTO data VALUES
('B', 'Y', 1),
('A', 'Z', 2),
('A', 'X', 3),
('B', 'X', 4);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES
('Alice', 100),
('Bob', 100),
('Charlie', 50),
('David', 100);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING, c INT64);
INSERT INTO data VALUES
(1, 'Z', 10),
(1, 'A', 20),
(2, 'Z', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (price FLOAT64, quantity INT64);
INSERT INTO data VALUES
(10.0, 5),
(20.0, 2),
(5.0, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, value INT64);
INSERT INTO data VALUES
('Alice', 10),
('alice', 20),
('Bob', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1355
SELECT value, name
FROM data
ORDER BY 1 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1356
SELECT category, subcategory, value
FROM data
ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_1357
SELECT player, score
FROM scores
ORDER BY 2 DESC, 1 ASC;
-- Tag: window_functions_window_functions_operators_test_select_1358
SELECT a, b, c
FROM data
ORDER BY 1, b DESC, 3;
-- Tag: window_functions_window_functions_operators_test_select_1359
SELECT price, quantity, price * quantity as total
FROM data
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1360
SELECT UPPER(name) as name_upper, SUM(value) as total
FROM data
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1361
SELECT a, b FROM data ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1362
SELECT a, b FROM data ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1363
SELECT category, SUM(value) FROM data GROUP BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1364
SELECT category, SUM(value) FROM data GROUP BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1365
SELECT a FROM data ORDER BY -1;
-- Tag: window_functions_window_functions_operators_test_select_1366
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1367
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1368
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1369
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1370
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1371
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1372
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1373
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1374
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1375
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1376
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1377
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1378
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1379
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, subcategory STRING, value INT64);
INSERT INTO data VALUES
('B', 'Y', 1),
('A', 'Z', 2),
('A', 'X', 3),
('B', 'X', 4);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES
('Alice', 100),
('Bob', 100),
('Charlie', 50),
('David', 100);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING, c INT64);
INSERT INTO data VALUES
(1, 'Z', 10),
(1, 'A', 20),
(2, 'Z', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (price FLOAT64, quantity INT64);
INSERT INTO data VALUES
(10.0, 5),
(20.0, 2),
(5.0, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, value INT64);
INSERT INTO data VALUES
('Alice', 10),
('alice', 20),
('Bob', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1380
SELECT category, subcategory, value
FROM data
ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_1381
SELECT player, score
FROM scores
ORDER BY 2 DESC, 1 ASC;
-- Tag: window_functions_window_functions_operators_test_select_1382
SELECT a, b, c
FROM data
ORDER BY 1, b DESC, 3;
-- Tag: window_functions_window_functions_operators_test_select_1383
SELECT price, quantity, price * quantity as total
FROM data
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1384
SELECT UPPER(name) as name_upper, SUM(value) as total
FROM data
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1385
SELECT a, b FROM data ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1386
SELECT a, b FROM data ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1387
SELECT category, SUM(value) FROM data GROUP BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1388
SELECT category, SUM(value) FROM data GROUP BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1389
SELECT a FROM data ORDER BY -1;
-- Tag: window_functions_window_functions_operators_test_select_1390
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1391
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1392
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1393
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1394
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1395
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1396
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1397
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1398
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1399
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1400
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1401
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1402
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1403
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES
('Alice', 100),
('Bob', 100),
('Charlie', 50),
('David', 100);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING, c INT64);
INSERT INTO data VALUES
(1, 'Z', 10),
(1, 'A', 20),
(2, 'Z', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (price FLOAT64, quantity INT64);
INSERT INTO data VALUES
(10.0, 5),
(20.0, 2),
(5.0, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, value INT64);
INSERT INTO data VALUES
('Alice', 10),
('alice', 20),
('Bob', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1404
SELECT player, score
FROM scores
ORDER BY 2 DESC, 1 ASC;
-- Tag: window_functions_window_functions_operators_test_select_1405
SELECT a, b, c
FROM data
ORDER BY 1, b DESC, 3;
-- Tag: window_functions_window_functions_operators_test_select_1406
SELECT price, quantity, price * quantity as total
FROM data
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1407
SELECT UPPER(name) as name_upper, SUM(value) as total
FROM data
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1408
SELECT a, b FROM data ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1409
SELECT a, b FROM data ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1410
SELECT category, SUM(value) FROM data GROUP BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1411
SELECT category, SUM(value) FROM data GROUP BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1412
SELECT a FROM data ORDER BY -1;
-- Tag: window_functions_window_functions_operators_test_select_1413
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1414
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1415
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1416
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1417
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1418
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1419
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1420
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1421
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1422
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1423
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1424
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1425
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1426
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING, c INT64);
INSERT INTO data VALUES
(1, 'Z', 10),
(1, 'A', 20),
(2, 'Z', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (price FLOAT64, quantity INT64);
INSERT INTO data VALUES
(10.0, 5),
(20.0, 2),
(5.0, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, value INT64);
INSERT INTO data VALUES
('Alice', 10),
('alice', 20),
('Bob', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1427
SELECT a, b, c
FROM data
ORDER BY 1, b DESC, 3;
-- Tag: window_functions_window_functions_operators_test_select_1428
SELECT price, quantity, price * quantity as total
FROM data
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1429
SELECT UPPER(name) as name_upper, SUM(value) as total
FROM data
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1430
SELECT a, b FROM data ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1431
SELECT a, b FROM data ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1432
SELECT category, SUM(value) FROM data GROUP BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1433
SELECT category, SUM(value) FROM data GROUP BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1434
SELECT a FROM data ORDER BY -1;
-- Tag: window_functions_window_functions_operators_test_select_1435
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1436
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1437
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1438
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1439
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1440
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1441
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1442
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1443
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1444
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1445
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1446
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1447
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1448
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (price FLOAT64, quantity INT64);
INSERT INTO data VALUES
(10.0, 5),
(20.0, 2),
(5.0, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, value INT64);
INSERT INTO data VALUES
('Alice', 10),
('alice', 20),
('Bob', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1449
SELECT price, quantity, price * quantity as total
FROM data
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1450
SELECT UPPER(name) as name_upper, SUM(value) as total
FROM data
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1451
SELECT a, b FROM data ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1452
SELECT a, b FROM data ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1453
SELECT category, SUM(value) FROM data GROUP BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1454
SELECT category, SUM(value) FROM data GROUP BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1455
SELECT a FROM data ORDER BY -1;
-- Tag: window_functions_window_functions_operators_test_select_1456
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1457
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1458
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1459
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1460
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1461
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1462
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1463
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1464
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1465
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1466
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1467
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1468
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1469
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1470
SELECT a, b FROM data ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1471
SELECT a, b FROM data ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1472
SELECT category, SUM(value) FROM data GROUP BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1473
SELECT category, SUM(value) FROM data GROUP BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1474
SELECT a FROM data ORDER BY -1;
-- Tag: window_functions_window_functions_operators_test_select_1475
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1476
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1477
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1478
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1479
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1480
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1481
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1482
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1483
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1484
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1485
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1486
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1487
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1488
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1489
SELECT a, b FROM data ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1490
SELECT category, SUM(value) FROM data GROUP BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1491
SELECT category, SUM(value) FROM data GROUP BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1492
SELECT a FROM data ORDER BY -1;
-- Tag: window_functions_window_functions_operators_test_select_1493
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1494
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1495
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1496
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1497
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1498
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1499
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1500
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1501
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1502
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1503
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1504
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1505
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1506
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1507
SELECT category, SUM(value) FROM data GROUP BY 0;
-- Tag: window_functions_window_functions_operators_test_select_1508
SELECT category, SUM(value) FROM data GROUP BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1509
SELECT a FROM data ORDER BY -1;
-- Tag: window_functions_window_functions_operators_test_select_1510
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1511
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1512
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1513
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1514
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1515
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1516
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1517
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1518
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1519
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1520
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1521
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1522
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1523
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1524
SELECT category, SUM(value) FROM data GROUP BY 3;
-- Tag: window_functions_window_functions_operators_test_select_1525
SELECT a FROM data ORDER BY -1;
-- Tag: window_functions_window_functions_operators_test_select_1526
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1527
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1528
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1529
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1530
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1531
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1532
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1533
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1534
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1535
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1536
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1537
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1538
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1539
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1540
SELECT a FROM data ORDER BY -1;
-- Tag: window_functions_window_functions_operators_test_select_1541
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1542
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1543
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1544
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1545
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1546
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1547
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1548
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1549
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1550
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1551
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1552
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1553
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1554
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0),
('C', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1555
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1556
SELECT category, SUM(amount) as total
FROM sales
GROUP BY 1
HAVING SUM(amount) > 100
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1557
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1558
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1559
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1560
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1561
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1562
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1563
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1564
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1565
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1566
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1567
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1568
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (3, 30), (1, 10), (2, 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1569
SELECT *
FROM (SELECT id, value FROM data ORDER BY 1) as sorted
LIMIT 2;
-- Tag: window_functions_window_functions_operators_test_select_1570
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1571
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1572
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1573
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1574
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1575
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1576
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1577
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1578
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1579
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1580
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1581
SELECT category, total
FROM (SELECT category, SUM(amount) as total FROM sales GROUP BY 1) as grouped
ORDER BY total DESC;
WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1582
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1583
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1584
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1585
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1586
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1587
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1588
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1589
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1590
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1591
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING, score INT64);
INSERT INTO data VALUES
('Alice', 90),
('Bob', 85),
('Charlie', 95);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, subcategory STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'X', 100.0),
('A', 'Y', 150.0),
('B', 'X', 200.0);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

WITH ranked AS (
-- Tag: window_functions_window_functions_operators_test_select_1592
SELECT name, score FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_1593
SELECT name, score
FROM ranked
ORDER BY 2 DESC;
WITH category_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_1594
SELECT category, subcategory, amount FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_1595
SELECT category, SUM(amount) as total
FROM category_sales
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1596
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1597
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1598
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1599
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1600
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1601
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0), (2, 200.0), (1, 150.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO products VALUES (1, 'Electronics'), (2, 'Electronics'), (3, 'Clothing');
INSERT INTO sales VALUES (1, 100.0), (2, 200.0), (3, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1602
SELECT c.name, SUM(o.amount) as total
FROM customers c
JOIN orders o ON c.id = o.customer_id
GROUP BY c.name
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1603
SELECT p.category, SUM(s.amount) as total
FROM products p
JOIN sales s ON p.id = s.product_id
GROUP BY 1
ORDER BY 1;
-- Tag: window_functions_window_functions_operators_test_select_1604
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1605
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1606
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1607
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING, value INT64);
INSERT INTO data VALUES
('X', 'Y', 10),
('X', 'Z', 20),
('Y', 'Y', 30);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5), (1), (3), (4), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('B', 20),
('A', 10),
('C', 30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1608
SELECT a, b, SUM(value) as total
FROM data
GROUP BY 1, 2
ORDER BY 3 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1609
SELECT value
FROM numbers
ORDER BY 1
LIMIT 3 OFFSET 1;
-- Tag: window_functions_window_functions_operators_test_select_1610
SELECT DISTINCT category, value
FROM data
ORDER BY 2 DESC;
-- Tag: window_functions_window_functions_operators_test_select_1611
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, year INT64, amount FLOAT64);
INSERT INTO sales VALUES
('A', 2021, 100.0),
('A', 2022, 150.0),
('A', 2023, 200.0);

-- Tag: window_functions_window_functions_operators_test_select_1612
SELECT product, year, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY 2) as row_num
FROM sales;

DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 10);
INSERT INTO numbers VALUES (4, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (1), (2), (3), (4), (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES (1, 'Alice');
INSERT INTO data VALUES (2, 'Bob');
INSERT INTO data VALUES (3, 'Alice');
INSERT INTO data VALUES (4, 'Charlie');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '50%');
INSERT INTO data VALUES (2, '50percent');
INSERT INTO data VALUES (3, 'discount_50');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'file_1.txt');
INSERT INTO files VALUES (2, 'file1.txt');
INSERT INTO files VALUES (3, 'filea1.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test_%_data');
INSERT INTO data VALUES (2, 'test_x_data');
INSERT INTO data VALUES (3, 'test_abc_data');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '100%');
INSERT INTO data VALUES (2, '100x');
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, department_id INT64, salary FLOAT64);
INSERT INTO employees VALUES (1, 'Alice', 1, 70000.0);
INSERT INTO employees VALUES (2, 'Bob', 1, 60000.0);
INSERT INTO employees VALUES (3, 'Charlie', 2, 80000.0);
INSERT INTO employees VALUES (4, 'David', 2, 65000.0);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
INSERT INTO departments VALUES (1, 'Sales');
INSERT INTO departments VALUES (2, 'Engineering');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS empty_filter;
CREATE TABLE empty_filter (value INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, product_id INT64, customer_id INT64);
INSERT INTO orders VALUES (1, 100, 1);
INSERT INTO orders VALUES (2, 200, 2);
INSERT INTO orders VALUES (3, 100, 2);
DROP TABLE IF EXISTS valid_combos;
CREATE TABLE valid_combos (product_id INT64, customer_id INT64);
INSERT INTO valid_combos VALUES (100, 1);
INSERT INTO valid_combos VALUES (200, 2);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, code STRING);
INSERT INTO products VALUES (1, 'PROD-001');
INSERT INTO products VALUES (2, 'ITEM-042');
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, '^PROD-');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount FLOAT64);
INSERT INTO sales VALUES (1, 'A', 100.0);
INSERT INTO sales VALUES (2, 'A', 200.0);
INSERT INTO sales VALUES (3, 'B', 150.0);
INSERT INTO sales VALUES (4, 'C', 100.0);
INSERT INTO sales VALUES (5, 'C', 100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ');
INSERT INTO data VALUES (3, 'DEF456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Test123');
INSERT INTO data VALUES (2, 'Hello');
INSERT INTO data VALUES (3, 'World456');
INSERT INTO data VALUES (4, 'Example');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Hello ');
INSERT INTO data VALUES (2, ' ');
INSERT INTO data VALUES (3, '');
INSERT INTO data VALUES (4, 'Hello World');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'line1
line2');
INSERT INTO data VALUES (2, 'single line');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test!value');
INSERT INTO data VALUES (2, 'test_value');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'completed');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (2, 'short');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_1613
SELECT id FROM numbers WHERE value <> 10 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1614
SELECT COUNT(*) FROM data WHERE value <> 3;
-- Tag: window_functions_window_functions_operators_test_select_1615
SELECT COUNT(*) FROM data WHERE value != 3;
-- Tag: window_functions_window_functions_operators_test_select_1616
SELECT id FROM data WHERE value <> 10;
-- Tag: window_functions_window_functions_operators_test_select_1617
SELECT id FROM data WHERE name <> 'Alice' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1618
SELECT id FROM data WHERE value LIKE '50!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1619
SELECT id FROM files WHERE filename LIKE 'file#_1.txt' ESCAPE '#';
-- Tag: window_functions_window_functions_operators_test_select_1620
SELECT id FROM data WHERE value LIKE 'test!_%!_data' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1621
SELECT id FROM data WHERE value LIKE '100\%' ESCAPE '\';
-- Tag: window_functions_window_functions_operators_test_select_1622
SELECT name FROM employees e WHERE e.department_id IN (SELECT id FROM departments) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1623
SELECT id FROM data WHERE value IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1624
SELECT id FROM data WHERE value IN (SELECT value FROM empty_filter);
-- Tag: window_functions_window_functions_operators_test_select_1625
SELECT id FROM orders WHERE (product_id, customer_id) IN (SELECT product_id, customer_id FROM valid_combos) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1626
SELECT id FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1627
SELECT p.id FROM products p, patterns pat WHERE p.code ~ pat.pattern;
-- Tag: window_functions_window_functions_operators_test_select_1628
SELECT product FROM sales GROUP BY product HAVING SUM(amount) <> 200.0 ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_1629
SELECT id, CASE WHEN value ~ '[0-9]' THEN 'has_digits' ELSE 'no_digits' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1630
SELECT id FROM data WHERE value ~ '^[A-Z]' AND value ~ '[0-9]' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1631
SELECT * FROM data WHERE value ~ '[a-z';
-- Tag: window_functions_window_functions_operators_test_select_1632
SELECT * FROM data WHERE value LIKE 'test' ESCAPE 'ab';
-- Tag: window_functions_window_functions_operators_test_select_1633
SELECT COUNT(*) FROM data WHERE value ~ '^value[1-3]$';
-- Tag: window_functions_window_functions_operators_test_select_1634
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1635
SELECT id FROM data WHERE value ~ 'Hello' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1636
SELECT id FROM data WHERE value ~ '\
';
-- Tag: window_functions_window_functions_operators_test_select_1637
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1638
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1639
SELECT id FROM data WHERE value LIKE 'test!!value' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1640
SELECT id FROM data WHERE status ~ '^(active|pending)$' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1641
SELECT id FROM data WHERE value ~ '^a+$';
-- Tag: window_functions_window_functions_operators_test_select_1642
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1643
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_1644
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1645
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1646
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1647
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1648
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_1649
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_1650
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_1651
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1652
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1653
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_1654
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1655
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (1), (2), (3), (4), (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES (1, 'Alice');
INSERT INTO data VALUES (2, 'Bob');
INSERT INTO data VALUES (3, 'Alice');
INSERT INTO data VALUES (4, 'Charlie');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '50%');
INSERT INTO data VALUES (2, '50percent');
INSERT INTO data VALUES (3, 'discount_50');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'file_1.txt');
INSERT INTO files VALUES (2, 'file1.txt');
INSERT INTO files VALUES (3, 'filea1.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test_%_data');
INSERT INTO data VALUES (2, 'test_x_data');
INSERT INTO data VALUES (3, 'test_abc_data');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '100%');
INSERT INTO data VALUES (2, '100x');
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, department_id INT64, salary FLOAT64);
INSERT INTO employees VALUES (1, 'Alice', 1, 70000.0);
INSERT INTO employees VALUES (2, 'Bob', 1, 60000.0);
INSERT INTO employees VALUES (3, 'Charlie', 2, 80000.0);
INSERT INTO employees VALUES (4, 'David', 2, 65000.0);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
INSERT INTO departments VALUES (1, 'Sales');
INSERT INTO departments VALUES (2, 'Engineering');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS empty_filter;
CREATE TABLE empty_filter (value INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, product_id INT64, customer_id INT64);
INSERT INTO orders VALUES (1, 100, 1);
INSERT INTO orders VALUES (2, 200, 2);
INSERT INTO orders VALUES (3, 100, 2);
DROP TABLE IF EXISTS valid_combos;
CREATE TABLE valid_combos (product_id INT64, customer_id INT64);
INSERT INTO valid_combos VALUES (100, 1);
INSERT INTO valid_combos VALUES (200, 2);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, code STRING);
INSERT INTO products VALUES (1, 'PROD-001');
INSERT INTO products VALUES (2, 'ITEM-042');
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, '^PROD-');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount FLOAT64);
INSERT INTO sales VALUES (1, 'A', 100.0);
INSERT INTO sales VALUES (2, 'A', 200.0);
INSERT INTO sales VALUES (3, 'B', 150.0);
INSERT INTO sales VALUES (4, 'C', 100.0);
INSERT INTO sales VALUES (5, 'C', 100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ');
INSERT INTO data VALUES (3, 'DEF456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Test123');
INSERT INTO data VALUES (2, 'Hello');
INSERT INTO data VALUES (3, 'World456');
INSERT INTO data VALUES (4, 'Example');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Hello ');
INSERT INTO data VALUES (2, ' ');
INSERT INTO data VALUES (3, '');
INSERT INTO data VALUES (4, 'Hello World');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'line1
line2');
INSERT INTO data VALUES (2, 'single line');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test!value');
INSERT INTO data VALUES (2, 'test_value');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'completed');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (2, 'short');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_1656
SELECT COUNT(*) FROM data WHERE value <> 3;
-- Tag: window_functions_window_functions_operators_test_select_1657
SELECT COUNT(*) FROM data WHERE value != 3;
-- Tag: window_functions_window_functions_operators_test_select_1658
SELECT id FROM data WHERE value <> 10;
-- Tag: window_functions_window_functions_operators_test_select_1659
SELECT id FROM data WHERE name <> 'Alice' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1660
SELECT id FROM data WHERE value LIKE '50!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1661
SELECT id FROM files WHERE filename LIKE 'file#_1.txt' ESCAPE '#';
-- Tag: window_functions_window_functions_operators_test_select_1662
SELECT id FROM data WHERE value LIKE 'test!_%!_data' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1663
SELECT id FROM data WHERE value LIKE '100\%' ESCAPE '\';
-- Tag: window_functions_window_functions_operators_test_select_1664
SELECT name FROM employees e WHERE e.department_id IN (SELECT id FROM departments) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1665
SELECT id FROM data WHERE value IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1666
SELECT id FROM data WHERE value IN (SELECT value FROM empty_filter);
-- Tag: window_functions_window_functions_operators_test_select_1667
SELECT id FROM orders WHERE (product_id, customer_id) IN (SELECT product_id, customer_id FROM valid_combos) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1668
SELECT id FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1669
SELECT p.id FROM products p, patterns pat WHERE p.code ~ pat.pattern;
-- Tag: window_functions_window_functions_operators_test_select_1670
SELECT product FROM sales GROUP BY product HAVING SUM(amount) <> 200.0 ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_1671
SELECT id, CASE WHEN value ~ '[0-9]' THEN 'has_digits' ELSE 'no_digits' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1672
SELECT id FROM data WHERE value ~ '^[A-Z]' AND value ~ '[0-9]' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1673
SELECT * FROM data WHERE value ~ '[a-z';
-- Tag: window_functions_window_functions_operators_test_select_1674
SELECT * FROM data WHERE value LIKE 'test' ESCAPE 'ab';
-- Tag: window_functions_window_functions_operators_test_select_1675
SELECT COUNT(*) FROM data WHERE value ~ '^value[1-3]$';
-- Tag: window_functions_window_functions_operators_test_select_1676
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1677
SELECT id FROM data WHERE value ~ 'Hello' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1678
SELECT id FROM data WHERE value ~ '\
';
-- Tag: window_functions_window_functions_operators_test_select_1679
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1680
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1681
SELECT id FROM data WHERE value LIKE 'test!!value' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1682
SELECT id FROM data WHERE status ~ '^(active|pending)$' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1683
SELECT id FROM data WHERE value ~ '^a+$';
-- Tag: window_functions_window_functions_operators_test_select_1684
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1685
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_1686
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1687
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1688
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1689
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1690
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_1691
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_1692
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_1693
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1694
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1695
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_1696
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1697
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES (1, 'Alice');
INSERT INTO data VALUES (2, 'Bob');
INSERT INTO data VALUES (3, 'Alice');
INSERT INTO data VALUES (4, 'Charlie');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '50%');
INSERT INTO data VALUES (2, '50percent');
INSERT INTO data VALUES (3, 'discount_50');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'file_1.txt');
INSERT INTO files VALUES (2, 'file1.txt');
INSERT INTO files VALUES (3, 'filea1.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test_%_data');
INSERT INTO data VALUES (2, 'test_x_data');
INSERT INTO data VALUES (3, 'test_abc_data');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '100%');
INSERT INTO data VALUES (2, '100x');
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, department_id INT64, salary FLOAT64);
INSERT INTO employees VALUES (1, 'Alice', 1, 70000.0);
INSERT INTO employees VALUES (2, 'Bob', 1, 60000.0);
INSERT INTO employees VALUES (3, 'Charlie', 2, 80000.0);
INSERT INTO employees VALUES (4, 'David', 2, 65000.0);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
INSERT INTO departments VALUES (1, 'Sales');
INSERT INTO departments VALUES (2, 'Engineering');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS empty_filter;
CREATE TABLE empty_filter (value INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, product_id INT64, customer_id INT64);
INSERT INTO orders VALUES (1, 100, 1);
INSERT INTO orders VALUES (2, 200, 2);
INSERT INTO orders VALUES (3, 100, 2);
DROP TABLE IF EXISTS valid_combos;
CREATE TABLE valid_combos (product_id INT64, customer_id INT64);
INSERT INTO valid_combos VALUES (100, 1);
INSERT INTO valid_combos VALUES (200, 2);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, code STRING);
INSERT INTO products VALUES (1, 'PROD-001');
INSERT INTO products VALUES (2, 'ITEM-042');
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, '^PROD-');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount FLOAT64);
INSERT INTO sales VALUES (1, 'A', 100.0);
INSERT INTO sales VALUES (2, 'A', 200.0);
INSERT INTO sales VALUES (3, 'B', 150.0);
INSERT INTO sales VALUES (4, 'C', 100.0);
INSERT INTO sales VALUES (5, 'C', 100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ');
INSERT INTO data VALUES (3, 'DEF456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Test123');
INSERT INTO data VALUES (2, 'Hello');
INSERT INTO data VALUES (3, 'World456');
INSERT INTO data VALUES (4, 'Example');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Hello ');
INSERT INTO data VALUES (2, ' ');
INSERT INTO data VALUES (3, '');
INSERT INTO data VALUES (4, 'Hello World');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'line1
line2');
INSERT INTO data VALUES (2, 'single line');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test!value');
INSERT INTO data VALUES (2, 'test_value');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'completed');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (2, 'short');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_1698
SELECT id FROM data WHERE value <> 10;
-- Tag: window_functions_window_functions_operators_test_select_1699
SELECT id FROM data WHERE name <> 'Alice' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1700
SELECT id FROM data WHERE value LIKE '50!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1701
SELECT id FROM files WHERE filename LIKE 'file#_1.txt' ESCAPE '#';
-- Tag: window_functions_window_functions_operators_test_select_1702
SELECT id FROM data WHERE value LIKE 'test!_%!_data' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1703
SELECT id FROM data WHERE value LIKE '100\%' ESCAPE '\';
-- Tag: window_functions_window_functions_operators_test_select_1704
SELECT name FROM employees e WHERE e.department_id IN (SELECT id FROM departments) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1705
SELECT id FROM data WHERE value IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1706
SELECT id FROM data WHERE value IN (SELECT value FROM empty_filter);
-- Tag: window_functions_window_functions_operators_test_select_1707
SELECT id FROM orders WHERE (product_id, customer_id) IN (SELECT product_id, customer_id FROM valid_combos) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1708
SELECT id FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1709
SELECT p.id FROM products p, patterns pat WHERE p.code ~ pat.pattern;
-- Tag: window_functions_window_functions_operators_test_select_1710
SELECT product FROM sales GROUP BY product HAVING SUM(amount) <> 200.0 ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_1711
SELECT id, CASE WHEN value ~ '[0-9]' THEN 'has_digits' ELSE 'no_digits' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1712
SELECT id FROM data WHERE value ~ '^[A-Z]' AND value ~ '[0-9]' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1713
SELECT * FROM data WHERE value ~ '[a-z';
-- Tag: window_functions_window_functions_operators_test_select_1714
SELECT * FROM data WHERE value LIKE 'test' ESCAPE 'ab';
-- Tag: window_functions_window_functions_operators_test_select_1715
SELECT COUNT(*) FROM data WHERE value ~ '^value[1-3]$';
-- Tag: window_functions_window_functions_operators_test_select_1716
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1717
SELECT id FROM data WHERE value ~ 'Hello' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1718
SELECT id FROM data WHERE value ~ '\
';
-- Tag: window_functions_window_functions_operators_test_select_1719
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1720
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1721
SELECT id FROM data WHERE value LIKE 'test!!value' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1722
SELECT id FROM data WHERE status ~ '^(active|pending)$' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1723
SELECT id FROM data WHERE value ~ '^a+$';
-- Tag: window_functions_window_functions_operators_test_select_1724
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1725
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_1726
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1727
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1728
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1729
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1730
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_1731
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_1732
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_1733
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1734
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1735
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_1736
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1737
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES (1, 'Alice');
INSERT INTO data VALUES (2, 'Bob');
INSERT INTO data VALUES (3, 'Alice');
INSERT INTO data VALUES (4, 'Charlie');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '50%');
INSERT INTO data VALUES (2, '50percent');
INSERT INTO data VALUES (3, 'discount_50');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'file_1.txt');
INSERT INTO files VALUES (2, 'file1.txt');
INSERT INTO files VALUES (3, 'filea1.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test_%_data');
INSERT INTO data VALUES (2, 'test_x_data');
INSERT INTO data VALUES (3, 'test_abc_data');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '100%');
INSERT INTO data VALUES (2, '100x');
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, department_id INT64, salary FLOAT64);
INSERT INTO employees VALUES (1, 'Alice', 1, 70000.0);
INSERT INTO employees VALUES (2, 'Bob', 1, 60000.0);
INSERT INTO employees VALUES (3, 'Charlie', 2, 80000.0);
INSERT INTO employees VALUES (4, 'David', 2, 65000.0);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
INSERT INTO departments VALUES (1, 'Sales');
INSERT INTO departments VALUES (2, 'Engineering');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS empty_filter;
CREATE TABLE empty_filter (value INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, product_id INT64, customer_id INT64);
INSERT INTO orders VALUES (1, 100, 1);
INSERT INTO orders VALUES (2, 200, 2);
INSERT INTO orders VALUES (3, 100, 2);
DROP TABLE IF EXISTS valid_combos;
CREATE TABLE valid_combos (product_id INT64, customer_id INT64);
INSERT INTO valid_combos VALUES (100, 1);
INSERT INTO valid_combos VALUES (200, 2);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, code STRING);
INSERT INTO products VALUES (1, 'PROD-001');
INSERT INTO products VALUES (2, 'ITEM-042');
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, '^PROD-');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount FLOAT64);
INSERT INTO sales VALUES (1, 'A', 100.0);
INSERT INTO sales VALUES (2, 'A', 200.0);
INSERT INTO sales VALUES (3, 'B', 150.0);
INSERT INTO sales VALUES (4, 'C', 100.0);
INSERT INTO sales VALUES (5, 'C', 100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ');
INSERT INTO data VALUES (3, 'DEF456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Test123');
INSERT INTO data VALUES (2, 'Hello');
INSERT INTO data VALUES (3, 'World456');
INSERT INTO data VALUES (4, 'Example');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Hello ');
INSERT INTO data VALUES (2, ' ');
INSERT INTO data VALUES (3, '');
INSERT INTO data VALUES (4, 'Hello World');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'line1
line2');
INSERT INTO data VALUES (2, 'single line');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test!value');
INSERT INTO data VALUES (2, 'test_value');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'completed');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (2, 'short');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_1738
SELECT id FROM data WHERE name <> 'Alice' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1739
SELECT id FROM data WHERE value LIKE '50!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1740
SELECT id FROM files WHERE filename LIKE 'file#_1.txt' ESCAPE '#';
-- Tag: window_functions_window_functions_operators_test_select_1741
SELECT id FROM data WHERE value LIKE 'test!_%!_data' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1742
SELECT id FROM data WHERE value LIKE '100\%' ESCAPE '\';
-- Tag: window_functions_window_functions_operators_test_select_1743
SELECT name FROM employees e WHERE e.department_id IN (SELECT id FROM departments) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1744
SELECT id FROM data WHERE value IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1745
SELECT id FROM data WHERE value IN (SELECT value FROM empty_filter);
-- Tag: window_functions_window_functions_operators_test_select_1746
SELECT id FROM orders WHERE (product_id, customer_id) IN (SELECT product_id, customer_id FROM valid_combos) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1747
SELECT id FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1748
SELECT p.id FROM products p, patterns pat WHERE p.code ~ pat.pattern;
-- Tag: window_functions_window_functions_operators_test_select_1749
SELECT product FROM sales GROUP BY product HAVING SUM(amount) <> 200.0 ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_1750
SELECT id, CASE WHEN value ~ '[0-9]' THEN 'has_digits' ELSE 'no_digits' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1751
SELECT id FROM data WHERE value ~ '^[A-Z]' AND value ~ '[0-9]' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1752
SELECT * FROM data WHERE value ~ '[a-z';
-- Tag: window_functions_window_functions_operators_test_select_1753
SELECT * FROM data WHERE value LIKE 'test' ESCAPE 'ab';
-- Tag: window_functions_window_functions_operators_test_select_1754
SELECT COUNT(*) FROM data WHERE value ~ '^value[1-3]$';
-- Tag: window_functions_window_functions_operators_test_select_1755
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1756
SELECT id FROM data WHERE value ~ 'Hello' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1757
SELECT id FROM data WHERE value ~ '\
';
-- Tag: window_functions_window_functions_operators_test_select_1758
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1759
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1760
SELECT id FROM data WHERE value LIKE 'test!!value' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1761
SELECT id FROM data WHERE status ~ '^(active|pending)$' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1762
SELECT id FROM data WHERE value ~ '^a+$';
-- Tag: window_functions_window_functions_operators_test_select_1763
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1764
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_1765
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1766
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1767
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1768
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1769
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_1770
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_1771
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_1772
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1773
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1774
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_1775
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1776
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, department_id INT64, salary FLOAT64);
INSERT INTO employees VALUES (1, 'Alice', 1, 70000.0);
INSERT INTO employees VALUES (2, 'Bob', 1, 60000.0);
INSERT INTO employees VALUES (3, 'Charlie', 2, 80000.0);
INSERT INTO employees VALUES (4, 'David', 2, 65000.0);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
INSERT INTO departments VALUES (1, 'Sales');
INSERT INTO departments VALUES (2, 'Engineering');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS empty_filter;
CREATE TABLE empty_filter (value INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, product_id INT64, customer_id INT64);
INSERT INTO orders VALUES (1, 100, 1);
INSERT INTO orders VALUES (2, 200, 2);
INSERT INTO orders VALUES (3, 100, 2);
DROP TABLE IF EXISTS valid_combos;
CREATE TABLE valid_combos (product_id INT64, customer_id INT64);
INSERT INTO valid_combos VALUES (100, 1);
INSERT INTO valid_combos VALUES (200, 2);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, code STRING);
INSERT INTO products VALUES (1, 'PROD-001');
INSERT INTO products VALUES (2, 'ITEM-042');
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, '^PROD-');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount FLOAT64);
INSERT INTO sales VALUES (1, 'A', 100.0);
INSERT INTO sales VALUES (2, 'A', 200.0);
INSERT INTO sales VALUES (3, 'B', 150.0);
INSERT INTO sales VALUES (4, 'C', 100.0);
INSERT INTO sales VALUES (5, 'C', 100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ');
INSERT INTO data VALUES (3, 'DEF456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Test123');
INSERT INTO data VALUES (2, 'Hello');
INSERT INTO data VALUES (3, 'World456');
INSERT INTO data VALUES (4, 'Example');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Hello ');
INSERT INTO data VALUES (2, ' ');
INSERT INTO data VALUES (3, '');
INSERT INTO data VALUES (4, 'Hello World');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'line1
line2');
INSERT INTO data VALUES (2, 'single line');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test!value');
INSERT INTO data VALUES (2, 'test_value');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'completed');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (2, 'short');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_1777
SELECT name FROM employees e WHERE e.department_id IN (SELECT id FROM departments) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1778
SELECT id FROM data WHERE value IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1779
SELECT id FROM data WHERE value IN (SELECT value FROM empty_filter);
-- Tag: window_functions_window_functions_operators_test_select_1780
SELECT id FROM orders WHERE (product_id, customer_id) IN (SELECT product_id, customer_id FROM valid_combos) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1781
SELECT id FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1782
SELECT p.id FROM products p, patterns pat WHERE p.code ~ pat.pattern;
-- Tag: window_functions_window_functions_operators_test_select_1783
SELECT product FROM sales GROUP BY product HAVING SUM(amount) <> 200.0 ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_1784
SELECT id, CASE WHEN value ~ '[0-9]' THEN 'has_digits' ELSE 'no_digits' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1785
SELECT id FROM data WHERE value ~ '^[A-Z]' AND value ~ '[0-9]' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1786
SELECT * FROM data WHERE value ~ '[a-z';
-- Tag: window_functions_window_functions_operators_test_select_1787
SELECT * FROM data WHERE value LIKE 'test' ESCAPE 'ab';
-- Tag: window_functions_window_functions_operators_test_select_1788
SELECT COUNT(*) FROM data WHERE value ~ '^value[1-3]$';
-- Tag: window_functions_window_functions_operators_test_select_1789
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1790
SELECT id FROM data WHERE value ~ 'Hello' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1791
SELECT id FROM data WHERE value ~ '\
';
-- Tag: window_functions_window_functions_operators_test_select_1792
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1793
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1794
SELECT id FROM data WHERE value LIKE 'test!!value' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1795
SELECT id FROM data WHERE status ~ '^(active|pending)$' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1796
SELECT id FROM data WHERE value ~ '^a+$';
-- Tag: window_functions_window_functions_operators_test_select_1797
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1798
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_1799
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1800
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1801
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1802
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1803
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_1804
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_1805
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_1806
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1807
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1808
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_1809
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1810
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS empty_filter;
CREATE TABLE empty_filter (value INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, product_id INT64, customer_id INT64);
INSERT INTO orders VALUES (1, 100, 1);
INSERT INTO orders VALUES (2, 200, 2);
INSERT INTO orders VALUES (3, 100, 2);
DROP TABLE IF EXISTS valid_combos;
CREATE TABLE valid_combos (product_id INT64, customer_id INT64);
INSERT INTO valid_combos VALUES (100, 1);
INSERT INTO valid_combos VALUES (200, 2);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, code STRING);
INSERT INTO products VALUES (1, 'PROD-001');
INSERT INTO products VALUES (2, 'ITEM-042');
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, '^PROD-');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount FLOAT64);
INSERT INTO sales VALUES (1, 'A', 100.0);
INSERT INTO sales VALUES (2, 'A', 200.0);
INSERT INTO sales VALUES (3, 'B', 150.0);
INSERT INTO sales VALUES (4, 'C', 100.0);
INSERT INTO sales VALUES (5, 'C', 100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ');
INSERT INTO data VALUES (3, 'DEF456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Test123');
INSERT INTO data VALUES (2, 'Hello');
INSERT INTO data VALUES (3, 'World456');
INSERT INTO data VALUES (4, 'Example');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Hello ');
INSERT INTO data VALUES (2, ' ');
INSERT INTO data VALUES (3, '');
INSERT INTO data VALUES (4, 'Hello World');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'line1
line2');
INSERT INTO data VALUES (2, 'single line');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test!value');
INSERT INTO data VALUES (2, 'test_value');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'completed');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (2, 'short');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_1811
SELECT id FROM data WHERE value IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1812
SELECT id FROM data WHERE value IN (SELECT value FROM empty_filter);
-- Tag: window_functions_window_functions_operators_test_select_1813
SELECT id FROM orders WHERE (product_id, customer_id) IN (SELECT product_id, customer_id FROM valid_combos) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1814
SELECT id FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1815
SELECT p.id FROM products p, patterns pat WHERE p.code ~ pat.pattern;
-- Tag: window_functions_window_functions_operators_test_select_1816
SELECT product FROM sales GROUP BY product HAVING SUM(amount) <> 200.0 ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_1817
SELECT id, CASE WHEN value ~ '[0-9]' THEN 'has_digits' ELSE 'no_digits' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1818
SELECT id FROM data WHERE value ~ '^[A-Z]' AND value ~ '[0-9]' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1819
SELECT * FROM data WHERE value ~ '[a-z';
-- Tag: window_functions_window_functions_operators_test_select_1820
SELECT * FROM data WHERE value LIKE 'test' ESCAPE 'ab';
-- Tag: window_functions_window_functions_operators_test_select_1821
SELECT COUNT(*) FROM data WHERE value ~ '^value[1-3]$';
-- Tag: window_functions_window_functions_operators_test_select_1822
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1823
SELECT id FROM data WHERE value ~ 'Hello' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1824
SELECT id FROM data WHERE value ~ '\
';
-- Tag: window_functions_window_functions_operators_test_select_1825
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1826
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1827
SELECT id FROM data WHERE value LIKE 'test!!value' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1828
SELECT id FROM data WHERE status ~ '^(active|pending)$' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1829
SELECT id FROM data WHERE value ~ '^a+$';
-- Tag: window_functions_window_functions_operators_test_select_1830
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1831
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_1832
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1833
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1834
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1835
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1836
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_1837
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_1838
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_1839
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1840
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1841
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_1842
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1843
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS empty_filter;
CREATE TABLE empty_filter (value INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, product_id INT64, customer_id INT64);
INSERT INTO orders VALUES (1, 100, 1);
INSERT INTO orders VALUES (2, 200, 2);
INSERT INTO orders VALUES (3, 100, 2);
DROP TABLE IF EXISTS valid_combos;
CREATE TABLE valid_combos (product_id INT64, customer_id INT64);
INSERT INTO valid_combos VALUES (100, 1);
INSERT INTO valid_combos VALUES (200, 2);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, code STRING);
INSERT INTO products VALUES (1, 'PROD-001');
INSERT INTO products VALUES (2, 'ITEM-042');
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, '^PROD-');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount FLOAT64);
INSERT INTO sales VALUES (1, 'A', 100.0);
INSERT INTO sales VALUES (2, 'A', 200.0);
INSERT INTO sales VALUES (3, 'B', 150.0);
INSERT INTO sales VALUES (4, 'C', 100.0);
INSERT INTO sales VALUES (5, 'C', 100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ');
INSERT INTO data VALUES (3, 'DEF456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Test123');
INSERT INTO data VALUES (2, 'Hello');
INSERT INTO data VALUES (3, 'World456');
INSERT INTO data VALUES (4, 'Example');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Hello ');
INSERT INTO data VALUES (2, ' ');
INSERT INTO data VALUES (3, '');
INSERT INTO data VALUES (4, 'Hello World');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'line1
line2');
INSERT INTO data VALUES (2, 'single line');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test!value');
INSERT INTO data VALUES (2, 'test_value');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'completed');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (2, 'short');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_1844
SELECT id FROM data WHERE value IN (SELECT value FROM empty_filter);
-- Tag: window_functions_window_functions_operators_test_select_1845
SELECT id FROM orders WHERE (product_id, customer_id) IN (SELECT product_id, customer_id FROM valid_combos) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1846
SELECT id FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1847
SELECT p.id FROM products p, patterns pat WHERE p.code ~ pat.pattern;
-- Tag: window_functions_window_functions_operators_test_select_1848
SELECT product FROM sales GROUP BY product HAVING SUM(amount) <> 200.0 ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_1849
SELECT id, CASE WHEN value ~ '[0-9]' THEN 'has_digits' ELSE 'no_digits' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1850
SELECT id FROM data WHERE value ~ '^[A-Z]' AND value ~ '[0-9]' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1851
SELECT * FROM data WHERE value ~ '[a-z';
-- Tag: window_functions_window_functions_operators_test_select_1852
SELECT * FROM data WHERE value LIKE 'test' ESCAPE 'ab';
-- Tag: window_functions_window_functions_operators_test_select_1853
SELECT COUNT(*) FROM data WHERE value ~ '^value[1-3]$';
-- Tag: window_functions_window_functions_operators_test_select_1854
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1855
SELECT id FROM data WHERE value ~ 'Hello' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1856
SELECT id FROM data WHERE value ~ '\
';
-- Tag: window_functions_window_functions_operators_test_select_1857
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1858
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1859
SELECT id FROM data WHERE value LIKE 'test!!value' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1860
SELECT id FROM data WHERE status ~ '^(active|pending)$' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1861
SELECT id FROM data WHERE value ~ '^a+$';
-- Tag: window_functions_window_functions_operators_test_select_1862
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1863
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_1864
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1865
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1866
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1867
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1868
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_1869
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_1870
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_1871
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1872
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1873
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_1874
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1875
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, product_id INT64, customer_id INT64);
INSERT INTO orders VALUES (1, 100, 1);
INSERT INTO orders VALUES (2, 200, 2);
INSERT INTO orders VALUES (3, 100, 2);
DROP TABLE IF EXISTS valid_combos;
CREATE TABLE valid_combos (product_id INT64, customer_id INT64);
INSERT INTO valid_combos VALUES (100, 1);
INSERT INTO valid_combos VALUES (200, 2);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, code STRING);
INSERT INTO products VALUES (1, 'PROD-001');
INSERT INTO products VALUES (2, 'ITEM-042');
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, '^PROD-');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount FLOAT64);
INSERT INTO sales VALUES (1, 'A', 100.0);
INSERT INTO sales VALUES (2, 'A', 200.0);
INSERT INTO sales VALUES (3, 'B', 150.0);
INSERT INTO sales VALUES (4, 'C', 100.0);
INSERT INTO sales VALUES (5, 'C', 100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ');
INSERT INTO data VALUES (3, 'DEF456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Test123');
INSERT INTO data VALUES (2, 'Hello');
INSERT INTO data VALUES (3, 'World456');
INSERT INTO data VALUES (4, 'Example');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Hello ');
INSERT INTO data VALUES (2, ' ');
INSERT INTO data VALUES (3, '');
INSERT INTO data VALUES (4, 'Hello World');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'line1
line2');
INSERT INTO data VALUES (2, 'single line');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test!value');
INSERT INTO data VALUES (2, 'test_value');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'completed');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (2, 'short');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_1876
SELECT id FROM orders WHERE (product_id, customer_id) IN (SELECT product_id, customer_id FROM valid_combos) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1877
SELECT id FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1878
SELECT p.id FROM products p, patterns pat WHERE p.code ~ pat.pattern;
-- Tag: window_functions_window_functions_operators_test_select_1879
SELECT product FROM sales GROUP BY product HAVING SUM(amount) <> 200.0 ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_1880
SELECT id, CASE WHEN value ~ '[0-9]' THEN 'has_digits' ELSE 'no_digits' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1881
SELECT id FROM data WHERE value ~ '^[A-Z]' AND value ~ '[0-9]' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1882
SELECT * FROM data WHERE value ~ '[a-z';
-- Tag: window_functions_window_functions_operators_test_select_1883
SELECT * FROM data WHERE value LIKE 'test' ESCAPE 'ab';
-- Tag: window_functions_window_functions_operators_test_select_1884
SELECT COUNT(*) FROM data WHERE value ~ '^value[1-3]$';
-- Tag: window_functions_window_functions_operators_test_select_1885
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1886
SELECT id FROM data WHERE value ~ 'Hello' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1887
SELECT id FROM data WHERE value ~ '\
';
-- Tag: window_functions_window_functions_operators_test_select_1888
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1889
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1890
SELECT id FROM data WHERE value LIKE 'test!!value' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1891
SELECT id FROM data WHERE status ~ '^(active|pending)$' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1892
SELECT id FROM data WHERE value ~ '^a+$';
-- Tag: window_functions_window_functions_operators_test_select_1893
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1894
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_1895
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1896
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1897
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1898
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1899
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_1900
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_1901
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_1902
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1903
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1904
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_1905
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1906
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, code STRING);
INSERT INTO products VALUES (1, 'PROD-001');
INSERT INTO products VALUES (2, 'ITEM-042');
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, '^PROD-');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount FLOAT64);
INSERT INTO sales VALUES (1, 'A', 100.0);
INSERT INTO sales VALUES (2, 'A', 200.0);
INSERT INTO sales VALUES (3, 'B', 150.0);
INSERT INTO sales VALUES (4, 'C', 100.0);
INSERT INTO sales VALUES (5, 'C', 100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ');
INSERT INTO data VALUES (3, 'DEF456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Test123');
INSERT INTO data VALUES (2, 'Hello');
INSERT INTO data VALUES (3, 'World456');
INSERT INTO data VALUES (4, 'Example');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Hello ');
INSERT INTO data VALUES (2, ' ');
INSERT INTO data VALUES (3, '');
INSERT INTO data VALUES (4, 'Hello World');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'line1
line2');
INSERT INTO data VALUES (2, 'single line');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test!value');
INSERT INTO data VALUES (2, 'test_value');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'completed');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (2, 'short');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_1907
SELECT id FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1908
SELECT p.id FROM products p, patterns pat WHERE p.code ~ pat.pattern;
-- Tag: window_functions_window_functions_operators_test_select_1909
SELECT product FROM sales GROUP BY product HAVING SUM(amount) <> 200.0 ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_1910
SELECT id, CASE WHEN value ~ '[0-9]' THEN 'has_digits' ELSE 'no_digits' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1911
SELECT id FROM data WHERE value ~ '^[A-Z]' AND value ~ '[0-9]' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1912
SELECT * FROM data WHERE value ~ '[a-z';
-- Tag: window_functions_window_functions_operators_test_select_1913
SELECT * FROM data WHERE value LIKE 'test' ESCAPE 'ab';
-- Tag: window_functions_window_functions_operators_test_select_1914
SELECT COUNT(*) FROM data WHERE value ~ '^value[1-3]$';
-- Tag: window_functions_window_functions_operators_test_select_1915
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1916
SELECT id FROM data WHERE value ~ 'Hello' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1917
SELECT id FROM data WHERE value ~ '\
';
-- Tag: window_functions_window_functions_operators_test_select_1918
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1919
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1920
SELECT id FROM data WHERE value LIKE 'test!!value' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1921
SELECT id FROM data WHERE status ~ '^(active|pending)$' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1922
SELECT id FROM data WHERE value ~ '^a+$';
-- Tag: window_functions_window_functions_operators_test_select_1923
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1924
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_1925
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1926
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1927
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1928
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1929
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_1930
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_1931
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_1932
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1933
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1934
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_1935
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1936
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount FLOAT64);
INSERT INTO sales VALUES (1, 'A', 100.0);
INSERT INTO sales VALUES (2, 'A', 200.0);
INSERT INTO sales VALUES (3, 'B', 150.0);
INSERT INTO sales VALUES (4, 'C', 100.0);
INSERT INTO sales VALUES (5, 'C', 100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ');
INSERT INTO data VALUES (3, 'DEF456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Test123');
INSERT INTO data VALUES (2, 'Hello');
INSERT INTO data VALUES (3, 'World456');
INSERT INTO data VALUES (4, 'Example');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Hello ');
INSERT INTO data VALUES (2, ' ');
INSERT INTO data VALUES (3, '');
INSERT INTO data VALUES (4, 'Hello World');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'line1
line2');
INSERT INTO data VALUES (2, 'single line');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test!value');
INSERT INTO data VALUES (2, 'test_value');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'completed');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (2, 'short');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_1937
SELECT product FROM sales GROUP BY product HAVING SUM(amount) <> 200.0 ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_1938
SELECT id, CASE WHEN value ~ '[0-9]' THEN 'has_digits' ELSE 'no_digits' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1939
SELECT id FROM data WHERE value ~ '^[A-Z]' AND value ~ '[0-9]' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1940
SELECT * FROM data WHERE value ~ '[a-z';
-- Tag: window_functions_window_functions_operators_test_select_1941
SELECT * FROM data WHERE value LIKE 'test' ESCAPE 'ab';
-- Tag: window_functions_window_functions_operators_test_select_1942
SELECT COUNT(*) FROM data WHERE value ~ '^value[1-3]$';
-- Tag: window_functions_window_functions_operators_test_select_1943
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1944
SELECT id FROM data WHERE value ~ 'Hello' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1945
SELECT id FROM data WHERE value ~ '\
';
-- Tag: window_functions_window_functions_operators_test_select_1946
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1947
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1948
SELECT id FROM data WHERE value LIKE 'test!!value' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1949
SELECT id FROM data WHERE status ~ '^(active|pending)$' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1950
SELECT id FROM data WHERE value ~ '^a+$';
-- Tag: window_functions_window_functions_operators_test_select_1951
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1952
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_1953
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1954
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1955
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1956
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1957
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_1958
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_1959
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_1960
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1961
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1962
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_1963
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1964
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'Hello ');
INSERT INTO data VALUES (2, ' ');
INSERT INTO data VALUES (3, '');
INSERT INTO data VALUES (4, 'Hello World');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'line1
line2');
INSERT INTO data VALUES (2, 'single line');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test!value');
INSERT INTO data VALUES (2, 'test_value');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'completed');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (2, 'short');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_1965
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1966
SELECT id FROM data WHERE value ~ 'Hello' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1967
SELECT id FROM data WHERE value ~ '\
';
-- Tag: window_functions_window_functions_operators_test_select_1968
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1969
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1970
SELECT id FROM data WHERE value LIKE 'test!!value' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1971
SELECT id FROM data WHERE status ~ '^(active|pending)$' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1972
SELECT id FROM data WHERE value ~ '^a+$';
-- Tag: window_functions_window_functions_operators_test_select_1973
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1974
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_1975
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1976
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1977
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1978
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1979
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_1980
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_1981
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_1982
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1983
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1984
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_1985
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_1986
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test!value');
INSERT INTO data VALUES (2, 'test_value');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'completed');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (2, 'short');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_1987
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1988
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_1989
SELECT id FROM data WHERE value LIKE 'test!!value' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1990
SELECT id FROM data WHERE status ~ '^(active|pending)$' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1991
SELECT id FROM data WHERE value ~ '^a+$';
-- Tag: window_functions_window_functions_operators_test_select_1992
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1993
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_1994
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1995
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1996
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_1997
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_1998
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_1999
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_2000
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_2001
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2002
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2003
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_2004
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_2005
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test!value');
INSERT INTO data VALUES (2, 'test_value');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'completed');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (2, 'short');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_2006
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_2007
SELECT id FROM data WHERE value LIKE 'test!!value' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_2008
SELECT id FROM data WHERE status ~ '^(active|pending)$' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2009
SELECT id FROM data WHERE value ~ '^a+$';
-- Tag: window_functions_window_functions_operators_test_select_2010
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2011
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_2012
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2013
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2014
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_2015
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2016
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_2017
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_2018
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_2019
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2020
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2021
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_2022
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_2023
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 1.5);
INSERT INTO data VALUES (2, 2.5);
INSERT INTO data VALUES (3, 1.5);
INSERT INTO data VALUES (4, 3.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123');
INSERT INTO data VALUES (2, 'test');
INSERT INTO data VALUES (3, '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_2024
SELECT id FROM data WHERE value <> 1.5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2025
SELECT id FROM data WHERE value ~ 'test(?=[0-9])';
-- Tag: window_functions_window_functions_operators_test_select_2026
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2027
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2028
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_2029
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2030
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_2031
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_2032
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_2033
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2034
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2035
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_2036
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_2037
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (5);
INSERT INTO multipliers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'the cat');
INSERT INTO data VALUES (2, 'category');
INSERT INTO data VALUES (3, 'cat');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test%');
INSERT INTO data VALUES (2, 'test_');
INSERT INTO data VALUES (3, 'testx');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_2038
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2039
SELECT id FROM data WHERE value ~ '\bcat\b' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2040
SELECT id FROM data WHERE value LIKE 'test!%' ESCAPE '!';
-- Tag: window_functions_window_functions_operators_test_select_2041
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2042
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_2043
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_2044
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_2045
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2046
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2047
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_2048
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_2049
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value FLOAT64);
INSERT INTO filter VALUES (10.0);
INSERT INTO filter VALUES (20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'HELLO');
INSERT INTO data VALUES (2, 'hello');
INSERT INTO data VALUES (3, 'HeLLo');
INSERT INTO data VALUES (4, 'Strae');
INSERT INTO data VALUES (5, 'STRASSE');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING, flag BOOL);
INSERT INTO data VALUES (1, 'test123', false);
INSERT INTO data VALUES (2, 'hello', false);
INSERT INTO data VALUES (3, 'world456', false);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'keep_this');
INSERT INTO data VALUES (2, 'DELETE_ME');
INSERT INTO data VALUES (3, 'also_keep');
INSERT INTO data VALUES (4, 'DELETE_THIS');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'file_01.txt');
INSERT INTO data VALUES (2, 'file_02.txt');
INSERT INTO data VALUES (3, 'fileX01.txt');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 123);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '<tag>content</tag>');
INSERT INTO data VALUES (2, '<a><b></b></a>');
INSERT INTO data VALUES (3, 'no tags here');

-- Tag: window_functions_window_functions_operators_test_select_2050
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2051
SELECT id FROM data WHERE value ~* '^hello$' ORDER BY id;
UPDATE data SET flag = true WHERE value ~ '[0-9]';
-- Tag: window_functions_window_functions_operators_test_select_2052
SELECT id FROM data WHERE flag = true ORDER BY id;
DELETE FROM data WHERE value ~ '^DELETE_';
-- Tag: window_functions_window_functions_operators_test_select_2053
SELECT id FROM data ORDER BY id;
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_2054
SELECT id FROM products WHERE active = true ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2055
SELECT id FROM data WHERE value LIKE 'file!___.txt' ESCAPE '!' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2056
SELECT * FROM data WHERE value ~ '123';
-- Tag: window_functions_window_functions_operators_test_select_2057
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_2058
SELECT id FROM data WHERE value ~ '<.*>' ORDER BY id;

DROP TABLE IF EXISTS prices;
CREATE TABLE prices (product STRING, date DATE, price FLOAT64);
INSERT INTO prices VALUES ('A', DATE '2024-01-01', 10.0);
INSERT INTO prices VALUES ('A', DATE '2024-01-15', 15.0);
INSERT INTO prices VALUES ('B', DATE '2024-01-01', 20.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, number INT64);
INSERT INTO data VALUES (1, 12345), (2, 67890), (3, 11111);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount STRING);
INSERT INTO sales VALUES ('A', '100.50'), ('B', '200.75'), ('A', '150.25');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, '10'), (2, '20'), (3, '30'), (4, '40');
DROP TABLE IF EXISTS daily_sales;
CREATE TABLE daily_sales (date DATE, product STRING, amount INT64);
DROP TABLE IF EXISTS monthly_summary;
CREATE TABLE monthly_summary (month INT64, product STRING, total INT64);
INSERT INTO daily_sales VALUES (DATE '2024-01-05', 'A', 100);
INSERT INTO daily_sales VALUES (DATE '2024-01-15', 'A', 150);
INSERT INTO daily_sales VALUES (DATE '2024-02-10', 'A', 200);
INSERT INTO monthly_summary SELECT EXTRACT(MONTH FROM date), product, SUM(amount) FROM daily_sales GROUP BY EXTRACT(MONTH FROM date), product;
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64, squared INT64);
INSERT INTO computed VALUES (1, 5, 5 * 5), (2, 10, 10 * 10), (3, 15, 15 * 15);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64, value INT64);
INSERT INTO dest SELECT * FROM source WHERE value > 500 ORDER BY value DESC LIMIT 10;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice'), (2, 'Bob');
ALTER TABLE users ADD COLUMN status STRING DEFAULT 'active';
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 30);
ALTER TABLE data ALTER COLUMN value SET NOT NULL;
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount INT64);
ALTER TABLE orders ADD CONSTRAINT check_customer CHECK (customer_id > 0);
ALTER TABLE orders DROP COLUMN customer_id;
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, manager_id INT64, salary INT64);
INSERT INTO employees VALUES (1, NULL, 100000);
INSERT INTO employees VALUES (2, 1, 80000), (3, 1, 90000);
INSERT INTO employees VALUES (4, 2, 60000), (5, 2, 70000);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, data STRING);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Apple', 1.5), (2, 'Banana', 0.5);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('West', 'A', 100), ('West', 'B', 200);
INSERT INTO sales VALUES ('East', 'A', 150), ('East', 'B', 250);
DROP TABLE IF EXISTS prices;
CREATE TABLE prices (date DATE, price FLOAT64);
INSERT INTO prices VALUES (DATE '2024-01-01', 10.0);
INSERT INTO prices VALUES (DATE '2024-01-02', 11.0);
INSERT INTO prices VALUES (DATE '2024-01-03', NULL);
INSERT INTO prices VALUES (DATE '2024-01-04', 12.0);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, user_id INT64, date DATE, amount FLOAT64, category STRING);
INSERT INTO transactions VALUES (1, 1, DATE '2024-01-05', 100.0, 'Food');
INSERT INTO transactions VALUES (2, 1, DATE '2024-01-15', 50.0, 'Transport');
INSERT INTO transactions VALUES (3, 2, DATE '2024-01-10', 200.0, 'Food');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, product STRING, quantity INT64, price FLOAT64);
INSERT INTO orders VALUES (1, 'A', 5, 10.0), (1, 'B', 3, 20.0);
INSERT INTO orders VALUES (2, 'A', 10, 10.0), (2, 'B', 1, 20.0);
DROP TABLE IF EXISTS sales_2023;
CREATE TABLE sales_2023 (product STRING, amount INT64);
DROP TABLE IF EXISTS sales_2024;
CREATE TABLE sales_2024 (product STRING, amount INT64);
INSERT INTO sales_2023 VALUES ('A', 100), ('B', 200);
INSERT INTO sales_2024 VALUES ('A', 150), ('B', 250);

-- Tag: window_functions_window_functions_operators_test_select_2059
SELECT * FROM data WHERE CAST(number AS STRING) LIKE '1%';
-- Tag: window_functions_window_functions_operators_test_select_2060
SELECT product, SUM(CAST(amount AS FLOAT64)) as total FROM sales GROUP BY product ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_2061
SELECT * FROM data WHERE CAST(value AS INT64) BETWEEN 15 AND 35;
-- Tag: window_functions_window_functions_operators_test_select_2062
SELECT COUNT(*) FROM monthly_summary;
-- Tag: window_functions_window_functions_operators_test_select_2063
SELECT * FROM computed ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2064
SELECT COUNT(*) FROM dest;
-- Tag: window_functions_window_functions_operators_test_select_2065
SELECT * FROM users WHERE status = 'active';
-- Tag: window_functions_window_functions_operators_test_select_2066
SELECT * FROM events WHERE JSON_EXTRACT(data, '$.type') = 'click';
-- Tag: window_functions_window_functions_operators_test_select_2067
SELECT JSON_ARRAYAGG(name) as products FROM products;
-- Tag: window_functions_window_functions_operators_test_select_2068
SELECT *, RANK() OVER (PARTITION BY region ORDER BY amount DESC) as rank FROM sales;
-- Tag: window_functions_window_functions_operators_test_select_2069
SELECT date, price, LAG(price, 1, 0.0) OVER (ORDER BY date) as prev_price FROM prices ORDER BY date;
-- Tag: window_functions_window_functions_operators_test_select_2070
SELECT DISTINCT product FROM prices p1
WHERE (SELECT price FROM prices p2 WHERE p2.product = p1.product ORDER BY date DESC LIMIT 1) BETWEEN 12.0 AND 18.0;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary INT64, department STRING);
INSERT INTO employees VALUES (1, 'Alice', 80000, 'Engineering');
INSERT INTO employees VALUES (2, 'Bob', 60000, 'Sales');
INSERT INTO employees VALUES (3, 'Charlie', 90000, 'Engineering');
INSERT INTO employees VALUES (4, 'David', 55000, 'Sales');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount INT64);
INSERT INTO sales VALUES ('Widget', 'North', 100);
INSERT INTO sales VALUES ('Widget', 'South', 150);
INSERT INTO sales VALUES ('Gadget', 'North', 200);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, department STRING, salary INT64);
INSERT INTO employees VALUES (1, 'Alice', 'Engineering', 80000);
INSERT INTO employees VALUES (2, 'Bob', 'Engineering', 75000);
INSERT INTO employees VALUES (3, 'Charlie', 'Sales', 60000);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount INT64);
INSERT INTO sales VALUES ('Widget', 100);
INSERT INTO sales VALUES ('Gadget', 200);
INSERT INTO sales VALUES ('Widget', 150);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, department STRING, salary INT64);
INSERT INTO employees VALUES (1, 'Alice', 'Engineering', 80000);
INSERT INTO employees VALUES (2, 'Bob', 'Sales', 60000);
INSERT INTO employees VALUES (3, 'Charlie', 'Engineering', 90000);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer STRING, product STRING);
INSERT INTO orders VALUES ('Alice', 'Widget');
INSERT INTO orders VALUES ('Alice', 'Gadget');
INSERT INTO orders VALUES ('Bob', 'Widget');
INSERT INTO orders VALUES ('Alice', 'Widget');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer STRING, product STRING);
INSERT INTO orders VALUES ('Alice', 'Widget');
INSERT INTO orders VALUES ('Alice', 'Gadget');
INSERT INTO orders VALUES ('Bob', 'Widget');
INSERT INTO orders VALUES ('Alice', 'Widget');
DROP TABLE IF EXISTS customers_us;
CREATE TABLE customers_us (name STRING);
DROP TABLE IF EXISTS customers_eu;
CREATE TABLE customers_eu (name STRING);
INSERT INTO customers_us VALUES ('Alice');
INSERT INTO customers_us VALUES ('Bob');
INSERT INTO customers_eu VALUES ('Charlie');
INSERT INTO customers_eu VALUES ('Alice');
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value INT64);
INSERT INTO table1 VALUES (1);
INSERT INTO table1 VALUES (2);
INSERT INTO table2 VALUES (2);
INSERT INTO table2 VALUES (3);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO set1 VALUES (1);
INSERT INTO set1 VALUES (2);
INSERT INTO set1 VALUES (3);
INSERT INTO set2 VALUES (2);
INSERT INTO set2 VALUES (3);
INSERT INTO set2 VALUES (4);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO set1 VALUES (1);
INSERT INTO set1 VALUES (2);
INSERT INTO set1 VALUES (3);
INSERT INTO set2 VALUES (2);
INSERT INTO set2 VALUES (4);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (name STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 95);
INSERT INTO scores VALUES ('Bob', 75);
INSERT INTO scores VALUES ('Charlie', 55);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount INT64);
INSERT INTO sales VALUES ('Widget', 100);
INSERT INTO sales VALUES ('Gadget', 200);
INSERT INTO sales VALUES ('Gizmo', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('North', 'Widget', 100);
INSERT INTO sales VALUES ('North', 'Gadget', 200);
INSERT INTO sales VALUES ('South', 'Widget', 150);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING, region STRING);
INSERT INTO orders VALUES (1, 1, 100);
INSERT INTO orders VALUES (2, 1, 200);
INSERT INTO orders VALUES (3, 2, 150);
INSERT INTO customers VALUES (1, 'Alice', 'North');
INSERT INTO customers VALUES (2, 'Bob', 'South');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, category STRING);
INSERT INTO products VALUES (1, 'Laptop', 'Electronics');
INSERT INTO products VALUES (2, 'Desk', 'Furniture');
INSERT INTO products VALUES (3, 'Phone', 'Electronics');
INSERT INTO products VALUES (4, 'Chair', 'Furniture');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, status STRING);
INSERT INTO users VALUES (1, 'Alice', 'active');
INSERT INTO users VALUES (2, 'Bob', 'inactive');
INSERT INTO users VALUES (3, 'Charlie', 'pending');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
INSERT INTO products VALUES (1, 10.0);
INSERT INTO products VALUES (2, 25.0);
INSERT INTO products VALUES (3, 50.0);
INSERT INTO products VALUES (4, 75.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (name STRING);
INSERT INTO users VALUES ('Alice');
INSERT INTO users VALUES ('Bob');
INSERT INTO users VALUES ('Alicia');
INSERT INTO users VALUES ('Albert');
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount INT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO customers VALUES (3, 'Charlie');
INSERT INTO orders VALUES (1, 100);
INSERT INTO orders VALUES (1, 200);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);

-- Tag: window_functions_window_functions_operators_test_select_2071
SELECT name FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees);
-- Tag: window_functions_window_functions_operators_test_select_2072
SELECT * FROM (SELECT product, SUM(amount) as total FROM sales GROUP BY product) as totals;
-- Tag: window_functions_window_functions_operators_test_select_2073
SELECT e1.name, e1.salary
FROM employees e1
WHERE e1.salary > (
-- Tag: window_functions_window_functions_operators_test_select_2074
SELECT AVG(e2.salary)
FROM employees e2
WHERE e2.department = e1.department
);
WITH product_totals AS (
-- Tag: window_functions_window_functions_operators_test_select_2075
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
)
-- Tag: window_functions_window_functions_operators_test_select_2076
SELECT * FROM product_totals;
WITH
eng_emps AS (SELECT * FROM employees WHERE department = 'Engineering'),
high_earners AS (SELECT * FROM eng_emps WHERE salary > 75000)
-- Tag: window_functions_window_functions_operators_test_select_2077
SELECT * FROM high_earners;
-- Tag: window_functions_window_functions_operators_test_select_2078
SELECT DISTINCT customer FROM orders;
-- Tag: window_functions_window_functions_operators_test_select_2079
SELECT DISTINCT customer, product FROM orders;
-- Tag: window_functions_window_functions_operators_test_select_2080
SELECT name FROM customers_us UNION SELECT name FROM customers_eu;
-- Tag: window_functions_window_functions_operators_test_select_2081
SELECT value FROM table1 UNION ALL SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2082
SELECT value FROM set1 INTERSECT SELECT value FROM set2;
-- Tag: window_functions_window_functions_operators_test_select_2083
SELECT value FROM set1 EXCEPT SELECT value FROM set2;
-- Tag: window_functions_window_functions_operators_test_select_2084
SELECT name,
CASE
WHEN score >= 90 THEN 'A'
WHEN score >= 70 THEN 'B'
ELSE 'C'
END as grade
FROM scores;
-- Tag: window_functions_window_functions_operators_test_select_2085
SELECT product, amount, ROW_NUMBER() OVER (ORDER BY amount DESC) as rank
FROM sales;
-- Tag: window_functions_window_functions_operators_test_select_2086
SELECT region, product, amount,
ROW_NUMBER() OVER (PARTITION BY region ORDER BY amount DESC) as region_rank
FROM sales;
-- Tag: window_functions_window_functions_operators_test_select_2087
SELECT c.name, c.region, o.total
FROM customers c
JOIN (
-- Tag: window_functions_window_functions_operators_test_select_2088
SELECT customer_id, SUM(amount) as total
FROM orders
GROUP BY customer_id
) o ON c.id = o.customer_id
WHERE o.total > 150;
-- Tag: window_functions_window_functions_operators_test_select_2089
SELECT * FROM products WHERE category IN ('Electronics', 'Appliances');
-- Tag: window_functions_window_functions_operators_test_select_2090
SELECT * FROM users WHERE status NOT IN ('inactive', 'banned');
-- Tag: window_functions_window_functions_operators_test_select_2091
SELECT * FROM products WHERE price BETWEEN 20.0 AND 60.0;
-- Tag: window_functions_window_functions_operators_test_select_2092
SELECT * FROM users WHERE name LIKE 'Al%';
-- Tag: window_functions_window_functions_operators_test_select_2093
SELECT name FROM customers c
WHERE EXISTS (SELECT 1 FROM orders o WHERE o.customer_id = c.id);
-- Tag: window_functions_window_functions_operators_test_select_2094
SELECT * FROM numbers ORDER BY value LIMIT 5 OFFSET 3;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount INT64);
INSERT INTO sales VALUES ('Widget', 'North', 100);
INSERT INTO sales VALUES ('Widget', 'South', 150);
INSERT INTO sales VALUES ('Gadget', 'North', 200);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, department STRING, salary INT64);
INSERT INTO employees VALUES (1, 'Alice', 'Engineering', 80000);
INSERT INTO employees VALUES (2, 'Bob', 'Engineering', 75000);
INSERT INTO employees VALUES (3, 'Charlie', 'Sales', 60000);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount INT64);
INSERT INTO sales VALUES ('Widget', 100);
INSERT INTO sales VALUES ('Gadget', 200);
INSERT INTO sales VALUES ('Widget', 150);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, department STRING, salary INT64);
INSERT INTO employees VALUES (1, 'Alice', 'Engineering', 80000);
INSERT INTO employees VALUES (2, 'Bob', 'Sales', 60000);
INSERT INTO employees VALUES (3, 'Charlie', 'Engineering', 90000);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer STRING, product STRING);
INSERT INTO orders VALUES ('Alice', 'Widget');
INSERT INTO orders VALUES ('Alice', 'Gadget');
INSERT INTO orders VALUES ('Bob', 'Widget');
INSERT INTO orders VALUES ('Alice', 'Widget');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer STRING, product STRING);
INSERT INTO orders VALUES ('Alice', 'Widget');
INSERT INTO orders VALUES ('Alice', 'Gadget');
INSERT INTO orders VALUES ('Bob', 'Widget');
INSERT INTO orders VALUES ('Alice', 'Widget');
DROP TABLE IF EXISTS customers_us;
CREATE TABLE customers_us (name STRING);
DROP TABLE IF EXISTS customers_eu;
CREATE TABLE customers_eu (name STRING);
INSERT INTO customers_us VALUES ('Alice');
INSERT INTO customers_us VALUES ('Bob');
INSERT INTO customers_eu VALUES ('Charlie');
INSERT INTO customers_eu VALUES ('Alice');
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value INT64);
INSERT INTO table1 VALUES (1);
INSERT INTO table1 VALUES (2);
INSERT INTO table2 VALUES (2);
INSERT INTO table2 VALUES (3);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO set1 VALUES (1);
INSERT INTO set1 VALUES (2);
INSERT INTO set1 VALUES (3);
INSERT INTO set2 VALUES (2);
INSERT INTO set2 VALUES (3);
INSERT INTO set2 VALUES (4);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO set1 VALUES (1);
INSERT INTO set1 VALUES (2);
INSERT INTO set1 VALUES (3);
INSERT INTO set2 VALUES (2);
INSERT INTO set2 VALUES (4);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (name STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 95);
INSERT INTO scores VALUES ('Bob', 75);
INSERT INTO scores VALUES ('Charlie', 55);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount INT64);
INSERT INTO sales VALUES ('Widget', 100);
INSERT INTO sales VALUES ('Gadget', 200);
INSERT INTO sales VALUES ('Gizmo', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('North', 'Widget', 100);
INSERT INTO sales VALUES ('North', 'Gadget', 200);
INSERT INTO sales VALUES ('South', 'Widget', 150);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING, region STRING);
INSERT INTO orders VALUES (1, 1, 100);
INSERT INTO orders VALUES (2, 1, 200);
INSERT INTO orders VALUES (3, 2, 150);
INSERT INTO customers VALUES (1, 'Alice', 'North');
INSERT INTO customers VALUES (2, 'Bob', 'South');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, category STRING);
INSERT INTO products VALUES (1, 'Laptop', 'Electronics');
INSERT INTO products VALUES (2, 'Desk', 'Furniture');
INSERT INTO products VALUES (3, 'Phone', 'Electronics');
INSERT INTO products VALUES (4, 'Chair', 'Furniture');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, status STRING);
INSERT INTO users VALUES (1, 'Alice', 'active');
INSERT INTO users VALUES (2, 'Bob', 'inactive');
INSERT INTO users VALUES (3, 'Charlie', 'pending');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
INSERT INTO products VALUES (1, 10.0);
INSERT INTO products VALUES (2, 25.0);
INSERT INTO products VALUES (3, 50.0);
INSERT INTO products VALUES (4, 75.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (name STRING);
INSERT INTO users VALUES ('Alice');
INSERT INTO users VALUES ('Bob');
INSERT INTO users VALUES ('Alicia');
INSERT INTO users VALUES ('Albert');
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount INT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO customers VALUES (3, 'Charlie');
INSERT INTO orders VALUES (1, 100);
INSERT INTO orders VALUES (1, 200);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);

-- Tag: window_functions_window_functions_operators_test_select_2095
SELECT * FROM (SELECT product, SUM(amount) as total FROM sales GROUP BY product) as totals;
-- Tag: window_functions_window_functions_operators_test_select_2096
SELECT e1.name, e1.salary
FROM employees e1
WHERE e1.salary > (
-- Tag: window_functions_window_functions_operators_test_select_2097
SELECT AVG(e2.salary)
FROM employees e2
WHERE e2.department = e1.department
);
WITH product_totals AS (
-- Tag: window_functions_window_functions_operators_test_select_2098
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
)
-- Tag: window_functions_window_functions_operators_test_select_2099
SELECT * FROM product_totals;
WITH
eng_emps AS (SELECT * FROM employees WHERE department = 'Engineering'),
high_earners AS (SELECT * FROM eng_emps WHERE salary > 75000)
-- Tag: window_functions_window_functions_operators_test_select_2100
SELECT * FROM high_earners;
-- Tag: window_functions_window_functions_operators_test_select_2101
SELECT DISTINCT customer FROM orders;
-- Tag: window_functions_window_functions_operators_test_select_2102
SELECT DISTINCT customer, product FROM orders;
-- Tag: window_functions_window_functions_operators_test_select_2103
SELECT name FROM customers_us UNION SELECT name FROM customers_eu;
-- Tag: window_functions_window_functions_operators_test_select_2104
SELECT value FROM table1 UNION ALL SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2105
SELECT value FROM set1 INTERSECT SELECT value FROM set2;
-- Tag: window_functions_window_functions_operators_test_select_2106
SELECT value FROM set1 EXCEPT SELECT value FROM set2;
-- Tag: window_functions_window_functions_operators_test_select_2107
SELECT name,
CASE
WHEN score >= 90 THEN 'A'
WHEN score >= 70 THEN 'B'
ELSE 'C'
END as grade
FROM scores;
-- Tag: window_functions_window_functions_operators_test_select_2108
SELECT product, amount, ROW_NUMBER() OVER (ORDER BY amount DESC) as rank
FROM sales;
-- Tag: window_functions_window_functions_operators_test_select_2109
SELECT region, product, amount,
ROW_NUMBER() OVER (PARTITION BY region ORDER BY amount DESC) as region_rank
FROM sales;
-- Tag: window_functions_window_functions_operators_test_select_2110
SELECT c.name, c.region, o.total
FROM customers c
JOIN (
-- Tag: window_functions_window_functions_operators_test_select_2111
SELECT customer_id, SUM(amount) as total
FROM orders
GROUP BY customer_id
) o ON c.id = o.customer_id
WHERE o.total > 150;
-- Tag: window_functions_window_functions_operators_test_select_2112
SELECT * FROM products WHERE category IN ('Electronics', 'Appliances');
-- Tag: window_functions_window_functions_operators_test_select_2113
SELECT * FROM users WHERE status NOT IN ('inactive', 'banned');
-- Tag: window_functions_window_functions_operators_test_select_2114
SELECT * FROM products WHERE price BETWEEN 20.0 AND 60.0;
-- Tag: window_functions_window_functions_operators_test_select_2115
SELECT * FROM users WHERE name LIKE 'Al%';
-- Tag: window_functions_window_functions_operators_test_select_2116
SELECT name FROM customers c
WHERE EXISTS (SELECT 1 FROM orders o WHERE o.customer_id = c.id);
-- Tag: window_functions_window_functions_operators_test_select_2117
SELECT * FROM numbers ORDER BY value LIMIT 5 OFFSET 3;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, department STRING, salary INT64);
INSERT INTO employees VALUES (1, 'Alice', 'Engineering', 80000);
INSERT INTO employees VALUES (2, 'Bob', 'Engineering', 75000);
INSERT INTO employees VALUES (3, 'Charlie', 'Sales', 60000);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount INT64);
INSERT INTO sales VALUES ('Widget', 100);
INSERT INTO sales VALUES ('Gadget', 200);
INSERT INTO sales VALUES ('Widget', 150);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, department STRING, salary INT64);
INSERT INTO employees VALUES (1, 'Alice', 'Engineering', 80000);
INSERT INTO employees VALUES (2, 'Bob', 'Sales', 60000);
INSERT INTO employees VALUES (3, 'Charlie', 'Engineering', 90000);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer STRING, product STRING);
INSERT INTO orders VALUES ('Alice', 'Widget');
INSERT INTO orders VALUES ('Alice', 'Gadget');
INSERT INTO orders VALUES ('Bob', 'Widget');
INSERT INTO orders VALUES ('Alice', 'Widget');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer STRING, product STRING);
INSERT INTO orders VALUES ('Alice', 'Widget');
INSERT INTO orders VALUES ('Alice', 'Gadget');
INSERT INTO orders VALUES ('Bob', 'Widget');
INSERT INTO orders VALUES ('Alice', 'Widget');
DROP TABLE IF EXISTS customers_us;
CREATE TABLE customers_us (name STRING);
DROP TABLE IF EXISTS customers_eu;
CREATE TABLE customers_eu (name STRING);
INSERT INTO customers_us VALUES ('Alice');
INSERT INTO customers_us VALUES ('Bob');
INSERT INTO customers_eu VALUES ('Charlie');
INSERT INTO customers_eu VALUES ('Alice');
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value INT64);
INSERT INTO table1 VALUES (1);
INSERT INTO table1 VALUES (2);
INSERT INTO table2 VALUES (2);
INSERT INTO table2 VALUES (3);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO set1 VALUES (1);
INSERT INTO set1 VALUES (2);
INSERT INTO set1 VALUES (3);
INSERT INTO set2 VALUES (2);
INSERT INTO set2 VALUES (3);
INSERT INTO set2 VALUES (4);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO set1 VALUES (1);
INSERT INTO set1 VALUES (2);
INSERT INTO set1 VALUES (3);
INSERT INTO set2 VALUES (2);
INSERT INTO set2 VALUES (4);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (name STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 95);
INSERT INTO scores VALUES ('Bob', 75);
INSERT INTO scores VALUES ('Charlie', 55);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount INT64);
INSERT INTO sales VALUES ('Widget', 100);
INSERT INTO sales VALUES ('Gadget', 200);
INSERT INTO sales VALUES ('Gizmo', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('North', 'Widget', 100);
INSERT INTO sales VALUES ('North', 'Gadget', 200);
INSERT INTO sales VALUES ('South', 'Widget', 150);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING, region STRING);
INSERT INTO orders VALUES (1, 1, 100);
INSERT INTO orders VALUES (2, 1, 200);
INSERT INTO orders VALUES (3, 2, 150);
INSERT INTO customers VALUES (1, 'Alice', 'North');
INSERT INTO customers VALUES (2, 'Bob', 'South');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, category STRING);
INSERT INTO products VALUES (1, 'Laptop', 'Electronics');
INSERT INTO products VALUES (2, 'Desk', 'Furniture');
INSERT INTO products VALUES (3, 'Phone', 'Electronics');
INSERT INTO products VALUES (4, 'Chair', 'Furniture');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, status STRING);
INSERT INTO users VALUES (1, 'Alice', 'active');
INSERT INTO users VALUES (2, 'Bob', 'inactive');
INSERT INTO users VALUES (3, 'Charlie', 'pending');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
INSERT INTO products VALUES (1, 10.0);
INSERT INTO products VALUES (2, 25.0);
INSERT INTO products VALUES (3, 50.0);
INSERT INTO products VALUES (4, 75.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (name STRING);
INSERT INTO users VALUES ('Alice');
INSERT INTO users VALUES ('Bob');
INSERT INTO users VALUES ('Alicia');
INSERT INTO users VALUES ('Albert');
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount INT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO customers VALUES (3, 'Charlie');
INSERT INTO orders VALUES (1, 100);
INSERT INTO orders VALUES (1, 200);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);

-- Tag: window_functions_window_functions_operators_test_select_2118
SELECT e1.name, e1.salary
FROM employees e1
WHERE e1.salary > (
-- Tag: window_functions_window_functions_operators_test_select_2119
SELECT AVG(e2.salary)
FROM employees e2
WHERE e2.department = e1.department
);
WITH product_totals AS (
-- Tag: window_functions_window_functions_operators_test_select_2120
SELECT product, SUM(amount) as total
FROM sales
GROUP BY product
)
-- Tag: window_functions_window_functions_operators_test_select_2121
SELECT * FROM product_totals;
WITH
eng_emps AS (SELECT * FROM employees WHERE department = 'Engineering'),
high_earners AS (SELECT * FROM eng_emps WHERE salary > 75000)
-- Tag: window_functions_window_functions_operators_test_select_2122
SELECT * FROM high_earners;
-- Tag: window_functions_window_functions_operators_test_select_2123
SELECT DISTINCT customer FROM orders;
-- Tag: window_functions_window_functions_operators_test_select_2124
SELECT DISTINCT customer, product FROM orders;
-- Tag: window_functions_window_functions_operators_test_select_2125
SELECT name FROM customers_us UNION SELECT name FROM customers_eu;
-- Tag: window_functions_window_functions_operators_test_select_2126
SELECT value FROM table1 UNION ALL SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2127
SELECT value FROM set1 INTERSECT SELECT value FROM set2;
-- Tag: window_functions_window_functions_operators_test_select_2128
SELECT value FROM set1 EXCEPT SELECT value FROM set2;
-- Tag: window_functions_window_functions_operators_test_select_2129
SELECT name,
CASE
WHEN score >= 90 THEN 'A'
WHEN score >= 70 THEN 'B'
ELSE 'C'
END as grade
FROM scores;
-- Tag: window_functions_window_functions_operators_test_select_2130
SELECT product, amount, ROW_NUMBER() OVER (ORDER BY amount DESC) as rank
FROM sales;
-- Tag: window_functions_window_functions_operators_test_select_2131
SELECT region, product, amount,
ROW_NUMBER() OVER (PARTITION BY region ORDER BY amount DESC) as region_rank
FROM sales;
-- Tag: window_functions_window_functions_operators_test_select_2132
SELECT c.name, c.region, o.total
FROM customers c
JOIN (
-- Tag: window_functions_window_functions_operators_test_select_2133
SELECT customer_id, SUM(amount) as total
FROM orders
GROUP BY customer_id
) o ON c.id = o.customer_id
WHERE o.total > 150;
-- Tag: window_functions_window_functions_operators_test_select_2134
SELECT * FROM products WHERE category IN ('Electronics', 'Appliances');
-- Tag: window_functions_window_functions_operators_test_select_2135
SELECT * FROM users WHERE status NOT IN ('inactive', 'banned');
-- Tag: window_functions_window_functions_operators_test_select_2136
SELECT * FROM products WHERE price BETWEEN 20.0 AND 60.0;
-- Tag: window_functions_window_functions_operators_test_select_2137
SELECT * FROM users WHERE name LIKE 'Al%';
-- Tag: window_functions_window_functions_operators_test_select_2138
SELECT name FROM customers c
WHERE EXISTS (SELECT 1 FROM orders o WHERE o.customer_id = c.id);
-- Tag: window_functions_window_functions_operators_test_select_2139
SELECT * FROM numbers ORDER BY value LIMIT 5 OFFSET 3;

DROP TABLE IF EXISTS scores;
CREATE TABLE scores (name STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 95);
INSERT INTO scores VALUES ('Bob', 75);
INSERT INTO scores VALUES ('Charlie', 55);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount INT64);
INSERT INTO sales VALUES ('Widget', 100);
INSERT INTO sales VALUES ('Gadget', 200);
INSERT INTO sales VALUES ('Gizmo', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('North', 'Widget', 100);
INSERT INTO sales VALUES ('North', 'Gadget', 200);
INSERT INTO sales VALUES ('South', 'Widget', 150);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING, region STRING);
INSERT INTO orders VALUES (1, 1, 100);
INSERT INTO orders VALUES (2, 1, 200);
INSERT INTO orders VALUES (3, 2, 150);
INSERT INTO customers VALUES (1, 'Alice', 'North');
INSERT INTO customers VALUES (2, 'Bob', 'South');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, category STRING);
INSERT INTO products VALUES (1, 'Laptop', 'Electronics');
INSERT INTO products VALUES (2, 'Desk', 'Furniture');
INSERT INTO products VALUES (3, 'Phone', 'Electronics');
INSERT INTO products VALUES (4, 'Chair', 'Furniture');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, status STRING);
INSERT INTO users VALUES (1, 'Alice', 'active');
INSERT INTO users VALUES (2, 'Bob', 'inactive');
INSERT INTO users VALUES (3, 'Charlie', 'pending');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
INSERT INTO products VALUES (1, 10.0);
INSERT INTO products VALUES (2, 25.0);
INSERT INTO products VALUES (3, 50.0);
INSERT INTO products VALUES (4, 75.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (name STRING);
INSERT INTO users VALUES ('Alice');
INSERT INTO users VALUES ('Bob');
INSERT INTO users VALUES ('Alicia');
INSERT INTO users VALUES ('Albert');
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount INT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO customers VALUES (3, 'Charlie');
INSERT INTO orders VALUES (1, 100);
INSERT INTO orders VALUES (1, 200);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);

-- Tag: window_functions_window_functions_operators_test_select_2140
SELECT name,
CASE
WHEN score >= 90 THEN 'A'
WHEN score >= 70 THEN 'B'
ELSE 'C'
END as grade
FROM scores;
-- Tag: window_functions_window_functions_operators_test_select_2141
SELECT product, amount, ROW_NUMBER() OVER (ORDER BY amount DESC) as rank
FROM sales;
-- Tag: window_functions_window_functions_operators_test_select_2142
SELECT region, product, amount,
ROW_NUMBER() OVER (PARTITION BY region ORDER BY amount DESC) as region_rank
FROM sales;
-- Tag: window_functions_window_functions_operators_test_select_2143
SELECT c.name, c.region, o.total
FROM customers c
JOIN (
-- Tag: window_functions_window_functions_operators_test_select_2144
SELECT customer_id, SUM(amount) as total
FROM orders
GROUP BY customer_id
) o ON c.id = o.customer_id
WHERE o.total > 150;
-- Tag: window_functions_window_functions_operators_test_select_2145
SELECT * FROM products WHERE category IN ('Electronics', 'Appliances');
-- Tag: window_functions_window_functions_operators_test_select_2146
SELECT * FROM users WHERE status NOT IN ('inactive', 'banned');
-- Tag: window_functions_window_functions_operators_test_select_2147
SELECT * FROM products WHERE price BETWEEN 20.0 AND 60.0;
-- Tag: window_functions_window_functions_operators_test_select_2148
SELECT * FROM users WHERE name LIKE 'Al%';
-- Tag: window_functions_window_functions_operators_test_select_2149
SELECT name FROM customers c
WHERE EXISTS (SELECT 1 FROM orders o WHERE o.customer_id = c.id);
-- Tag: window_functions_window_functions_operators_test_select_2150
SELECT * FROM numbers ORDER BY value LIMIT 5 OFFSET 3;

DROP TABLE IF EXISTS evolving;
CREATE TABLE evolving (id INT64);
INSERT INTO evolving VALUES (1);
ALTER TABLE evolving ADD COLUMN value INT64 DEFAULT 100;
INSERT INTO evolving VALUES (2, 200);
ALTER TABLE evolving ADD COLUMN name STRING DEFAULT 'test';
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (session_id INT64, status STRING);
INSERT INTO sessions VALUES (1, 'active');
INSERT INTO sessions VALUES (1, 'new');
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
INSERT INTO outer_table VALUES (1), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO nonexistent VALUES (1);
DROP TABLE IF EXISTS recovery_test;
CREATE TABLE recovery_test (id INT64);
INSERT INTO recovery_test VALUES (1);

UPDATE evolving SET value = 150 WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_2151
SELECT * FROM evolving ORDER BY id;
UPDATE data SET value = value * 2;
-- Tag: window_functions_window_functions_operators_test_select_2152
SELECT SUM(value) FROM data;
DELETE FROM sessions WHERE session_id = 1;
-- Tag: window_functions_window_functions_operators_test_select_2153
SELECT status FROM sessions WHERE session_id = 1;
-- Tag: window_functions_window_functions_operators_test_select_2154
SELECT * FROM outer_table WHERE id IN (SELECT nonexistent FROM outer_table);
WITH bad AS (SELECT nonexistent FROM data) SELECT * FROM bad;
-- Tag: window_functions_window_functions_operators_test_select_2155
SELECT * FROM t1 INNER JOIN t2 ON t1.nonexistent = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2156
SELECT * FROM nonexistent_table;
UPDATE nonexistent SET x = 1;
-- Tag: window_functions_window_functions_operators_test_select_2157
SELECT * FROM recovery_test;

DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
INSERT INTO outer_table VALUES (1), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO nonexistent VALUES (1);
DROP TABLE IF EXISTS recovery_test;
CREATE TABLE recovery_test (id INT64);
INSERT INTO recovery_test VALUES (1);

-- Tag: window_functions_window_functions_operators_test_select_2158
SELECT * FROM outer_table WHERE id IN (SELECT nonexistent FROM outer_table);
WITH bad AS (SELECT nonexistent FROM data) SELECT * FROM bad;
-- Tag: window_functions_window_functions_operators_test_select_2159
SELECT * FROM t1 INNER JOIN t2 ON t1.nonexistent = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2160
SELECT * FROM nonexistent_table;
UPDATE nonexistent SET x = 1;
-- Tag: window_functions_window_functions_operators_test_select_2161
SELECT * FROM recovery_test;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO nonexistent VALUES (1);
DROP TABLE IF EXISTS recovery_test;
CREATE TABLE recovery_test (id INT64);
INSERT INTO recovery_test VALUES (1);

WITH bad AS (SELECT nonexistent FROM data) SELECT * FROM bad;
-- Tag: window_functions_window_functions_operators_test_select_2162
SELECT * FROM t1 INNER JOIN t2 ON t1.nonexistent = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2163
SELECT * FROM nonexistent_table;
UPDATE nonexistent SET x = 1;
-- Tag: window_functions_window_functions_operators_test_select_2164
SELECT * FROM recovery_test;

DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO nonexistent VALUES (1);
DROP TABLE IF EXISTS recovery_test;
CREATE TABLE recovery_test (id INT64);
INSERT INTO recovery_test VALUES (1);

-- Tag: window_functions_window_functions_operators_test_select_2165
SELECT * FROM t1 INNER JOIN t2 ON t1.nonexistent = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2166
SELECT * FROM nonexistent_table;
UPDATE nonexistent SET x = 1;
-- Tag: window_functions_window_functions_operators_test_select_2167
SELECT * FROM recovery_test;

INSERT INTO nonexistent VALUES (1);
DROP TABLE IF EXISTS recovery_test;
CREATE TABLE recovery_test (id INT64);
INSERT INTO recovery_test VALUES (1);

-- Tag: window_functions_window_functions_operators_test_select_2168
SELECT * FROM nonexistent_table;
UPDATE nonexistent SET x = 1;
-- Tag: window_functions_window_functions_operators_test_select_2169
SELECT * FROM recovery_test;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 10), (3, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value INT64);
INSERT INTO test VALUES (1, 'A', 10), (2, 'A', 10), (3, 'A', 20), (4, 'B', 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'apple'), (2, 'banana'), (3, 'apple'), (4, 'cherry');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value STRING);
INSERT INTO test VALUES (1, 'zebra'), (2, 'apple'), (3, 'zebra'), (4, 'banana');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value INT64);
INSERT INTO test VALUES (1, 'A', 10), (2, 'A', 20), (3, 'B', 30), (4, 'B', 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);

-- Tag: window_functions_window_functions_operators_test_select_2170
SELECT COUNT(*) AS total, COUNT(DISTINCT value) AS unique, SUM(value) AS total_sum, SUM(DISTINCT value) AS distinct_sum FROM test;
-- Tag: window_functions_window_functions_operators_test_select_2171
SELECT id, category, COUNT(DISTINCT value) OVER (PARTITION BY category) AS unique_in_category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_2172
SELECT STRING_AGG(DISTINCT value, ', ') AS unique_fruits FROM test;
-- Tag: window_functions_window_functions_operators_test_select_2173
SELECT STRING_AGG(DISTINCT value, ', ' ORDER BY value) AS sorted_unique FROM test;
-- Tag: window_functions_window_functions_operators_test_select_2174
SELECT category FROM test GROUP BY category HAVING COUNT(DISTINCT value) > 1;
-- Tag: window_functions_window_functions_operators_test_select_2175
SELECT COUNT(DISTINCT value) AS unique_count FROM test;
-- Tag: window_functions_window_functions_operators_test_select_2176
SELECT COUNT(DISTINCT value) AS unique_count, SUM(DISTINCT value) AS unique_sum FROM test;

DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (0, 0);
INSERT INTO numbers VALUES (1, 0);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (-100);
INSERT INTO numbers VALUES (-1);
INSERT INTO numbers VALUES (0);
INSERT INTO numbers VALUES (1);
DROP TABLE IF EXISTS texts;
CREATE TABLE texts (id INT64, content STRING);
DROP TABLE IF EXISTS unicode;
CREATE TABLE unicode (id INT64, text STRING);
INSERT INTO unicode VALUES (1, 'Hello ');
INSERT INTO unicode VALUES (2, ' ');
INSERT INTO unicode VALUES (3, '');
DROP TABLE IF EXISTS special;
CREATE TABLE special (id INT64, text STRING);
INSERT INTO special VALUES (1, 'Line1
Line2');
INSERT INTO special VALUES (2, 'Tab\there');
INSERT INTO special VALUES (3, 'Quote''s');
DROP TABLE IF EXISTS spaces;
CREATE TABLE spaces (id INT64, text STRING);
INSERT INTO spaces VALUES (1, ' leading');
INSERT INTO spaces VALUES (2, 'trailing ');
INSERT INTO spaces VALUES (3, ' both ');
DROP TABLE IF EXISTS duplicates;
CREATE TABLE duplicates (value INT64);
INSERT INTO duplicates VALUES (42);
DROP TABLE IF EXISTS single;
CREATE TABLE single (id INT64, value STRING);
INSERT INTO single VALUES (1, 'only');
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (20);
INSERT INTO data VALUES (30);
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (id INT64, value FLOAT64);
INSERT INTO floats VALUES (1, 0.0);
INSERT INTO floats VALUES (2, -0.0);
INSERT INTO floats VALUES (3, 1.7976931348623157E308);
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (value FLOAT64);
INSERT INTO floats VALUES (2.2250738585072014E-308);
INSERT INTO floats VALUES (1e-300);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5);
INSERT INTO numbers VALUES (10);
INSERT INTO numbers VALUES (15);
DROP TABLE IF EXISTS groups;
CREATE TABLE groups (category STRING, value INT64);
DROP TABLE IF EXISTS distinct_vals;
CREATE TABLE distinct_vals (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS whitespace;
CREATE TABLE whitespace (id INT64, text STRING);
INSERT INTO whitespace VALUES (1, '  ');
INSERT INTO whitespace VALUES (2, '\t\t');
INSERT INTO whitespace VALUES (3, '
');

-- Tag: window_functions_window_functions_operators_test_select_2177
SELECT * FROM numbers WHERE id = 0;
-- Tag: window_functions_window_functions_operators_test_select_2178
SELECT * FROM numbers WHERE value = 0;
-- Tag: window_functions_window_functions_operators_test_select_2179
SELECT SUM(value) FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2180
SELECT * FROM numbers WHERE value < 0;
-- Tag: window_functions_window_functions_operators_test_select_2181
SELECT * FROM texts;
-- Tag: window_functions_window_functions_operators_test_select_2182
SELECT * FROM unicode;
-- Tag: window_functions_window_functions_operators_test_select_2183
SELECT * FROM special;
-- Tag: window_functions_window_functions_operators_test_select_2184
SELECT * FROM spaces;
-- Tag: window_functions_window_functions_operators_test_select_2185
SELECT * FROM duplicates;
-- Tag: window_functions_window_functions_operators_test_select_2186
SELECT DISTINCT value FROM duplicates;
-- Tag: window_functions_window_functions_operators_test_select_2187
SELECT * FROM single;
-- Tag: window_functions_window_functions_operators_test_select_2188
SELECT COUNT(*) FROM single;
-- Tag: window_functions_window_functions_operators_test_select_2189
SELECT value, COUNT(*) FROM single GROUP BY value;
-- Tag: window_functions_window_functions_operators_test_select_2190
SELECT * FROM empty;
-- Tag: window_functions_window_functions_operators_test_select_2191
SELECT * FROM data WHERE value > 1000;
-- Tag: window_functions_window_functions_operators_test_select_2192
SELECT * FROM data WHERE value > 0;
-- Tag: window_functions_window_functions_operators_test_select_2193
SELECT * FROM floats;
-- Tag: window_functions_window_functions_operators_test_select_2194
SELECT * FROM floats;
-- Tag: window_functions_window_functions_operators_test_select_2195
SELECT * FROM wide;
-- Tag: window_functions_window_functions_operators_test_select_2196
SELECT * FROM (SELECT * FROM numbers WHERE value > 3) sub WHERE value < 12;
-- Tag: window_functions_window_functions_operators_test_select_2197
SELECT category, COUNT(*) FROM groups GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2198
SELECT DISTINCT value FROM distinct_vals;
-- Tag: window_functions_window_functions_operators_test_select_2199
SELECT * FROM data LIMIT 0;
-- Tag: window_functions_window_functions_operators_test_select_2200
SELECT * FROM data LIMIT 1;
-- Tag: window_functions_window_functions_operators_test_select_2201
SELECT * FROM data LIMIT 10 OFFSET 100;
-- Tag: window_functions_window_functions_operators_test_select_2202
SELECT * FROM data ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_2203
SELECT * FROM whitespace;

DROP TABLE IF EXISTS special;
CREATE TABLE special (id INT64, text STRING);
INSERT INTO special VALUES (1, 'Line1
Line2');
INSERT INTO special VALUES (2, 'Tab\there');
INSERT INTO special VALUES (3, 'Quote''s');
DROP TABLE IF EXISTS spaces;
CREATE TABLE spaces (id INT64, text STRING);
INSERT INTO spaces VALUES (1, ' leading');
INSERT INTO spaces VALUES (2, 'trailing ');
INSERT INTO spaces VALUES (3, ' both ');
DROP TABLE IF EXISTS duplicates;
CREATE TABLE duplicates (value INT64);
INSERT INTO duplicates VALUES (42);
DROP TABLE IF EXISTS single;
CREATE TABLE single (id INT64, value STRING);
INSERT INTO single VALUES (1, 'only');
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (20);
INSERT INTO data VALUES (30);
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (id INT64, value FLOAT64);
INSERT INTO floats VALUES (1, 0.0);
INSERT INTO floats VALUES (2, -0.0);
INSERT INTO floats VALUES (3, 1.7976931348623157E308);
DROP TABLE IF EXISTS floats;
CREATE TABLE floats (value FLOAT64);
INSERT INTO floats VALUES (2.2250738585072014E-308);
INSERT INTO floats VALUES (1e-300);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (5);
INSERT INTO numbers VALUES (10);
INSERT INTO numbers VALUES (15);
DROP TABLE IF EXISTS groups;
CREATE TABLE groups (category STRING, value INT64);
DROP TABLE IF EXISTS distinct_vals;
CREATE TABLE distinct_vals (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS whitespace;
CREATE TABLE whitespace (id INT64, text STRING);
INSERT INTO whitespace VALUES (1, '  ');
INSERT INTO whitespace VALUES (2, '\t\t');
INSERT INTO whitespace VALUES (3, '
');

-- Tag: window_functions_window_functions_operators_test_select_2204
SELECT * FROM special;
-- Tag: window_functions_window_functions_operators_test_select_2205
SELECT * FROM spaces;
-- Tag: window_functions_window_functions_operators_test_select_2206
SELECT * FROM duplicates;
-- Tag: window_functions_window_functions_operators_test_select_2207
SELECT DISTINCT value FROM duplicates;
-- Tag: window_functions_window_functions_operators_test_select_2208
SELECT * FROM single;
-- Tag: window_functions_window_functions_operators_test_select_2209
SELECT COUNT(*) FROM single;
-- Tag: window_functions_window_functions_operators_test_select_2210
SELECT value, COUNT(*) FROM single GROUP BY value;
-- Tag: window_functions_window_functions_operators_test_select_2211
SELECT * FROM empty;
-- Tag: window_functions_window_functions_operators_test_select_2212
SELECT * FROM data WHERE value > 1000;
-- Tag: window_functions_window_functions_operators_test_select_2213
SELECT * FROM data WHERE value > 0;
-- Tag: window_functions_window_functions_operators_test_select_2214
SELECT * FROM floats;
-- Tag: window_functions_window_functions_operators_test_select_2215
SELECT * FROM floats;
-- Tag: window_functions_window_functions_operators_test_select_2216
SELECT * FROM wide;
-- Tag: window_functions_window_functions_operators_test_select_2217
SELECT * FROM (SELECT * FROM numbers WHERE value > 3) sub WHERE value < 12;
-- Tag: window_functions_window_functions_operators_test_select_2218
SELECT category, COUNT(*) FROM groups GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2219
SELECT DISTINCT value FROM distinct_vals;
-- Tag: window_functions_window_functions_operators_test_select_2220
SELECT * FROM data LIMIT 0;
-- Tag: window_functions_window_functions_operators_test_select_2221
SELECT * FROM data LIMIT 1;
-- Tag: window_functions_window_functions_operators_test_select_2222
SELECT * FROM data LIMIT 10 OFFSET 100;
-- Tag: window_functions_window_functions_operators_test_select_2223
SELECT * FROM data ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_2224
SELECT * FROM whitespace;

DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS typed;
CREATE TABLE typed (id INT64, value INT64);
INSERT INTO typed VALUES (1, 'string');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, age INT64);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount INT64);
INSERT INTO sales VALUES ('Widget', 'North', 100);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64, value STRING);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (id INT64, value STRING);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);

-- Tag: window_functions_window_functions_operators_test_select_2225
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2226
SELECT value / 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2227
SELECT product, region, SUM(amount) FROM sales GROUP BY product;
-- Tag: window_functions_window_functions_operators_test_select_2228
SELECT amount FROM sales HAVING amount > 100;
-- Tag: window_functions_window_functions_operators_test_select_2229
SELECT NONEXISTENT_FUNCTION(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2230
SELECT COALESCE() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2231
SELECT id FROM table1 INNER JOIN table2 ON table1.id = table2.id;
-- Tag: window_functions_window_functions_operators_test_select_2232
SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.name;
-- Tag: window_functions_window_functions_operators_test_select_2233
SELECT value + 10 FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2234
SELECT *;
-- Tag: window_functions_window_functions_operators_test_select_2235
SELECT col1 FROM data ORDER BY col2;
-- Tag: window_functions_window_functions_operators_test_select_2236
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2237
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2238
SELECT * FROM (SELECT * FROM data);
-- Tag: window_functions_window_functions_operators_test_select_2239
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2240
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2241
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2242
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;

DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64, value STRING);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (id INT64, value STRING);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);

-- Tag: window_functions_window_functions_operators_test_select_2243
SELECT id FROM table1 INNER JOIN table2 ON table1.id = table2.id;
-- Tag: window_functions_window_functions_operators_test_select_2244
SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.name;
-- Tag: window_functions_window_functions_operators_test_select_2245
SELECT value + 10 FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2246
SELECT *;
-- Tag: window_functions_window_functions_operators_test_select_2247
SELECT col1 FROM data ORDER BY col2;
-- Tag: window_functions_window_functions_operators_test_select_2248
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2249
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2250
SELECT * FROM (SELECT * FROM data);
-- Tag: window_functions_window_functions_operators_test_select_2251
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2252
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2253
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2254
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;

DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);

-- Tag: window_functions_window_functions_operators_test_select_2255
SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.name;
-- Tag: window_functions_window_functions_operators_test_select_2256
SELECT value + 10 FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2257
SELECT *;
-- Tag: window_functions_window_functions_operators_test_select_2258
SELECT col1 FROM data ORDER BY col2;
-- Tag: window_functions_window_functions_operators_test_select_2259
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2260
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2261
SELECT * FROM (SELECT * FROM data);
-- Tag: window_functions_window_functions_operators_test_select_2262
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2263
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2264
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2265
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);

-- Tag: window_functions_window_functions_operators_test_select_2266
SELECT value + 10 FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2267
SELECT *;
-- Tag: window_functions_window_functions_operators_test_select_2268
SELECT col1 FROM data ORDER BY col2;
-- Tag: window_functions_window_functions_operators_test_select_2269
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2270
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2271
SELECT * FROM (SELECT * FROM data);
-- Tag: window_functions_window_functions_operators_test_select_2272
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2273
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2274
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2275
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;

DROP TABLE IF EXISTS data;
CREATE TABLE data (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);

-- Tag: window_functions_window_functions_operators_test_select_2276
SELECT col1 FROM data ORDER BY col2;
-- Tag: window_functions_window_functions_operators_test_select_2277
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2278
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2279
SELECT * FROM (SELECT * FROM data);
-- Tag: window_functions_window_functions_operators_test_select_2280
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2281
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2282
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2283
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);

-- Tag: window_functions_window_functions_operators_test_select_2284
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2285
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);

-- Tag: window_functions_window_functions_operators_test_select_2286
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING);
INSERT INTO data VALUES ('10', '20');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING);
INSERT INTO data VALUES ('Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 NOT NULL, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 42.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, a_value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, b_value INT64);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2287
SELECT id WHERE value > 10;
-- Tag: window_functions_window_functions_operators_test_select_2288
SELECT * FROM data WHERE;
-- Tag: window_functions_window_functions_operators_test_select_2289
SELECT (a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2290
SELECT a === b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2291
SELECT a,, b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2292
SELECT * FROM nonexistent_table;
-- Tag: window_functions_window_functions_operators_test_select_2293
SELECT id, age FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2294
SELECT id FROM a JOIN b ON a.id = b.id;
-- Tag: window_functions_window_functions_operators_test_select_2295
SELECT category, value, COUNT(*) FROM data GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2296
SELECT value FROM data HAVING value > 10;
-- Tag: window_functions_window_functions_operators_test_select_2297
SELECT a / b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2298
SELECT a % b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2299
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2300
SELECT a * b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2301
SELECT a - b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2302
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2303
SELECT * FROM data WHERE a = b;
-- Tag: window_functions_window_functions_operators_test_select_2304
SELECT SUM(name) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2305
SELECT AVG(text) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2306
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2307
SELECT COUNT(*) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2308
SELECT SUM(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2309
SELECT * FROM data WHERE id > 0;
-- Tag: window_functions_window_functions_operators_test_select_2310
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2311
SELECT MAX(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2312
SELECT t.id FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2313
SELECT a.id, a.b_value FROM a;
-- Tag: window_functions_window_functions_operators_test_select_2314
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2315
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2316
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2317
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2318
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2319
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2320
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2321
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING);
INSERT INTO data VALUES ('10', '20');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING);
INSERT INTO data VALUES ('Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 NOT NULL, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 42.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, a_value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, b_value INT64);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2322
SELECT * FROM data WHERE;
-- Tag: window_functions_window_functions_operators_test_select_2323
SELECT (a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2324
SELECT a === b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2325
SELECT a,, b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2326
SELECT * FROM nonexistent_table;
-- Tag: window_functions_window_functions_operators_test_select_2327
SELECT id, age FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2328
SELECT id FROM a JOIN b ON a.id = b.id;
-- Tag: window_functions_window_functions_operators_test_select_2329
SELECT category, value, COUNT(*) FROM data GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2330
SELECT value FROM data HAVING value > 10;
-- Tag: window_functions_window_functions_operators_test_select_2331
SELECT a / b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2332
SELECT a % b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2333
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2334
SELECT a * b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2335
SELECT a - b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2336
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2337
SELECT * FROM data WHERE a = b;
-- Tag: window_functions_window_functions_operators_test_select_2338
SELECT SUM(name) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2339
SELECT AVG(text) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2340
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2341
SELECT COUNT(*) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2342
SELECT SUM(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2343
SELECT * FROM data WHERE id > 0;
-- Tag: window_functions_window_functions_operators_test_select_2344
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2345
SELECT MAX(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2346
SELECT t.id FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2347
SELECT a.id, a.b_value FROM a;
-- Tag: window_functions_window_functions_operators_test_select_2348
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2349
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2350
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2351
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2352
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2353
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2354
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2355
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING);
INSERT INTO data VALUES ('10', '20');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING);
INSERT INTO data VALUES ('Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 NOT NULL, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 42.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, a_value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, b_value INT64);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2356
SELECT (a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2357
SELECT a === b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2358
SELECT a,, b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2359
SELECT * FROM nonexistent_table;
-- Tag: window_functions_window_functions_operators_test_select_2360
SELECT id, age FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2361
SELECT id FROM a JOIN b ON a.id = b.id;
-- Tag: window_functions_window_functions_operators_test_select_2362
SELECT category, value, COUNT(*) FROM data GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2363
SELECT value FROM data HAVING value > 10;
-- Tag: window_functions_window_functions_operators_test_select_2364
SELECT a / b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2365
SELECT a % b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2366
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2367
SELECT a * b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2368
SELECT a - b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2369
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2370
SELECT * FROM data WHERE a = b;
-- Tag: window_functions_window_functions_operators_test_select_2371
SELECT SUM(name) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2372
SELECT AVG(text) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2373
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2374
SELECT COUNT(*) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2375
SELECT SUM(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2376
SELECT * FROM data WHERE id > 0;
-- Tag: window_functions_window_functions_operators_test_select_2377
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2378
SELECT MAX(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2379
SELECT t.id FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2380
SELECT a.id, a.b_value FROM a;
-- Tag: window_functions_window_functions_operators_test_select_2381
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2382
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2383
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2384
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2385
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2386
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2387
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2388
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING);
INSERT INTO data VALUES ('10', '20');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING);
INSERT INTO data VALUES ('Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 NOT NULL, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 42.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, a_value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, b_value INT64);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2389
SELECT a === b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2390
SELECT a,, b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2391
SELECT * FROM nonexistent_table;
-- Tag: window_functions_window_functions_operators_test_select_2392
SELECT id, age FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2393
SELECT id FROM a JOIN b ON a.id = b.id;
-- Tag: window_functions_window_functions_operators_test_select_2394
SELECT category, value, COUNT(*) FROM data GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2395
SELECT value FROM data HAVING value > 10;
-- Tag: window_functions_window_functions_operators_test_select_2396
SELECT a / b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2397
SELECT a % b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2398
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2399
SELECT a * b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2400
SELECT a - b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2401
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2402
SELECT * FROM data WHERE a = b;
-- Tag: window_functions_window_functions_operators_test_select_2403
SELECT SUM(name) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2404
SELECT AVG(text) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2405
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2406
SELECT COUNT(*) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2407
SELECT SUM(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2408
SELECT * FROM data WHERE id > 0;
-- Tag: window_functions_window_functions_operators_test_select_2409
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2410
SELECT MAX(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2411
SELECT t.id FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2412
SELECT a.id, a.b_value FROM a;
-- Tag: window_functions_window_functions_operators_test_select_2413
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2414
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2415
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2416
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2417
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2418
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2419
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2420
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING);
INSERT INTO data VALUES ('10', '20');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING);
INSERT INTO data VALUES ('Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 NOT NULL, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 42.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, a_value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, b_value INT64);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2421
SELECT a,, b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2422
SELECT * FROM nonexistent_table;
-- Tag: window_functions_window_functions_operators_test_select_2423
SELECT id, age FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2424
SELECT id FROM a JOIN b ON a.id = b.id;
-- Tag: window_functions_window_functions_operators_test_select_2425
SELECT category, value, COUNT(*) FROM data GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2426
SELECT value FROM data HAVING value > 10;
-- Tag: window_functions_window_functions_operators_test_select_2427
SELECT a / b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2428
SELECT a % b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2429
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2430
SELECT a * b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2431
SELECT a - b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2432
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2433
SELECT * FROM data WHERE a = b;
-- Tag: window_functions_window_functions_operators_test_select_2434
SELECT SUM(name) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2435
SELECT AVG(text) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2436
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2437
SELECT COUNT(*) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2438
SELECT SUM(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2439
SELECT * FROM data WHERE id > 0;
-- Tag: window_functions_window_functions_operators_test_select_2440
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2441
SELECT MAX(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2442
SELECT t.id FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2443
SELECT a.id, a.b_value FROM a;
-- Tag: window_functions_window_functions_operators_test_select_2444
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2445
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2446
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2447
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2448
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2449
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2450
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2451
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING);
INSERT INTO data VALUES ('10', '20');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING);
INSERT INTO data VALUES ('Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 NOT NULL, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 42.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, a_value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, b_value INT64);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2452
SELECT id, age FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2453
SELECT id FROM a JOIN b ON a.id = b.id;
-- Tag: window_functions_window_functions_operators_test_select_2454
SELECT category, value, COUNT(*) FROM data GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2455
SELECT value FROM data HAVING value > 10;
-- Tag: window_functions_window_functions_operators_test_select_2456
SELECT a / b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2457
SELECT a % b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2458
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2459
SELECT a * b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2460
SELECT a - b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2461
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2462
SELECT * FROM data WHERE a = b;
-- Tag: window_functions_window_functions_operators_test_select_2463
SELECT SUM(name) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2464
SELECT AVG(text) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2465
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2466
SELECT COUNT(*) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2467
SELECT SUM(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2468
SELECT * FROM data WHERE id > 0;
-- Tag: window_functions_window_functions_operators_test_select_2469
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2470
SELECT MAX(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2471
SELECT t.id FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2472
SELECT a.id, a.b_value FROM a;
-- Tag: window_functions_window_functions_operators_test_select_2473
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2474
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2475
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2476
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2477
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2478
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2479
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2480
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING);
INSERT INTO data VALUES ('10', '20');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING);
INSERT INTO data VALUES ('Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 NOT NULL, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 42.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, a_value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, b_value INT64);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2481
SELECT category, value, COUNT(*) FROM data GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2482
SELECT value FROM data HAVING value > 10;
-- Tag: window_functions_window_functions_operators_test_select_2483
SELECT a / b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2484
SELECT a % b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2485
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2486
SELECT a * b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2487
SELECT a - b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2488
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2489
SELECT * FROM data WHERE a = b;
-- Tag: window_functions_window_functions_operators_test_select_2490
SELECT SUM(name) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2491
SELECT AVG(text) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2492
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2493
SELECT COUNT(*) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2494
SELECT SUM(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2495
SELECT * FROM data WHERE id > 0;
-- Tag: window_functions_window_functions_operators_test_select_2496
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2497
SELECT MAX(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2498
SELECT t.id FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2499
SELECT a.id, a.b_value FROM a;
-- Tag: window_functions_window_functions_operators_test_select_2500
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2501
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2502
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2503
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2504
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2505
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2506
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2507
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING);
INSERT INTO data VALUES ('10', '20');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING);
INSERT INTO data VALUES ('Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 NOT NULL, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 42.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, a_value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, b_value INT64);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2508
SELECT value FROM data HAVING value > 10;
-- Tag: window_functions_window_functions_operators_test_select_2509
SELECT a / b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2510
SELECT a % b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2511
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2512
SELECT a * b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2513
SELECT a - b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2514
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2515
SELECT * FROM data WHERE a = b;
-- Tag: window_functions_window_functions_operators_test_select_2516
SELECT SUM(name) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2517
SELECT AVG(text) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2518
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2519
SELECT COUNT(*) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2520
SELECT SUM(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2521
SELECT * FROM data WHERE id > 0;
-- Tag: window_functions_window_functions_operators_test_select_2522
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2523
SELECT MAX(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2524
SELECT t.id FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2525
SELECT a.id, a.b_value FROM a;
-- Tag: window_functions_window_functions_operators_test_select_2526
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2527
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2528
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2529
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2530
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2531
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2532
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2533
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING);
INSERT INTO data VALUES ('10', '20');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING);
INSERT INTO data VALUES ('Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 NOT NULL, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 42.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, a_value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, b_value INT64);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2534
SELECT a / b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2535
SELECT a % b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2536
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2537
SELECT a * b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2538
SELECT a - b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2539
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2540
SELECT * FROM data WHERE a = b;
-- Tag: window_functions_window_functions_operators_test_select_2541
SELECT SUM(name) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2542
SELECT AVG(text) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2543
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2544
SELECT COUNT(*) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2545
SELECT SUM(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2546
SELECT * FROM data WHERE id > 0;
-- Tag: window_functions_window_functions_operators_test_select_2547
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2548
SELECT MAX(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2549
SELECT t.id FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2550
SELECT a.id, a.b_value FROM a;
-- Tag: window_functions_window_functions_operators_test_select_2551
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2552
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2553
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2554
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2555
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2556
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2557
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2558
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (10, 0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING);
INSERT INTO data VALUES ('10', '20');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING);
INSERT INTO data VALUES ('Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 NOT NULL, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 42.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, a_value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, b_value INT64);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2559
SELECT a % b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2560
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2561
SELECT a * b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2562
SELECT a - b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2563
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2564
SELECT * FROM data WHERE a = b;
-- Tag: window_functions_window_functions_operators_test_select_2565
SELECT SUM(name) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2566
SELECT AVG(text) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2567
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2568
SELECT COUNT(*) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2569
SELECT SUM(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2570
SELECT * FROM data WHERE id > 0;
-- Tag: window_functions_window_functions_operators_test_select_2571
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2572
SELECT MAX(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2573
SELECT t.id FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2574
SELECT a.id, a.b_value FROM a;
-- Tag: window_functions_window_functions_operators_test_select_2575
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2576
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2577
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2578
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2579
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2580
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2581
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2582
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (a STRING, b STRING);
INSERT INTO data VALUES ('10', '20');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (name STRING);
INSERT INTO data VALUES ('Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 NOT NULL, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 42.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, a_value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, b_value INT64);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2583
SELECT a + b FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2584
SELECT * FROM data WHERE a = b;
-- Tag: window_functions_window_functions_operators_test_select_2585
SELECT SUM(name) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2586
SELECT AVG(text) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2587
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2588
SELECT COUNT(*) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2589
SELECT SUM(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2590
SELECT * FROM data WHERE id > 0;
-- Tag: window_functions_window_functions_operators_test_select_2591
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2592
SELECT MAX(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2593
SELECT t.id FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2594
SELECT a.id, a.b_value FROM a;
-- Tag: window_functions_window_functions_operators_test_select_2595
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2596
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2597
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2598
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2599
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2600
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2601
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2602
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 NOT NULL, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY, name STRING);
INSERT INTO data VALUES (NULL, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 42.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, a_value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, b_value INT64);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2603
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2604
SELECT COUNT(*) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2605
SELECT SUM(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2606
SELECT * FROM data WHERE id > 0;
-- Tag: window_functions_window_functions_operators_test_select_2607
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2608
SELECT MAX(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2609
SELECT t.id FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2610
SELECT a.id, a.b_value FROM a;
-- Tag: window_functions_window_functions_operators_test_select_2611
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2612
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2613
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2614
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2615
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2616
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2617
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2618
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, 42.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, a_value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, b_value INT64);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2619
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2620
SELECT COUNT(*) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2621
SELECT SUM(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2622
SELECT * FROM data WHERE id > 0;
-- Tag: window_functions_window_functions_operators_test_select_2623
SELECT * FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2624
SELECT MAX(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2625
SELECT t.id FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2626
SELECT a.id, a.b_value FROM a;
-- Tag: window_functions_window_functions_operators_test_select_2627
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2628
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2629
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2630
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2631
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2632
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2633
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2634
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, value INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, amount INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING, value FLOAT64);
INSERT INTO data VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES ('not a number', 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INVALID_TYPE);
ALTER TABLE nonexistent ADD COLUMN new_col INT64;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2635
SELECT (SELECT amount FROM inner_table WHERE id = outer_table.id) FROM outer_table;
UPDATE data SET age = 25;
DELETE FROM data WHERE nonexistent > 10;
-- Tag: window_functions_window_functions_operators_test_select_2636
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2637
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2638
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2639
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2640
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2641
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2642
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2643
SELECT SUM(COUNT(value)) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2644
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2645
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2646
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2647
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2648
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2649
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2650
SELECT category FROM data WHERE SUM(value) > 100 GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_2651
SELECT ROW_NUMBER() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2652
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2653
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2654
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2655
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64);
INSERT INTO data VALUES (1, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (big_float FLOAT64);
INSERT INTO data VALUES (1e100);

-- Tag: window_functions_window_functions_operators_test_select_2656
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY id) = 1;
-- Tag: window_functions_window_functions_operators_test_select_2657
SELECT (SELECT value FROM data) as single_value;
-- Tag: window_functions_window_functions_operators_test_select_2658
SELECT (SELECT a, b FROM data) as multi_col;
-- Tag: window_functions_window_functions_operators_test_select_2659
SELECT CAST(big_float AS INT64) FROM data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (a INT64, b INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64, value STRING);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (id INT64, value STRING);
DROP TABLE IF EXISTS typed;
CREATE TABLE typed (id INT64, value INT64);
INSERT INTO typed VALUES (1, 'string');
DROP TABLE IF EXISTS data;
CREATE TABLE data (int_val INT64, str_val STRING);
INSERT INTO data VALUES (42, 'test');
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (name STRING);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, age INT64);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (user_id INT64, username STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2660
SELECT * FROM;
-- Tag: window_functions_window_functions_operators_test_select_2661
SELECT * FROM (SELECT * FROM test;
SELCT * FROM test;
-- Tag: window_functions_window_functions_operators_test_select_2662
SELECT a b FROM test;
-- Tag: window_functions_window_functions_operators_test_select_2663
SELECT * FROM nonexistent_table;
-- Tag: window_functions_window_functions_operators_test_select_2664
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2665
SELECT id FROM table1 INNER JOIN table2 ON table1.id = table2.id;
-- Tag: window_functions_window_functions_operators_test_select_2666
SELECT * FROM data WHERE int_val = str_val;
-- Tag: window_functions_window_functions_operators_test_select_2667
SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.name;
-- Tag: window_functions_window_functions_operators_test_select_2668
SELECT value / 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2669
SELECT value % 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2670
SELECT NONEXISTENT_FUNCTION(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2671
SELECT COALESCE() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2672
SELECT ABS(str_val) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2673
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2674
SELECT product, region, SUM(amount) FROM sales GROUP BY product;
-- Tag: window_functions_window_functions_operators_test_select_2675
SELECT amount FROM sales HAVING amount > 100;
-- Tag: window_functions_window_functions_operators_test_select_2676
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2677
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2678
SELECT * FROM (SELECT * FROM data);
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;
-- Tag: window_functions_window_functions_operators_test_select_2679
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2680
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2681
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
-- Tag: window_functions_window_functions_operators_test_select_025
SELECT
id,
nonexistent_column,
name
FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2682
SELECT userid FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2683
SELECT * FROM user;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (a INT64, b INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64, value STRING);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (id INT64, value STRING);
DROP TABLE IF EXISTS typed;
CREATE TABLE typed (id INT64, value INT64);
INSERT INTO typed VALUES (1, 'string');
DROP TABLE IF EXISTS data;
CREATE TABLE data (int_val INT64, str_val STRING);
INSERT INTO data VALUES (42, 'test');
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (name STRING);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, age INT64);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (user_id INT64, username STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2684
SELECT * FROM (SELECT * FROM test;
SELCT * FROM test;
-- Tag: window_functions_window_functions_operators_test_select_2685
SELECT a b FROM test;
-- Tag: window_functions_window_functions_operators_test_select_2686
SELECT * FROM nonexistent_table;
-- Tag: window_functions_window_functions_operators_test_select_2687
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2688
SELECT id FROM table1 INNER JOIN table2 ON table1.id = table2.id;
-- Tag: window_functions_window_functions_operators_test_select_2689
SELECT * FROM data WHERE int_val = str_val;
-- Tag: window_functions_window_functions_operators_test_select_2690
SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.name;
-- Tag: window_functions_window_functions_operators_test_select_2691
SELECT value / 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2692
SELECT value % 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2693
SELECT NONEXISTENT_FUNCTION(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2694
SELECT COALESCE() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2695
SELECT ABS(str_val) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2696
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2697
SELECT product, region, SUM(amount) FROM sales GROUP BY product;
-- Tag: window_functions_window_functions_operators_test_select_2698
SELECT amount FROM sales HAVING amount > 100;
-- Tag: window_functions_window_functions_operators_test_select_2699
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2700
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2701
SELECT * FROM (SELECT * FROM data);
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;
-- Tag: window_functions_window_functions_operators_test_select_2702
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2703
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2704
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
-- Tag: window_functions_window_functions_operators_test_select_026
SELECT
id,
nonexistent_column,
name
FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2705
SELECT userid FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2706
SELECT * FROM user;

DROP TABLE IF EXISTS test;
CREATE TABLE test (a INT64, b INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64, value STRING);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (id INT64, value STRING);
DROP TABLE IF EXISTS typed;
CREATE TABLE typed (id INT64, value INT64);
INSERT INTO typed VALUES (1, 'string');
DROP TABLE IF EXISTS data;
CREATE TABLE data (int_val INT64, str_val STRING);
INSERT INTO data VALUES (42, 'test');
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (name STRING);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, age INT64);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (user_id INT64, username STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);

SELCT * FROM test;
-- Tag: window_functions_window_functions_operators_test_select_2707
SELECT a b FROM test;
-- Tag: window_functions_window_functions_operators_test_select_2708
SELECT * FROM nonexistent_table;
-- Tag: window_functions_window_functions_operators_test_select_2709
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2710
SELECT id FROM table1 INNER JOIN table2 ON table1.id = table2.id;
-- Tag: window_functions_window_functions_operators_test_select_2711
SELECT * FROM data WHERE int_val = str_val;
-- Tag: window_functions_window_functions_operators_test_select_2712
SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.name;
-- Tag: window_functions_window_functions_operators_test_select_2713
SELECT value / 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2714
SELECT value % 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2715
SELECT NONEXISTENT_FUNCTION(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2716
SELECT COALESCE() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2717
SELECT ABS(str_val) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2718
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2719
SELECT product, region, SUM(amount) FROM sales GROUP BY product;
-- Tag: window_functions_window_functions_operators_test_select_2720
SELECT amount FROM sales HAVING amount > 100;
-- Tag: window_functions_window_functions_operators_test_select_2721
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2722
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2723
SELECT * FROM (SELECT * FROM data);
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;
-- Tag: window_functions_window_functions_operators_test_select_2724
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2725
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2726
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
-- Tag: window_functions_window_functions_operators_test_select_027
SELECT
id,
nonexistent_column,
name
FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2727
SELECT userid FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2728
SELECT * FROM user;

DROP TABLE IF EXISTS test;
CREATE TABLE test (a INT64, b INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64, value STRING);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (id INT64, value STRING);
DROP TABLE IF EXISTS typed;
CREATE TABLE typed (id INT64, value INT64);
INSERT INTO typed VALUES (1, 'string');
DROP TABLE IF EXISTS data;
CREATE TABLE data (int_val INT64, str_val STRING);
INSERT INTO data VALUES (42, 'test');
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (name STRING);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, age INT64);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (user_id INT64, username STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2729
SELECT a b FROM test;
-- Tag: window_functions_window_functions_operators_test_select_2730
SELECT * FROM nonexistent_table;
-- Tag: window_functions_window_functions_operators_test_select_2731
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2732
SELECT id FROM table1 INNER JOIN table2 ON table1.id = table2.id;
-- Tag: window_functions_window_functions_operators_test_select_2733
SELECT * FROM data WHERE int_val = str_val;
-- Tag: window_functions_window_functions_operators_test_select_2734
SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.name;
-- Tag: window_functions_window_functions_operators_test_select_2735
SELECT value / 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2736
SELECT value % 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2737
SELECT NONEXISTENT_FUNCTION(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2738
SELECT COALESCE() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2739
SELECT ABS(str_val) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2740
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2741
SELECT product, region, SUM(amount) FROM sales GROUP BY product;
-- Tag: window_functions_window_functions_operators_test_select_2742
SELECT amount FROM sales HAVING amount > 100;
-- Tag: window_functions_window_functions_operators_test_select_2743
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2744
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2745
SELECT * FROM (SELECT * FROM data);
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;
-- Tag: window_functions_window_functions_operators_test_select_2746
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2747
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2748
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
-- Tag: window_functions_window_functions_operators_test_select_028
SELECT
id,
nonexistent_column,
name
FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2749
SELECT userid FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2750
SELECT * FROM user;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64, value STRING);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (id INT64, value STRING);
DROP TABLE IF EXISTS typed;
CREATE TABLE typed (id INT64, value INT64);
INSERT INTO typed VALUES (1, 'string');
DROP TABLE IF EXISTS data;
CREATE TABLE data (int_val INT64, str_val STRING);
INSERT INTO data VALUES (42, 'test');
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (name STRING);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, age INT64);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (user_id INT64, username STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2751
SELECT * FROM nonexistent_table;
-- Tag: window_functions_window_functions_operators_test_select_2752
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2753
SELECT id FROM table1 INNER JOIN table2 ON table1.id = table2.id;
-- Tag: window_functions_window_functions_operators_test_select_2754
SELECT * FROM data WHERE int_val = str_val;
-- Tag: window_functions_window_functions_operators_test_select_2755
SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.name;
-- Tag: window_functions_window_functions_operators_test_select_2756
SELECT value / 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2757
SELECT value % 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2758
SELECT NONEXISTENT_FUNCTION(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2759
SELECT COALESCE() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2760
SELECT ABS(str_val) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2761
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2762
SELECT product, region, SUM(amount) FROM sales GROUP BY product;
-- Tag: window_functions_window_functions_operators_test_select_2763
SELECT amount FROM sales HAVING amount > 100;
-- Tag: window_functions_window_functions_operators_test_select_2764
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2765
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2766
SELECT * FROM (SELECT * FROM data);
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;
-- Tag: window_functions_window_functions_operators_test_select_2767
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2768
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2769
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
-- Tag: window_functions_window_functions_operators_test_select_029
SELECT
id,
nonexistent_column,
name
FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2770
SELECT userid FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2771
SELECT * FROM user;

DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64, value STRING);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (id INT64, value STRING);
DROP TABLE IF EXISTS typed;
CREATE TABLE typed (id INT64, value INT64);
INSERT INTO typed VALUES (1, 'string');
DROP TABLE IF EXISTS data;
CREATE TABLE data (int_val INT64, str_val STRING);
INSERT INTO data VALUES (42, 'test');
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (name STRING);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, age INT64);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (user_id INT64, username STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2772
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2773
SELECT id FROM table1 INNER JOIN table2 ON table1.id = table2.id;
-- Tag: window_functions_window_functions_operators_test_select_2774
SELECT * FROM data WHERE int_val = str_val;
-- Tag: window_functions_window_functions_operators_test_select_2775
SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.name;
-- Tag: window_functions_window_functions_operators_test_select_2776
SELECT value / 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2777
SELECT value % 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2778
SELECT NONEXISTENT_FUNCTION(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2779
SELECT COALESCE() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2780
SELECT ABS(str_val) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2781
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2782
SELECT product, region, SUM(amount) FROM sales GROUP BY product;
-- Tag: window_functions_window_functions_operators_test_select_2783
SELECT amount FROM sales HAVING amount > 100;
-- Tag: window_functions_window_functions_operators_test_select_2784
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2785
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2786
SELECT * FROM (SELECT * FROM data);
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;
-- Tag: window_functions_window_functions_operators_test_select_2787
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2788
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2789
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
-- Tag: window_functions_window_functions_operators_test_select_030
SELECT
id,
nonexistent_column,
name
FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2790
SELECT userid FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2791
SELECT * FROM user;

DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (id INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (name STRING);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64);
INSERT INTO numbers VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (str_val STRING);
INSERT INTO data VALUES ('test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, age INT64);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (user_id INT64, username STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2792
SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.name;
-- Tag: window_functions_window_functions_operators_test_select_2793
SELECT value / 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2794
SELECT value % 0 FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_2795
SELECT NONEXISTENT_FUNCTION(value) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2796
SELECT COALESCE() FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2797
SELECT ABS(str_val) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_2798
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2799
SELECT product, region, SUM(amount) FROM sales GROUP BY product;
-- Tag: window_functions_window_functions_operators_test_select_2800
SELECT amount FROM sales HAVING amount > 100;
-- Tag: window_functions_window_functions_operators_test_select_2801
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2802
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2803
SELECT * FROM (SELECT * FROM data);
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;
-- Tag: window_functions_window_functions_operators_test_select_2804
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2805
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2806
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
-- Tag: window_functions_window_functions_operators_test_select_031
SELECT
id,
nonexistent_column,
name
FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2807
SELECT userid FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2808
SELECT * FROM user;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, age INT64);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (user_id INT64, username STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2809
SELECT * FROM data WHERE SUM(value) > 100;
-- Tag: window_functions_window_functions_operators_test_select_2810
SELECT product, region, SUM(amount) FROM sales GROUP BY product;
-- Tag: window_functions_window_functions_operators_test_select_2811
SELECT amount FROM sales HAVING amount > 100;
-- Tag: window_functions_window_functions_operators_test_select_2812
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2813
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2814
SELECT * FROM (SELECT * FROM data);
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;
-- Tag: window_functions_window_functions_operators_test_select_2815
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2816
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2817
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
-- Tag: window_functions_window_functions_operators_test_select_032
SELECT
id,
nonexistent_column,
name
FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2818
SELECT userid FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2819
SELECT * FROM user;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (col1 INT64);
DROP TABLE IF EXISTS table1;
CREATE TABLE table1 (value INT64);
DROP TABLE IF EXISTS table2;
CREATE TABLE table2 (value STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS invalid;
CREATE TABLE invalid (id INT64, id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, age INT64);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (user_id INT64, username STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2820
SELECT product, region, SUM(amount) FROM sales GROUP BY product;
-- Tag: window_functions_window_functions_operators_test_select_2821
SELECT amount FROM sales HAVING amount > 100;
-- Tag: window_functions_window_functions_operators_test_select_2822
SELECT * FROM table1 UNION SELECT * FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2823
SELECT value FROM table1 UNION SELECT value FROM table2;
-- Tag: window_functions_window_functions_operators_test_select_2824
SELECT * FROM (SELECT * FROM data);
WITH cte AS (SELECT * FROM data) SELECT * FROM nonexistent_cte;
-- Tag: window_functions_window_functions_operators_test_select_2825
SELECT * FROM data LIMIT -1;
-- Tag: window_functions_window_functions_operators_test_select_2826
SELECT * FROM data OFFSET -1;
-- Tag: window_functions_window_functions_operators_test_select_2827
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
-- Tag: window_functions_window_functions_operators_test_select_033
SELECT
id,
nonexistent_column,
name
FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2828
SELECT userid FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2829
SELECT * FROM user;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (user_id INT64, username STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2830
SELECT * FROM data WHERE ROW_NUMBER() OVER (ORDER BY value) = 1;
-- Tag: window_functions_window_functions_operators_test_select_034
SELECT
id,
nonexistent_column,
name
FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2831
SELECT userid FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2832
SELECT * FROM user;

DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (123);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val STRING);
INSERT INTO t VALUES ('not_a_number');
DROP TABLE IF EXISTS t;
CREATE TABLE t (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val STRING);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val STRING);
INSERT INTO t1 VALUES (1, 'a');
INSERT INTO t2 VALUES (1, 'b');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val FLOAT64);
INSERT INTO t VALUES (-1.0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES ('not_an_int', 'Alice');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (1), (2), (3);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id STRING);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES ('1');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (column_name INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2833
SELECT * FORM table;
-- Tag: window_functions_window_functions_operators_test_select_2834
SELECT column_name;
-- Tag: window_functions_window_functions_operators_test_select_2835
SELECT val + 'string' FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2836
SELECT CAST(val AS INT64) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2837
SELECT * FROM nonexistent_table;
-- Tag: window_functions_window_functions_operators_test_select_2838
SELECT nonexistent_column FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2839
SELECT id FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2840
SELECT NONEXISTENT_FUNCTION(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2841
SELECT ABS(val, val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2842
SELECT val / 0 FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2843
SELECT SQRT(val) FROM t;
UPDATE nonexistent SET col = 1;
-- Tag: window_functions_window_functions_operators_test_select_2844
SELECT id, SUM(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2845
SELECT val FROM t HAVING val > 10;
-- Tag: window_functions_window_functions_operators_test_select_2846
SELECT (SELECT val FROM t) as result;
-- Tag: window_functions_window_functions_operators_test_select_2847
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2848
SELECT ROW_NUMBER() FROM t;
WITH cte AS (SELECT * FROM cte)
-- Tag: window_functions_window_functions_operators_test_select_2849
SELECT * FROM cte;
-- Tag: window_functions_window_functions_operators_test_select_2850
SELECT val as v FROM t ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_2851
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2852
SELECT colum_name FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2853
SELECT * FROM t LIMIT 999999999999999;
-- Tag: window_functions_window_functions_operators_test_select_2854
SELECT * FROM t LIMIT -1;

DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (123);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val STRING);
INSERT INTO t VALUES ('not_a_number');
DROP TABLE IF EXISTS t;
CREATE TABLE t (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val STRING);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val STRING);
INSERT INTO t1 VALUES (1, 'a');
INSERT INTO t2 VALUES (1, 'b');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val FLOAT64);
INSERT INTO t VALUES (-1.0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES ('not_an_int', 'Alice');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (1), (2), (3);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id STRING);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES ('1');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (column_name INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2855
SELECT column_name;
-- Tag: window_functions_window_functions_operators_test_select_2856
SELECT val + 'string' FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2857
SELECT CAST(val AS INT64) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2858
SELECT * FROM nonexistent_table;
-- Tag: window_functions_window_functions_operators_test_select_2859
SELECT nonexistent_column FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2860
SELECT id FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2861
SELECT NONEXISTENT_FUNCTION(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2862
SELECT ABS(val, val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2863
SELECT val / 0 FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2864
SELECT SQRT(val) FROM t;
UPDATE nonexistent SET col = 1;
-- Tag: window_functions_window_functions_operators_test_select_2865
SELECT id, SUM(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2866
SELECT val FROM t HAVING val > 10;
-- Tag: window_functions_window_functions_operators_test_select_2867
SELECT (SELECT val FROM t) as result;
-- Tag: window_functions_window_functions_operators_test_select_2868
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2869
SELECT ROW_NUMBER() FROM t;
WITH cte AS (SELECT * FROM cte)
-- Tag: window_functions_window_functions_operators_test_select_2870
SELECT * FROM cte;
-- Tag: window_functions_window_functions_operators_test_select_2871
SELECT val as v FROM t ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_2872
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2873
SELECT colum_name FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2874
SELECT * FROM t LIMIT 999999999999999;
-- Tag: window_functions_window_functions_operators_test_select_2875
SELECT * FROM t LIMIT -1;

DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (123);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val STRING);
INSERT INTO t VALUES ('not_a_number');
DROP TABLE IF EXISTS t;
CREATE TABLE t (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val STRING);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val STRING);
INSERT INTO t1 VALUES (1, 'a');
INSERT INTO t2 VALUES (1, 'b');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val FLOAT64);
INSERT INTO t VALUES (-1.0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES ('not_an_int', 'Alice');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (1), (2), (3);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id STRING);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES ('1');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (column_name INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2876
SELECT val + 'string' FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2877
SELECT CAST(val AS INT64) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2878
SELECT * FROM nonexistent_table;
-- Tag: window_functions_window_functions_operators_test_select_2879
SELECT nonexistent_column FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2880
SELECT id FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2881
SELECT NONEXISTENT_FUNCTION(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2882
SELECT ABS(val, val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2883
SELECT val / 0 FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2884
SELECT SQRT(val) FROM t;
UPDATE nonexistent SET col = 1;
-- Tag: window_functions_window_functions_operators_test_select_2885
SELECT id, SUM(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2886
SELECT val FROM t HAVING val > 10;
-- Tag: window_functions_window_functions_operators_test_select_2887
SELECT (SELECT val FROM t) as result;
-- Tag: window_functions_window_functions_operators_test_select_2888
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2889
SELECT ROW_NUMBER() FROM t;
WITH cte AS (SELECT * FROM cte)
-- Tag: window_functions_window_functions_operators_test_select_2890
SELECT * FROM cte;
-- Tag: window_functions_window_functions_operators_test_select_2891
SELECT val as v FROM t ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_2892
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2893
SELECT colum_name FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2894
SELECT * FROM t LIMIT 999999999999999;
-- Tag: window_functions_window_functions_operators_test_select_2895
SELECT * FROM t LIMIT -1;

DROP TABLE IF EXISTS t;
CREATE TABLE t (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val STRING);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val STRING);
INSERT INTO t1 VALUES (1, 'a');
INSERT INTO t2 VALUES (1, 'b');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val FLOAT64);
INSERT INTO t VALUES (-1.0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES ('not_an_int', 'Alice');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (1), (2), (3);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id STRING);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES ('1');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (column_name INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2896
SELECT nonexistent_column FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2897
SELECT id FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2898
SELECT NONEXISTENT_FUNCTION(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2899
SELECT ABS(val, val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2900
SELECT val / 0 FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2901
SELECT SQRT(val) FROM t;
UPDATE nonexistent SET col = 1;
-- Tag: window_functions_window_functions_operators_test_select_2902
SELECT id, SUM(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2903
SELECT val FROM t HAVING val > 10;
-- Tag: window_functions_window_functions_operators_test_select_2904
SELECT (SELECT val FROM t) as result;
-- Tag: window_functions_window_functions_operators_test_select_2905
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2906
SELECT ROW_NUMBER() FROM t;
WITH cte AS (SELECT * FROM cte)
-- Tag: window_functions_window_functions_operators_test_select_2907
SELECT * FROM cte;
-- Tag: window_functions_window_functions_operators_test_select_2908
SELECT val as v FROM t ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_2909
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2910
SELECT colum_name FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2911
SELECT * FROM t LIMIT 999999999999999;
-- Tag: window_functions_window_functions_operators_test_select_2912
SELECT * FROM t LIMIT -1;

DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val STRING);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val STRING);
INSERT INTO t1 VALUES (1, 'a');
INSERT INTO t2 VALUES (1, 'b');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val FLOAT64);
INSERT INTO t VALUES (-1.0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES ('not_an_int', 'Alice');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (1), (2), (3);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id STRING);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES ('1');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (column_name INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2913
SELECT id FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2914
SELECT NONEXISTENT_FUNCTION(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2915
SELECT ABS(val, val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2916
SELECT val / 0 FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2917
SELECT SQRT(val) FROM t;
UPDATE nonexistent SET col = 1;
-- Tag: window_functions_window_functions_operators_test_select_2918
SELECT id, SUM(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2919
SELECT val FROM t HAVING val > 10;
-- Tag: window_functions_window_functions_operators_test_select_2920
SELECT (SELECT val FROM t) as result;
-- Tag: window_functions_window_functions_operators_test_select_2921
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2922
SELECT ROW_NUMBER() FROM t;
WITH cte AS (SELECT * FROM cte)
-- Tag: window_functions_window_functions_operators_test_select_2923
SELECT * FROM cte;
-- Tag: window_functions_window_functions_operators_test_select_2924
SELECT val as v FROM t ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_2925
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2926
SELECT colum_name FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2927
SELECT * FROM t LIMIT 999999999999999;
-- Tag: window_functions_window_functions_operators_test_select_2928
SELECT * FROM t LIMIT -1;

DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val FLOAT64);
INSERT INTO t VALUES (-1.0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES ('not_an_int', 'Alice');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (1), (2), (3);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id STRING);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES ('1');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (column_name INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2929
SELECT NONEXISTENT_FUNCTION(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2930
SELECT ABS(val, val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2931
SELECT val / 0 FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2932
SELECT SQRT(val) FROM t;
UPDATE nonexistent SET col = 1;
-- Tag: window_functions_window_functions_operators_test_select_2933
SELECT id, SUM(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2934
SELECT val FROM t HAVING val > 10;
-- Tag: window_functions_window_functions_operators_test_select_2935
SELECT (SELECT val FROM t) as result;
-- Tag: window_functions_window_functions_operators_test_select_2936
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2937
SELECT ROW_NUMBER() FROM t;
WITH cte AS (SELECT * FROM cte)
-- Tag: window_functions_window_functions_operators_test_select_2938
SELECT * FROM cte;
-- Tag: window_functions_window_functions_operators_test_select_2939
SELECT val as v FROM t ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_2940
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2941
SELECT colum_name FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2942
SELECT * FROM t LIMIT 999999999999999;
-- Tag: window_functions_window_functions_operators_test_select_2943
SELECT * FROM t LIMIT -1;

DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val FLOAT64);
INSERT INTO t VALUES (-1.0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES ('not_an_int', 'Alice');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (1), (2), (3);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id STRING);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES ('1');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (column_name INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2944
SELECT val / 0 FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2945
SELECT SQRT(val) FROM t;
UPDATE nonexistent SET col = 1;
-- Tag: window_functions_window_functions_operators_test_select_2946
SELECT id, SUM(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2947
SELECT val FROM t HAVING val > 10;
-- Tag: window_functions_window_functions_operators_test_select_2948
SELECT (SELECT val FROM t) as result;
-- Tag: window_functions_window_functions_operators_test_select_2949
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2950
SELECT ROW_NUMBER() FROM t;
WITH cte AS (SELECT * FROM cte)
-- Tag: window_functions_window_functions_operators_test_select_2951
SELECT * FROM cte;
-- Tag: window_functions_window_functions_operators_test_select_2952
SELECT val as v FROM t ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_2953
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2954
SELECT colum_name FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2955
SELECT * FROM t LIMIT 999999999999999;
-- Tag: window_functions_window_functions_operators_test_select_2956
SELECT * FROM t LIMIT -1;

DROP TABLE IF EXISTS t;
CREATE TABLE t (val FLOAT64);
INSERT INTO t VALUES (-1.0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
DROP TABLE nonexistent;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES ('not_an_int', 'Alice');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (1), (2), (3);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id STRING);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES ('1');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (column_name INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2957
SELECT SQRT(val) FROM t;
UPDATE nonexistent SET col = 1;
-- Tag: window_functions_window_functions_operators_test_select_2958
SELECT id, SUM(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2959
SELECT val FROM t HAVING val > 10;
-- Tag: window_functions_window_functions_operators_test_select_2960
SELECT (SELECT val FROM t) as result;
-- Tag: window_functions_window_functions_operators_test_select_2961
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2962
SELECT ROW_NUMBER() FROM t;
WITH cte AS (SELECT * FROM cte)
-- Tag: window_functions_window_functions_operators_test_select_2963
SELECT * FROM cte;
-- Tag: window_functions_window_functions_operators_test_select_2964
SELECT val as v FROM t ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_2965
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2966
SELECT colum_name FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2967
SELECT * FROM t LIMIT 999999999999999;
-- Tag: window_functions_window_functions_operators_test_select_2968
SELECT * FROM t LIMIT -1;

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (1), (2), (3);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id STRING);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES ('1');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (column_name INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2969
SELECT id, SUM(val) FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2970
SELECT val FROM t HAVING val > 10;
-- Tag: window_functions_window_functions_operators_test_select_2971
SELECT (SELECT val FROM t) as result;
-- Tag: window_functions_window_functions_operators_test_select_2972
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2973
SELECT ROW_NUMBER() FROM t;
WITH cte AS (SELECT * FROM cte)
-- Tag: window_functions_window_functions_operators_test_select_2974
SELECT * FROM cte;
-- Tag: window_functions_window_functions_operators_test_select_2975
SELECT val as v FROM t ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_2976
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2977
SELECT colum_name FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2978
SELECT * FROM t LIMIT 999999999999999;
-- Tag: window_functions_window_functions_operators_test_select_2979
SELECT * FROM t LIMIT -1;

DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
INSERT INTO t VALUES (1), (2), (3);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id STRING);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES ('1');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (column_name INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2980
SELECT val FROM t HAVING val > 10;
-- Tag: window_functions_window_functions_operators_test_select_2981
SELECT (SELECT val FROM t) as result;
-- Tag: window_functions_window_functions_operators_test_select_2982
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2983
SELECT ROW_NUMBER() FROM t;
WITH cte AS (SELECT * FROM cte)
-- Tag: window_functions_window_functions_operators_test_select_2984
SELECT * FROM cte;
-- Tag: window_functions_window_functions_operators_test_select_2985
SELECT val as v FROM t ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_2986
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2987
SELECT colum_name FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2988
SELECT * FROM t LIMIT 999999999999999;
-- Tag: window_functions_window_functions_operators_test_select_2989
SELECT * FROM t LIMIT -1;

DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id STRING);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES ('1');
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (val INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (column_name INT64);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);

-- Tag: window_functions_window_functions_operators_test_select_2990
SELECT * FROM t1 JOIN t2 ON t1.id = t2.id;
-- Tag: window_functions_window_functions_operators_test_select_2991
SELECT ROW_NUMBER() FROM t;
WITH cte AS (SELECT * FROM cte)
-- Tag: window_functions_window_functions_operators_test_select_2992
SELECT * FROM cte;
-- Tag: window_functions_window_functions_operators_test_select_2993
SELECT val as v FROM t ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_2994
SELECT nonexistent_column FROM users;
-- Tag: window_functions_window_functions_operators_test_select_2995
SELECT colum_name FROM t;
-- Tag: window_functions_window_functions_operators_test_select_2996
SELECT * FROM t LIMIT 999999999999999;
-- Tag: window_functions_window_functions_operators_test_select_2997
SELECT * FROM t LIMIT -1;

DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING, age INT64);
INSERT INTO users VALUES (1, 'Alice', 30), (2, 'Bob', 25);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount INT64);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, salary INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 100), (2, 200), (3, 300);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, value INT64);
INSERT INTO t1 VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO t2 VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, category STRING, amount INT64);
INSERT INTO sales VALUES (1, 'A', 100), (2, 'B', 200), (3, 'A', 150), (4, 'B', 250);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, city STRING);
INSERT INTO users VALUES (1, 25, 'NYC'), (2, 30, 'SF'), (3, 35, 'NYC'), (4, 40, 'LA');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, data STRING);
DROP TABLE IF EXISTS small;
CREATE TABLE small (id INT64, ref STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS wide_table;
CREATE TABLE wide_table (id INT64, col1 STRING, col2 STRING, col3 INT64, col4 FLOAT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS big;
CREATE TABLE big (id INT64, data STRING);
DROP TABLE IF EXISTS tiny;
CREATE TABLE tiny (id INT64, ref STRING);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40), (5, 50);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 100), (2, 200), (3, 300);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, data STRING);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, t1_id INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (id INT64, t2_id INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount INT64, region STRING);
DROP TABLE IF EXISTS active_users;
CREATE TABLE active_users (id INT64, name STRING);
DROP TABLE IF EXISTS inactive_users;
CREATE TABLE inactive_users (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, avg_salary INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, date DATE, amount INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);

EXPLAIN SELECT * FROM users WHERE age > 25;
EXPLAIN SELECT o.id, c.name FROM orders o JOIN customers c ON o.customer_id = c.id;
EXPLAIN SELECT product, SUM(amount) FROM sales GROUP BY product;
EXPLAIN SELECT name FROM departments WHERE id IN (SELECT dept_id FROM employees WHERE salary > 100000);
EXPLAIN SELECT * FROM test ORDER BY value DESC LIMIT 10;
EXPLAIN SELECT product, amount, RANK() OVER (ORDER BY amount DESC) as rank FROM sales;
EXPLAIN ANALYZE SELECT * FROM test WHERE value > 150;
EXPLAIN ANALYZE SELECT t1.id, t1.value, t2.value FROM t1 JOIN t2 ON t1.id = t2.id;
EXPLAIN ANALYZE SELECT category, SUM(amount), COUNT(*) FROM sales GROUP BY category;
EXPLAIN ANALYZE SELECT * FROM users WHERE age > 28 AND city = 'NYC';
EXPLAIN SELECT * FROM test WHERE id = 42;
EXPLAIN SELECT * FROM large JOIN small ON large.id = small.id;
EXPLAIN SELECT c.name FROM customers c JOIN orders o ON c.id = o.customer_id WHERE o.amount > 1000;
EXPLAIN SELECT id, col1 FROM wide_table;
EXPLAIN SELECT * FROM test WHERE value > 100;
EXPLAIN SELECT * FROM big JOIN tiny ON big.id = tiny.id;
EXPLAIN ANALYZE SELECT * FROM test WHERE value > 25;
EXPLAIN ANALYZE SELECT SUM(value) FROM test;
EXPLAIN ANALYZE SELECT id, data FROM test ORDER BY data;
EXPLAIN SELECT * FROM t1 JOIN t2 ON t1.id = t2.t1_id JOIN t3 ON t2.id = t3.t2_id;
EXPLAIN WITH regional_totals AS (SELECT region, SUM(amount) as total FROM sales GROUP BY region) SELECT * FROM regional_totals WHERE total > 1000;
EXPLAIN SELECT name FROM active_users UNION SELECT name FROM inactive_users;
EXPLAIN SELECT e.id FROM employees e WHERE e.salary > (SELECT avg_salary FROM departments d WHERE d.id = e.dept_id);
EXPLAIN SELECT product, AVG(daily_total) FROM (SELECT product, date, SUM(amount) as daily_total FROM sales GROUP BY product, date) GROUP BY product;
EXPLAIN SELECT * FROM test;
EXPLAIN (FORMAT JSON) SELECT * FROM test;
EXPLAIN (FORMAT YAML) SELECT * FROM test;
EXPLAIN SELECT * FROM test;
EXPLAIN SELECT 1 + 1 as result;
EXPLAIN INSERT INTO test SELECT id, id * 2 FROM test WHERE id > 10;
EXPLAIN UPDATE test SET value = value * 2 WHERE id > 100;
EXPLAIN DELETE FROM test WHERE value < 10;

DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount INT64);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, salary INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 100), (2, 200), (3, 300);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, value INT64);
INSERT INTO t1 VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO t2 VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, category STRING, amount INT64);
INSERT INTO sales VALUES (1, 'A', 100), (2, 'B', 200), (3, 'A', 150), (4, 'B', 250);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, city STRING);
INSERT INTO users VALUES (1, 25, 'NYC'), (2, 30, 'SF'), (3, 35, 'NYC'), (4, 40, 'LA');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, data STRING);
DROP TABLE IF EXISTS small;
CREATE TABLE small (id INT64, ref STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS wide_table;
CREATE TABLE wide_table (id INT64, col1 STRING, col2 STRING, col3 INT64, col4 FLOAT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS big;
CREATE TABLE big (id INT64, data STRING);
DROP TABLE IF EXISTS tiny;
CREATE TABLE tiny (id INT64, ref STRING);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40), (5, 50);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 100), (2, 200), (3, 300);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, data STRING);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, t1_id INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (id INT64, t2_id INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount INT64, region STRING);
DROP TABLE IF EXISTS active_users;
CREATE TABLE active_users (id INT64, name STRING);
DROP TABLE IF EXISTS inactive_users;
CREATE TABLE inactive_users (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, avg_salary INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, date DATE, amount INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);

EXPLAIN SELECT o.id, c.name FROM orders o JOIN customers c ON o.customer_id = c.id;
EXPLAIN SELECT product, SUM(amount) FROM sales GROUP BY product;
EXPLAIN SELECT name FROM departments WHERE id IN (SELECT dept_id FROM employees WHERE salary > 100000);
EXPLAIN SELECT * FROM test ORDER BY value DESC LIMIT 10;
EXPLAIN SELECT product, amount, RANK() OVER (ORDER BY amount DESC) as rank FROM sales;
EXPLAIN ANALYZE SELECT * FROM test WHERE value > 150;
EXPLAIN ANALYZE SELECT t1.id, t1.value, t2.value FROM t1 JOIN t2 ON t1.id = t2.id;
EXPLAIN ANALYZE SELECT category, SUM(amount), COUNT(*) FROM sales GROUP BY category;
EXPLAIN ANALYZE SELECT * FROM users WHERE age > 28 AND city = 'NYC';
EXPLAIN SELECT * FROM test WHERE id = 42;
EXPLAIN SELECT * FROM large JOIN small ON large.id = small.id;
EXPLAIN SELECT c.name FROM customers c JOIN orders o ON c.id = o.customer_id WHERE o.amount > 1000;
EXPLAIN SELECT id, col1 FROM wide_table;
EXPLAIN SELECT * FROM test WHERE value > 100;
EXPLAIN SELECT * FROM big JOIN tiny ON big.id = tiny.id;
EXPLAIN ANALYZE SELECT * FROM test WHERE value > 25;
EXPLAIN ANALYZE SELECT SUM(value) FROM test;
EXPLAIN ANALYZE SELECT id, data FROM test ORDER BY data;
EXPLAIN SELECT * FROM t1 JOIN t2 ON t1.id = t2.t1_id JOIN t3 ON t2.id = t3.t2_id;
EXPLAIN WITH regional_totals AS (SELECT region, SUM(amount) as total FROM sales GROUP BY region) SELECT * FROM regional_totals WHERE total > 1000;
EXPLAIN SELECT name FROM active_users UNION SELECT name FROM inactive_users;
EXPLAIN SELECT e.id FROM employees e WHERE e.salary > (SELECT avg_salary FROM departments d WHERE d.id = e.dept_id);
EXPLAIN SELECT product, AVG(daily_total) FROM (SELECT product, date, SUM(amount) as daily_total FROM sales GROUP BY product, date) GROUP BY product;
EXPLAIN SELECT * FROM test;
EXPLAIN (FORMAT JSON) SELECT * FROM test;
EXPLAIN (FORMAT YAML) SELECT * FROM test;
EXPLAIN SELECT * FROM test;
EXPLAIN SELECT 1 + 1 as result;
EXPLAIN INSERT INTO test SELECT id, id * 2 FROM test WHERE id > 10;
EXPLAIN UPDATE test SET value = value * 2 WHERE id > 100;
EXPLAIN DELETE FROM test WHERE value < 10;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount INT64);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, salary INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 100), (2, 200), (3, 300);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, value INT64);
INSERT INTO t1 VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO t2 VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, category STRING, amount INT64);
INSERT INTO sales VALUES (1, 'A', 100), (2, 'B', 200), (3, 'A', 150), (4, 'B', 250);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, city STRING);
INSERT INTO users VALUES (1, 25, 'NYC'), (2, 30, 'SF'), (3, 35, 'NYC'), (4, 40, 'LA');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, data STRING);
DROP TABLE IF EXISTS small;
CREATE TABLE small (id INT64, ref STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS wide_table;
CREATE TABLE wide_table (id INT64, col1 STRING, col2 STRING, col3 INT64, col4 FLOAT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS big;
CREATE TABLE big (id INT64, data STRING);
DROP TABLE IF EXISTS tiny;
CREATE TABLE tiny (id INT64, ref STRING);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40), (5, 50);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 100), (2, 200), (3, 300);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, data STRING);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, t1_id INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (id INT64, t2_id INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount INT64, region STRING);
DROP TABLE IF EXISTS active_users;
CREATE TABLE active_users (id INT64, name STRING);
DROP TABLE IF EXISTS inactive_users;
CREATE TABLE inactive_users (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, avg_salary INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, date DATE, amount INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);

EXPLAIN SELECT product, SUM(amount) FROM sales GROUP BY product;
EXPLAIN SELECT name FROM departments WHERE id IN (SELECT dept_id FROM employees WHERE salary > 100000);
EXPLAIN SELECT * FROM test ORDER BY value DESC LIMIT 10;
EXPLAIN SELECT product, amount, RANK() OVER (ORDER BY amount DESC) as rank FROM sales;
EXPLAIN ANALYZE SELECT * FROM test WHERE value > 150;
EXPLAIN ANALYZE SELECT t1.id, t1.value, t2.value FROM t1 JOIN t2 ON t1.id = t2.id;
EXPLAIN ANALYZE SELECT category, SUM(amount), COUNT(*) FROM sales GROUP BY category;
EXPLAIN ANALYZE SELECT * FROM users WHERE age > 28 AND city = 'NYC';
EXPLAIN SELECT * FROM test WHERE id = 42;
EXPLAIN SELECT * FROM large JOIN small ON large.id = small.id;
EXPLAIN SELECT c.name FROM customers c JOIN orders o ON c.id = o.customer_id WHERE o.amount > 1000;
EXPLAIN SELECT id, col1 FROM wide_table;
EXPLAIN SELECT * FROM test WHERE value > 100;
EXPLAIN SELECT * FROM big JOIN tiny ON big.id = tiny.id;
EXPLAIN ANALYZE SELECT * FROM test WHERE value > 25;
EXPLAIN ANALYZE SELECT SUM(value) FROM test;
EXPLAIN ANALYZE SELECT id, data FROM test ORDER BY data;
EXPLAIN SELECT * FROM t1 JOIN t2 ON t1.id = t2.t1_id JOIN t3 ON t2.id = t3.t2_id;
EXPLAIN WITH regional_totals AS (SELECT region, SUM(amount) as total FROM sales GROUP BY region) SELECT * FROM regional_totals WHERE total > 1000;
EXPLAIN SELECT name FROM active_users UNION SELECT name FROM inactive_users;
EXPLAIN SELECT e.id FROM employees e WHERE e.salary > (SELECT avg_salary FROM departments d WHERE d.id = e.dept_id);
EXPLAIN SELECT product, AVG(daily_total) FROM (SELECT product, date, SUM(amount) as daily_total FROM sales GROUP BY product, date) GROUP BY product;
EXPLAIN SELECT * FROM test;
EXPLAIN (FORMAT JSON) SELECT * FROM test;
EXPLAIN (FORMAT YAML) SELECT * FROM test;
EXPLAIN SELECT * FROM test;
EXPLAIN SELECT 1 + 1 as result;
EXPLAIN INSERT INTO test SELECT id, id * 2 FROM test WHERE id > 10;
EXPLAIN UPDATE test SET value = value * 2 WHERE id > 100;
EXPLAIN DELETE FROM test WHERE value < 10;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, salary INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 100), (2, 200), (3, 300);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, value INT64);
INSERT INTO t1 VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO t2 VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, category STRING, amount INT64);
INSERT INTO sales VALUES (1, 'A', 100), (2, 'B', 200), (3, 'A', 150), (4, 'B', 250);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, city STRING);
INSERT INTO users VALUES (1, 25, 'NYC'), (2, 30, 'SF'), (3, 35, 'NYC'), (4, 40, 'LA');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, data STRING);
DROP TABLE IF EXISTS small;
CREATE TABLE small (id INT64, ref STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS wide_table;
CREATE TABLE wide_table (id INT64, col1 STRING, col2 STRING, col3 INT64, col4 FLOAT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS big;
CREATE TABLE big (id INT64, data STRING);
DROP TABLE IF EXISTS tiny;
CREATE TABLE tiny (id INT64, ref STRING);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40), (5, 50);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 100), (2, 200), (3, 300);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, data STRING);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, t1_id INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (id INT64, t2_id INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount INT64, region STRING);
DROP TABLE IF EXISTS active_users;
CREATE TABLE active_users (id INT64, name STRING);
DROP TABLE IF EXISTS inactive_users;
CREATE TABLE inactive_users (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, avg_salary INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, date DATE, amount INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);

EXPLAIN SELECT name FROM departments WHERE id IN (SELECT dept_id FROM employees WHERE salary > 100000);
EXPLAIN SELECT * FROM test ORDER BY value DESC LIMIT 10;
EXPLAIN SELECT product, amount, RANK() OVER (ORDER BY amount DESC) as rank FROM sales;
EXPLAIN ANALYZE SELECT * FROM test WHERE value > 150;
EXPLAIN ANALYZE SELECT t1.id, t1.value, t2.value FROM t1 JOIN t2 ON t1.id = t2.id;
EXPLAIN ANALYZE SELECT category, SUM(amount), COUNT(*) FROM sales GROUP BY category;
EXPLAIN ANALYZE SELECT * FROM users WHERE age > 28 AND city = 'NYC';
EXPLAIN SELECT * FROM test WHERE id = 42;
EXPLAIN SELECT * FROM large JOIN small ON large.id = small.id;
EXPLAIN SELECT c.name FROM customers c JOIN orders o ON c.id = o.customer_id WHERE o.amount > 1000;
EXPLAIN SELECT id, col1 FROM wide_table;
EXPLAIN SELECT * FROM test WHERE value > 100;
EXPLAIN SELECT * FROM big JOIN tiny ON big.id = tiny.id;
EXPLAIN ANALYZE SELECT * FROM test WHERE value > 25;
EXPLAIN ANALYZE SELECT SUM(value) FROM test;
EXPLAIN ANALYZE SELECT id, data FROM test ORDER BY data;
EXPLAIN SELECT * FROM t1 JOIN t2 ON t1.id = t2.t1_id JOIN t3 ON t2.id = t3.t2_id;
EXPLAIN WITH regional_totals AS (SELECT region, SUM(amount) as total FROM sales GROUP BY region) SELECT * FROM regional_totals WHERE total > 1000;
EXPLAIN SELECT name FROM active_users UNION SELECT name FROM inactive_users;
EXPLAIN SELECT e.id FROM employees e WHERE e.salary > (SELECT avg_salary FROM departments d WHERE d.id = e.dept_id);
EXPLAIN SELECT product, AVG(daily_total) FROM (SELECT product, date, SUM(amount) as daily_total FROM sales GROUP BY product, date) GROUP BY product;
EXPLAIN SELECT * FROM test;
EXPLAIN (FORMAT JSON) SELECT * FROM test;
EXPLAIN (FORMAT YAML) SELECT * FROM test;
EXPLAIN SELECT * FROM test;
EXPLAIN SELECT 1 + 1 as result;
EXPLAIN INSERT INTO test SELECT id, id * 2 FROM test WHERE id > 10;
EXPLAIN UPDATE test SET value = value * 2 WHERE id > 100;
EXPLAIN DELETE FROM test WHERE value < 10;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 100), (2, 200), (3, 300);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, value INT64);
INSERT INTO t1 VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO t2 VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, category STRING, amount INT64);
INSERT INTO sales VALUES (1, 'A', 100), (2, 'B', 200), (3, 'A', 150), (4, 'B', 250);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, city STRING);
INSERT INTO users VALUES (1, 25, 'NYC'), (2, 30, 'SF'), (3, 35, 'NYC'), (4, 40, 'LA');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, data STRING);
DROP TABLE IF EXISTS small;
CREATE TABLE small (id INT64, ref STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS wide_table;
CREATE TABLE wide_table (id INT64, col1 STRING, col2 STRING, col3 INT64, col4 FLOAT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS big;
CREATE TABLE big (id INT64, data STRING);
DROP TABLE IF EXISTS tiny;
CREATE TABLE tiny (id INT64, ref STRING);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40), (5, 50);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 100), (2, 200), (3, 300);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, data STRING);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, t1_id INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (id INT64, t2_id INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount INT64, region STRING);
DROP TABLE IF EXISTS active_users;
CREATE TABLE active_users (id INT64, name STRING);
DROP TABLE IF EXISTS inactive_users;
CREATE TABLE inactive_users (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, avg_salary INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, date DATE, amount INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);

EXPLAIN SELECT * FROM test ORDER BY value DESC LIMIT 10;
EXPLAIN SELECT product, amount, RANK() OVER (ORDER BY amount DESC) as rank FROM sales;
EXPLAIN ANALYZE SELECT * FROM test WHERE value > 150;
EXPLAIN ANALYZE SELECT t1.id, t1.value, t2.value FROM t1 JOIN t2 ON t1.id = t2.id;
EXPLAIN ANALYZE SELECT category, SUM(amount), COUNT(*) FROM sales GROUP BY category;
EXPLAIN ANALYZE SELECT * FROM users WHERE age > 28 AND city = 'NYC';
EXPLAIN SELECT * FROM test WHERE id = 42;
EXPLAIN SELECT * FROM large JOIN small ON large.id = small.id;
EXPLAIN SELECT c.name FROM customers c JOIN orders o ON c.id = o.customer_id WHERE o.amount > 1000;
EXPLAIN SELECT id, col1 FROM wide_table;
EXPLAIN SELECT * FROM test WHERE value > 100;
EXPLAIN SELECT * FROM big JOIN tiny ON big.id = tiny.id;
EXPLAIN ANALYZE SELECT * FROM test WHERE value > 25;
EXPLAIN ANALYZE SELECT SUM(value) FROM test;
EXPLAIN ANALYZE SELECT id, data FROM test ORDER BY data;
EXPLAIN SELECT * FROM t1 JOIN t2 ON t1.id = t2.t1_id JOIN t3 ON t2.id = t3.t2_id;
EXPLAIN WITH regional_totals AS (SELECT region, SUM(amount) as total FROM sales GROUP BY region) SELECT * FROM regional_totals WHERE total > 1000;
EXPLAIN SELECT name FROM active_users UNION SELECT name FROM inactive_users;
EXPLAIN SELECT e.id FROM employees e WHERE e.salary > (SELECT avg_salary FROM departments d WHERE d.id = e.dept_id);
EXPLAIN SELECT product, AVG(daily_total) FROM (SELECT product, date, SUM(amount) as daily_total FROM sales GROUP BY product, date) GROUP BY product;
EXPLAIN SELECT * FROM test;
EXPLAIN (FORMAT JSON) SELECT * FROM test;
EXPLAIN (FORMAT YAML) SELECT * FROM test;
EXPLAIN SELECT * FROM test;
EXPLAIN SELECT 1 + 1 as result;
EXPLAIN INSERT INTO test SELECT id, id * 2 FROM test WHERE id > 10;
EXPLAIN UPDATE test SET value = value * 2 WHERE id > 100;
EXPLAIN DELETE FROM test WHERE value < 10;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, amount INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 100), (2, 200), (3, 300);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, value INT64);
INSERT INTO t1 VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO t2 VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, category STRING, amount INT64);
INSERT INTO sales VALUES (1, 'A', 100), (2, 'B', 200), (3, 'A', 150), (4, 'B', 250);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, city STRING);
INSERT INTO users VALUES (1, 25, 'NYC'), (2, 30, 'SF'), (3, 35, 'NYC'), (4, 40, 'LA');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, data STRING);
DROP TABLE IF EXISTS small;
CREATE TABLE small (id INT64, ref STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS wide_table;
CREATE TABLE wide_table (id INT64, col1 STRING, col2 STRING, col3 INT64, col4 FLOAT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS big;
CREATE TABLE big (id INT64, data STRING);
DROP TABLE IF EXISTS tiny;
CREATE TABLE tiny (id INT64, ref STRING);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40), (5, 50);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 100), (2, 200), (3, 300);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, data STRING);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, t1_id INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (id INT64, t2_id INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount INT64, region STRING);
DROP TABLE IF EXISTS active_users;
CREATE TABLE active_users (id INT64, name STRING);
DROP TABLE IF EXISTS inactive_users;
CREATE TABLE inactive_users (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, avg_salary INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product STRING, date DATE, amount INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);

EXPLAIN SELECT product, amount, RANK() OVER (ORDER BY amount DESC) as rank FROM sales;
EXPLAIN ANALYZE SELECT * FROM test WHERE value > 150;
EXPLAIN ANALYZE SELECT t1.id, t1.value, t2.value FROM t1 JOIN t2 ON t1.id = t2.id;
EXPLAIN ANALYZE SELECT category, SUM(amount), COUNT(*) FROM sales GROUP BY category;
EXPLAIN ANALYZE SELECT * FROM users WHERE age > 28 AND city = 'NYC';
EXPLAIN SELECT * FROM test WHERE id = 42;
EXPLAIN SELECT * FROM large JOIN small ON large.id = small.id;
EXPLAIN SELECT c.name FROM customers c JOIN orders o ON c.id = o.customer_id WHERE o.amount > 1000;
EXPLAIN SELECT id, col1 FROM wide_table;
EXPLAIN SELECT * FROM test WHERE value > 100;
EXPLAIN SELECT * FROM big JOIN tiny ON big.id = tiny.id;
EXPLAIN ANALYZE SELECT * FROM test WHERE value > 25;
EXPLAIN ANALYZE SELECT SUM(value) FROM test;
EXPLAIN ANALYZE SELECT id, data FROM test ORDER BY data;
EXPLAIN SELECT * FROM t1 JOIN t2 ON t1.id = t2.t1_id JOIN t3 ON t2.id = t3.t2_id;
EXPLAIN WITH regional_totals AS (SELECT region, SUM(amount) as total FROM sales GROUP BY region) SELECT * FROM regional_totals WHERE total > 1000;
EXPLAIN SELECT name FROM active_users UNION SELECT name FROM inactive_users;
EXPLAIN SELECT e.id FROM employees e WHERE e.salary > (SELECT avg_salary FROM departments d WHERE d.id = e.dept_id);
EXPLAIN SELECT product, AVG(daily_total) FROM (SELECT product, date, SUM(amount) as daily_total FROM sales GROUP BY product, date) GROUP BY product;
EXPLAIN SELECT * FROM test;
EXPLAIN (FORMAT JSON) SELECT * FROM test;
EXPLAIN (FORMAT YAML) SELECT * FROM test;
EXPLAIN SELECT * FROM test;
EXPLAIN SELECT 1 + 1 as result;
EXPLAIN INSERT INTO test SELECT id, id * 2 FROM test WHERE id > 10;
EXPLAIN UPDATE test SET value = value * 2 WHERE id > 100;
EXPLAIN DELETE FROM test WHERE value < 10;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64, salary INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
INSERT INTO employees VALUES
(1, 'Alice', 1, 80000),
(2, 'Bob', 1, 90000),
(3, 'Charlie', 2, 70000),
(4, 'David', 2, 85000);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING, region STRING);
INSERT INTO orders VALUES
(1, 1, 100.0), (2, 1, 200.0),
(3, 2, 150.0),
(4, 3, 300.0), (5, 3, 400.0), (6, 3, 250.0);
INSERT INTO customers VALUES
(1, 'Alice', 'North'),
(2, 'Bob', 'South'),
(3, 'Charlie', 'North');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount FLOAT64);
INSERT INTO sales VALUES
('Widget', 'North', 100.0),
('Widget', 'South', 150.0),
('Widget', 'East', 120.0),
('Gadget', 'North', 200.0),
('Gadget', 'South', 180.0);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount FLOAT64, type STRING);
INSERT INTO transactions VALUES
(1, 100.0, 'credit'), (2, 50.0, 'debit'),
(3, 200.0, 'credit'), (4, 75.0, 'debit'),
(5, 150.0, 'credit');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer STRING, status STRING, amount FLOAT64);
INSERT INTO orders VALUES
('Alice', 'completed', 100.0),
('Alice', 'cancelled', 50.0),
('Alice', 'completed', 200.0),
('Bob', 'completed', 150.0),
('Bob', 'cancelled', 200.0),
('Charlie', 'completed', 300.0);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (student STRING, subject STRING, score INT64);
INSERT INTO scores VALUES
('Alice', 'Math', 90), ('Alice', 'English', 85),
('Bob', 'Math', 75), ('Bob', 'English', 95),
('Charlie', 'Math', 60), ('Charlie', 'English', 70);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64, c STRING);
INSERT INTO data VALUES
(1, 10, 20, '5'),
(2, NULL, 30, '10'),
(3, 40, NULL, '15'),
(4, 50, 60, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10), ('A', 20),
(NULL, 30), (NULL, 40),
('B', 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, int_val INT64, float_val FLOAT64, str_val STRING);
INSERT INTO data VALUES (1, 10, 2.5, '5');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL, int_val INT64, float_val FLOAT64);
INSERT INTO data VALUES (1, true, 10, 3.5), (2, false, 20, 4.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 100), (2, 'A', 200), (3, 'B', 150),
(4, 'B', 250), (5, 'C', 300);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (user_id INT64, amount_str STRING);
INSERT INTO transactions VALUES
(1, '100'), (1, '200'), (2, '150'), (2, '250'), (2, '100');
DROP TABLE IF EXISTS source;
CREATE TABLE source (name STRING, age_str STRING, score_str STRING);
DROP TABLE IF EXISTS target;
CREATE TABLE target (name STRING, age INT64, score FLOAT64, grade STRING);
INSERT INTO source VALUES
('Alice', '25', '85.5'),
('Bob', '30', '92.0'),
('Charlie', '22', '78.5');
INSERT INTO target (name, age, score, grade)
-- Tag: window_functions_window_functions_operators_test_select_2998
SELECT name,
CAST(age_str AS INT64),
CAST(score_str AS FLOAT64),
CASE
WHEN CAST(score_str AS FLOAT64) >= 90 THEN 'A'
WHEN CAST(score_str AS FLOAT64) >= 80 THEN 'B'
ELSE 'C'
END
FROM source;
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, year_str STRING, amount FLOAT64);
INSERT INTO sales VALUES
(1, '2023', 100.0), (2, '2023', 200.0),
(3, '2024', 150.0), (4, '2024', 250.0), (5, '2024', 300.0);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept STRING, salary INT64);
INSERT INTO employees VALUES
(1, 'Alice', 'Eng', 80000),
(2, 'Bob', 'Sales', 70000),
(3, 'Charlie', 'Eng', 90000),
(4, 'David', 'Sales', 75000);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value STRING);
INSERT INTO data VALUES ('A', 'abc'), ('B', '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, true), (2, false);

-- Tag: window_functions_window_functions_operators_test_select_2999
SELECT e.name, d.name as dept, e.salary
FROM employees e
JOIN departments d ON e.dept_id = d.id
WHERE e.salary > (SELECT AVG(salary) FROM employees)
ORDER BY e.salary DESC;
-- Tag: window_functions_window_functions_operators_test_select_3000
SELECT c.name,
(SELECT COUNT(*) FROM orders o WHERE o.customer_id = c.id) as order_count,
(SELECT SUM(amount) FROM orders o WHERE o.customer_id = c.id) as total_spent
FROM customers c
WHERE c.region = 'North'
ORDER BY c.name;
WITH ranked_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_3001
SELECT product, region, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY amount DESC) as rank
FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_3002
SELECT product, region, amount
FROM ranked_sales
WHERE rank <= 2
ORDER BY product, rank;
WITH credits AS (
-- Tag: window_functions_window_functions_operators_test_select_3003
SELECT SUM(amount) as total_credits
FROM transactions
WHERE type = 'credit'
),
debits AS (
-- Tag: window_functions_window_functions_operators_test_select_3004
SELECT SUM(amount) as total_debits
FROM transactions
WHERE type = 'debit'
),
summary AS (
-- Tag: window_functions_window_functions_operators_test_select_035
SELECT
(SELECT total_credits FROM credits) as credits,
(SELECT total_debits FROM debits) as debits
)
-- Tag: window_functions_window_functions_operators_test_select_3005
SELECT credits, debits, credits - debits as net
FROM summary;
-- Tag: window_functions_window_functions_operators_test_select_3006
SELECT customer,
SUM(CASE WHEN status = 'completed' THEN amount ELSE 0 END) as completed_total,
SUM(CASE WHEN status = 'cancelled' THEN amount ELSE 0 END) as cancelled_total,
COUNT(*) as order_count
FROM orders
GROUP BY customer
HAVING SUM(CASE WHEN status = 'completed' THEN amount ELSE 0 END) > 100
ORDER BY completed_total DESC;
-- Tag: window_functions_window_functions_operators_test_select_3007
SELECT student,
AVG(score) as avg_score,
CASE
WHEN AVG(score) >= 85 THEN 'A'
WHEN AVG(score) >= 75 THEN 'B'
WHEN AVG(score) >= 65 THEN 'C'
ELSE 'F'
END as grade
FROM scores
GROUP BY student
ORDER BY avg_score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3008
SELECT id,
a + b as sum,
a * b as product,
CAST(c AS INT64) as c_int,
COALESCE(a, 0) + COALESCE(b, 0) as coalesced_sum
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3009
SELECT category, COUNT(*) as count, SUM(value) as total
FROM data
GROUP BY category
ORDER BY category NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_3010
SELECT (int_val + float_val) * CAST(str_val AS FLOAT64) as complex_result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_3011
SELECT id,
CASE WHEN flag THEN int_val ELSE float_val END as mixed_result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3012
SELECT category, avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3013
SELECT category, AVG(value) as avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3014
SELECT category, value
FROM data
WHERE value > 100
) as filtered
GROUP BY category
) as averaged
WHERE avg_value > 150
ORDER BY avg_value DESC;
-- Tag: window_functions_window_functions_operators_test_select_3015
SELECT user_id, total_amount
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3016
SELECT user_id, SUM(CAST(amount_str AS INT64)) as total_amount
FROM transactions
GROUP BY user_id
) as user_totals
WHERE total_amount > 300
ORDER BY total_amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_3017
SELECT name, age, score, grade FROM target ORDER BY score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3018
SELECT id,
CAST(year_str AS INT64) as year,
amount,
ROW_NUMBER() OVER (PARTITION BY CAST(year_str AS INT64) ORDER BY amount DESC) as rank
FROM sales
ORDER BY year, rank;
-- Tag: window_functions_window_functions_operators_test_select_3019
SELECT name, dept, salary,
ROW_NUMBER() OVER (
PARTITION BY dept
ORDER BY CASE WHEN salary > 75000 THEN salary ELSE 0 END DESC
) as priority_rank
FROM employees
ORDER BY dept, priority_rank;
-- Tag: window_functions_window_functions_operators_test_select_3020
SELECT category, SUM(CAST(value AS INT64)) as total
FROM data
GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_3021
SELECT CASE WHEN flag THEN 'yes' ELSE 42 END as mixed FROM data;

DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING, region STRING);
INSERT INTO orders VALUES
(1, 1, 100.0), (2, 1, 200.0),
(3, 2, 150.0),
(4, 3, 300.0), (5, 3, 400.0), (6, 3, 250.0);
INSERT INTO customers VALUES
(1, 'Alice', 'North'),
(2, 'Bob', 'South'),
(3, 'Charlie', 'North');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount FLOAT64);
INSERT INTO sales VALUES
('Widget', 'North', 100.0),
('Widget', 'South', 150.0),
('Widget', 'East', 120.0),
('Gadget', 'North', 200.0),
('Gadget', 'South', 180.0);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount FLOAT64, type STRING);
INSERT INTO transactions VALUES
(1, 100.0, 'credit'), (2, 50.0, 'debit'),
(3, 200.0, 'credit'), (4, 75.0, 'debit'),
(5, 150.0, 'credit');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer STRING, status STRING, amount FLOAT64);
INSERT INTO orders VALUES
('Alice', 'completed', 100.0),
('Alice', 'cancelled', 50.0),
('Alice', 'completed', 200.0),
('Bob', 'completed', 150.0),
('Bob', 'cancelled', 200.0),
('Charlie', 'completed', 300.0);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (student STRING, subject STRING, score INT64);
INSERT INTO scores VALUES
('Alice', 'Math', 90), ('Alice', 'English', 85),
('Bob', 'Math', 75), ('Bob', 'English', 95),
('Charlie', 'Math', 60), ('Charlie', 'English', 70);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64, c STRING);
INSERT INTO data VALUES
(1, 10, 20, '5'),
(2, NULL, 30, '10'),
(3, 40, NULL, '15'),
(4, 50, 60, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10), ('A', 20),
(NULL, 30), (NULL, 40),
('B', 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, int_val INT64, float_val FLOAT64, str_val STRING);
INSERT INTO data VALUES (1, 10, 2.5, '5');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL, int_val INT64, float_val FLOAT64);
INSERT INTO data VALUES (1, true, 10, 3.5), (2, false, 20, 4.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 100), (2, 'A', 200), (3, 'B', 150),
(4, 'B', 250), (5, 'C', 300);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (user_id INT64, amount_str STRING);
INSERT INTO transactions VALUES
(1, '100'), (1, '200'), (2, '150'), (2, '250'), (2, '100');
DROP TABLE IF EXISTS source;
CREATE TABLE source (name STRING, age_str STRING, score_str STRING);
DROP TABLE IF EXISTS target;
CREATE TABLE target (name STRING, age INT64, score FLOAT64, grade STRING);
INSERT INTO source VALUES
('Alice', '25', '85.5'),
('Bob', '30', '92.0'),
('Charlie', '22', '78.5');
INSERT INTO target (name, age, score, grade)
-- Tag: window_functions_window_functions_operators_test_select_3022
SELECT name,
CAST(age_str AS INT64),
CAST(score_str AS FLOAT64),
CASE
WHEN CAST(score_str AS FLOAT64) >= 90 THEN 'A'
WHEN CAST(score_str AS FLOAT64) >= 80 THEN 'B'
ELSE 'C'
END
FROM source;
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, year_str STRING, amount FLOAT64);
INSERT INTO sales VALUES
(1, '2023', 100.0), (2, '2023', 200.0),
(3, '2024', 150.0), (4, '2024', 250.0), (5, '2024', 300.0);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept STRING, salary INT64);
INSERT INTO employees VALUES
(1, 'Alice', 'Eng', 80000),
(2, 'Bob', 'Sales', 70000),
(3, 'Charlie', 'Eng', 90000),
(4, 'David', 'Sales', 75000);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value STRING);
INSERT INTO data VALUES ('A', 'abc'), ('B', '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, true), (2, false);

-- Tag: window_functions_window_functions_operators_test_select_3023
SELECT c.name,
(SELECT COUNT(*) FROM orders o WHERE o.customer_id = c.id) as order_count,
(SELECT SUM(amount) FROM orders o WHERE o.customer_id = c.id) as total_spent
FROM customers c
WHERE c.region = 'North'
ORDER BY c.name;
WITH ranked_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_3024
SELECT product, region, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY amount DESC) as rank
FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_3025
SELECT product, region, amount
FROM ranked_sales
WHERE rank <= 2
ORDER BY product, rank;
WITH credits AS (
-- Tag: window_functions_window_functions_operators_test_select_3026
SELECT SUM(amount) as total_credits
FROM transactions
WHERE type = 'credit'
),
debits AS (
-- Tag: window_functions_window_functions_operators_test_select_3027
SELECT SUM(amount) as total_debits
FROM transactions
WHERE type = 'debit'
),
summary AS (
-- Tag: window_functions_window_functions_operators_test_select_036
SELECT
(SELECT total_credits FROM credits) as credits,
(SELECT total_debits FROM debits) as debits
)
-- Tag: window_functions_window_functions_operators_test_select_3028
SELECT credits, debits, credits - debits as net
FROM summary;
-- Tag: window_functions_window_functions_operators_test_select_3029
SELECT customer,
SUM(CASE WHEN status = 'completed' THEN amount ELSE 0 END) as completed_total,
SUM(CASE WHEN status = 'cancelled' THEN amount ELSE 0 END) as cancelled_total,
COUNT(*) as order_count
FROM orders
GROUP BY customer
HAVING SUM(CASE WHEN status = 'completed' THEN amount ELSE 0 END) > 100
ORDER BY completed_total DESC;
-- Tag: window_functions_window_functions_operators_test_select_3030
SELECT student,
AVG(score) as avg_score,
CASE
WHEN AVG(score) >= 85 THEN 'A'
WHEN AVG(score) >= 75 THEN 'B'
WHEN AVG(score) >= 65 THEN 'C'
ELSE 'F'
END as grade
FROM scores
GROUP BY student
ORDER BY avg_score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3031
SELECT id,
a + b as sum,
a * b as product,
CAST(c AS INT64) as c_int,
COALESCE(a, 0) + COALESCE(b, 0) as coalesced_sum
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3032
SELECT category, COUNT(*) as count, SUM(value) as total
FROM data
GROUP BY category
ORDER BY category NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_3033
SELECT (int_val + float_val) * CAST(str_val AS FLOAT64) as complex_result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_3034
SELECT id,
CASE WHEN flag THEN int_val ELSE float_val END as mixed_result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3035
SELECT category, avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3036
SELECT category, AVG(value) as avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3037
SELECT category, value
FROM data
WHERE value > 100
) as filtered
GROUP BY category
) as averaged
WHERE avg_value > 150
ORDER BY avg_value DESC;
-- Tag: window_functions_window_functions_operators_test_select_3038
SELECT user_id, total_amount
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3039
SELECT user_id, SUM(CAST(amount_str AS INT64)) as total_amount
FROM transactions
GROUP BY user_id
) as user_totals
WHERE total_amount > 300
ORDER BY total_amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_3040
SELECT name, age, score, grade FROM target ORDER BY score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3041
SELECT id,
CAST(year_str AS INT64) as year,
amount,
ROW_NUMBER() OVER (PARTITION BY CAST(year_str AS INT64) ORDER BY amount DESC) as rank
FROM sales
ORDER BY year, rank;
-- Tag: window_functions_window_functions_operators_test_select_3042
SELECT name, dept, salary,
ROW_NUMBER() OVER (
PARTITION BY dept
ORDER BY CASE WHEN salary > 75000 THEN salary ELSE 0 END DESC
) as priority_rank
FROM employees
ORDER BY dept, priority_rank;
-- Tag: window_functions_window_functions_operators_test_select_3043
SELECT category, SUM(CAST(value AS INT64)) as total
FROM data
GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_3044
SELECT CASE WHEN flag THEN 'yes' ELSE 42 END as mixed FROM data;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, region STRING, amount FLOAT64);
INSERT INTO sales VALUES
('Widget', 'North', 100.0),
('Widget', 'South', 150.0),
('Widget', 'East', 120.0),
('Gadget', 'North', 200.0),
('Gadget', 'South', 180.0);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (id INT64, amount FLOAT64, type STRING);
INSERT INTO transactions VALUES
(1, 100.0, 'credit'), (2, 50.0, 'debit'),
(3, 200.0, 'credit'), (4, 75.0, 'debit'),
(5, 150.0, 'credit');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer STRING, status STRING, amount FLOAT64);
INSERT INTO orders VALUES
('Alice', 'completed', 100.0),
('Alice', 'cancelled', 50.0),
('Alice', 'completed', 200.0),
('Bob', 'completed', 150.0),
('Bob', 'cancelled', 200.0),
('Charlie', 'completed', 300.0);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (student STRING, subject STRING, score INT64);
INSERT INTO scores VALUES
('Alice', 'Math', 90), ('Alice', 'English', 85),
('Bob', 'Math', 75), ('Bob', 'English', 95),
('Charlie', 'Math', 60), ('Charlie', 'English', 70);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64, c STRING);
INSERT INTO data VALUES
(1, 10, 20, '5'),
(2, NULL, 30, '10'),
(3, 40, NULL, '15'),
(4, 50, 60, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10), ('A', 20),
(NULL, 30), (NULL, 40),
('B', 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, int_val INT64, float_val FLOAT64, str_val STRING);
INSERT INTO data VALUES (1, 10, 2.5, '5');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL, int_val INT64, float_val FLOAT64);
INSERT INTO data VALUES (1, true, 10, 3.5), (2, false, 20, 4.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 100), (2, 'A', 200), (3, 'B', 150),
(4, 'B', 250), (5, 'C', 300);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (user_id INT64, amount_str STRING);
INSERT INTO transactions VALUES
(1, '100'), (1, '200'), (2, '150'), (2, '250'), (2, '100');
DROP TABLE IF EXISTS source;
CREATE TABLE source (name STRING, age_str STRING, score_str STRING);
DROP TABLE IF EXISTS target;
CREATE TABLE target (name STRING, age INT64, score FLOAT64, grade STRING);
INSERT INTO source VALUES
('Alice', '25', '85.5'),
('Bob', '30', '92.0'),
('Charlie', '22', '78.5');
INSERT INTO target (name, age, score, grade)
-- Tag: window_functions_window_functions_operators_test_select_3045
SELECT name,
CAST(age_str AS INT64),
CAST(score_str AS FLOAT64),
CASE
WHEN CAST(score_str AS FLOAT64) >= 90 THEN 'A'
WHEN CAST(score_str AS FLOAT64) >= 80 THEN 'B'
ELSE 'C'
END
FROM source;
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, year_str STRING, amount FLOAT64);
INSERT INTO sales VALUES
(1, '2023', 100.0), (2, '2023', 200.0),
(3, '2024', 150.0), (4, '2024', 250.0), (5, '2024', 300.0);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept STRING, salary INT64);
INSERT INTO employees VALUES
(1, 'Alice', 'Eng', 80000),
(2, 'Bob', 'Sales', 70000),
(3, 'Charlie', 'Eng', 90000),
(4, 'David', 'Sales', 75000);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value STRING);
INSERT INTO data VALUES ('A', 'abc'), ('B', '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, true), (2, false);

WITH ranked_sales AS (
-- Tag: window_functions_window_functions_operators_test_select_3046
SELECT product, region, amount,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY amount DESC) as rank
FROM sales
)
-- Tag: window_functions_window_functions_operators_test_select_3047
SELECT product, region, amount
FROM ranked_sales
WHERE rank <= 2
ORDER BY product, rank;
WITH credits AS (
-- Tag: window_functions_window_functions_operators_test_select_3048
SELECT SUM(amount) as total_credits
FROM transactions
WHERE type = 'credit'
),
debits AS (
-- Tag: window_functions_window_functions_operators_test_select_3049
SELECT SUM(amount) as total_debits
FROM transactions
WHERE type = 'debit'
),
summary AS (
-- Tag: window_functions_window_functions_operators_test_select_037
SELECT
(SELECT total_credits FROM credits) as credits,
(SELECT total_debits FROM debits) as debits
)
-- Tag: window_functions_window_functions_operators_test_select_3050
SELECT credits, debits, credits - debits as net
FROM summary;
-- Tag: window_functions_window_functions_operators_test_select_3051
SELECT customer,
SUM(CASE WHEN status = 'completed' THEN amount ELSE 0 END) as completed_total,
SUM(CASE WHEN status = 'cancelled' THEN amount ELSE 0 END) as cancelled_total,
COUNT(*) as order_count
FROM orders
GROUP BY customer
HAVING SUM(CASE WHEN status = 'completed' THEN amount ELSE 0 END) > 100
ORDER BY completed_total DESC;
-- Tag: window_functions_window_functions_operators_test_select_3052
SELECT student,
AVG(score) as avg_score,
CASE
WHEN AVG(score) >= 85 THEN 'A'
WHEN AVG(score) >= 75 THEN 'B'
WHEN AVG(score) >= 65 THEN 'C'
ELSE 'F'
END as grade
FROM scores
GROUP BY student
ORDER BY avg_score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3053
SELECT id,
a + b as sum,
a * b as product,
CAST(c AS INT64) as c_int,
COALESCE(a, 0) + COALESCE(b, 0) as coalesced_sum
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3054
SELECT category, COUNT(*) as count, SUM(value) as total
FROM data
GROUP BY category
ORDER BY category NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_3055
SELECT (int_val + float_val) * CAST(str_val AS FLOAT64) as complex_result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_3056
SELECT id,
CASE WHEN flag THEN int_val ELSE float_val END as mixed_result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3057
SELECT category, avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3058
SELECT category, AVG(value) as avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3059
SELECT category, value
FROM data
WHERE value > 100
) as filtered
GROUP BY category
) as averaged
WHERE avg_value > 150
ORDER BY avg_value DESC;
-- Tag: window_functions_window_functions_operators_test_select_3060
SELECT user_id, total_amount
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3061
SELECT user_id, SUM(CAST(amount_str AS INT64)) as total_amount
FROM transactions
GROUP BY user_id
) as user_totals
WHERE total_amount > 300
ORDER BY total_amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_3062
SELECT name, age, score, grade FROM target ORDER BY score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3063
SELECT id,
CAST(year_str AS INT64) as year,
amount,
ROW_NUMBER() OVER (PARTITION BY CAST(year_str AS INT64) ORDER BY amount DESC) as rank
FROM sales
ORDER BY year, rank;
-- Tag: window_functions_window_functions_operators_test_select_3064
SELECT name, dept, salary,
ROW_NUMBER() OVER (
PARTITION BY dept
ORDER BY CASE WHEN salary > 75000 THEN salary ELSE 0 END DESC
) as priority_rank
FROM employees
ORDER BY dept, priority_rank;
-- Tag: window_functions_window_functions_operators_test_select_3065
SELECT category, SUM(CAST(value AS INT64)) as total
FROM data
GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_3066
SELECT CASE WHEN flag THEN 'yes' ELSE 42 END as mixed FROM data;

DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer STRING, status STRING, amount FLOAT64);
INSERT INTO orders VALUES
('Alice', 'completed', 100.0),
('Alice', 'cancelled', 50.0),
('Alice', 'completed', 200.0),
('Bob', 'completed', 150.0),
('Bob', 'cancelled', 200.0),
('Charlie', 'completed', 300.0);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (student STRING, subject STRING, score INT64);
INSERT INTO scores VALUES
('Alice', 'Math', 90), ('Alice', 'English', 85),
('Bob', 'Math', 75), ('Bob', 'English', 95),
('Charlie', 'Math', 60), ('Charlie', 'English', 70);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64, c STRING);
INSERT INTO data VALUES
(1, 10, 20, '5'),
(2, NULL, 30, '10'),
(3, 40, NULL, '15'),
(4, 50, 60, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10), ('A', 20),
(NULL, 30), (NULL, 40),
('B', 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, int_val INT64, float_val FLOAT64, str_val STRING);
INSERT INTO data VALUES (1, 10, 2.5, '5');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL, int_val INT64, float_val FLOAT64);
INSERT INTO data VALUES (1, true, 10, 3.5), (2, false, 20, 4.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 100), (2, 'A', 200), (3, 'B', 150),
(4, 'B', 250), (5, 'C', 300);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (user_id INT64, amount_str STRING);
INSERT INTO transactions VALUES
(1, '100'), (1, '200'), (2, '150'), (2, '250'), (2, '100');
DROP TABLE IF EXISTS source;
CREATE TABLE source (name STRING, age_str STRING, score_str STRING);
DROP TABLE IF EXISTS target;
CREATE TABLE target (name STRING, age INT64, score FLOAT64, grade STRING);
INSERT INTO source VALUES
('Alice', '25', '85.5'),
('Bob', '30', '92.0'),
('Charlie', '22', '78.5');
INSERT INTO target (name, age, score, grade)
-- Tag: window_functions_window_functions_operators_test_select_3067
SELECT name,
CAST(age_str AS INT64),
CAST(score_str AS FLOAT64),
CASE
WHEN CAST(score_str AS FLOAT64) >= 90 THEN 'A'
WHEN CAST(score_str AS FLOAT64) >= 80 THEN 'B'
ELSE 'C'
END
FROM source;
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, year_str STRING, amount FLOAT64);
INSERT INTO sales VALUES
(1, '2023', 100.0), (2, '2023', 200.0),
(3, '2024', 150.0), (4, '2024', 250.0), (5, '2024', 300.0);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept STRING, salary INT64);
INSERT INTO employees VALUES
(1, 'Alice', 'Eng', 80000),
(2, 'Bob', 'Sales', 70000),
(3, 'Charlie', 'Eng', 90000),
(4, 'David', 'Sales', 75000);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value STRING);
INSERT INTO data VALUES ('A', 'abc'), ('B', '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, true), (2, false);

-- Tag: window_functions_window_functions_operators_test_select_3068
SELECT customer,
SUM(CASE WHEN status = 'completed' THEN amount ELSE 0 END) as completed_total,
SUM(CASE WHEN status = 'cancelled' THEN amount ELSE 0 END) as cancelled_total,
COUNT(*) as order_count
FROM orders
GROUP BY customer
HAVING SUM(CASE WHEN status = 'completed' THEN amount ELSE 0 END) > 100
ORDER BY completed_total DESC;
-- Tag: window_functions_window_functions_operators_test_select_3069
SELECT student,
AVG(score) as avg_score,
CASE
WHEN AVG(score) >= 85 THEN 'A'
WHEN AVG(score) >= 75 THEN 'B'
WHEN AVG(score) >= 65 THEN 'C'
ELSE 'F'
END as grade
FROM scores
GROUP BY student
ORDER BY avg_score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3070
SELECT id,
a + b as sum,
a * b as product,
CAST(c AS INT64) as c_int,
COALESCE(a, 0) + COALESCE(b, 0) as coalesced_sum
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3071
SELECT category, COUNT(*) as count, SUM(value) as total
FROM data
GROUP BY category
ORDER BY category NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_3072
SELECT (int_val + float_val) * CAST(str_val AS FLOAT64) as complex_result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_3073
SELECT id,
CASE WHEN flag THEN int_val ELSE float_val END as mixed_result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3074
SELECT category, avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3075
SELECT category, AVG(value) as avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3076
SELECT category, value
FROM data
WHERE value > 100
) as filtered
GROUP BY category
) as averaged
WHERE avg_value > 150
ORDER BY avg_value DESC;
-- Tag: window_functions_window_functions_operators_test_select_3077
SELECT user_id, total_amount
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3078
SELECT user_id, SUM(CAST(amount_str AS INT64)) as total_amount
FROM transactions
GROUP BY user_id
) as user_totals
WHERE total_amount > 300
ORDER BY total_amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_3079
SELECT name, age, score, grade FROM target ORDER BY score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3080
SELECT id,
CAST(year_str AS INT64) as year,
amount,
ROW_NUMBER() OVER (PARTITION BY CAST(year_str AS INT64) ORDER BY amount DESC) as rank
FROM sales
ORDER BY year, rank;
-- Tag: window_functions_window_functions_operators_test_select_3081
SELECT name, dept, salary,
ROW_NUMBER() OVER (
PARTITION BY dept
ORDER BY CASE WHEN salary > 75000 THEN salary ELSE 0 END DESC
) as priority_rank
FROM employees
ORDER BY dept, priority_rank;
-- Tag: window_functions_window_functions_operators_test_select_3082
SELECT category, SUM(CAST(value AS INT64)) as total
FROM data
GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_3083
SELECT CASE WHEN flag THEN 'yes' ELSE 42 END as mixed FROM data;

DROP TABLE IF EXISTS scores;
CREATE TABLE scores (student STRING, subject STRING, score INT64);
INSERT INTO scores VALUES
('Alice', 'Math', 90), ('Alice', 'English', 85),
('Bob', 'Math', 75), ('Bob', 'English', 95),
('Charlie', 'Math', 60), ('Charlie', 'English', 70);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64, c STRING);
INSERT INTO data VALUES
(1, 10, 20, '5'),
(2, NULL, 30, '10'),
(3, 40, NULL, '15'),
(4, 50, 60, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10), ('A', 20),
(NULL, 30), (NULL, 40),
('B', 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, int_val INT64, float_val FLOAT64, str_val STRING);
INSERT INTO data VALUES (1, 10, 2.5, '5');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL, int_val INT64, float_val FLOAT64);
INSERT INTO data VALUES (1, true, 10, 3.5), (2, false, 20, 4.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 100), (2, 'A', 200), (3, 'B', 150),
(4, 'B', 250), (5, 'C', 300);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (user_id INT64, amount_str STRING);
INSERT INTO transactions VALUES
(1, '100'), (1, '200'), (2, '150'), (2, '250'), (2, '100');
DROP TABLE IF EXISTS source;
CREATE TABLE source (name STRING, age_str STRING, score_str STRING);
DROP TABLE IF EXISTS target;
CREATE TABLE target (name STRING, age INT64, score FLOAT64, grade STRING);
INSERT INTO source VALUES
('Alice', '25', '85.5'),
('Bob', '30', '92.0'),
('Charlie', '22', '78.5');
INSERT INTO target (name, age, score, grade)
-- Tag: window_functions_window_functions_operators_test_select_3084
SELECT name,
CAST(age_str AS INT64),
CAST(score_str AS FLOAT64),
CASE
WHEN CAST(score_str AS FLOAT64) >= 90 THEN 'A'
WHEN CAST(score_str AS FLOAT64) >= 80 THEN 'B'
ELSE 'C'
END
FROM source;
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, year_str STRING, amount FLOAT64);
INSERT INTO sales VALUES
(1, '2023', 100.0), (2, '2023', 200.0),
(3, '2024', 150.0), (4, '2024', 250.0), (5, '2024', 300.0);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept STRING, salary INT64);
INSERT INTO employees VALUES
(1, 'Alice', 'Eng', 80000),
(2, 'Bob', 'Sales', 70000),
(3, 'Charlie', 'Eng', 90000),
(4, 'David', 'Sales', 75000);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value STRING);
INSERT INTO data VALUES ('A', 'abc'), ('B', '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, true), (2, false);

-- Tag: window_functions_window_functions_operators_test_select_3085
SELECT student,
AVG(score) as avg_score,
CASE
WHEN AVG(score) >= 85 THEN 'A'
WHEN AVG(score) >= 75 THEN 'B'
WHEN AVG(score) >= 65 THEN 'C'
ELSE 'F'
END as grade
FROM scores
GROUP BY student
ORDER BY avg_score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3086
SELECT id,
a + b as sum,
a * b as product,
CAST(c AS INT64) as c_int,
COALESCE(a, 0) + COALESCE(b, 0) as coalesced_sum
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3087
SELECT category, COUNT(*) as count, SUM(value) as total
FROM data
GROUP BY category
ORDER BY category NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_3088
SELECT (int_val + float_val) * CAST(str_val AS FLOAT64) as complex_result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_3089
SELECT id,
CASE WHEN flag THEN int_val ELSE float_val END as mixed_result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3090
SELECT category, avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3091
SELECT category, AVG(value) as avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3092
SELECT category, value
FROM data
WHERE value > 100
) as filtered
GROUP BY category
) as averaged
WHERE avg_value > 150
ORDER BY avg_value DESC;
-- Tag: window_functions_window_functions_operators_test_select_3093
SELECT user_id, total_amount
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3094
SELECT user_id, SUM(CAST(amount_str AS INT64)) as total_amount
FROM transactions
GROUP BY user_id
) as user_totals
WHERE total_amount > 300
ORDER BY total_amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_3095
SELECT name, age, score, grade FROM target ORDER BY score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3096
SELECT id,
CAST(year_str AS INT64) as year,
amount,
ROW_NUMBER() OVER (PARTITION BY CAST(year_str AS INT64) ORDER BY amount DESC) as rank
FROM sales
ORDER BY year, rank;
-- Tag: window_functions_window_functions_operators_test_select_3097
SELECT name, dept, salary,
ROW_NUMBER() OVER (
PARTITION BY dept
ORDER BY CASE WHEN salary > 75000 THEN salary ELSE 0 END DESC
) as priority_rank
FROM employees
ORDER BY dept, priority_rank;
-- Tag: window_functions_window_functions_operators_test_select_3098
SELECT category, SUM(CAST(value AS INT64)) as total
FROM data
GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_3099
SELECT CASE WHEN flag THEN 'yes' ELSE 42 END as mixed FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64, c STRING);
INSERT INTO data VALUES
(1, 10, 20, '5'),
(2, NULL, 30, '10'),
(3, 40, NULL, '15'),
(4, 50, 60, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10), ('A', 20),
(NULL, 30), (NULL, 40),
('B', 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, int_val INT64, float_val FLOAT64, str_val STRING);
INSERT INTO data VALUES (1, 10, 2.5, '5');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL, int_val INT64, float_val FLOAT64);
INSERT INTO data VALUES (1, true, 10, 3.5), (2, false, 20, 4.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 100), (2, 'A', 200), (3, 'B', 150),
(4, 'B', 250), (5, 'C', 300);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (user_id INT64, amount_str STRING);
INSERT INTO transactions VALUES
(1, '100'), (1, '200'), (2, '150'), (2, '250'), (2, '100');
DROP TABLE IF EXISTS source;
CREATE TABLE source (name STRING, age_str STRING, score_str STRING);
DROP TABLE IF EXISTS target;
CREATE TABLE target (name STRING, age INT64, score FLOAT64, grade STRING);
INSERT INTO source VALUES
('Alice', '25', '85.5'),
('Bob', '30', '92.0'),
('Charlie', '22', '78.5');
INSERT INTO target (name, age, score, grade)
-- Tag: window_functions_window_functions_operators_test_select_3100
SELECT name,
CAST(age_str AS INT64),
CAST(score_str AS FLOAT64),
CASE
WHEN CAST(score_str AS FLOAT64) >= 90 THEN 'A'
WHEN CAST(score_str AS FLOAT64) >= 80 THEN 'B'
ELSE 'C'
END
FROM source;
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, year_str STRING, amount FLOAT64);
INSERT INTO sales VALUES
(1, '2023', 100.0), (2, '2023', 200.0),
(3, '2024', 150.0), (4, '2024', 250.0), (5, '2024', 300.0);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept STRING, salary INT64);
INSERT INTO employees VALUES
(1, 'Alice', 'Eng', 80000),
(2, 'Bob', 'Sales', 70000),
(3, 'Charlie', 'Eng', 90000),
(4, 'David', 'Sales', 75000);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value STRING);
INSERT INTO data VALUES ('A', 'abc'), ('B', '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, true), (2, false);

-- Tag: window_functions_window_functions_operators_test_select_3101
SELECT id,
a + b as sum,
a * b as product,
CAST(c AS INT64) as c_int,
COALESCE(a, 0) + COALESCE(b, 0) as coalesced_sum
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3102
SELECT category, COUNT(*) as count, SUM(value) as total
FROM data
GROUP BY category
ORDER BY category NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_3103
SELECT (int_val + float_val) * CAST(str_val AS FLOAT64) as complex_result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_3104
SELECT id,
CASE WHEN flag THEN int_val ELSE float_val END as mixed_result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3105
SELECT category, avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3106
SELECT category, AVG(value) as avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3107
SELECT category, value
FROM data
WHERE value > 100
) as filtered
GROUP BY category
) as averaged
WHERE avg_value > 150
ORDER BY avg_value DESC;
-- Tag: window_functions_window_functions_operators_test_select_3108
SELECT user_id, total_amount
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3109
SELECT user_id, SUM(CAST(amount_str AS INT64)) as total_amount
FROM transactions
GROUP BY user_id
) as user_totals
WHERE total_amount > 300
ORDER BY total_amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_3110
SELECT name, age, score, grade FROM target ORDER BY score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3111
SELECT id,
CAST(year_str AS INT64) as year,
amount,
ROW_NUMBER() OVER (PARTITION BY CAST(year_str AS INT64) ORDER BY amount DESC) as rank
FROM sales
ORDER BY year, rank;
-- Tag: window_functions_window_functions_operators_test_select_3112
SELECT name, dept, salary,
ROW_NUMBER() OVER (
PARTITION BY dept
ORDER BY CASE WHEN salary > 75000 THEN salary ELSE 0 END DESC
) as priority_rank
FROM employees
ORDER BY dept, priority_rank;
-- Tag: window_functions_window_functions_operators_test_select_3113
SELECT category, SUM(CAST(value AS INT64)) as total
FROM data
GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_3114
SELECT CASE WHEN flag THEN 'yes' ELSE 42 END as mixed FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10), ('A', 20),
(NULL, 30), (NULL, 40),
('B', 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, int_val INT64, float_val FLOAT64, str_val STRING);
INSERT INTO data VALUES (1, 10, 2.5, '5');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL, int_val INT64, float_val FLOAT64);
INSERT INTO data VALUES (1, true, 10, 3.5), (2, false, 20, 4.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 100), (2, 'A', 200), (3, 'B', 150),
(4, 'B', 250), (5, 'C', 300);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (user_id INT64, amount_str STRING);
INSERT INTO transactions VALUES
(1, '100'), (1, '200'), (2, '150'), (2, '250'), (2, '100');
DROP TABLE IF EXISTS source;
CREATE TABLE source (name STRING, age_str STRING, score_str STRING);
DROP TABLE IF EXISTS target;
CREATE TABLE target (name STRING, age INT64, score FLOAT64, grade STRING);
INSERT INTO source VALUES
('Alice', '25', '85.5'),
('Bob', '30', '92.0'),
('Charlie', '22', '78.5');
INSERT INTO target (name, age, score, grade)
-- Tag: window_functions_window_functions_operators_test_select_3115
SELECT name,
CAST(age_str AS INT64),
CAST(score_str AS FLOAT64),
CASE
WHEN CAST(score_str AS FLOAT64) >= 90 THEN 'A'
WHEN CAST(score_str AS FLOAT64) >= 80 THEN 'B'
ELSE 'C'
END
FROM source;
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, year_str STRING, amount FLOAT64);
INSERT INTO sales VALUES
(1, '2023', 100.0), (2, '2023', 200.0),
(3, '2024', 150.0), (4, '2024', 250.0), (5, '2024', 300.0);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept STRING, salary INT64);
INSERT INTO employees VALUES
(1, 'Alice', 'Eng', 80000),
(2, 'Bob', 'Sales', 70000),
(3, 'Charlie', 'Eng', 90000),
(4, 'David', 'Sales', 75000);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value STRING);
INSERT INTO data VALUES ('A', 'abc'), ('B', '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, true), (2, false);

-- Tag: window_functions_window_functions_operators_test_select_3116
SELECT category, COUNT(*) as count, SUM(value) as total
FROM data
GROUP BY category
ORDER BY category NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_3117
SELECT (int_val + float_val) * CAST(str_val AS FLOAT64) as complex_result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_3118
SELECT id,
CASE WHEN flag THEN int_val ELSE float_val END as mixed_result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3119
SELECT category, avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3120
SELECT category, AVG(value) as avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3121
SELECT category, value
FROM data
WHERE value > 100
) as filtered
GROUP BY category
) as averaged
WHERE avg_value > 150
ORDER BY avg_value DESC;
-- Tag: window_functions_window_functions_operators_test_select_3122
SELECT user_id, total_amount
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3123
SELECT user_id, SUM(CAST(amount_str AS INT64)) as total_amount
FROM transactions
GROUP BY user_id
) as user_totals
WHERE total_amount > 300
ORDER BY total_amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_3124
SELECT name, age, score, grade FROM target ORDER BY score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3125
SELECT id,
CAST(year_str AS INT64) as year,
amount,
ROW_NUMBER() OVER (PARTITION BY CAST(year_str AS INT64) ORDER BY amount DESC) as rank
FROM sales
ORDER BY year, rank;
-- Tag: window_functions_window_functions_operators_test_select_3126
SELECT name, dept, salary,
ROW_NUMBER() OVER (
PARTITION BY dept
ORDER BY CASE WHEN salary > 75000 THEN salary ELSE 0 END DESC
) as priority_rank
FROM employees
ORDER BY dept, priority_rank;
-- Tag: window_functions_window_functions_operators_test_select_3127
SELECT category, SUM(CAST(value AS INT64)) as total
FROM data
GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_3128
SELECT CASE WHEN flag THEN 'yes' ELSE 42 END as mixed FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, int_val INT64, float_val FLOAT64, str_val STRING);
INSERT INTO data VALUES (1, 10, 2.5, '5');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL, int_val INT64, float_val FLOAT64);
INSERT INTO data VALUES (1, true, 10, 3.5), (2, false, 20, 4.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 100), (2, 'A', 200), (3, 'B', 150),
(4, 'B', 250), (5, 'C', 300);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (user_id INT64, amount_str STRING);
INSERT INTO transactions VALUES
(1, '100'), (1, '200'), (2, '150'), (2, '250'), (2, '100');
DROP TABLE IF EXISTS source;
CREATE TABLE source (name STRING, age_str STRING, score_str STRING);
DROP TABLE IF EXISTS target;
CREATE TABLE target (name STRING, age INT64, score FLOAT64, grade STRING);
INSERT INTO source VALUES
('Alice', '25', '85.5'),
('Bob', '30', '92.0'),
('Charlie', '22', '78.5');
INSERT INTO target (name, age, score, grade)
-- Tag: window_functions_window_functions_operators_test_select_3129
SELECT name,
CAST(age_str AS INT64),
CAST(score_str AS FLOAT64),
CASE
WHEN CAST(score_str AS FLOAT64) >= 90 THEN 'A'
WHEN CAST(score_str AS FLOAT64) >= 80 THEN 'B'
ELSE 'C'
END
FROM source;
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, year_str STRING, amount FLOAT64);
INSERT INTO sales VALUES
(1, '2023', 100.0), (2, '2023', 200.0),
(3, '2024', 150.0), (4, '2024', 250.0), (5, '2024', 300.0);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept STRING, salary INT64);
INSERT INTO employees VALUES
(1, 'Alice', 'Eng', 80000),
(2, 'Bob', 'Sales', 70000),
(3, 'Charlie', 'Eng', 90000),
(4, 'David', 'Sales', 75000);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value STRING);
INSERT INTO data VALUES ('A', 'abc'), ('B', '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, true), (2, false);

-- Tag: window_functions_window_functions_operators_test_select_3130
SELECT (int_val + float_val) * CAST(str_val AS FLOAT64) as complex_result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_3131
SELECT id,
CASE WHEN flag THEN int_val ELSE float_val END as mixed_result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3132
SELECT category, avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3133
SELECT category, AVG(value) as avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3134
SELECT category, value
FROM data
WHERE value > 100
) as filtered
GROUP BY category
) as averaged
WHERE avg_value > 150
ORDER BY avg_value DESC;
-- Tag: window_functions_window_functions_operators_test_select_3135
SELECT user_id, total_amount
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3136
SELECT user_id, SUM(CAST(amount_str AS INT64)) as total_amount
FROM transactions
GROUP BY user_id
) as user_totals
WHERE total_amount > 300
ORDER BY total_amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_3137
SELECT name, age, score, grade FROM target ORDER BY score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3138
SELECT id,
CAST(year_str AS INT64) as year,
amount,
ROW_NUMBER() OVER (PARTITION BY CAST(year_str AS INT64) ORDER BY amount DESC) as rank
FROM sales
ORDER BY year, rank;
-- Tag: window_functions_window_functions_operators_test_select_3139
SELECT name, dept, salary,
ROW_NUMBER() OVER (
PARTITION BY dept
ORDER BY CASE WHEN salary > 75000 THEN salary ELSE 0 END DESC
) as priority_rank
FROM employees
ORDER BY dept, priority_rank;
-- Tag: window_functions_window_functions_operators_test_select_3140
SELECT category, SUM(CAST(value AS INT64)) as total
FROM data
GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_3141
SELECT CASE WHEN flag THEN 'yes' ELSE 42 END as mixed FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL, int_val INT64, float_val FLOAT64);
INSERT INTO data VALUES (1, true, 10, 3.5), (2, false, 20, 4.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 100), (2, 'A', 200), (3, 'B', 150),
(4, 'B', 250), (5, 'C', 300);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (user_id INT64, amount_str STRING);
INSERT INTO transactions VALUES
(1, '100'), (1, '200'), (2, '150'), (2, '250'), (2, '100');
DROP TABLE IF EXISTS source;
CREATE TABLE source (name STRING, age_str STRING, score_str STRING);
DROP TABLE IF EXISTS target;
CREATE TABLE target (name STRING, age INT64, score FLOAT64, grade STRING);
INSERT INTO source VALUES
('Alice', '25', '85.5'),
('Bob', '30', '92.0'),
('Charlie', '22', '78.5');
INSERT INTO target (name, age, score, grade)
-- Tag: window_functions_window_functions_operators_test_select_3142
SELECT name,
CAST(age_str AS INT64),
CAST(score_str AS FLOAT64),
CASE
WHEN CAST(score_str AS FLOAT64) >= 90 THEN 'A'
WHEN CAST(score_str AS FLOAT64) >= 80 THEN 'B'
ELSE 'C'
END
FROM source;
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, year_str STRING, amount FLOAT64);
INSERT INTO sales VALUES
(1, '2023', 100.0), (2, '2023', 200.0),
(3, '2024', 150.0), (4, '2024', 250.0), (5, '2024', 300.0);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept STRING, salary INT64);
INSERT INTO employees VALUES
(1, 'Alice', 'Eng', 80000),
(2, 'Bob', 'Sales', 70000),
(3, 'Charlie', 'Eng', 90000),
(4, 'David', 'Sales', 75000);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value STRING);
INSERT INTO data VALUES ('A', 'abc'), ('B', '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, true), (2, false);

-- Tag: window_functions_window_functions_operators_test_select_3143
SELECT id,
CASE WHEN flag THEN int_val ELSE float_val END as mixed_result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3144
SELECT category, avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3145
SELECT category, AVG(value) as avg_value
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3146
SELECT category, value
FROM data
WHERE value > 100
) as filtered
GROUP BY category
) as averaged
WHERE avg_value > 150
ORDER BY avg_value DESC;
-- Tag: window_functions_window_functions_operators_test_select_3147
SELECT user_id, total_amount
FROM (
-- Tag: window_functions_window_functions_operators_test_select_3148
SELECT user_id, SUM(CAST(amount_str AS INT64)) as total_amount
FROM transactions
GROUP BY user_id
) as user_totals
WHERE total_amount > 300
ORDER BY total_amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_3149
SELECT name, age, score, grade FROM target ORDER BY score DESC;
-- Tag: window_functions_window_functions_operators_test_select_3150
SELECT id,
CAST(year_str AS INT64) as year,
amount,
ROW_NUMBER() OVER (PARTITION BY CAST(year_str AS INT64) ORDER BY amount DESC) as rank
FROM sales
ORDER BY year, rank;
-- Tag: window_functions_window_functions_operators_test_select_3151
SELECT name, dept, salary,
ROW_NUMBER() OVER (
PARTITION BY dept
ORDER BY CASE WHEN salary > 75000 THEN salary ELSE 0 END DESC
) as priority_rank
FROM employees
ORDER BY dept, priority_rank;
-- Tag: window_functions_window_functions_operators_test_select_3152
SELECT category, SUM(CAST(value AS INT64)) as total
FROM data
GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_3153
SELECT CASE WHEN flag THEN 'yes' ELSE 42 END as mixed FROM data;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept STRING, salary INT64);
INSERT INTO employees VALUES
(1, 'Alice', 'Eng', 80000),
(2, 'Bob', 'Sales', 70000),
(3, 'Charlie', 'Eng', 90000),
(4, 'David', 'Sales', 75000);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value STRING);
INSERT INTO data VALUES ('A', 'abc'), ('B', '123');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, true), (2, false);

-- Tag: window_functions_window_functions_operators_test_select_3154
SELECT name, dept, salary,
ROW_NUMBER() OVER (
PARTITION BY dept
ORDER BY CASE WHEN salary > 75000 THEN salary ELSE 0 END DESC
) as priority_rank
FROM employees
ORDER BY dept, priority_rank;
-- Tag: window_functions_window_functions_operators_test_select_3155
SELECT category, SUM(CAST(value AS INT64)) as total
FROM data
GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_3156
SELECT CASE WHEN flag THEN 'yes' ELSE 42 END as mixed FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, true), (2, false);

-- Tag: window_functions_window_functions_operators_test_select_3157
SELECT CASE WHEN flag THEN 'yes' ELSE 42 END as mixed FROM data;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('West', 50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('West', 50);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64);
INSERT INTO products VALUES ('widget', 10.0);
INSERT INTO products VALUES ('Widget', 15.0);
INSERT INTO products VALUES ('GADGET', 20.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, total FLOAT64, tax_rate FLOAT64);
INSERT INTO orders VALUES (1, 100.0, 0.1);
INSERT INTO orders VALUES (2, 200.0, 0.1);
INSERT INTO orders VALUES (3, 150.0, 0.2);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
INSERT INTO products VALUES (1, 5.0);
INSERT INTO products VALUES (2, 15.0);
INSERT INTO products VALUES (3, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('East', 'Widget', 100);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('East', 'Widget', 100);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10);
INSERT INTO test VALUES (20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('West', 50);
DROP TABLE IF EXISTS regions;
CREATE TABLE regions (id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region_id INT64, amount INT64);
INSERT INTO regions VALUES (1, 'East');
INSERT INTO sales VALUES (1, 100);

-- Tag: window_functions_window_functions_operators_test_select_038
SELECT
region,
SUM(amount) as total,
GROUPING(region) as is_aggregated
FROM sales
GROUP BY ROLLUP(region)
ORDER BY GROUPING(region), region NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_3158
SELECT region, SUM(amount) as total
FROM sales
GROUP BY ROLLUP(region)
HAVING GROUPING(region) = 1;
-- Tag: window_functions_window_functions_operators_test_select_3159
SELECT region, SUM(amount) as total, GROUPING(region) as grp
FROM sales
GROUP BY ROLLUP(region)
ORDER BY GROUPING(region) DESC, region NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_3160
SELECT UPPER(name) as name_upper, SUM(price) as total
FROM products
GROUP BY UPPER(name)
ORDER BY name_upper;
-- Tag: window_functions_window_functions_operators_test_select_3161
SELECT tax_rate, COUNT(*) as cnt
FROM orders
GROUP BY tax_rate
ORDER BY tax_rate;
-- Tag: window_functions_window_functions_operators_test_select_039
SELECT
CASE
WHEN price < 10 THEN 'Cheap'
WHEN price < 30 THEN 'Medium'
ELSE 'Expensive'
END as price_range,
COUNT(*) as cnt
FROM products
GROUP BY CASE
WHEN price < 10 THEN 'Cheap'
WHEN price < 30 THEN 'Medium'
ELSE 'Expensive'
END;
-- Tag: window_functions_window_functions_operators_test_select_3162
SELECT region, product, SUM(amount) as total
FROM sales
GROUP BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_3163
SELECT region, SUM(amount) as total
FROM sales
GROUP BY ROLLUP(region)
ORDER BY region NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_3164
SELECT region, product, SUM(amount) as total
FROM sales
GROUP BY CUBE(region, product);
-- Tag: window_functions_window_functions_operators_test_select_3165
SELECT COUNT(*) as cnt, SUM(value) as total
FROM test
GROUP BY GROUPING SETS (());
-- Tag: window_functions_window_functions_operators_test_select_3166
SELECT col1, SUM(col1) FROM test GROUP BY ROLLUP(nonexistent);
-- Tag: window_functions_window_functions_operators_test_select_3167
SELECT col1, SUM(col2) as total
FROM test
GROUP BY GROUPING SETS ((col1), (col1));
-- Tag: window_functions_window_functions_operators_test_select_040
SELECT
region,
SUM(amount) as total,
SUM(SUM(amount)) OVER () as grand_total
FROM sales
GROUP BY ROLLUP(region);
-- Tag: window_functions_window_functions_operators_test_select_3168
SELECT r.name, SUM(s.amount) as total
FROM regions r
JOIN sales s ON r.id = s.region_id
GROUP BY CUBE(r.name);

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('West', 50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('West', 50);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64);
INSERT INTO products VALUES ('widget', 10.0);
INSERT INTO products VALUES ('Widget', 15.0);
INSERT INTO products VALUES ('GADGET', 20.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, total FLOAT64, tax_rate FLOAT64);
INSERT INTO orders VALUES (1, 100.0, 0.1);
INSERT INTO orders VALUES (2, 200.0, 0.1);
INSERT INTO orders VALUES (3, 150.0, 0.2);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
INSERT INTO products VALUES (1, 5.0);
INSERT INTO products VALUES (2, 15.0);
INSERT INTO products VALUES (3, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('East', 'Widget', 100);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('East', 'Widget', 100);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10);
INSERT INTO test VALUES (20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('West', 50);
DROP TABLE IF EXISTS regions;
CREATE TABLE regions (id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region_id INT64, amount INT64);
INSERT INTO regions VALUES (1, 'East');
INSERT INTO sales VALUES (1, 100);

-- Tag: window_functions_window_functions_operators_test_select_3169
SELECT region, SUM(amount) as total
FROM sales
GROUP BY ROLLUP(region)
HAVING GROUPING(region) = 1;
-- Tag: window_functions_window_functions_operators_test_select_3170
SELECT region, SUM(amount) as total, GROUPING(region) as grp
FROM sales
GROUP BY ROLLUP(region)
ORDER BY GROUPING(region) DESC, region NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_3171
SELECT UPPER(name) as name_upper, SUM(price) as total
FROM products
GROUP BY UPPER(name)
ORDER BY name_upper;
-- Tag: window_functions_window_functions_operators_test_select_3172
SELECT tax_rate, COUNT(*) as cnt
FROM orders
GROUP BY tax_rate
ORDER BY tax_rate;
-- Tag: window_functions_window_functions_operators_test_select_041
SELECT
CASE
WHEN price < 10 THEN 'Cheap'
WHEN price < 30 THEN 'Medium'
ELSE 'Expensive'
END as price_range,
COUNT(*) as cnt
FROM products
GROUP BY CASE
WHEN price < 10 THEN 'Cheap'
WHEN price < 30 THEN 'Medium'
ELSE 'Expensive'
END;
-- Tag: window_functions_window_functions_operators_test_select_3173
SELECT region, product, SUM(amount) as total
FROM sales
GROUP BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_3174
SELECT region, SUM(amount) as total
FROM sales
GROUP BY ROLLUP(region)
ORDER BY region NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_3175
SELECT region, product, SUM(amount) as total
FROM sales
GROUP BY CUBE(region, product);
-- Tag: window_functions_window_functions_operators_test_select_3176
SELECT COUNT(*) as cnt, SUM(value) as total
FROM test
GROUP BY GROUPING SETS (());
-- Tag: window_functions_window_functions_operators_test_select_3177
SELECT col1, SUM(col1) FROM test GROUP BY ROLLUP(nonexistent);
-- Tag: window_functions_window_functions_operators_test_select_3178
SELECT col1, SUM(col2) as total
FROM test
GROUP BY GROUPING SETS ((col1), (col1));
-- Tag: window_functions_window_functions_operators_test_select_042
SELECT
region,
SUM(amount) as total,
SUM(SUM(amount)) OVER () as grand_total
FROM sales
GROUP BY ROLLUP(region);
-- Tag: window_functions_window_functions_operators_test_select_3179
SELECT r.name, SUM(s.amount) as total
FROM regions r
JOIN sales s ON r.id = s.region_id
GROUP BY CUBE(r.name);

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('West', 50);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64);
INSERT INTO products VALUES ('widget', 10.0);
INSERT INTO products VALUES ('Widget', 15.0);
INSERT INTO products VALUES ('GADGET', 20.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, total FLOAT64, tax_rate FLOAT64);
INSERT INTO orders VALUES (1, 100.0, 0.1);
INSERT INTO orders VALUES (2, 200.0, 0.1);
INSERT INTO orders VALUES (3, 150.0, 0.2);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
INSERT INTO products VALUES (1, 5.0);
INSERT INTO products VALUES (2, 15.0);
INSERT INTO products VALUES (3, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('East', 'Widget', 100);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('East', 'Widget', 100);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10);
INSERT INTO test VALUES (20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('West', 50);
DROP TABLE IF EXISTS regions;
CREATE TABLE regions (id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region_id INT64, amount INT64);
INSERT INTO regions VALUES (1, 'East');
INSERT INTO sales VALUES (1, 100);

-- Tag: window_functions_window_functions_operators_test_select_3180
SELECT region, SUM(amount) as total, GROUPING(region) as grp
FROM sales
GROUP BY ROLLUP(region)
ORDER BY GROUPING(region) DESC, region NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_3181
SELECT UPPER(name) as name_upper, SUM(price) as total
FROM products
GROUP BY UPPER(name)
ORDER BY name_upper;
-- Tag: window_functions_window_functions_operators_test_select_3182
SELECT tax_rate, COUNT(*) as cnt
FROM orders
GROUP BY tax_rate
ORDER BY tax_rate;
-- Tag: window_functions_window_functions_operators_test_select_043
SELECT
CASE
WHEN price < 10 THEN 'Cheap'
WHEN price < 30 THEN 'Medium'
ELSE 'Expensive'
END as price_range,
COUNT(*) as cnt
FROM products
GROUP BY CASE
WHEN price < 10 THEN 'Cheap'
WHEN price < 30 THEN 'Medium'
ELSE 'Expensive'
END;
-- Tag: window_functions_window_functions_operators_test_select_3183
SELECT region, product, SUM(amount) as total
FROM sales
GROUP BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_3184
SELECT region, SUM(amount) as total
FROM sales
GROUP BY ROLLUP(region)
ORDER BY region NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_3185
SELECT region, product, SUM(amount) as total
FROM sales
GROUP BY CUBE(region, product);
-- Tag: window_functions_window_functions_operators_test_select_3186
SELECT COUNT(*) as cnt, SUM(value) as total
FROM test
GROUP BY GROUPING SETS (());
-- Tag: window_functions_window_functions_operators_test_select_3187
SELECT col1, SUM(col1) FROM test GROUP BY ROLLUP(nonexistent);
-- Tag: window_functions_window_functions_operators_test_select_3188
SELECT col1, SUM(col2) as total
FROM test
GROUP BY GROUPING SETS ((col1), (col1));
-- Tag: window_functions_window_functions_operators_test_select_044
SELECT
region,
SUM(amount) as total,
SUM(SUM(amount)) OVER () as grand_total
FROM sales
GROUP BY ROLLUP(region);
-- Tag: window_functions_window_functions_operators_test_select_3189
SELECT r.name, SUM(s.amount) as total
FROM regions r
JOIN sales s ON r.id = s.region_id
GROUP BY CUBE(r.name);

DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
INSERT INTO products VALUES (1, 5.0);
INSERT INTO products VALUES (2, 15.0);
INSERT INTO products VALUES (3, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('East', 'Widget', 100);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('East', 'Widget', 100);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10);
INSERT INTO test VALUES (20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('West', 50);
DROP TABLE IF EXISTS regions;
CREATE TABLE regions (id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region_id INT64, amount INT64);
INSERT INTO regions VALUES (1, 'East');
INSERT INTO sales VALUES (1, 100);

-- Tag: window_functions_window_functions_operators_test_select_045
SELECT
CASE
WHEN price < 10 THEN 'Cheap'
WHEN price < 30 THEN 'Medium'
ELSE 'Expensive'
END as price_range,
COUNT(*) as cnt
FROM products
GROUP BY CASE
WHEN price < 10 THEN 'Cheap'
WHEN price < 30 THEN 'Medium'
ELSE 'Expensive'
END;
-- Tag: window_functions_window_functions_operators_test_select_3190
SELECT region, product, SUM(amount) as total
FROM sales
GROUP BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_3191
SELECT region, SUM(amount) as total
FROM sales
GROUP BY ROLLUP(region)
ORDER BY region NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_3192
SELECT region, product, SUM(amount) as total
FROM sales
GROUP BY CUBE(region, product);
-- Tag: window_functions_window_functions_operators_test_select_3193
SELECT COUNT(*) as cnt, SUM(value) as total
FROM test
GROUP BY GROUPING SETS (());
-- Tag: window_functions_window_functions_operators_test_select_3194
SELECT col1, SUM(col1) FROM test GROUP BY ROLLUP(nonexistent);
-- Tag: window_functions_window_functions_operators_test_select_3195
SELECT col1, SUM(col2) as total
FROM test
GROUP BY GROUPING SETS ((col1), (col1));
-- Tag: window_functions_window_functions_operators_test_select_046
SELECT
region,
SUM(amount) as total,
SUM(SUM(amount)) OVER () as grand_total
FROM sales
GROUP BY ROLLUP(region);
-- Tag: window_functions_window_functions_operators_test_select_3196
SELECT r.name, SUM(s.amount) as total
FROM regions r
JOIN sales s ON r.id = s.region_id
GROUP BY CUBE(r.name);

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('East', 'Widget', 100);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10);
INSERT INTO test VALUES (20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('West', 50);
DROP TABLE IF EXISTS regions;
CREATE TABLE regions (id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region_id INT64, amount INT64);
INSERT INTO regions VALUES (1, 'East');
INSERT INTO sales VALUES (1, 100);

-- Tag: window_functions_window_functions_operators_test_select_3197
SELECT region, SUM(amount) as total
FROM sales
GROUP BY ROLLUP(region)
ORDER BY region NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_3198
SELECT region, product, SUM(amount) as total
FROM sales
GROUP BY CUBE(region, product);
-- Tag: window_functions_window_functions_operators_test_select_3199
SELECT COUNT(*) as cnt, SUM(value) as total
FROM test
GROUP BY GROUPING SETS (());
-- Tag: window_functions_window_functions_operators_test_select_3200
SELECT col1, SUM(col1) FROM test GROUP BY ROLLUP(nonexistent);
-- Tag: window_functions_window_functions_operators_test_select_3201
SELECT col1, SUM(col2) as total
FROM test
GROUP BY GROUPING SETS ((col1), (col1));
-- Tag: window_functions_window_functions_operators_test_select_047
SELECT
region,
SUM(amount) as total,
SUM(SUM(amount)) OVER () as grand_total
FROM sales
GROUP BY ROLLUP(region);
-- Tag: window_functions_window_functions_operators_test_select_3202
SELECT r.name, SUM(s.amount) as total
FROM regions r
JOIN sales s ON r.id = s.region_id
GROUP BY CUBE(r.name);

DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('West', 50);
DROP TABLE IF EXISTS regions;
CREATE TABLE regions (id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region_id INT64, amount INT64);
INSERT INTO regions VALUES (1, 'East');
INSERT INTO sales VALUES (1, 100);

-- Tag: window_functions_window_functions_operators_test_select_3203
SELECT col1, SUM(col1) FROM test GROUP BY ROLLUP(nonexistent);
-- Tag: window_functions_window_functions_operators_test_select_3204
SELECT col1, SUM(col2) as total
FROM test
GROUP BY GROUPING SETS ((col1), (col1));
-- Tag: window_functions_window_functions_operators_test_select_048
SELECT
region,
SUM(amount) as total,
SUM(SUM(amount)) OVER () as grand_total
FROM sales
GROUP BY ROLLUP(region);
-- Tag: window_functions_window_functions_operators_test_select_3205
SELECT r.name, SUM(s.amount) as total
FROM regions r
JOIN sales s ON r.id = s.region_id
GROUP BY CUBE(r.name);

DROP TABLE IF EXISTS data;
CREATE TABLE data (region STRING, amount INT64);
INSERT INTO data VALUES
('East', 100),
(NULL, 50),
('West', 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES
('East', 'X', 100),
('East', 'Y', 150),
('West', 'X', 200),
('West', 'Y', 120);
DROP TABLE IF EXISTS multi_dim;
CREATE TABLE multi_dim ( region STRING, category STRING, year INT64, revenue INT64 );
INSERT INTO multi_dim VALUES
('East', 'A', 2024, 1000),
('West', 'B', 2024, 2000);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING, count INT64);
INSERT INTO items VALUES ('A', 10), ('B', 20);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( region STRING, product STRING, quarter INT64, amount INT64 );
INSERT INTO sales VALUES
('East', 'A', 1, 100),
('West', 'B', 2, 200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( region STRING, product STRING, amount INT64 );
INSERT INTO sales VALUES
('East', 'A', 100),
('East', 'B', 150),
('West', 'A', 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES
('East', 100),
('West', 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( region STRING, product STRING, amount INT64 );
INSERT INTO sales VALUES
('East', 'A', 100),
('West', 'B', 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES
('East', 100),
(NULL, 50);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (region STRING, customer STRING, amount INT64);
INSERT INTO orders VALUES
('East', 'Alice', 100),
('East', 'Alice', 150),
('East', 'Bob', 200),
('West', 'Alice', 100);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES
('East', 'A', 100),
('West', 'B', 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100), ('West', 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('East', 'A', 100);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data ( a STRING, b STRING, c STRING, d STRING, value INT64 );
INSERT INTO data VALUES
('a1', 'b1', 'c1', 'd1', 100);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);

-- Tag: window_functions_window_functions_operators_test_select_3206
SELECT region, SUM(amount) AS total
FROM data
GROUP BY ROLLUP(region);
-- Tag: window_functions_window_functions_operators_test_select_3207
SELECT region, product, SUM(amount) AS total
FROM sales
GROUP BY CUBE(region, product);
-- Tag: window_functions_window_functions_operators_test_select_3208
SELECT region, category, year, SUM(revenue) AS total
FROM multi_dim
GROUP BY CUBE(region, category, year);
-- Tag: window_functions_window_functions_operators_test_select_3209
SELECT category, SUM(count) AS total
FROM items
GROUP BY CUBE(category);
-- Tag: window_functions_window_functions_operators_test_select_3210
SELECT region, product, quarter, SUM(amount) AS total
FROM sales
GROUP BY GROUPING SETS (
(region, product),
(quarter),
()
);
-- Tag: window_functions_window_functions_operators_test_select_3211
SELECT SUM(value) AS total
FROM data
GROUP BY GROUPING SETS (());
-- Tag: window_functions_window_functions_operators_test_select_3212
SELECT region, product, SUM(amount) AS total
FROM sales
GROUP BY GROUPING SETS ((region), (product));
-- Tag: window_functions_window_functions_operators_test_select_049
SELECT
region,
SUM(amount) AS total,
GROUPING(region) AS is_total_row
FROM sales
GROUP BY ROLLUP(region)
ORDER BY GROUPING(region), region;
-- Tag: window_functions_window_functions_operators_test_select_050
SELECT
region,
product,
SUM(amount) AS total,
GROUPING(region) AS grp_region,
GROUPING(product) AS grp_product
FROM sales
GROUP BY ROLLUP(region, product);
-- Tag: window_functions_window_functions_operators_test_select_051
SELECT
region,
SUM(amount) AS total,
GROUPING(region) AS grp
FROM sales
GROUP BY ROLLUP(region);
-- Tag: window_functions_window_functions_operators_test_select_052
SELECT
region,
COUNT(DISTINCT customer) AS unique_customers,
SUM(amount) AS total
FROM orders
GROUP BY ROLLUP(region);
-- Tag: window_functions_window_functions_operators_test_select_053
SELECT
region,
product,
SUM(amount) AS total,
ROW_NUMBER() OVER (ORDER BY SUM(amount) DESC) AS rank
FROM sales
GROUP BY CUBE(region, product);
WITH regional_summary AS (
-- Tag: window_functions_window_functions_operators_test_select_3213
SELECT region, SUM(amount) AS total
FROM sales
GROUP BY GROUPING SETS ((region), ())
)
-- Tag: window_functions_window_functions_operators_test_select_3214
SELECT * FROM regional_summary
ORDER BY region NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_3215
SELECT region, SUM(amount), GROUPING(product)
FROM sales
GROUP BY region;
-- Tag: window_functions_window_functions_operators_test_select_3216
SELECT SUM(value) FROM data GROUP BY GROUPING SETS ();
-- Tag: window_functions_window_functions_operators_test_select_3217
SELECT a, b, c, d, SUM(value)
FROM data
GROUP BY CUBE(a, b, c, d);
-- Tag: window_functions_window_functions_operators_test_select_3218
SELECT region, product, SUM(amount) AS total
FROM sales
GROUP BY ROLLUP(region, product);

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES
('East', 100),
(NULL, 50);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (region STRING, customer STRING, amount INT64);
INSERT INTO orders VALUES
('East', 'Alice', 100),
('East', 'Alice', 150),
('East', 'Bob', 200),
('West', 'Alice', 100);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES
('East', 'A', 100),
('West', 'B', 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100), ('West', 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);
INSERT INTO sales VALUES ('East', 'A', 100);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data ( a STRING, b STRING, c STRING, d STRING, value INT64 );
INSERT INTO data VALUES
('a1', 'b1', 'c1', 'd1', 100);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount INT64);

-- Tag: window_functions_window_functions_operators_test_select_054
SELECT
region,
SUM(amount) AS total,
GROUPING(region) AS grp
FROM sales
GROUP BY ROLLUP(region);
-- Tag: window_functions_window_functions_operators_test_select_055
SELECT
region,
COUNT(DISTINCT customer) AS unique_customers,
SUM(amount) AS total
FROM orders
GROUP BY ROLLUP(region);
-- Tag: window_functions_window_functions_operators_test_select_056
SELECT
region,
product,
SUM(amount) AS total,
ROW_NUMBER() OVER (ORDER BY SUM(amount) DESC) AS rank
FROM sales
GROUP BY CUBE(region, product);
WITH regional_summary AS (
-- Tag: window_functions_window_functions_operators_test_select_3219
SELECT region, SUM(amount) AS total
FROM sales
GROUP BY GROUPING SETS ((region), ())
)
-- Tag: window_functions_window_functions_operators_test_select_3220
SELECT * FROM regional_summary
ORDER BY region NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_3221
SELECT region, SUM(amount), GROUPING(product)
FROM sales
GROUP BY region;
-- Tag: window_functions_window_functions_operators_test_select_3222
SELECT SUM(value) FROM data GROUP BY GROUPING SETS ();
-- Tag: window_functions_window_functions_operators_test_select_3223
SELECT a, b, c, d, SUM(value)
FROM data
GROUP BY CUBE(a, b, c, d);
-- Tag: window_functions_window_functions_operators_test_select_3224
SELECT region, product, SUM(amount) AS total
FROM sales
GROUP BY ROLLUP(region, product);

DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 100);
INSERT INTO data VALUES (2, 200);
INSERT INTO data VALUES (3, 300);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES (1, 'Alice');
INSERT INTO data VALUES (2, 'Bob');
INSERT INTO data VALUES (3, 'Charlie');
INSERT INTO data VALUES (4, 'David');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, price FLOAT64);
INSERT INTO data VALUES (1, 9.99);
INSERT INTO data VALUES (2, 19.99);
INSERT INTO data VALUES (3, 29.99);
INSERT INTO data VALUES (4, 39.99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 2);
INSERT INTO employees VALUES (3, 'Charlie', 3);
INSERT INTO employees VALUES (4, 'David', 4);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO active_depts VALUES (1);
INSERT INTO active_depts VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 100);
INSERT INTO data VALUES (2, 200);
INSERT INTO data VALUES (3, 300);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_values;
CREATE TABLE all_values (value INT64);
INSERT INTO all_values VALUES (10);
INSERT INTO all_values VALUES (20);
INSERT INTO all_values VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 20);
INSERT INTO data VALUES (2, 40);
INSERT INTO data VALUES (3, 60);
INSERT INTO data VALUES (4, 80);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (10);
INSERT INTO multipliers VALUES (20);
INSERT INTO multipliers VALUES (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 70000.0, 1);
INSERT INTO employees VALUES (2, 'Bob', 60000.0, 1);
INSERT INTO employees VALUES (3, 'Charlie', 80000.0, 2);
INSERT INTO employees VALUES (4, 'David', 90000.0, 2);
DROP TABLE IF EXISTS high_performers;
CREATE TABLE high_performers (emp_id INT64, dept_id INT64);
INSERT INTO high_performers VALUES (1, 1);
INSERT INTO high_performers VALUES (4, 2);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3225
SELECT id FROM numbers WHERE value IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3226
SELECT id FROM data WHERE value IN (200);
-- Tag: window_functions_window_functions_operators_test_select_3227
SELECT id FROM data WHERE name IN ('Alice', 'Charlie', 'Eve') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3228
SELECT id FROM data WHERE price IN (9.99, 29.99) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3229
SELECT id FROM data WHERE value IN (100, 200, 300);
-- Tag: window_functions_window_functions_operators_test_select_3230
SELECT id FROM data WHERE value IN (10, 20, 30) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3231
SELECT name FROM employees WHERE dept_id IN (SELECT dept_id FROM active_depts) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3232
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3233
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3234
SELECT id FROM data WHERE value IN (SELECT value FROM all_values) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3235
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3236
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3237
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3238
SELECT name FROM employees e WHERE e.id IN (SELECT emp_id FROM high_performers h WHERE h.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3239
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3240
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3241
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3242
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3243
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3244
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3245
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3246
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3247
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3248
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3249
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3250
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3251
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3252
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3253
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3254
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3255
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3256
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3257
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3258
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3259
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3260
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3261
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3262
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3263
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3264
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3265
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3266
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3267
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3268
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3269
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3270
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3271
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3272
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3273
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 100);
INSERT INTO data VALUES (2, 200);
INSERT INTO data VALUES (3, 300);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES (1, 'Alice');
INSERT INTO data VALUES (2, 'Bob');
INSERT INTO data VALUES (3, 'Charlie');
INSERT INTO data VALUES (4, 'David');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, price FLOAT64);
INSERT INTO data VALUES (1, 9.99);
INSERT INTO data VALUES (2, 19.99);
INSERT INTO data VALUES (3, 29.99);
INSERT INTO data VALUES (4, 39.99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 2);
INSERT INTO employees VALUES (3, 'Charlie', 3);
INSERT INTO employees VALUES (4, 'David', 4);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO active_depts VALUES (1);
INSERT INTO active_depts VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 100);
INSERT INTO data VALUES (2, 200);
INSERT INTO data VALUES (3, 300);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_values;
CREATE TABLE all_values (value INT64);
INSERT INTO all_values VALUES (10);
INSERT INTO all_values VALUES (20);
INSERT INTO all_values VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 20);
INSERT INTO data VALUES (2, 40);
INSERT INTO data VALUES (3, 60);
INSERT INTO data VALUES (4, 80);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (10);
INSERT INTO multipliers VALUES (20);
INSERT INTO multipliers VALUES (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 70000.0, 1);
INSERT INTO employees VALUES (2, 'Bob', 60000.0, 1);
INSERT INTO employees VALUES (3, 'Charlie', 80000.0, 2);
INSERT INTO employees VALUES (4, 'David', 90000.0, 2);
DROP TABLE IF EXISTS high_performers;
CREATE TABLE high_performers (emp_id INT64, dept_id INT64);
INSERT INTO high_performers VALUES (1, 1);
INSERT INTO high_performers VALUES (4, 2);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3274
SELECT id FROM data WHERE value IN (200);
-- Tag: window_functions_window_functions_operators_test_select_3275
SELECT id FROM data WHERE name IN ('Alice', 'Charlie', 'Eve') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3276
SELECT id FROM data WHERE price IN (9.99, 29.99) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3277
SELECT id FROM data WHERE value IN (100, 200, 300);
-- Tag: window_functions_window_functions_operators_test_select_3278
SELECT id FROM data WHERE value IN (10, 20, 30) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3279
SELECT name FROM employees WHERE dept_id IN (SELECT dept_id FROM active_depts) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3280
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3281
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3282
SELECT id FROM data WHERE value IN (SELECT value FROM all_values) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3283
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3284
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3285
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3286
SELECT name FROM employees e WHERE e.id IN (SELECT emp_id FROM high_performers h WHERE h.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3287
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3288
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3289
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3290
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3291
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3292
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3293
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3294
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3295
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3296
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3297
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3298
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3299
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3300
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3301
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3302
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3303
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3304
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3305
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3306
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3307
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3308
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3309
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3310
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3311
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3312
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3313
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3314
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3315
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3316
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3317
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3318
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3319
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3320
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3321
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, name STRING);
INSERT INTO data VALUES (1, 'Alice');
INSERT INTO data VALUES (2, 'Bob');
INSERT INTO data VALUES (3, 'Charlie');
INSERT INTO data VALUES (4, 'David');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, price FLOAT64);
INSERT INTO data VALUES (1, 9.99);
INSERT INTO data VALUES (2, 19.99);
INSERT INTO data VALUES (3, 29.99);
INSERT INTO data VALUES (4, 39.99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 2);
INSERT INTO employees VALUES (3, 'Charlie', 3);
INSERT INTO employees VALUES (4, 'David', 4);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO active_depts VALUES (1);
INSERT INTO active_depts VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 100);
INSERT INTO data VALUES (2, 200);
INSERT INTO data VALUES (3, 300);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_values;
CREATE TABLE all_values (value INT64);
INSERT INTO all_values VALUES (10);
INSERT INTO all_values VALUES (20);
INSERT INTO all_values VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 20);
INSERT INTO data VALUES (2, 40);
INSERT INTO data VALUES (3, 60);
INSERT INTO data VALUES (4, 80);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (10);
INSERT INTO multipliers VALUES (20);
INSERT INTO multipliers VALUES (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 70000.0, 1);
INSERT INTO employees VALUES (2, 'Bob', 60000.0, 1);
INSERT INTO employees VALUES (3, 'Charlie', 80000.0, 2);
INSERT INTO employees VALUES (4, 'David', 90000.0, 2);
DROP TABLE IF EXISTS high_performers;
CREATE TABLE high_performers (emp_id INT64, dept_id INT64);
INSERT INTO high_performers VALUES (1, 1);
INSERT INTO high_performers VALUES (4, 2);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3322
SELECT id FROM data WHERE name IN ('Alice', 'Charlie', 'Eve') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3323
SELECT id FROM data WHERE price IN (9.99, 29.99) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3324
SELECT id FROM data WHERE value IN (100, 200, 300);
-- Tag: window_functions_window_functions_operators_test_select_3325
SELECT id FROM data WHERE value IN (10, 20, 30) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3326
SELECT name FROM employees WHERE dept_id IN (SELECT dept_id FROM active_depts) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3327
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3328
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3329
SELECT id FROM data WHERE value IN (SELECT value FROM all_values) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3330
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3331
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3332
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3333
SELECT name FROM employees e WHERE e.id IN (SELECT emp_id FROM high_performers h WHERE h.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3334
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3335
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3336
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3337
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3338
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3339
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3340
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3341
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3342
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3343
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3344
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3345
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3346
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3347
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3348
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3349
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3350
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3351
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3352
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3353
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3354
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3355
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3356
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3357
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3358
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3359
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3360
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3361
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3362
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3363
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3364
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3365
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3366
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3367
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3368
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, price FLOAT64);
INSERT INTO data VALUES (1, 9.99);
INSERT INTO data VALUES (2, 19.99);
INSERT INTO data VALUES (3, 29.99);
INSERT INTO data VALUES (4, 39.99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 2);
INSERT INTO employees VALUES (3, 'Charlie', 3);
INSERT INTO employees VALUES (4, 'David', 4);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO active_depts VALUES (1);
INSERT INTO active_depts VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 100);
INSERT INTO data VALUES (2, 200);
INSERT INTO data VALUES (3, 300);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_values;
CREATE TABLE all_values (value INT64);
INSERT INTO all_values VALUES (10);
INSERT INTO all_values VALUES (20);
INSERT INTO all_values VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 20);
INSERT INTO data VALUES (2, 40);
INSERT INTO data VALUES (3, 60);
INSERT INTO data VALUES (4, 80);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (10);
INSERT INTO multipliers VALUES (20);
INSERT INTO multipliers VALUES (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 70000.0, 1);
INSERT INTO employees VALUES (2, 'Bob', 60000.0, 1);
INSERT INTO employees VALUES (3, 'Charlie', 80000.0, 2);
INSERT INTO employees VALUES (4, 'David', 90000.0, 2);
DROP TABLE IF EXISTS high_performers;
CREATE TABLE high_performers (emp_id INT64, dept_id INT64);
INSERT INTO high_performers VALUES (1, 1);
INSERT INTO high_performers VALUES (4, 2);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3369
SELECT id FROM data WHERE price IN (9.99, 29.99) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3370
SELECT id FROM data WHERE value IN (100, 200, 300);
-- Tag: window_functions_window_functions_operators_test_select_3371
SELECT id FROM data WHERE value IN (10, 20, 30) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3372
SELECT name FROM employees WHERE dept_id IN (SELECT dept_id FROM active_depts) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3373
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3374
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3375
SELECT id FROM data WHERE value IN (SELECT value FROM all_values) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3376
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3377
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3378
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3379
SELECT name FROM employees e WHERE e.id IN (SELECT emp_id FROM high_performers h WHERE h.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3380
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3381
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3382
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3383
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3384
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3385
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3386
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3387
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3388
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3389
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3390
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3391
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3392
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3393
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3394
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3395
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3396
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3397
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3398
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3399
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3400
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3401
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3402
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3403
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3404
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3405
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3406
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3407
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3408
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3409
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3410
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3411
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3412
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3413
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3414
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 2);
INSERT INTO employees VALUES (3, 'Charlie', 3);
INSERT INTO employees VALUES (4, 'David', 4);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO active_depts VALUES (1);
INSERT INTO active_depts VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 100);
INSERT INTO data VALUES (2, 200);
INSERT INTO data VALUES (3, 300);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_values;
CREATE TABLE all_values (value INT64);
INSERT INTO all_values VALUES (10);
INSERT INTO all_values VALUES (20);
INSERT INTO all_values VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 20);
INSERT INTO data VALUES (2, 40);
INSERT INTO data VALUES (3, 60);
INSERT INTO data VALUES (4, 80);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (10);
INSERT INTO multipliers VALUES (20);
INSERT INTO multipliers VALUES (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 70000.0, 1);
INSERT INTO employees VALUES (2, 'Bob', 60000.0, 1);
INSERT INTO employees VALUES (3, 'Charlie', 80000.0, 2);
INSERT INTO employees VALUES (4, 'David', 90000.0, 2);
DROP TABLE IF EXISTS high_performers;
CREATE TABLE high_performers (emp_id INT64, dept_id INT64);
INSERT INTO high_performers VALUES (1, 1);
INSERT INTO high_performers VALUES (4, 2);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3415
SELECT id FROM data WHERE value IN (100, 200, 300);
-- Tag: window_functions_window_functions_operators_test_select_3416
SELECT id FROM data WHERE value IN (10, 20, 30) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3417
SELECT name FROM employees WHERE dept_id IN (SELECT dept_id FROM active_depts) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3418
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3419
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3420
SELECT id FROM data WHERE value IN (SELECT value FROM all_values) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3421
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3422
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3423
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3424
SELECT name FROM employees e WHERE e.id IN (SELECT emp_id FROM high_performers h WHERE h.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3425
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3426
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3427
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3428
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3429
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3430
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3431
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3432
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3433
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3434
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3435
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3436
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3437
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3438
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3439
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3440
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3441
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3442
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3443
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3444
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3445
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3446
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3447
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3448
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3449
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3450
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3451
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3452
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3453
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3454
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3455
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3456
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3457
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3458
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3459
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 2);
INSERT INTO employees VALUES (3, 'Charlie', 3);
INSERT INTO employees VALUES (4, 'David', 4);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO active_depts VALUES (1);
INSERT INTO active_depts VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 100);
INSERT INTO data VALUES (2, 200);
INSERT INTO data VALUES (3, 300);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_values;
CREATE TABLE all_values (value INT64);
INSERT INTO all_values VALUES (10);
INSERT INTO all_values VALUES (20);
INSERT INTO all_values VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 20);
INSERT INTO data VALUES (2, 40);
INSERT INTO data VALUES (3, 60);
INSERT INTO data VALUES (4, 80);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (10);
INSERT INTO multipliers VALUES (20);
INSERT INTO multipliers VALUES (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 70000.0, 1);
INSERT INTO employees VALUES (2, 'Bob', 60000.0, 1);
INSERT INTO employees VALUES (3, 'Charlie', 80000.0, 2);
INSERT INTO employees VALUES (4, 'David', 90000.0, 2);
DROP TABLE IF EXISTS high_performers;
CREATE TABLE high_performers (emp_id INT64, dept_id INT64);
INSERT INTO high_performers VALUES (1, 1);
INSERT INTO high_performers VALUES (4, 2);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3460
SELECT id FROM data WHERE value IN (10, 20, 30) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3461
SELECT name FROM employees WHERE dept_id IN (SELECT dept_id FROM active_depts) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3462
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3463
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3464
SELECT id FROM data WHERE value IN (SELECT value FROM all_values) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3465
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3466
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3467
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3468
SELECT name FROM employees e WHERE e.id IN (SELECT emp_id FROM high_performers h WHERE h.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3469
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3470
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3471
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3472
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3473
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3474
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3475
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3476
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3477
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3478
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3479
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3480
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3481
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3482
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3483
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3484
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3485
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3486
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3487
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3488
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3489
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3490
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3491
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3492
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3493
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3494
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3495
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3496
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3497
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3498
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3499
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3500
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3501
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3502
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3503
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 2);
INSERT INTO employees VALUES (3, 'Charlie', 3);
INSERT INTO employees VALUES (4, 'David', 4);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO active_depts VALUES (1);
INSERT INTO active_depts VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 100);
INSERT INTO data VALUES (2, 200);
INSERT INTO data VALUES (3, 300);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_values;
CREATE TABLE all_values (value INT64);
INSERT INTO all_values VALUES (10);
INSERT INTO all_values VALUES (20);
INSERT INTO all_values VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 20);
INSERT INTO data VALUES (2, 40);
INSERT INTO data VALUES (3, 60);
INSERT INTO data VALUES (4, 80);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (10);
INSERT INTO multipliers VALUES (20);
INSERT INTO multipliers VALUES (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 70000.0, 1);
INSERT INTO employees VALUES (2, 'Bob', 60000.0, 1);
INSERT INTO employees VALUES (3, 'Charlie', 80000.0, 2);
INSERT INTO employees VALUES (4, 'David', 90000.0, 2);
DROP TABLE IF EXISTS high_performers;
CREATE TABLE high_performers (emp_id INT64, dept_id INT64);
INSERT INTO high_performers VALUES (1, 1);
INSERT INTO high_performers VALUES (4, 2);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3504
SELECT name FROM employees WHERE dept_id IN (SELECT dept_id FROM active_depts) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3505
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3506
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3507
SELECT id FROM data WHERE value IN (SELECT value FROM all_values) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3508
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3509
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3510
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3511
SELECT name FROM employees e WHERE e.id IN (SELECT emp_id FROM high_performers h WHERE h.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3512
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3513
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3514
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3515
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3516
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3517
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3518
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3519
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3520
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3521
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3522
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3523
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3524
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3525
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3526
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3527
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3528
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3529
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3530
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3531
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3532
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3533
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3534
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3535
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3536
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3537
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3538
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3539
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3540
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3541
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3542
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3543
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3544
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3545
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3546
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 100);
INSERT INTO data VALUES (2, 200);
INSERT INTO data VALUES (3, 300);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_values;
CREATE TABLE all_values (value INT64);
INSERT INTO all_values VALUES (10);
INSERT INTO all_values VALUES (20);
INSERT INTO all_values VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 20);
INSERT INTO data VALUES (2, 40);
INSERT INTO data VALUES (3, 60);
INSERT INTO data VALUES (4, 80);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (10);
INSERT INTO multipliers VALUES (20);
INSERT INTO multipliers VALUES (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 70000.0, 1);
INSERT INTO employees VALUES (2, 'Bob', 60000.0, 1);
INSERT INTO employees VALUES (3, 'Charlie', 80000.0, 2);
INSERT INTO employees VALUES (4, 'David', 90000.0, 2);
DROP TABLE IF EXISTS high_performers;
CREATE TABLE high_performers (emp_id INT64, dept_id INT64);
INSERT INTO high_performers VALUES (1, 1);
INSERT INTO high_performers VALUES (4, 2);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3547
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3548
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3549
SELECT id FROM data WHERE value IN (SELECT value FROM all_values) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3550
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3551
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3552
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3553
SELECT name FROM employees e WHERE e.id IN (SELECT emp_id FROM high_performers h WHERE h.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3554
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3555
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3556
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3557
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3558
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3559
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3560
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3561
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3562
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3563
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3564
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3565
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3566
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3567
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3568
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3569
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3570
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3571
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3572
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3573
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3574
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3575
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3576
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3577
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3578
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3579
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3580
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3581
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3582
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3583
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3584
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3585
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3586
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3587
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3588
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 100);
INSERT INTO data VALUES (2, 200);
INSERT INTO data VALUES (3, 300);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_values;
CREATE TABLE all_values (value INT64);
INSERT INTO all_values VALUES (10);
INSERT INTO all_values VALUES (20);
INSERT INTO all_values VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 20);
INSERT INTO data VALUES (2, 40);
INSERT INTO data VALUES (3, 60);
INSERT INTO data VALUES (4, 80);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (10);
INSERT INTO multipliers VALUES (20);
INSERT INTO multipliers VALUES (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 70000.0, 1);
INSERT INTO employees VALUES (2, 'Bob', 60000.0, 1);
INSERT INTO employees VALUES (3, 'Charlie', 80000.0, 2);
INSERT INTO employees VALUES (4, 'David', 90000.0, 2);
DROP TABLE IF EXISTS high_performers;
CREATE TABLE high_performers (emp_id INT64, dept_id INT64);
INSERT INTO high_performers VALUES (1, 1);
INSERT INTO high_performers VALUES (4, 2);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3589
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3590
SELECT id FROM data WHERE value IN (SELECT value FROM all_values) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3591
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3592
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3593
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3594
SELECT name FROM employees e WHERE e.id IN (SELECT emp_id FROM high_performers h WHERE h.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3595
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3596
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3597
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3598
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3599
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3600
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3601
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3602
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3603
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3604
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3605
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3606
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3607
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3608
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3609
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3610
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3611
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3612
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3613
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3614
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3615
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3616
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3617
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3618
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3619
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3620
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3621
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3622
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3623
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3624
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3625
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3626
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3627
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3628
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3629
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 20);
INSERT INTO data VALUES (2, 40);
INSERT INTO data VALUES (3, 60);
INSERT INTO data VALUES (4, 80);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (10);
INSERT INTO multipliers VALUES (20);
INSERT INTO multipliers VALUES (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 70000.0, 1);
INSERT INTO employees VALUES (2, 'Bob', 60000.0, 1);
INSERT INTO employees VALUES (3, 'Charlie', 80000.0, 2);
INSERT INTO employees VALUES (4, 'David', 90000.0, 2);
DROP TABLE IF EXISTS high_performers;
CREATE TABLE high_performers (emp_id INT64, dept_id INT64);
INSERT INTO high_performers VALUES (1, 1);
INSERT INTO high_performers VALUES (4, 2);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3630
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3631
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3632
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3633
SELECT name FROM employees e WHERE e.id IN (SELECT emp_id FROM high_performers h WHERE h.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3634
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3635
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3636
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3637
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3638
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3639
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3640
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3641
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3642
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3643
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3644
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3645
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3646
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3647
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3648
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3649
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3650
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3651
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3652
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3653
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3654
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3655
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3656
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3657
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3658
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3659
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3660
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3661
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3662
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3663
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3664
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3665
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3666
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3667
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3668
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 20);
INSERT INTO data VALUES (2, 40);
INSERT INTO data VALUES (3, 60);
INSERT INTO data VALUES (4, 80);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (10);
INSERT INTO multipliers VALUES (20);
INSERT INTO multipliers VALUES (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 70000.0, 1);
INSERT INTO employees VALUES (2, 'Bob', 60000.0, 1);
INSERT INTO employees VALUES (3, 'Charlie', 80000.0, 2);
INSERT INTO employees VALUES (4, 'David', 90000.0, 2);
DROP TABLE IF EXISTS high_performers;
CREATE TABLE high_performers (emp_id INT64, dept_id INT64);
INSERT INTO high_performers VALUES (1, 1);
INSERT INTO high_performers VALUES (4, 2);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3669
SELECT id FROM data WHERE value IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3670
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3671
SELECT name FROM employees e WHERE e.id IN (SELECT emp_id FROM high_performers h WHERE h.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3672
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3673
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3674
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3675
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3676
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3677
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3678
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3679
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3680
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3681
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3682
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3683
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3684
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3685
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3686
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3687
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3688
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3689
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3690
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3691
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3692
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3693
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3694
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3695
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3696
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3697
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3698
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3699
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3700
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3701
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3702
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3703
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3704
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3705
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3706
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 20);
INSERT INTO data VALUES (2, 40);
INSERT INTO data VALUES (3, 60);
INSERT INTO data VALUES (4, 80);
DROP TABLE IF EXISTS multipliers;
CREATE TABLE multipliers (mult INT64);
INSERT INTO multipliers VALUES (10);
INSERT INTO multipliers VALUES (20);
INSERT INTO multipliers VALUES (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 70000.0, 1);
INSERT INTO employees VALUES (2, 'Bob', 60000.0, 1);
INSERT INTO employees VALUES (3, 'Charlie', 80000.0, 2);
INSERT INTO employees VALUES (4, 'David', 90000.0, 2);
DROP TABLE IF EXISTS high_performers;
CREATE TABLE high_performers (emp_id INT64, dept_id INT64);
INSERT INTO high_performers VALUES (1, 1);
INSERT INTO high_performers VALUES (4, 2);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3707
SELECT id FROM data WHERE value IN (SELECT mult * 2 FROM multipliers) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3708
SELECT name FROM employees e WHERE e.id IN (SELECT emp_id FROM high_performers h WHERE h.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3709
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3710
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3711
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3712
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3713
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3714
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3715
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3716
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3717
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3718
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3719
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3720
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3721
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3722
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3723
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3724
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3725
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3726
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3727
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3728
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3729
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3730
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3731
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3732
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3733
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3734
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3735
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3736
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3737
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3738
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3739
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3740
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3741
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3742
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3743
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 70000.0, 1);
INSERT INTO employees VALUES (2, 'Bob', 60000.0, 1);
INSERT INTO employees VALUES (3, 'Charlie', 80000.0, 2);
INSERT INTO employees VALUES (4, 'David', 90000.0, 2);
DROP TABLE IF EXISTS high_performers;
CREATE TABLE high_performers (emp_id INT64, dept_id INT64);
INSERT INTO high_performers VALUES (1, 1);
INSERT INTO high_performers VALUES (4, 2);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3744
SELECT name FROM employees e WHERE e.id IN (SELECT emp_id FROM high_performers h WHERE h.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3745
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3746
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3747
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3748
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3749
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3750
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3751
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3752
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3753
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3754
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3755
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3756
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3757
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3758
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3759
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3760
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3761
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3762
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3763
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3764
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3765
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3766
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3767
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3768
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3769
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3770
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3771
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3772
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3773
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3774
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3775
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3776
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3777
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3778
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3779
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, manager_id INT64);
INSERT INTO employees VALUES (1, 'Alice', NULL);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 1);
INSERT INTO employees VALUES (4, 'David', 2);
INSERT INTO employees VALUES (5, 'Eve', 3);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3780
SELECT name FROM employees WHERE id IN (SELECT manager_id FROM employees WHERE manager_id IS NOT NULL) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3781
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3782
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3783
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3784
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3785
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3786
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3787
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3788
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3789
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3790
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3791
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3792
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3793
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3794
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3795
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3796
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3797
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3798
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3799
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3800
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3801
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3802
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3803
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3804
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3805
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3806
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3807
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3808
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3809
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3810
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3811
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3812
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3813
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3814
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (2, 'Gadget', 19.99);
INSERT INTO products VALUES (3, 'Gizmo', 29.99);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, quantity INT64);
INSERT INTO sales VALUES (1, 100);
INSERT INTO sales VALUES (2, 50);
INSERT INTO sales VALUES (3, 150);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3815
SELECT name FROM products WHERE id IN (SELECT product_id FROM sales WHERE quantity > 75) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3816
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3817
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3818
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3819
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3820
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3821
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3822
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3823
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3824
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3825
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3826
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3827
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3828
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3829
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3830
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3831
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3832
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3833
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3834
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3835
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3836
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3837
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3838
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3839
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3840
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3841
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3842
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3843
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3844
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3845
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3846
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3847
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3848
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10);
INSERT INTO numbers VALUES (2, 20);
INSERT INTO numbers VALUES (3, 30);
INSERT INTO numbers VALUES (4, 40);
INSERT INTO numbers VALUES (5, 50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3849
SELECT id FROM numbers WHERE value NOT IN (10, 30, 50) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3850
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3851
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3852
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3853
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3854
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3855
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3856
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3857
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3858
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3859
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3860
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3861
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3862
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3863
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3864
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3865
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3866
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3867
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3868
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3869
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3870
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3871
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3872
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3873
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3874
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3875
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3876
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3877
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3878
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3879
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3880
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3881
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3882
SELECT id FROM data WHERE value NOT IN (10, 20, 30);
-- Tag: window_functions_window_functions_operators_test_select_3883
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3884
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3885
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3886
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3887
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3888
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3889
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3890
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3891
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3892
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3893
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3894
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3895
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3896
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3897
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3898
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3899
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3900
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3901
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3902
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3903
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3904
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3905
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3906
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3907
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3908
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3909
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3910
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3911
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3912
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3913
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3914
SELECT id FROM data WHERE value NOT IN (100, 200, 300) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3915
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3916
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3917
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3918
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3919
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3920
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3921
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3922
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3923
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3924
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3925
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3926
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3927
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3928
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3929
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3930
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3931
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3932
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3933
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3934
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3935
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3936
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3937
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3938
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3939
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3940
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3941
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3942
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3943
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3944
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3945
SELECT id FROM data WHERE status NOT IN ('deleted', 'inactive') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3946
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3947
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3948
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3949
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3950
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3951
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3952
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3953
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3954
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3955
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3956
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3957
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3958
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3959
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3960
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3961
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3962
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3963
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3964
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3965
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3966
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3967
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3968
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3969
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3970
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3971
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3972
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3973
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3974
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, NULL);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_3975
SELECT id FROM data WHERE value NOT IN (10, 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3976
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3977
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3978
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3979
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3980
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3981
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3982
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_3983
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3984
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3985
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_3986
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3987
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_3988
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3989
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3990
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3991
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_3992
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3993
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_3994
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_3995
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_3996
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_3997
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_3998
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_3999
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4000
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4001
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4002
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4003
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS all_products;
CREATE TABLE all_products (id INT64, name STRING);
INSERT INTO all_products VALUES (1, 'Widget');
INSERT INTO all_products VALUES (2, 'Gadget');
INSERT INTO all_products VALUES (3, 'Gizmo');
INSERT INTO all_products VALUES (4, 'Doohickey');
DROP TABLE IF EXISTS sold_products;
CREATE TABLE sold_products (product_id INT64);
INSERT INTO sold_products VALUES (2);
INSERT INTO sold_products VALUES (4);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4004
SELECT name FROM all_products WHERE id NOT IN (SELECT product_id FROM sold_products) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_4005
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4006
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4007
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4008
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4009
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4010
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_4011
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4012
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4013
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_4014
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4015
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_4016
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4017
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4018
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4019
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4020
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4021
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4022
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4023
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4024
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4025
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4026
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4027
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4028
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4029
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4030
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4031
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4032
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4033
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4034
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4035
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4036
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4037
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_4038
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4039
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4040
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_4041
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4042
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_4043
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4044
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4045
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4046
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4047
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4048
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4049
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4050
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4051
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4052
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4053
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4054
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4055
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4056
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4057
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4058
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4059
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4060
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4061
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4062
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4063
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_4064
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4065
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4066
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_4067
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4068
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_4069
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4070
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4071
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4072
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4073
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4074
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4075
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4076
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4077
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4078
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4079
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4080
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4081
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4082
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4083
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4084
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4085
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4086
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4087
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4088
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_4089
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4090
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4091
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_4092
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4093
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_4094
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4095
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4096
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4097
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4098
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4099
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4100
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4101
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4102
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4103
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4104
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4105
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4106
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4107
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4108
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4109
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4110
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter WHERE value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4111
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4112
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_4113
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4114
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4115
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_4116
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4117
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_4118
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4119
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4120
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4121
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4122
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4123
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4124
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4125
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4126
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4127
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4128
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4129
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4130
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4131
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4132
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4133
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4134
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4135
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_4136
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4137
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4138
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_4139
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4140
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_4141
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4142
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4143
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4144
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4145
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4146
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4147
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4148
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4149
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4150
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4151
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4152
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4153
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4154
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4155
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4156
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64);
INSERT INTO employees VALUES (1, 'Alice', 1);
INSERT INTO employees VALUES (2, 'Bob', 1);
INSERT INTO employees VALUES (3, 'Charlie', 2);
INSERT INTO employees VALUES (4, 'David', 2);
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, emp_id INT64, dept_id INT64);
INSERT INTO projects VALUES (1, 1, 1);
INSERT INTO projects VALUES (2, 3, 2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4157
SELECT name FROM employees e WHERE e.id NOT IN (SELECT emp_id FROM projects p WHERE p.dept_id = e.dept_id) ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_4158
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4159
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4160
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_4161
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4162
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_4163
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4164
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4165
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4166
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4167
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4168
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4169
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4170
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4171
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4172
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4173
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4174
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4175
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4176
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4177
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4178
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4179
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4180
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4181
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_4182
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4183
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_4184
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4185
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4186
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4187
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4188
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4189
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4190
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4191
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4192
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4193
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4194
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4195
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4196
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4197
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4198
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4199
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4200
SELECT id FROM data WHERE value NOT IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4201
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_4202
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4203
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_4204
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4205
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4206
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4207
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4208
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4209
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4210
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4211
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4212
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4213
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4214
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4215
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4216
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4217
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4218
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4219
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, active BOOL);
INSERT INTO products VALUES (1, 'Widget', false);
INSERT INTO products VALUES (2, 'Gadget', false);
INSERT INTO products VALUES (3, 'Gizmo', false);
INSERT INTO products VALUES (4, 'Doohickey', false);
DROP TABLE IF EXISTS active_list;
CREATE TABLE active_list (product_id INT64);
INSERT INTO active_list VALUES (1);
INSERT INTO active_list VALUES (3);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, status STRING);
INSERT INTO employees VALUES (1, 'Alice', 'active');
INSERT INTO employees VALUES (2, 'Bob', 'active');
INSERT INTO employees VALUES (3, 'Charlie', 'active');
DROP TABLE IF EXISTS resignations;
CREATE TABLE resignations (emp_id INT64);
INSERT INTO resignations VALUES (2);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, value INT64);
INSERT INTO temp_data VALUES (1, 10);
INSERT INTO temp_data VALUES (2, 20);
INSERT INTO temp_data VALUES (3, 30);
INSERT INTO temp_data VALUES (4, 40);
DROP TABLE IF EXISTS delete_list;
CREATE TABLE delete_list (value INT64);
INSERT INTO delete_list VALUES (20);
INSERT INTO delete_list VALUES (40);
DROP TABLE IF EXISTS all_records;
CREATE TABLE all_records (id INT64, value INT64);
INSERT INTO all_records VALUES (1, 10);
INSERT INTO all_records VALUES (2, 20);
INSERT INTO all_records VALUES (3, 30);
INSERT INTO all_records VALUES (4, 40);
DROP TABLE IF EXISTS keep_list;
CREATE TABLE keep_list (value INT64);
INSERT INTO keep_list VALUES (10);
INSERT INTO keep_list VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4220
SELECT id FROM data WHERE value IN (SELECT value FROM filter);
UPDATE products SET active = true WHERE id IN (SELECT product_id FROM active_list);
-- Tag: window_functions_window_functions_operators_test_select_4221
SELECT id FROM products WHERE active = true ORDER BY id;
UPDATE employees SET status = 'inactive' WHERE id NOT IN (SELECT emp_id FROM resignations WHERE emp_id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4222
SELECT name FROM employees WHERE status = 'inactive' ORDER BY name;
DELETE FROM temp_data WHERE value IN (SELECT value FROM delete_list);
-- Tag: window_functions_window_functions_operators_test_select_4223
SELECT id FROM temp_data ORDER BY id;
DELETE FROM all_records WHERE value NOT IN (SELECT value FROM keep_list WHERE value IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4224
SELECT id FROM all_records ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4225
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4226
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4227
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4228
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4229
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4230
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4231
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4232
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4233
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4234
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4235
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4236
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4237
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4238
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, status STRING);
INSERT INTO data VALUES (1, 'active');
INSERT INTO data VALUES (2, 'pending');
INSERT INTO data VALUES (3, 'inactive');
INSERT INTO data VALUES (4, 'deleted');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4239
SELECT id, CASE WHEN status IN ('active', 'pending') THEN 'good' ELSE 'bad' END as health FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4240
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4241
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4242
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4243
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4244
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4245
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4246
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4247
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4248
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4249
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4250
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4251
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4252
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
INSERT INTO data VALUES (4, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4253
SELECT id, CASE WHEN value NOT IN (10, 30) THEN 'excluded' ELSE 'included' END as category FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4254
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4255
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4256
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4257
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4258
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4259
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4260
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4261
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4262
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4263
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4264
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4265
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4266
SELECT COUNT(*) FROM data WHERE id IN (SELECT id FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4267
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4268
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4269
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4270
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4271
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4272
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4273
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4274
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4275
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4276
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4277
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4278
SELECT COUNT(*) FROM data WHERE id NOT IN (SELECT id FROM filter WHERE id IS NOT NULL);
-- Tag: window_functions_window_functions_operators_test_select_4279
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4280
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4281
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4282
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4283
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4284
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4285
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4286
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4287
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4288
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (id INT64, value INT64);
INSERT INTO level1 VALUES (1, 100);
INSERT INTO level1 VALUES (2, 200);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (id INT64, l1_value INT64);
INSERT INTO level2 VALUES (1, 100);
DROP TABLE IF EXISTS level3;
CREATE TABLE level3 (id INT64, l2_id INT64);
INSERT INTO level3 VALUES (1, 1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4289
SELECT id FROM level1 WHERE value IN (SELECT l1_value FROM level2 WHERE id IN (SELECT l2_id FROM level3));
-- Tag: window_functions_window_functions_operators_test_select_4290
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4291
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4292
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4293
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4294
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4295
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4296
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4297
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4298
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4299
SELECT id FROM data WHERE value IN ('foo', 'bar');
-- Tag: window_functions_window_functions_operators_test_select_4300
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4301
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4302
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4303
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4304
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4305
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4306
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4307
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (col1 INT64, col2 INT64);
INSERT INTO multi VALUES (10, 20);
DROP TABLE IF EXISTS empty_data;
CREATE TABLE empty_data (id INT64, value INT64);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4308
SELECT id FROM data WHERE value IN (SELECT col1, col2 FROM multi);
-- Tag: window_functions_window_functions_operators_test_select_4309
SELECT id FROM empty_data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4310
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4311
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4312
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4313
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4314
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4315
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4316
SELECT COUNT(*) FROM data WHERE value IN (10, 30);
-- Tag: window_functions_window_functions_operators_test_select_4317
SELECT COUNT(*) FROM data WHERE value IN (SELECT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4318
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4319
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4320
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4321
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4322
SELECT id FROM data WHERE value IN (SELECT DISTINCT value FROM filter);
-- Tag: window_functions_window_functions_operators_test_select_4323
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4324
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4325
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
INSERT INTO data VALUES (3, 30);
DROP TABLE IF EXISTS filter;
CREATE TABLE filter (value INT64);
INSERT INTO filter VALUES (30);
INSERT INTO filter VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4326
SELECT id FROM data WHERE value IN (SELECT value FROM filter ORDER BY value DESC) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4327
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4328
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, status STRING);
INSERT INTO data VALUES (1, 10, 'active');
INSERT INTO data VALUES (2, 20, 'inactive');
INSERT INTO data VALUES (3, 30, 'active');
INSERT INTO data VALUES (4, 40, 'inactive');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4329
SELECT id FROM data WHERE value IN (10, 30) AND status = 'active' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4330
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64, flag BOOL);
INSERT INTO data VALUES (1, 10, true);
INSERT INTO data VALUES (2, 20, false);
INSERT INTO data VALUES (3, 30, true);
INSERT INTO data VALUES (4, 40, false);

-- Tag: window_functions_window_functions_operators_test_select_4331
SELECT id FROM data WHERE value NOT IN (10, 20) AND flag = true ORDER BY id;

DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, dept_name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64, name STRING, salary INT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 1, 'Alice', 100000),
(2, 1, 'Bob', 90000),
(3, 1, 'Charlie', 95000),
(4, 2, 'David', 80000),
(5, 2, 'Eve', 85000);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, dept_name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64, name STRING);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales'), (3, 'HR');
INSERT INTO employees VALUES (1, 1, 'Alice'), (2, 1, 'Bob');
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, dept_name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (dept_id INT64, salary INT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 100000), (1, 90000), (1, 95000),
(2, 80000), (2, 85000);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, customer_id INT64);
DROP TABLE IF EXISTS order_items;
CREATE TABLE order_items (order_id INT64, item_name STRING, price FLOAT64);
INSERT INTO orders VALUES (1, 100), (2, 100), (3, 101);
INSERT INTO order_items VALUES
(1, 'Widget', 10.0),
(1, 'Gadget', 20.0),
(2, 'Gizmo', 15.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64);
DROP TABLE IF EXISTS order_items;
CREATE TABLE order_items (order_id INT64, item_name STRING);
INSERT INTO orders VALUES (1), (2), (3);
INSERT INTO order_items VALUES (1, 'Widget'), (2, 'Gadget');
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value STRING);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, related STRING);
INSERT INTO t1 VALUES (1, 'test');
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (a INT64, b INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (a INT64, b INT64, c INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (1, 10), (2, 20);
INSERT INTO t3 VALUES (1, 10, 100), (2, 20, 200);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, ref_id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (ref_id INT64, data STRING);
INSERT INTO outer_table VALUES (1, 100), (2, NULL), (3, 200);
INSERT INTO inner_table VALUES (100, 'A'), (200, 'B');
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, value INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (b INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (10), (20);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100), (1, 200), (2, 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (dept STRING, product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'Widget', 100),
('A', 'Gadget', 150),
('B', 'Widget', 200);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (a INT64, b INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (b INT64, c INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES (1, 10);
INSERT INTO t3 VALUES (10, 100);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (customer_id INT64, amount FLOAT64, date DATE);

-- Tag: window_functions_window_functions_operators_test_select_4332
SELECT d.dept_name, e.name, e.salary
FROM departments d
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4333
SELECT name, salary
FROM employees
WHERE dept_id = d.dept_id
ORDER BY salary DESC
LIMIT 2
) e
ORDER BY d.dept_name, e.salary DESC;
-- Tag: window_functions_window_functions_operators_test_select_4334
SELECT d.dept_name, e.name
FROM departments d
LEFT JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4335
SELECT name
FROM employees
WHERE dept_id = d.dept_id
LIMIT 1
) e ON true
ORDER BY d.dept_name;
-- Tag: window_functions_window_functions_operators_test_select_4336
SELECT d.dept_name, stats.avg_salary, stats.emp_count
FROM departments d
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4337
SELECT AVG(salary) as avg_salary, COUNT(*) as emp_count
FROM employees
WHERE dept_id = d.dept_id
) stats
ORDER BY d.dept_name;
-- Tag: window_functions_window_functions_operators_test_select_4338
SELECT o.order_id, items.item_name, items.price
FROM orders o
CROSS APPLY (
-- Tag: window_functions_window_functions_operators_test_select_4339
SELECT item_name, price
FROM order_items
WHERE order_id = o.order_id
) items
ORDER BY o.order_id, items.item_name;
-- Tag: window_functions_window_functions_operators_test_select_4340
SELECT o.order_id, items.item_name
FROM orders o
OUTER APPLY (
-- Tag: window_functions_window_functions_operators_test_select_4341
SELECT item_name
FROM order_items
WHERE order_id = o.order_id
) items
ORDER BY o.order_id;
-- Tag: window_functions_window_functions_operators_test_select_4342
SELECT t1.value, t2.related
FROM t1
CROSS JOIN LATERAL (SELECT related FROM t2 WHERE id = t1.id) t2;
-- Tag: window_functions_window_functions_operators_test_select_4343
SELECT t1.value, t2.related
FROM t1
LEFT JOIN LATERAL (SELECT related FROM t2 WHERE id = t1.id) t2 ON true;
-- Tag: window_functions_window_functions_operators_test_select_4344
SELECT t1.a, x.b, y.c
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4345
SELECT b FROM t2 WHERE t2.a = t1.a
) x
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4346
SELECT c FROM t3 WHERE t3.a = t1.a AND t3.b = x.b
) y
ORDER BY t1.a;
-- Tag: window_functions_window_functions_operators_test_select_4347
SELECT o.id, i.data
FROM outer_table o
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4348
SELECT data FROM inner_table WHERE ref_id = o.ref_id
) i
ORDER BY o.id;
-- Tag: window_functions_window_functions_operators_test_select_4349
SELECT t1.id
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4350
SELECT * FROM t2 WHERE id = t1.nonexistent_col
) x;
-- Tag: window_functions_window_functions_operators_test_select_4351
SELECT t1.id
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4352
SELECT * FROM t2 WHERE id = value
) x;
-- Tag: window_functions_window_functions_operators_test_select_4353
SELECT t1.a, x.b
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4354
SELECT b FROM t2
) x
ORDER BY t1.a, x.b;
WITH customer_totals AS (
-- Tag: window_functions_window_functions_operators_test_select_4355
SELECT customer_id, SUM(amount) as total
FROM orders
GROUP BY customer_id
)
-- Tag: window_functions_window_functions_operators_test_select_4356
SELECT ct.customer_id, ct.total, recent.amount
FROM customer_totals ct
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4357
SELECT amount
FROM orders
WHERE customer_id = ct.customer_id
ORDER BY amount DESC
LIMIT 1
) recent
ORDER BY ct.customer_id;
-- Tag: window_functions_window_functions_operators_test_select_4358
SELECT DISTINCT dept, top_products.product, top_products.rank
FROM sales s
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_057
SELECT
product,
ROW_NUMBER() OVER (ORDER BY amount DESC) as rank
FROM sales
WHERE dept = s.dept
LIMIT 1
) top_products
ORDER BY dept;
-- Tag: window_functions_window_functions_operators_test_select_4359
SELECT t1.a, x.b, x.c
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4360
SELECT t2.b, y.c
FROM t2
WHERE t2.a = t1.a
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4361
SELECT c FROM t3 WHERE t3.b = t2.b
) y
) x;
-- Tag: window_functions_window_functions_operators_test_select_4362
SELECT c.id, t.amount, t.date
FROM customers c
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4363
SELECT amount, date
FROM transactions
WHERE customer_id = c.id
ORDER BY date DESC
LIMIT 1
) t;

DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, dept_name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64, name STRING);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales'), (3, 'HR');
INSERT INTO employees VALUES (1, 1, 'Alice'), (2, 1, 'Bob');
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, dept_name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (dept_id INT64, salary INT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 100000), (1, 90000), (1, 95000),
(2, 80000), (2, 85000);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, customer_id INT64);
DROP TABLE IF EXISTS order_items;
CREATE TABLE order_items (order_id INT64, item_name STRING, price FLOAT64);
INSERT INTO orders VALUES (1, 100), (2, 100), (3, 101);
INSERT INTO order_items VALUES
(1, 'Widget', 10.0),
(1, 'Gadget', 20.0),
(2, 'Gizmo', 15.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64);
DROP TABLE IF EXISTS order_items;
CREATE TABLE order_items (order_id INT64, item_name STRING);
INSERT INTO orders VALUES (1), (2), (3);
INSERT INTO order_items VALUES (1, 'Widget'), (2, 'Gadget');
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value STRING);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, related STRING);
INSERT INTO t1 VALUES (1, 'test');
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (a INT64, b INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (a INT64, b INT64, c INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (1, 10), (2, 20);
INSERT INTO t3 VALUES (1, 10, 100), (2, 20, 200);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, ref_id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (ref_id INT64, data STRING);
INSERT INTO outer_table VALUES (1, 100), (2, NULL), (3, 200);
INSERT INTO inner_table VALUES (100, 'A'), (200, 'B');
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, value INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (b INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (10), (20);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100), (1, 200), (2, 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (dept STRING, product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'Widget', 100),
('A', 'Gadget', 150),
('B', 'Widget', 200);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (a INT64, b INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (b INT64, c INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES (1, 10);
INSERT INTO t3 VALUES (10, 100);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (customer_id INT64, amount FLOAT64, date DATE);

-- Tag: window_functions_window_functions_operators_test_select_4364
SELECT d.dept_name, e.name
FROM departments d
LEFT JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4365
SELECT name
FROM employees
WHERE dept_id = d.dept_id
LIMIT 1
) e ON true
ORDER BY d.dept_name;
-- Tag: window_functions_window_functions_operators_test_select_4366
SELECT d.dept_name, stats.avg_salary, stats.emp_count
FROM departments d
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4367
SELECT AVG(salary) as avg_salary, COUNT(*) as emp_count
FROM employees
WHERE dept_id = d.dept_id
) stats
ORDER BY d.dept_name;
-- Tag: window_functions_window_functions_operators_test_select_4368
SELECT o.order_id, items.item_name, items.price
FROM orders o
CROSS APPLY (
-- Tag: window_functions_window_functions_operators_test_select_4369
SELECT item_name, price
FROM order_items
WHERE order_id = o.order_id
) items
ORDER BY o.order_id, items.item_name;
-- Tag: window_functions_window_functions_operators_test_select_4370
SELECT o.order_id, items.item_name
FROM orders o
OUTER APPLY (
-- Tag: window_functions_window_functions_operators_test_select_4371
SELECT item_name
FROM order_items
WHERE order_id = o.order_id
) items
ORDER BY o.order_id;
-- Tag: window_functions_window_functions_operators_test_select_4372
SELECT t1.value, t2.related
FROM t1
CROSS JOIN LATERAL (SELECT related FROM t2 WHERE id = t1.id) t2;
-- Tag: window_functions_window_functions_operators_test_select_4373
SELECT t1.value, t2.related
FROM t1
LEFT JOIN LATERAL (SELECT related FROM t2 WHERE id = t1.id) t2 ON true;
-- Tag: window_functions_window_functions_operators_test_select_4374
SELECT t1.a, x.b, y.c
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4375
SELECT b FROM t2 WHERE t2.a = t1.a
) x
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4376
SELECT c FROM t3 WHERE t3.a = t1.a AND t3.b = x.b
) y
ORDER BY t1.a;
-- Tag: window_functions_window_functions_operators_test_select_4377
SELECT o.id, i.data
FROM outer_table o
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4378
SELECT data FROM inner_table WHERE ref_id = o.ref_id
) i
ORDER BY o.id;
-- Tag: window_functions_window_functions_operators_test_select_4379
SELECT t1.id
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4380
SELECT * FROM t2 WHERE id = t1.nonexistent_col
) x;
-- Tag: window_functions_window_functions_operators_test_select_4381
SELECT t1.id
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4382
SELECT * FROM t2 WHERE id = value
) x;
-- Tag: window_functions_window_functions_operators_test_select_4383
SELECT t1.a, x.b
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4384
SELECT b FROM t2
) x
ORDER BY t1.a, x.b;
WITH customer_totals AS (
-- Tag: window_functions_window_functions_operators_test_select_4385
SELECT customer_id, SUM(amount) as total
FROM orders
GROUP BY customer_id
)
-- Tag: window_functions_window_functions_operators_test_select_4386
SELECT ct.customer_id, ct.total, recent.amount
FROM customer_totals ct
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4387
SELECT amount
FROM orders
WHERE customer_id = ct.customer_id
ORDER BY amount DESC
LIMIT 1
) recent
ORDER BY ct.customer_id;
-- Tag: window_functions_window_functions_operators_test_select_4388
SELECT DISTINCT dept, top_products.product, top_products.rank
FROM sales s
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_058
SELECT
product,
ROW_NUMBER() OVER (ORDER BY amount DESC) as rank
FROM sales
WHERE dept = s.dept
LIMIT 1
) top_products
ORDER BY dept;
-- Tag: window_functions_window_functions_operators_test_select_4389
SELECT t1.a, x.b, x.c
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4390
SELECT t2.b, y.c
FROM t2
WHERE t2.a = t1.a
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4391
SELECT c FROM t3 WHERE t3.b = t2.b
) y
) x;
-- Tag: window_functions_window_functions_operators_test_select_4392
SELECT c.id, t.amount, t.date
FROM customers c
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4393
SELECT amount, date
FROM transactions
WHERE customer_id = c.id
ORDER BY date DESC
LIMIT 1
) t;

DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, dept_name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (dept_id INT64, salary INT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 100000), (1, 90000), (1, 95000),
(2, 80000), (2, 85000);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, customer_id INT64);
DROP TABLE IF EXISTS order_items;
CREATE TABLE order_items (order_id INT64, item_name STRING, price FLOAT64);
INSERT INTO orders VALUES (1, 100), (2, 100), (3, 101);
INSERT INTO order_items VALUES
(1, 'Widget', 10.0),
(1, 'Gadget', 20.0),
(2, 'Gizmo', 15.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64);
DROP TABLE IF EXISTS order_items;
CREATE TABLE order_items (order_id INT64, item_name STRING);
INSERT INTO orders VALUES (1), (2), (3);
INSERT INTO order_items VALUES (1, 'Widget'), (2, 'Gadget');
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value STRING);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, related STRING);
INSERT INTO t1 VALUES (1, 'test');
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (a INT64, b INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (a INT64, b INT64, c INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (1, 10), (2, 20);
INSERT INTO t3 VALUES (1, 10, 100), (2, 20, 200);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, ref_id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (ref_id INT64, data STRING);
INSERT INTO outer_table VALUES (1, 100), (2, NULL), (3, 200);
INSERT INTO inner_table VALUES (100, 'A'), (200, 'B');
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, value INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (b INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (10), (20);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100), (1, 200), (2, 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (dept STRING, product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'Widget', 100),
('A', 'Gadget', 150),
('B', 'Widget', 200);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (a INT64, b INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (b INT64, c INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES (1, 10);
INSERT INTO t3 VALUES (10, 100);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (customer_id INT64, amount FLOAT64, date DATE);

-- Tag: window_functions_window_functions_operators_test_select_4394
SELECT d.dept_name, stats.avg_salary, stats.emp_count
FROM departments d
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4395
SELECT AVG(salary) as avg_salary, COUNT(*) as emp_count
FROM employees
WHERE dept_id = d.dept_id
) stats
ORDER BY d.dept_name;
-- Tag: window_functions_window_functions_operators_test_select_4396
SELECT o.order_id, items.item_name, items.price
FROM orders o
CROSS APPLY (
-- Tag: window_functions_window_functions_operators_test_select_4397
SELECT item_name, price
FROM order_items
WHERE order_id = o.order_id
) items
ORDER BY o.order_id, items.item_name;
-- Tag: window_functions_window_functions_operators_test_select_4398
SELECT o.order_id, items.item_name
FROM orders o
OUTER APPLY (
-- Tag: window_functions_window_functions_operators_test_select_4399
SELECT item_name
FROM order_items
WHERE order_id = o.order_id
) items
ORDER BY o.order_id;
-- Tag: window_functions_window_functions_operators_test_select_4400
SELECT t1.value, t2.related
FROM t1
CROSS JOIN LATERAL (SELECT related FROM t2 WHERE id = t1.id) t2;
-- Tag: window_functions_window_functions_operators_test_select_4401
SELECT t1.value, t2.related
FROM t1
LEFT JOIN LATERAL (SELECT related FROM t2 WHERE id = t1.id) t2 ON true;
-- Tag: window_functions_window_functions_operators_test_select_4402
SELECT t1.a, x.b, y.c
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4403
SELECT b FROM t2 WHERE t2.a = t1.a
) x
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4404
SELECT c FROM t3 WHERE t3.a = t1.a AND t3.b = x.b
) y
ORDER BY t1.a;
-- Tag: window_functions_window_functions_operators_test_select_4405
SELECT o.id, i.data
FROM outer_table o
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4406
SELECT data FROM inner_table WHERE ref_id = o.ref_id
) i
ORDER BY o.id;
-- Tag: window_functions_window_functions_operators_test_select_4407
SELECT t1.id
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4408
SELECT * FROM t2 WHERE id = t1.nonexistent_col
) x;
-- Tag: window_functions_window_functions_operators_test_select_4409
SELECT t1.id
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4410
SELECT * FROM t2 WHERE id = value
) x;
-- Tag: window_functions_window_functions_operators_test_select_4411
SELECT t1.a, x.b
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4412
SELECT b FROM t2
) x
ORDER BY t1.a, x.b;
WITH customer_totals AS (
-- Tag: window_functions_window_functions_operators_test_select_4413
SELECT customer_id, SUM(amount) as total
FROM orders
GROUP BY customer_id
)
-- Tag: window_functions_window_functions_operators_test_select_4414
SELECT ct.customer_id, ct.total, recent.amount
FROM customer_totals ct
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4415
SELECT amount
FROM orders
WHERE customer_id = ct.customer_id
ORDER BY amount DESC
LIMIT 1
) recent
ORDER BY ct.customer_id;
-- Tag: window_functions_window_functions_operators_test_select_4416
SELECT DISTINCT dept, top_products.product, top_products.rank
FROM sales s
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_059
SELECT
product,
ROW_NUMBER() OVER (ORDER BY amount DESC) as rank
FROM sales
WHERE dept = s.dept
LIMIT 1
) top_products
ORDER BY dept;
-- Tag: window_functions_window_functions_operators_test_select_4417
SELECT t1.a, x.b, x.c
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4418
SELECT t2.b, y.c
FROM t2
WHERE t2.a = t1.a
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4419
SELECT c FROM t3 WHERE t3.b = t2.b
) y
) x;
-- Tag: window_functions_window_functions_operators_test_select_4420
SELECT c.id, t.amount, t.date
FROM customers c
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4421
SELECT amount, date
FROM transactions
WHERE customer_id = c.id
ORDER BY date DESC
LIMIT 1
) t;

DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, ref_id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (ref_id INT64, data STRING);
INSERT INTO outer_table VALUES (1, 100), (2, NULL), (3, 200);
INSERT INTO inner_table VALUES (100, 'A'), (200, 'B');
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, value INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (b INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (10), (20);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100), (1, 200), (2, 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (dept STRING, product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'Widget', 100),
('A', 'Gadget', 150),
('B', 'Widget', 200);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (a INT64, b INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (b INT64, c INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES (1, 10);
INSERT INTO t3 VALUES (10, 100);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (customer_id INT64, amount FLOAT64, date DATE);

-- Tag: window_functions_window_functions_operators_test_select_4422
SELECT o.id, i.data
FROM outer_table o
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4423
SELECT data FROM inner_table WHERE ref_id = o.ref_id
) i
ORDER BY o.id;
-- Tag: window_functions_window_functions_operators_test_select_4424
SELECT t1.id
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4425
SELECT * FROM t2 WHERE id = t1.nonexistent_col
) x;
-- Tag: window_functions_window_functions_operators_test_select_4426
SELECT t1.id
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4427
SELECT * FROM t2 WHERE id = value
) x;
-- Tag: window_functions_window_functions_operators_test_select_4428
SELECT t1.a, x.b
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4429
SELECT b FROM t2
) x
ORDER BY t1.a, x.b;
WITH customer_totals AS (
-- Tag: window_functions_window_functions_operators_test_select_4430
SELECT customer_id, SUM(amount) as total
FROM orders
GROUP BY customer_id
)
-- Tag: window_functions_window_functions_operators_test_select_4431
SELECT ct.customer_id, ct.total, recent.amount
FROM customer_totals ct
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4432
SELECT amount
FROM orders
WHERE customer_id = ct.customer_id
ORDER BY amount DESC
LIMIT 1
) recent
ORDER BY ct.customer_id;
-- Tag: window_functions_window_functions_operators_test_select_4433
SELECT DISTINCT dept, top_products.product, top_products.rank
FROM sales s
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_060
SELECT
product,
ROW_NUMBER() OVER (ORDER BY amount DESC) as rank
FROM sales
WHERE dept = s.dept
LIMIT 1
) top_products
ORDER BY dept;
-- Tag: window_functions_window_functions_operators_test_select_4434
SELECT t1.a, x.b, x.c
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4435
SELECT t2.b, y.c
FROM t2
WHERE t2.a = t1.a
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4436
SELECT c FROM t3 WHERE t3.b = t2.b
) y
) x;
-- Tag: window_functions_window_functions_operators_test_select_4437
SELECT c.id, t.amount, t.date
FROM customers c
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4438
SELECT amount, date
FROM transactions
WHERE customer_id = c.id
ORDER BY date DESC
LIMIT 1
) t;

DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (b INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (10), (20);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100), (1, 200), (2, 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (dept STRING, product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 'Widget', 100),
('A', 'Gadget', 150),
('B', 'Widget', 200);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (a INT64, b INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (b INT64, c INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t2 VALUES (1, 10);
INSERT INTO t3 VALUES (10, 100);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS transactions;
CREATE TABLE transactions (customer_id INT64, amount FLOAT64, date DATE);

-- Tag: window_functions_window_functions_operators_test_select_4439
SELECT t1.a, x.b
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4440
SELECT b FROM t2
) x
ORDER BY t1.a, x.b;
WITH customer_totals AS (
-- Tag: window_functions_window_functions_operators_test_select_4441
SELECT customer_id, SUM(amount) as total
FROM orders
GROUP BY customer_id
)
-- Tag: window_functions_window_functions_operators_test_select_4442
SELECT ct.customer_id, ct.total, recent.amount
FROM customer_totals ct
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4443
SELECT amount
FROM orders
WHERE customer_id = ct.customer_id
ORDER BY amount DESC
LIMIT 1
) recent
ORDER BY ct.customer_id;
-- Tag: window_functions_window_functions_operators_test_select_4444
SELECT DISTINCT dept, top_products.product, top_products.rank
FROM sales s
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_061
SELECT
product,
ROW_NUMBER() OVER (ORDER BY amount DESC) as rank
FROM sales
WHERE dept = s.dept
LIMIT 1
) top_products
ORDER BY dept;
-- Tag: window_functions_window_functions_operators_test_select_4445
SELECT t1.a, x.b, x.c
FROM t1
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4446
SELECT t2.b, y.c
FROM t2
WHERE t2.a = t1.a
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4447
SELECT c FROM t3 WHERE t3.b = t2.b
) y
) x;
-- Tag: window_functions_window_functions_operators_test_select_4448
SELECT c.id, t.amount, t.date
FROM customers c
CROSS JOIN LATERAL (
-- Tag: window_functions_window_functions_operators_test_select_4449
SELECT amount, date
FROM transactions
WHERE customer_id = c.id
ORDER BY date DESC
LIMIT 1
) t;

DROP TABLE IF EXISTS bools;
CREATE TABLE bools (id INT64, val BOOL);
INSERT INTO bools VALUES (1, TRUE);
DROP TABLE IF EXISTS bools;
CREATE TABLE bools (id INT64, val BOOL);
INSERT INTO bools VALUES (1, FALSE);
DROP TABLE IF EXISTS bools;
CREATE TABLE bools (id INT64, val BOOL);
INSERT INTO bools VALUES (1, NULL);
DROP TABLE IF EXISTS bools;
CREATE TABLE bools (id INT64, val BOOL);
INSERT INTO bools VALUES (1, TRUE);
DROP TABLE IF EXISTS bools;
CREATE TABLE bools (id INT64, val BOOL);
INSERT INTO bools VALUES (1, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4450
SELECT NOT val as result FROM bools WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4451
SELECT NOT val as result FROM bools WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4452
SELECT NOT val as result FROM bools WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4453
SELECT NOT NOT val as result FROM bools WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4454
SELECT NOT NOT NOT val as result FROM bools WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4455
SELECT (TRUE AND TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4456
SELECT (TRUE AND FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4457
SELECT (TRUE AND val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4458
SELECT (FALSE AND val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4459
SELECT (val AND FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4460
SELECT (a AND b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4461
SELECT (TRUE OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4462
SELECT (TRUE OR FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4463
SELECT (TRUE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4464
SELECT (FALSE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4465
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4466
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4467
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4468
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4469
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4470
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4471
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4472
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4473
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4474
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4475
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4476
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4477
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4478
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4479
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4480
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4481
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4482
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4483
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4484
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4485
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4486
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4487
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4488
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4489
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS bools;
CREATE TABLE bools (id INT64, val BOOL);
INSERT INTO bools VALUES (1, FALSE);
DROP TABLE IF EXISTS bools;
CREATE TABLE bools (id INT64, val BOOL);
INSERT INTO bools VALUES (1, NULL);
DROP TABLE IF EXISTS bools;
CREATE TABLE bools (id INT64, val BOOL);
INSERT INTO bools VALUES (1, TRUE);
DROP TABLE IF EXISTS bools;
CREATE TABLE bools (id INT64, val BOOL);
INSERT INTO bools VALUES (1, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4490
SELECT NOT val as result FROM bools WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4491
SELECT NOT val as result FROM bools WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4492
SELECT NOT NOT val as result FROM bools WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4493
SELECT NOT NOT NOT val as result FROM bools WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4494
SELECT (TRUE AND TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4495
SELECT (TRUE AND FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4496
SELECT (TRUE AND val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4497
SELECT (FALSE AND val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4498
SELECT (val AND FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4499
SELECT (a AND b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4500
SELECT (TRUE OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4501
SELECT (TRUE OR FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4502
SELECT (TRUE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4503
SELECT (FALSE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4504
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4505
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4506
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4507
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4508
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4509
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4510
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4511
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4512
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4513
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4514
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4515
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4516
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4517
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4518
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4519
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4520
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4521
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4522
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4523
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4524
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4525
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4526
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4527
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4528
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS bools;
CREATE TABLE bools (id INT64, val BOOL);
INSERT INTO bools VALUES (1, NULL);
DROP TABLE IF EXISTS bools;
CREATE TABLE bools (id INT64, val BOOL);
INSERT INTO bools VALUES (1, TRUE);
DROP TABLE IF EXISTS bools;
CREATE TABLE bools (id INT64, val BOOL);
INSERT INTO bools VALUES (1, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4529
SELECT NOT val as result FROM bools WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4530
SELECT NOT NOT val as result FROM bools WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4531
SELECT NOT NOT NOT val as result FROM bools WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4532
SELECT (TRUE AND TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4533
SELECT (TRUE AND FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4534
SELECT (TRUE AND val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4535
SELECT (FALSE AND val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4536
SELECT (val AND FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4537
SELECT (a AND b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4538
SELECT (TRUE OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4539
SELECT (TRUE OR FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4540
SELECT (TRUE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4541
SELECT (FALSE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4542
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4543
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4544
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4545
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4546
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4547
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4548
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4549
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4550
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4551
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4552
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4553
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4554
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4555
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4556
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4557
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4558
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4559
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4560
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4561
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4562
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4563
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4564
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4565
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4566
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4567
SELECT (TRUE AND TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4568
SELECT (TRUE AND FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4569
SELECT (TRUE AND val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4570
SELECT (FALSE AND val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4571
SELECT (val AND FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4572
SELECT (a AND b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4573
SELECT (TRUE OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4574
SELECT (TRUE OR FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4575
SELECT (TRUE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4576
SELECT (FALSE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4577
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4578
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4579
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4580
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4581
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4582
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4583
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4584
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4585
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4586
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4587
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4588
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4589
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4590
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4591
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4592
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4593
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4594
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4595
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4596
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4597
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4598
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4599
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4600
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4601
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4602
SELECT (TRUE AND FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4603
SELECT (TRUE AND val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4604
SELECT (FALSE AND val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4605
SELECT (val AND FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4606
SELECT (a AND b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4607
SELECT (TRUE OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4608
SELECT (TRUE OR FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4609
SELECT (TRUE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4610
SELECT (FALSE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4611
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4612
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4613
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4614
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4615
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4616
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4617
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4618
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4619
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4620
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4621
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4622
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4623
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4624
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4625
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4626
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4627
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4628
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4629
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4630
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4631
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4632
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4633
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4634
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4635
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4636
SELECT (TRUE AND val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4637
SELECT (FALSE AND val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4638
SELECT (val AND FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4639
SELECT (a AND b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4640
SELECT (TRUE OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4641
SELECT (TRUE OR FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4642
SELECT (TRUE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4643
SELECT (FALSE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4644
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4645
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4646
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4647
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4648
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4649
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4650
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4651
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4652
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4653
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4654
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4655
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4656
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4657
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4658
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4659
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4660
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4661
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4662
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4663
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4664
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4665
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4666
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4667
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4668
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4669
SELECT (FALSE AND val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4670
SELECT (val AND FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4671
SELECT (a AND b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4672
SELECT (TRUE OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4673
SELECT (TRUE OR FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4674
SELECT (TRUE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4675
SELECT (FALSE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4676
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4677
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4678
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4679
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4680
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4681
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4682
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4683
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4684
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4685
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4686
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4687
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4688
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4689
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4690
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4691
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4692
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4693
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4694
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4695
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4696
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4697
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4698
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4699
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4700
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4701
SELECT (val AND FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4702
SELECT (a AND b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4703
SELECT (TRUE OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4704
SELECT (TRUE OR FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4705
SELECT (TRUE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4706
SELECT (FALSE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4707
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4708
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4709
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4710
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4711
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4712
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4713
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4714
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4715
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4716
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4717
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4718
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4719
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4720
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4721
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4722
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4723
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4724
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4725
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4726
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4727
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4728
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4729
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4730
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4731
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4732
SELECT (a AND b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4733
SELECT (TRUE OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4734
SELECT (TRUE OR FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4735
SELECT (TRUE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4736
SELECT (FALSE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4737
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4738
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4739
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4740
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4741
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4742
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4743
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4744
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4745
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4746
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4747
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4748
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4749
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4750
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4751
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4752
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4753
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4754
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4755
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4756
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4757
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4758
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4759
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4760
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4761
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4762
SELECT (TRUE OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4763
SELECT (TRUE OR FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4764
SELECT (TRUE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4765
SELECT (FALSE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4766
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4767
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4768
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4769
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4770
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4771
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4772
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4773
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4774
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4775
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4776
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4777
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4778
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4779
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4780
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4781
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4782
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4783
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4784
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4785
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4786
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4787
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4788
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4789
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4790
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4791
SELECT (TRUE OR FALSE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4792
SELECT (TRUE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4793
SELECT (FALSE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4794
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4795
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4796
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4797
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4798
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4799
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4800
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4801
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4802
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4803
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4804
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4805
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4806
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4807
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4808
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4809
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4810
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4811
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4812
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4813
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4814
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4815
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4816
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4817
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4818
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4819
SELECT (TRUE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4820
SELECT (FALSE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4821
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4822
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4823
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4824
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4825
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4826
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4827
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4828
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4829
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4830
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4831
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4832
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4833
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4834
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4835
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4836
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4837
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4838
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4839
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4840
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4841
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4842
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4843
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4844
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4845
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4846
SELECT (FALSE OR val) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4847
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4848
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4849
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4850
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4851
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4852
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4853
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4854
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4855
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4856
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4857
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4858
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4859
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4860
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4861
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4862
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4863
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4864
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4865
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4866
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4867
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4868
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4869
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4870
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4871
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, val BOOL);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4872
SELECT (val OR TRUE) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4873
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4874
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4875
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4876
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4877
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4878
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4879
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4880
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4881
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4882
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4883
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4884
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4885
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4886
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4887
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4888
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4889
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4890
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4891
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4892
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4893
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4894
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4895
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4896
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, NULL, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4897
SELECT (a OR b) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4898
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4899
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4900
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4901
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4902
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4903
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4904
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4905
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4906
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4907
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4908
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4909
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4910
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4911
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4912
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4913
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4914
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4915
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4916
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4917
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4918
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4919
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4920
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4921
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4922
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4923
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4924
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4925
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4926
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4927
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4928
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4929
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4930
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4931
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4932
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4933
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4934
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4935
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4936
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4937
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4938
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4939
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4940
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4941
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4942
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4943
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE);
INSERT INTO t VALUES (2, TRUE, TRUE);
INSERT INTO t VALUES (3, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4944
SELECT id, NOT (a OR b) as left_side, (NOT a) AND (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4945
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4946
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4947
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4948
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4949
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4950
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4951
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4952
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4953
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4954
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4955
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4956
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4957
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4958
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4959
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4960
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4961
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4962
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4963
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4964
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4965
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, TRUE, NULL);
INSERT INTO t VALUES (2, FALSE, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL);
INSERT INTO t VALUES (1, TRUE, FALSE, TRUE, TRUE);
INSERT INTO t VALUES (2, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4966
SELECT id, NOT (a AND b) as left_side, (NOT a) OR (NOT b) as right_side FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4967
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4968
SELECT (a AND b) OR (c AND d) as result FROM t WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_4969
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4970
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4971
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4972
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4973
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4974
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4975
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4976
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4977
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4978
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4979
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4980
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4981
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_4982
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_4983
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4984
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_4985
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_4986
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_4987
SELECT a OR b AND c as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4988
SELECT a OR (b AND c) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4989
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4990
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4991
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_4992
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4993
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4994
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_4995
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_4996
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4997
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_4998
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_4999
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_5000
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_5001
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5002
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_5003
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_5004
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL);
INSERT INTO t VALUES (1, FALSE, TRUE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a BOOL, b BOOL, c BOOL, d BOOL, e BOOL, f BOOL);
INSERT INTO t VALUES (1, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_5005
SELECT NOT a AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_5006
SELECT (NOT a) AND b as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_5007
SELECT ((a AND b) OR (c AND d)) AND NOT (e OR f) as result FROM t WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_5008
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_5009
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_5010
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_5011
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_5012
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5013
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5014
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_5015
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_5016
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_5017
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5018
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_5019
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_5020
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_5021
SELECT id FROM t WHERE FALSE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_5022
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_5023
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_5024
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_5025
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5026
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5027
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_5028
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_5029
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_5030
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5031
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_5032
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_5033
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
INSERT INTO t VALUES (2, 1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_5034
SELECT id FROM t WHERE TRUE OR (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_5035
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_5036
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_5037
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5038
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5039
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_5040
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_5041
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_5042
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5043
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_5044
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_5045
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, denominator INT64);
INSERT INTO t VALUES (1, 0);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_5046
SELECT id FROM t WHERE TRUE AND (10 / denominator = 10);
-- Tag: window_functions_window_functions_operators_test_select_5047
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_5048
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5049
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5050
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_5051
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_5052
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_5053
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5054
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_5055
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_5056
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
INSERT INTO t VALUES (2);
INSERT INTO t VALUES (3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_5057
SELECT id FROM t WHERE NULL;
-- Tag: window_functions_window_functions_operators_test_select_5058
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5059
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5060
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_5061
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_5062
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_5063
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5064
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_5065
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_5066
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_5067
SELECT id FROM t WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5068
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5069
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_5070
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_5071
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_5072
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5073
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_5074
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_5075
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_5076
SELECT id FROM t WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5077
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_5078
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_5079
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_5080
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5081
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_5082
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_5083
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_5084
SELECT region, SUM(amount) FROM sales GROUP BY region HAVING NULL;
-- Tag: window_functions_window_functions_operators_test_select_5085
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_5086
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_5087
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5088
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_5089
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_5090
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (category STRING, value INT64);
INSERT INTO t VALUES ('A', NULL);
INSERT INTO t VALUES ('B', 10);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_5091
SELECT category, MAX(value) as max_val FROM t GROUP BY category HAVING MAX(value) > 5;
-- Tag: window_functions_window_functions_operators_test_select_5092
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_5093
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5094
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_5095
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_5096
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64);
INSERT INTO t VALUES (1);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_5097
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result FROM t;
-- Tag: window_functions_window_functions_operators_test_select_5098
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5099
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_5100
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_5101
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, flag BOOL);
INSERT INTO t VALUES (1, TRUE);
INSERT INTO t VALUES (2, FALSE);
INSERT INTO t VALUES (3, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64);
INSERT INTO t1 VALUES (1);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t2 VALUES (99);

-- Tag: window_functions_window_functions_operators_test_select_5102
SELECT id, CASE WHEN flag THEN 'yes' ELSE 'no' END as result FROM t ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5103
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE TRUE);
-- Tag: window_functions_window_functions_operators_test_select_5104
SELECT id FROM t1 WHERE EXISTS (SELECT 1 FROM t2 WHERE FALSE);
-- Tag: window_functions_window_functions_operators_test_select_5105
SELECT id FROM t1 WHERE NOT EXISTS (SELECT 1 FROM t2 WHERE NULL);

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active'), (2, 'inactive'), (3, 'active');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, NULL), (3, false, NULL), (4, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5106
SELECT id FROM test WHERE NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5107
SELECT id FROM numbers WHERE NOT (value > 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5108
SELECT id FROM test WHERE NOT (status = 'active') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5109
SELECT id FROM test WHERE NOT NOT (value > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5110
SELECT id FROM test WHERE NOT value ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5111
SELECT id FROM test WHERE NOT (value IS NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5112
SELECT id FROM test WHERE NOT (value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5113
SELECT id FROM test WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5114
SELECT id FROM test WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5115
SELECT COUNT(*) as cnt FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5116
SELECT COUNT(*) as cnt FROM test WHERE value;
-- Tag: window_functions_window_functions_operators_test_select_5117
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5118
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5119
SELECT id FROM test WHERE NOT (value BETWEEN 10 AND 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5120
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5121
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5122
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5123
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5124
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5125
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5126
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5127
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5128
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5129
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5130
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5131
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5132
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5133
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5134
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5135
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5136
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5137
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5138
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5139
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5140
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5141
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5142
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5143
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5144
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5145
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5146
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5147
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5148
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5149
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5150
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5151
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5152
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5153
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5154
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5155
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5156
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5157
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5158
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5159
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5160
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5161
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5162
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5163
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5164
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active'), (2, 'inactive'), (3, 'active');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, NULL), (3, false, NULL), (4, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5165
SELECT id FROM numbers WHERE NOT (value > 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5166
SELECT id FROM test WHERE NOT (status = 'active') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5167
SELECT id FROM test WHERE NOT NOT (value > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5168
SELECT id FROM test WHERE NOT value ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5169
SELECT id FROM test WHERE NOT (value IS NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5170
SELECT id FROM test WHERE NOT (value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5171
SELECT id FROM test WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5172
SELECT id FROM test WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5173
SELECT COUNT(*) as cnt FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5174
SELECT COUNT(*) as cnt FROM test WHERE value;
-- Tag: window_functions_window_functions_operators_test_select_5175
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5176
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5177
SELECT id FROM test WHERE NOT (value BETWEEN 10 AND 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5178
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5179
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5180
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5181
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5182
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5183
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5184
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5185
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5186
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5187
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5188
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5189
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5190
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5191
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5192
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5193
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5194
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5195
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5196
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5197
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5198
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5199
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5200
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5201
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5202
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5203
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5204
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5205
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5206
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5207
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5208
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5209
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5210
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5211
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5212
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5213
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5214
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5215
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5216
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5217
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5218
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5219
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5220
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5221
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5222
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active'), (2, 'inactive'), (3, 'active');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, NULL), (3, false, NULL), (4, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5223
SELECT id FROM test WHERE NOT (status = 'active') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5224
SELECT id FROM test WHERE NOT NOT (value > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5225
SELECT id FROM test WHERE NOT value ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5226
SELECT id FROM test WHERE NOT (value IS NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5227
SELECT id FROM test WHERE NOT (value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5228
SELECT id FROM test WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5229
SELECT id FROM test WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5230
SELECT COUNT(*) as cnt FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5231
SELECT COUNT(*) as cnt FROM test WHERE value;
-- Tag: window_functions_window_functions_operators_test_select_5232
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5233
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5234
SELECT id FROM test WHERE NOT (value BETWEEN 10 AND 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5235
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5236
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5237
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5238
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5239
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5240
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5241
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5242
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5243
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5244
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5245
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5246
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5247
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5248
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5249
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5250
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5251
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5252
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5253
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5254
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5255
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5256
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5257
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5258
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5259
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5260
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5261
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5262
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5263
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5264
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5265
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5266
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5267
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5268
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5269
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5270
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5271
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5272
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5273
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5274
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5275
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5276
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5277
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5278
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5279
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, NULL), (3, false, NULL), (4, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5280
SELECT id FROM test WHERE NOT NOT (value > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5281
SELECT id FROM test WHERE NOT value ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5282
SELECT id FROM test WHERE NOT (value IS NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5283
SELECT id FROM test WHERE NOT (value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5284
SELECT id FROM test WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5285
SELECT id FROM test WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5286
SELECT COUNT(*) as cnt FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5287
SELECT COUNT(*) as cnt FROM test WHERE value;
-- Tag: window_functions_window_functions_operators_test_select_5288
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5289
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5290
SELECT id FROM test WHERE NOT (value BETWEEN 10 AND 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5291
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5292
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5293
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5294
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5295
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5296
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5297
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5298
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5299
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5300
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5301
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5302
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5303
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5304
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5305
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5306
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5307
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5308
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5309
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5310
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5311
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5312
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5313
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5314
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5315
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5316
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5317
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5318
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5319
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5320
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5321
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5322
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5323
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5324
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5325
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5326
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5327
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5328
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5329
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5330
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5331
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5332
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5333
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5334
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5335
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, NULL), (3, false, NULL), (4, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5336
SELECT id FROM test WHERE NOT value ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5337
SELECT id FROM test WHERE NOT (value IS NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5338
SELECT id FROM test WHERE NOT (value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5339
SELECT id FROM test WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5340
SELECT id FROM test WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5341
SELECT COUNT(*) as cnt FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5342
SELECT COUNT(*) as cnt FROM test WHERE value;
-- Tag: window_functions_window_functions_operators_test_select_5343
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5344
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5345
SELECT id FROM test WHERE NOT (value BETWEEN 10 AND 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5346
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5347
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5348
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5349
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5350
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5351
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5352
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5353
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5354
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5355
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5356
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5357
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5358
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5359
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5360
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5361
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5362
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5363
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5364
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5365
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5366
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5367
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5368
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5369
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5370
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5371
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5372
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5373
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5374
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5375
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5376
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5377
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5378
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5379
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5380
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5381
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5382
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5383
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5384
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5385
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5386
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5387
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5388
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5389
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5390
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, NULL), (3, false, NULL), (4, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5391
SELECT id FROM test WHERE NOT (value IS NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5392
SELECT id FROM test WHERE NOT (value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5393
SELECT id FROM test WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5394
SELECT id FROM test WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5395
SELECT COUNT(*) as cnt FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5396
SELECT COUNT(*) as cnt FROM test WHERE value;
-- Tag: window_functions_window_functions_operators_test_select_5397
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5398
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5399
SELECT id FROM test WHERE NOT (value BETWEEN 10 AND 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5400
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5401
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5402
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5403
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5404
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5405
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5406
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5407
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5408
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5409
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5410
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5411
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5412
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5413
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5414
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5415
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5416
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5417
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5418
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5419
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5420
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5421
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5422
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5423
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5424
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5425
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5426
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5427
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5428
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5429
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5430
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5431
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5432
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5433
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5434
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5435
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5436
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5437
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5438
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5439
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5440
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5441
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5442
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5443
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5444
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, NULL), (3, false, NULL), (4, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5445
SELECT id FROM test WHERE NOT (value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5446
SELECT id FROM test WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5447
SELECT id FROM test WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5448
SELECT COUNT(*) as cnt FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5449
SELECT COUNT(*) as cnt FROM test WHERE value;
-- Tag: window_functions_window_functions_operators_test_select_5450
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5451
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5452
SELECT id FROM test WHERE NOT (value BETWEEN 10 AND 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5453
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5454
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5455
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5456
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5457
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5458
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5459
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5460
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5461
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5462
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5463
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5464
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5465
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5466
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5467
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5468
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5469
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5470
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5471
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5472
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5473
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5474
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5475
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5476
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5477
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5478
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5479
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5480
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5481
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5482
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5483
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5484
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5485
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5486
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5487
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5488
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5489
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5490
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5491
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5492
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5493
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5494
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5495
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5496
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5497
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, NULL), (3, false, NULL), (4, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5498
SELECT id FROM test WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5499
SELECT id FROM test WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5500
SELECT COUNT(*) as cnt FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5501
SELECT COUNT(*) as cnt FROM test WHERE value;
-- Tag: window_functions_window_functions_operators_test_select_5502
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5503
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5504
SELECT id FROM test WHERE NOT (value BETWEEN 10 AND 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5505
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5506
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5507
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5508
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5509
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5510
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5511
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5512
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5513
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5514
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5515
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5516
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5517
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5518
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5519
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5520
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5521
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5522
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5523
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5524
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5525
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5526
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5527
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5528
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5529
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5530
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5531
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5532
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5533
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5534
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5535
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5536
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5537
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5538
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5539
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5540
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5541
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5542
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5543
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5544
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5545
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5546
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5547
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5548
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5549
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5550
SELECT id FROM test WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5551
SELECT COUNT(*) as cnt FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5552
SELECT COUNT(*) as cnt FROM test WHERE value;
-- Tag: window_functions_window_functions_operators_test_select_5553
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5554
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5555
SELECT id FROM test WHERE NOT (value BETWEEN 10 AND 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5556
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5557
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5558
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5559
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5560
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5561
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5562
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5563
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5564
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5565
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5566
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5567
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5568
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5569
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5570
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5571
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5572
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5573
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5574
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5575
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5576
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5577
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5578
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5579
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5580
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5581
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5582
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5583
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5584
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5585
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5586
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5587
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5588
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5589
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5590
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5591
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5592
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5593
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5594
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5595
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5596
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5597
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5598
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5599
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5600
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5601
SELECT COUNT(*) as cnt FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5602
SELECT COUNT(*) as cnt FROM test WHERE value;
-- Tag: window_functions_window_functions_operators_test_select_5603
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5604
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5605
SELECT id FROM test WHERE NOT (value BETWEEN 10 AND 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5606
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5607
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5608
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5609
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5610
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5611
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5612
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5613
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5614
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5615
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5616
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5617
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5618
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5619
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5620
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5621
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5622
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5623
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5624
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5625
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5626
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5627
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5628
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5629
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5630
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5631
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5632
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5633
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5634
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5635
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5636
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5637
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5638
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5639
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5640
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5641
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5642
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5643
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5644
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5645
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5646
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5647
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5648
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5649
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5650
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5651
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5652
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5653
SELECT id FROM test WHERE NOT (value BETWEEN 10 AND 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5654
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5655
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5656
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5657
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5658
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5659
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5660
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5661
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5662
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5663
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5664
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5665
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5666
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5667
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5668
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5669
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5670
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5671
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5672
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5673
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5674
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5675
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5676
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5677
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5678
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5679
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5680
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5681
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5682
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5683
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5684
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5685
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5686
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5687
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5688
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5689
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5690
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5691
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5692
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5693
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5694
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5695
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5696
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5697
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5698
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5699
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5700
SELECT id FROM test WHERE NOT (value BETWEEN 10 AND 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5701
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5702
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5703
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5704
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5705
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5706
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5707
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5708
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5709
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5710
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5711
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5712
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5713
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5714
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5715
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5716
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5717
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5718
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5719
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5720
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5721
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5722
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5723
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5724
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5725
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5726
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5727
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5728
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5729
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5730
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5731
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5732
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5733
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5734
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5735
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5736
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5737
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5738
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5739
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5740
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5741
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5742
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5743
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5744
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5745
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5746
SELECT id FROM test WHERE NOT (value BETWEEN 10 AND 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5747
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5748
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5749
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5750
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5751
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5752
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5753
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5754
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5755
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5756
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5757
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5758
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5759
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5760
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5761
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5762
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5763
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5764
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5765
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5766
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5767
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5768
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5769
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5770
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5771
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5772
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5773
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5774
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5775
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5776
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5777
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5778
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5779
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5780
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5781
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5782
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5783
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5784
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5785
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5786
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5787
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5788
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5789
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5790
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5791
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30), (4, 40);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5792
SELECT id FROM test WHERE NOT (value IN (10, 30)) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5793
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5794
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5795
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5796
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5797
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5798
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5799
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5800
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5801
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5802
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5803
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5804
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5805
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5806
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5807
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5808
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5809
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5810
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5811
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5812
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5813
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5814
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5815
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5816
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5817
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5818
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5819
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5820
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5821
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5822
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5823
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5824
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5825
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5826
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5827
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5828
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5829
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5830
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5831
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5832
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5833
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5834
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5835
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5836
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5837
SELECT id FROM employees e WHERE NOT EXISTS (SELECT 1 FROM departments d WHERE d.dept_id = e.dept_id) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5838
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5839
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5840
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5841
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5842
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5843
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5844
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5845
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5846
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5847
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5848
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5849
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5850
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5851
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5852
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5853
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5854
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5855
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5856
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5857
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5858
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5859
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5860
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5861
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5862
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5863
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5864
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5865
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5866
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5867
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5868
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5869
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5870
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5871
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5872
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5873
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5874
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5875
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5876
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5877
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5878
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5879
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5880
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64);
DROP TABLE IF EXISTS active_depts;
CREATE TABLE active_depts (dept_id INT64);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO active_depts VALUES (10), (30);
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'apple'), (2, 'application'), (3, 'banana'), (4, 'apply');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Apple'), (2, 'BANANA'), (3, 'cherry'), (4, 'APPLication');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5881
SELECT id FROM employees WHERE dept_id NOT IN (SELECT dept_id FROM active_depts) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5882
SELECT id FROM words WHERE word NOT LIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5883
SELECT id FROM words WHERE word NOT ILIKE 'app%' ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5884
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5885
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5886
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5887
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5888
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5889
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5890
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5891
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5892
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5893
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5894
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5895
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5896
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5897
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5898
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5899
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5900
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5901
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5902
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5903
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5904
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5905
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5906
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5907
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5908
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5909
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5910
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5911
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5912
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5913
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5914
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5915
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5916
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5917
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5918
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5919
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5920
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5921
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5922
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5923
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5924
SELECT id FROM test WHERE value > 5 AND (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5925
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5926
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5927
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5928
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5929
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5930
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5931
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5932
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5933
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5934
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5935
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5936
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5937
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5938
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5939
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5940
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5941
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5942
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5943
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5944
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5945
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5946
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5947
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5948
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5949
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5950
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5951
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5952
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5953
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5954
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5955
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5956
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5957
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5958
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5959
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5960
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_5961
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5962
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_5963
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 0), (2, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_5964
SELECT id FROM test WHERE value = 0 OR (100 / value) > 5 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5965
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5966
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5967
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5968
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5969
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5970
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5971
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_5972
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_5973
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_5974
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_5975
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5976
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_5977
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_5978
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5979
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5980
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5981
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5982
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5983
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5984
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5985
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_5986
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_5987
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5988
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5989
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5990
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5991
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5992
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5993
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_5994
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5995
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_5996
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_5997
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_5998
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_5999
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6000
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6001
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6002
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6003
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE false END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6004
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6005
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6006
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6007
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6008
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6009
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_6010
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_6011
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_6012
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_6013
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6014
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_6015
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_6016
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6017
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6018
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6019
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6020
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6021
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6022
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6023
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6024
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6025
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6026
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6027
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6028
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6029
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6030
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6031
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6032
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6033
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6034
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6035
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6036
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6037
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6038
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6039
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6040
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6041
SELECT id, CASE WHEN NOT (value > 15) THEN 'low' ELSE 'high' END as category FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6042
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6043
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6044
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6045
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6046
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_6047
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_6048
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_6049
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_6050
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6051
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_6052
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_6053
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6054
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6055
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6056
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6057
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6058
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6059
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6060
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6061
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6062
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6063
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6064
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6065
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6066
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6067
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6068
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6069
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6070
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6071
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6072
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6073
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6074
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6075
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6076
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6077
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64, c INT64);
INSERT INTO test VALUES (1, 10, 20, 30), (2, 5, 15, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6078
SELECT id FROM test WHERE NOT ((a > 5 AND b > 15) OR c > 35) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6079
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6080
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6081
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6082
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_6083
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_6084
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_6085
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_6086
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6087
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_6088
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_6089
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6090
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6091
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6092
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6093
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6094
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6095
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6096
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6097
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6098
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6099
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6100
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6101
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6102
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6103
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6104
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6105
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6106
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6107
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6108
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6109
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6110
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6111
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6112
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6113
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6114
SELECT id FROM test WHERE NOT (name < 'Charlie') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6115
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6116
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6117
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_6118
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_6119
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_6120
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_6121
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6122
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_6123
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_6124
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6125
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6126
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6127
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6128
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6129
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6130
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6131
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6132
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6133
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6134
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6135
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6136
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6137
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6138
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6139
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6140
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6141
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6142
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6143
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6144
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6145
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6146
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6147
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6148
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6149
SELECT id FROM test WHERE NOT NOT NOT active ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6150
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6151
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_6152
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_6153
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_6154
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_6155
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6156
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_6157
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_6158
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6159
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6160
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6161
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6162
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6163
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6164
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6165
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6166
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6167
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6168
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6169
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6170
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6171
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6172
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6173
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6174
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6175
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6176
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6177
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6178
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6179
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6180
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6181
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6182
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, false, true), (2, false, true, false), (3, true, true, true);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6183
SELECT id FROM test WHERE NOT a AND NOT b AND NOT c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6184
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_6185
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_6186
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_6187
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_6188
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6189
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_6190
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_6191
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6192
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6193
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6194
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6195
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6196
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6197
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6198
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6199
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6200
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6201
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6202
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6203
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6204
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6205
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6206
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6207
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6208
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6209
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6210
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6211
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6212
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6213
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6214
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6215
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100.0), (1, 200.0), (2, 50.0), (2, 60.0);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, order_id INT64);
INSERT INTO orders VALUES (1, 101), (1, 102), (2, 201), (3, 301), (3, 302), (3, 303);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6216
SELECT product_id FROM sales GROUP BY product_id HAVING NOT (SUM(amount) > 200) ORDER BY product_id;
-- Tag: window_functions_window_functions_operators_test_select_6217
SELECT customer_id FROM orders GROUP BY customer_id HAVING NOT (COUNT(*) > 2) ORDER BY customer_id;
-- Tag: window_functions_window_functions_operators_test_select_6218
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_6219
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_6220
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6221
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_6222
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_6223
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6224
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6225
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6226
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6227
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6228
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6229
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6230
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6231
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6232
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6233
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6234
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6235
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6236
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6237
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6238
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6239
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6240
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6241
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6242
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6243
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6244
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6245
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6246
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6247
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6248
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_6249
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_6250
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6251
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_6252
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_6253
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6254
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6255
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6256
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6257
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6258
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6259
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6260
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6261
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6262
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6263
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6264
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6265
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6266
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6267
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6268
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6269
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6270
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6271
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6272
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6273
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6274
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6275
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6276
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6277
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6278
SELECT id FROM test WHERE NOT status;
-- Tag: window_functions_window_functions_operators_test_select_6279
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6280
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_6281
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_6282
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6283
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6284
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6285
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6286
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6287
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6288
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6289
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6290
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6291
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6292
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6293
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6294
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6295
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6296
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6297
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6298
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6299
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6300
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6301
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6302
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6303
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6304
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6305
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6306
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64, country STRING, active BOOL);
INSERT INTO users VALUES (1, 25, 'US', true), (2, 17, 'UK', true), (3, 30, 'US', false), (4, 40, 'UK', true);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6307
SELECT id FROM users WHERE NOT (age < 18 OR country = 'US' OR NOT active) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6308
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_6309
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_6310
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6311
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6312
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6313
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6314
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6315
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6316
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6317
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6318
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6319
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6320
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6321
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6322
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6323
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6324
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6325
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6326
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6327
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6328
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6329
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6330
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6331
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6332
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6333
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6334
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, active BOOL);
INSERT INTO employees VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO departments VALUES (10, true), (20, false), (30, true);
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL, expected STRING);
INSERT INTO logic VALUES
(1, TRUE, TRUE, 'TRUE'),
(2, TRUE, FALSE, 'FALSE'),
(3, TRUE, NULL, 'NULL'),
(4, FALSE, TRUE, 'FALSE'),
(5, FALSE, FALSE, 'FALSE'),
(6, FALSE, NULL, 'FALSE'),
(7, NULL, TRUE, 'NULL'),
(8, NULL, FALSE, 'FALSE'),
(9, NULL, NULL, 'NULL');
DROP TABLE IF EXISTS logic;
CREATE TABLE logic (id INT64, a BOOL, b BOOL);
INSERT INTO logic VALUES
(1, TRUE, TRUE),
(2, TRUE, FALSE),
(3, TRUE, NULL),
(4, FALSE, TRUE),
(5, FALSE, FALSE),
(6, FALSE, NULL),
(7, NULL, TRUE),
(8, NULL, FALSE),
(9, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6335
SELECT e.emp_id FROM employees e JOIN departments d ON e.dept_id = d.dept_id WHERE NOT d.active ORDER BY e.emp_id;
-- Tag: window_functions_window_functions_operators_test_select_6336
SELECT id FROM logic WHERE a AND b;
-- Tag: window_functions_window_functions_operators_test_select_6337
SELECT id FROM logic WHERE a OR b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6338
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6339
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6340
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6341
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6342
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6343
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6344
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6345
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6346
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6347
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6348
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6349
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6350
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6351
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6352
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6353
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6354
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6355
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6356
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6357
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6358
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6359
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6360
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6361
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6362
SELECT id FROM test WHERE (val + 5) > 20 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6363
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6364
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6365
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6366
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6367
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6368
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6369
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6370
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6371
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6372
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6373
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6374
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6375
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6376
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6377
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6378
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6379
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6380
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6381
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6382
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6383
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6384
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6385
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES
(1, TRUE, TRUE),  -- (TRUE OR NULL) AND TRUE = TRUE AND TRUE = TRUE
(2, TRUE, FALSE), -- (TRUE OR NULL) AND FALSE = TRUE AND FALSE = FALSE
(3, FALSE, TRUE), -- (FALSE OR NULL) AND TRUE = NULL AND TRUE = NULL
(4, FALSE, FALSE) -- (FALSE OR NULL) AND FALSE = NULL AND FALSE = FALSE;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, text STRING);
INSERT INTO test VALUES
(1, 'test123'),
(2, 'hello'),
(3, 'test456'),
(4, 'world789');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6386
SELECT id FROM test WHERE (a OR NULL) AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6387
SELECT id FROM test WHERE NOT REGEXP_CONTAINS(text, r'test') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6388
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6389
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6390
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6391
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6392
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6393
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6394
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6395
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6396
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6397
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6398
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6399
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6400
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6401
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6402
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6403
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6404
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6405
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6406
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6407
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6408
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val INT64, default_val INT64);
INSERT INTO test VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 20, 5);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6409
SELECT id FROM test WHERE NOT (COALESCE(val, default_val) > 15) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6410
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6411
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6412
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6413
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6414
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6415
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6416
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6417
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6418
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6419
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6420
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6421
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6422
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6423
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6424
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6425
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6426
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6427
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6428
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6429
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6430
SELECT COUNT(*) as cnt FROM large_test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6431
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6432
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6433
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6434
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6435
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6436
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6437
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6438
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6439
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6440
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6441
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6442
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6443
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6444
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6445
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6446
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6447
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6448
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6449
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6450
SELECT id FROM test WHERE NOT NOT NOT NOT NOT val ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6451
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6452
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6453
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6454
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6455
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6456
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6457
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6458
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6459
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6460
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6461
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6462
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6463
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6464
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6465
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6466
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6467
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6468
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, TRUE), (2, FALSE), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6469
SELECT id, NOT flag as inverted FROM test ORDER BY inverted NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6470
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6471
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6472
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6473
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6474
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6475
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6476
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6477
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6478
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6479
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6480
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6481
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6482
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6483
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6484
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6485
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6486
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL, dept STRING);
INSERT INTO test VALUES
(1, TRUE, 'Sales'),
(2, FALSE, 'Sales'),
(3, NULL, 'Sales'),
(4, TRUE, 'HR');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6487
SELECT dept, COUNT(*) as cnt FROM test WHERE NOT active GROUP BY dept;
-- Tag: window_functions_window_functions_operators_test_select_6488
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6489
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6490
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6491
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6492
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6493
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6494
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6495
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6496
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6497
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6498
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6499
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6500
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6501
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6502
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6503
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6504
SELECT id FROM test WHERE NOT (a > b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6505
SELECT id FROM test WHERE a <= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6506
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6507
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6508
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6509
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6510
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6511
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6512
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6513
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6514
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6515
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6516
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6517
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6518
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6519
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 20), (2, 30, 20), (3, 20, 20);
DROP TABLE IF EXISTS state;
CREATE TABLE state (id INT64, active BOOL);
INSERT INTO state VALUES (1, TRUE), (2, FALSE);
INSERT INTO state VALUES (3, FALSE), (4, TRUE);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6520
SELECT id FROM test WHERE NOT (a < b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6521
SELECT id FROM test WHERE a >= b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6522
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6523
SELECT COUNT(*) as cnt FROM state WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6524
SELECT id FROM test WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6525
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6526
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6527
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6528
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6529
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6530
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6531
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6532
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6533
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6534
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6535
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6536
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6537
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6538
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6539
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6540
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6541
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6542
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, val BOOL);
INSERT INTO test VALUES (1, TRUE), (2, TRUE), (3, TRUE);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6543
SELECT id FROM test WHERE NOT val;
-- Tag: window_functions_window_functions_operators_test_select_6544
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6545
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6546
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6547
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6548
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6549
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6550
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount FLOAT64, is_refund BOOL);
INSERT INTO sales VALUES
(1, 100.0, FALSE),
(2, 50.0, TRUE),
(3, 200.0, FALSE),
(4, 30.0, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, active BOOL);
INSERT INTO t1 VALUES (1, TRUE), (2, FALSE);
INSERT INTO t2 VALUES (3, TRUE), (4, FALSE);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, is_cancelled BOOL, amount FLOAT64);
INSERT INTO orders VALUES
(1, FALSE, 100.0),
(2, TRUE, 50.0),
(3, FALSE, 200.0),
(4, TRUE, 30.0);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, active BOOL, last_login TIMESTAMP);
INSERT INTO users VALUES
(1, TRUE, CURRENT_TIMESTAMP),
(2, FALSE, CURRENT_TIMESTAMP);
DROP TABLE IF EXISTS temp_data;
CREATE TABLE temp_data (id INT64, keep BOOL);
INSERT INTO temp_data VALUES
(1, TRUE),
(2, FALSE),
(3, TRUE),
(4, FALSE);

-- Tag: window_functions_window_functions_operators_test_select_6551
SELECT id, ROW_NUMBER() OVER (ORDER BY amount DESC) as rn
FROM sales
WHERE NOT is_refund
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6552
SELECT id FROM t1 WHERE NOT active
UNION
-- Tag: window_functions_window_functions_operators_test_select_6553
SELECT id FROM t2 WHERE NOT active
ORDER BY id;
WITH active_orders AS (
-- Tag: window_functions_window_functions_operators_test_select_6554
SELECT order_id, amount FROM orders WHERE NOT is_cancelled
)
-- Tag: window_functions_window_functions_operators_test_select_6555
SELECT SUM(amount) as total FROM active_orders;
UPDATE users SET active = TRUE WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6556
SELECT COUNT(*) as cnt FROM users WHERE active;
DELETE FROM temp_data WHERE NOT keep;
-- Tag: window_functions_window_functions_operators_test_select_6557
SELECT COUNT(*) as cnt FROM temp_data;

DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, flag INT64);
INSERT INTO nums VALUES (1, 0);
INSERT INTO nums VALUES (2, 1);
INSERT INTO nums VALUES (3, 42);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, value STRING);
INSERT INTO strings VALUES (1, '');
INSERT INTO strings VALUES (2, 'true');
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, group_id INT64, active BOOL);
INSERT INTO flags VALUES (1, 1, TRUE);
INSERT INTO flags VALUES (2, 1, FALSE);
INSERT INTO flags VALUES (3, 2, FALSE);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category STRING);
INSERT INTO items VALUES (1, 'A');
INSERT INTO items VALUES (2, 'A');
INSERT INTO items VALUES (3, 'B');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (id INT64, value INT64, is_max BOOL);
INSERT INTO scores VALUES (1, 10, FALSE);
INSERT INTO scores VALUES (2, 20, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, active BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, flag BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, flag BOOL);
INSERT INTO t1 VALUES (1, TRUE);
INSERT INTO t2 VALUES (2, FALSE);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64);
INSERT INTO customers VALUES (1);
INSERT INTO customers VALUES (2);
INSERT INTO orders VALUES (1);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, value BOOL);
INSERT INTO flags VALUES (1, TRUE);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, active BOOL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO data VALUES (1, TRUE, NULL, FALSE);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, flag BOOL);
INSERT INTO nulls VALUES (1, NULL);
INSERT INTO nulls VALUES (2, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, a INT64, b INT64);
INSERT INTO nums VALUES (1, 5, 10);
DROP TABLE IF EXISTS complex;
CREATE TABLE complex (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO complex VALUES (1, TRUE, TRUE, FALSE);
INSERT INTO complex VALUES (2, FALSE, TRUE, FALSE);
INSERT INTO complex VALUES (3, TRUE, FALSE, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'true');
INSERT INTO data VALUES (2, 'false');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);

-- Tag: window_functions_window_functions_operators_test_select_6558
SELECT id FROM nums WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6559
SELECT id FROM strings WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_6560
SELECT category, SUM(amount) as total FROM sales GROUP BY category HAVING NOT (SUM(amount) < 100);
-- Tag: window_functions_window_functions_operators_test_select_6561
SELECT group_id, NOT MAX(active) as all_inactive FROM flags GROUP BY group_id ORDER BY group_id;
-- Tag: window_functions_window_functions_operators_test_select_6562
SELECT category FROM items GROUP BY category HAVING NOT (COUNT(*) = 1);
-- Tag: window_functions_window_functions_operators_test_select_6563
SELECT id, NOT (value = MAX(value) OVER ()) as not_max FROM scores ORDER BY id;
WITH cte AS (SELECT id, active FROM data) SELECT id FROM cte WHERE NOT active ORDER BY id;
WITH filtered AS (SELECT id FROM data WHERE NOT (value < 15)) SELECT * FROM filtered ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6564
SELECT id FROM (SELECT id, flag FROM t1 UNION SELECT id, flag FROM t2) AS combined WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6565
SELECT id, (NOT EXISTS (SELECT 1 FROM orders WHERE customer_id = customers.id)) as has_no_orders FROM customers ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6566
SELECT NOT (SELECT value FROM flags WHERE id = 1) as inverted;
-- Tag: window_functions_window_functions_operators_test_select_6567
SELECT COUNT(*) FROM large WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6568
SELECT id FROM data WHERE NOT ((a AND b) OR c);
-- Tag: window_functions_window_functions_operators_test_select_6569
SELECT id FROM nulls WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6570
SELECT id FROM nums WHERE NOT a < b;
-- Tag: window_functions_window_functions_operators_test_select_6571
SELECT id FROM complex WHERE NOT a AND b OR c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6572
SELECT NOT;
-- Tag: window_functions_window_functions_operators_test_select_6573
SELECT NOT 42;
-- Tag: window_functions_window_functions_operators_test_select_6574
SELECT NOT 'hello';
-- Tag: window_functions_window_functions_operators_test_select_6575
SELECT id FROM data WHERE NOT CAST(value AS BOOL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6576
SELECT id FROM data WHERE NOT (CASE WHEN value > 15 THEN TRUE ELSE FALSE END) ORDER BY id;

DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, flag INT64);
INSERT INTO nums VALUES (1, 0);
INSERT INTO nums VALUES (2, 1);
INSERT INTO nums VALUES (3, 42);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, value STRING);
INSERT INTO strings VALUES (1, '');
INSERT INTO strings VALUES (2, 'true');
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, group_id INT64, active BOOL);
INSERT INTO flags VALUES (1, 1, TRUE);
INSERT INTO flags VALUES (2, 1, FALSE);
INSERT INTO flags VALUES (3, 2, FALSE);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category STRING);
INSERT INTO items VALUES (1, 'A');
INSERT INTO items VALUES (2, 'A');
INSERT INTO items VALUES (3, 'B');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (id INT64, value INT64, is_max BOOL);
INSERT INTO scores VALUES (1, 10, FALSE);
INSERT INTO scores VALUES (2, 20, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, active BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, flag BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, flag BOOL);
INSERT INTO t1 VALUES (1, TRUE);
INSERT INTO t2 VALUES (2, FALSE);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64);
INSERT INTO customers VALUES (1);
INSERT INTO customers VALUES (2);
INSERT INTO orders VALUES (1);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, value BOOL);
INSERT INTO flags VALUES (1, TRUE);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, active BOOL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO data VALUES (1, TRUE, NULL, FALSE);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, flag BOOL);
INSERT INTO nulls VALUES (1, NULL);
INSERT INTO nulls VALUES (2, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, a INT64, b INT64);
INSERT INTO nums VALUES (1, 5, 10);
DROP TABLE IF EXISTS complex;
CREATE TABLE complex (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO complex VALUES (1, TRUE, TRUE, FALSE);
INSERT INTO complex VALUES (2, FALSE, TRUE, FALSE);
INSERT INTO complex VALUES (3, TRUE, FALSE, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'true');
INSERT INTO data VALUES (2, 'false');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);

-- Tag: window_functions_window_functions_operators_test_select_6577
SELECT id FROM nums WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6578
SELECT id FROM strings WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_6579
SELECT category, SUM(amount) as total FROM sales GROUP BY category HAVING NOT (SUM(amount) < 100);
-- Tag: window_functions_window_functions_operators_test_select_6580
SELECT group_id, NOT MAX(active) as all_inactive FROM flags GROUP BY group_id ORDER BY group_id;
-- Tag: window_functions_window_functions_operators_test_select_6581
SELECT category FROM items GROUP BY category HAVING NOT (COUNT(*) = 1);
-- Tag: window_functions_window_functions_operators_test_select_6582
SELECT id, NOT (value = MAX(value) OVER ()) as not_max FROM scores ORDER BY id;
WITH cte AS (SELECT id, active FROM data) SELECT id FROM cte WHERE NOT active ORDER BY id;
WITH filtered AS (SELECT id FROM data WHERE NOT (value < 15)) SELECT * FROM filtered ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6583
SELECT id FROM (SELECT id, flag FROM t1 UNION SELECT id, flag FROM t2) AS combined WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6584
SELECT id, (NOT EXISTS (SELECT 1 FROM orders WHERE customer_id = customers.id)) as has_no_orders FROM customers ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6585
SELECT NOT (SELECT value FROM flags WHERE id = 1) as inverted;
-- Tag: window_functions_window_functions_operators_test_select_6586
SELECT COUNT(*) FROM large WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6587
SELECT id FROM data WHERE NOT ((a AND b) OR c);
-- Tag: window_functions_window_functions_operators_test_select_6588
SELECT id FROM nulls WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6589
SELECT id FROM nums WHERE NOT a < b;
-- Tag: window_functions_window_functions_operators_test_select_6590
SELECT id FROM complex WHERE NOT a AND b OR c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6591
SELECT NOT;
-- Tag: window_functions_window_functions_operators_test_select_6592
SELECT NOT 42;
-- Tag: window_functions_window_functions_operators_test_select_6593
SELECT NOT 'hello';
-- Tag: window_functions_window_functions_operators_test_select_6594
SELECT id FROM data WHERE NOT CAST(value AS BOOL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6595
SELECT id FROM data WHERE NOT (CASE WHEN value > 15 THEN TRUE ELSE FALSE END) ORDER BY id;

DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, value STRING);
INSERT INTO strings VALUES (1, '');
INSERT INTO strings VALUES (2, 'true');
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, group_id INT64, active BOOL);
INSERT INTO flags VALUES (1, 1, TRUE);
INSERT INTO flags VALUES (2, 1, FALSE);
INSERT INTO flags VALUES (3, 2, FALSE);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category STRING);
INSERT INTO items VALUES (1, 'A');
INSERT INTO items VALUES (2, 'A');
INSERT INTO items VALUES (3, 'B');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (id INT64, value INT64, is_max BOOL);
INSERT INTO scores VALUES (1, 10, FALSE);
INSERT INTO scores VALUES (2, 20, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, active BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, flag BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, flag BOOL);
INSERT INTO t1 VALUES (1, TRUE);
INSERT INTO t2 VALUES (2, FALSE);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64);
INSERT INTO customers VALUES (1);
INSERT INTO customers VALUES (2);
INSERT INTO orders VALUES (1);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, value BOOL);
INSERT INTO flags VALUES (1, TRUE);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, active BOOL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO data VALUES (1, TRUE, NULL, FALSE);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, flag BOOL);
INSERT INTO nulls VALUES (1, NULL);
INSERT INTO nulls VALUES (2, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, a INT64, b INT64);
INSERT INTO nums VALUES (1, 5, 10);
DROP TABLE IF EXISTS complex;
CREATE TABLE complex (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO complex VALUES (1, TRUE, TRUE, FALSE);
INSERT INTO complex VALUES (2, FALSE, TRUE, FALSE);
INSERT INTO complex VALUES (3, TRUE, FALSE, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'true');
INSERT INTO data VALUES (2, 'false');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);

-- Tag: window_functions_window_functions_operators_test_select_6596
SELECT id FROM strings WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_6597
SELECT category, SUM(amount) as total FROM sales GROUP BY category HAVING NOT (SUM(amount) < 100);
-- Tag: window_functions_window_functions_operators_test_select_6598
SELECT group_id, NOT MAX(active) as all_inactive FROM flags GROUP BY group_id ORDER BY group_id;
-- Tag: window_functions_window_functions_operators_test_select_6599
SELECT category FROM items GROUP BY category HAVING NOT (COUNT(*) = 1);
-- Tag: window_functions_window_functions_operators_test_select_6600
SELECT id, NOT (value = MAX(value) OVER ()) as not_max FROM scores ORDER BY id;
WITH cte AS (SELECT id, active FROM data) SELECT id FROM cte WHERE NOT active ORDER BY id;
WITH filtered AS (SELECT id FROM data WHERE NOT (value < 15)) SELECT * FROM filtered ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6601
SELECT id FROM (SELECT id, flag FROM t1 UNION SELECT id, flag FROM t2) AS combined WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6602
SELECT id, (NOT EXISTS (SELECT 1 FROM orders WHERE customer_id = customers.id)) as has_no_orders FROM customers ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6603
SELECT NOT (SELECT value FROM flags WHERE id = 1) as inverted;
-- Tag: window_functions_window_functions_operators_test_select_6604
SELECT COUNT(*) FROM large WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6605
SELECT id FROM data WHERE NOT ((a AND b) OR c);
-- Tag: window_functions_window_functions_operators_test_select_6606
SELECT id FROM nulls WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6607
SELECT id FROM nums WHERE NOT a < b;
-- Tag: window_functions_window_functions_operators_test_select_6608
SELECT id FROM complex WHERE NOT a AND b OR c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6609
SELECT NOT;
-- Tag: window_functions_window_functions_operators_test_select_6610
SELECT NOT 42;
-- Tag: window_functions_window_functions_operators_test_select_6611
SELECT NOT 'hello';
-- Tag: window_functions_window_functions_operators_test_select_6612
SELECT id FROM data WHERE NOT CAST(value AS BOOL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6613
SELECT id FROM data WHERE NOT (CASE WHEN value > 15 THEN TRUE ELSE FALSE END) ORDER BY id;

DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, group_id INT64, active BOOL);
INSERT INTO flags VALUES (1, 1, TRUE);
INSERT INTO flags VALUES (2, 1, FALSE);
INSERT INTO flags VALUES (3, 2, FALSE);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category STRING);
INSERT INTO items VALUES (1, 'A');
INSERT INTO items VALUES (2, 'A');
INSERT INTO items VALUES (3, 'B');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (id INT64, value INT64, is_max BOOL);
INSERT INTO scores VALUES (1, 10, FALSE);
INSERT INTO scores VALUES (2, 20, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, active BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, flag BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, flag BOOL);
INSERT INTO t1 VALUES (1, TRUE);
INSERT INTO t2 VALUES (2, FALSE);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64);
INSERT INTO customers VALUES (1);
INSERT INTO customers VALUES (2);
INSERT INTO orders VALUES (1);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, value BOOL);
INSERT INTO flags VALUES (1, TRUE);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, active BOOL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO data VALUES (1, TRUE, NULL, FALSE);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, flag BOOL);
INSERT INTO nulls VALUES (1, NULL);
INSERT INTO nulls VALUES (2, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, a INT64, b INT64);
INSERT INTO nums VALUES (1, 5, 10);
DROP TABLE IF EXISTS complex;
CREATE TABLE complex (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO complex VALUES (1, TRUE, TRUE, FALSE);
INSERT INTO complex VALUES (2, FALSE, TRUE, FALSE);
INSERT INTO complex VALUES (3, TRUE, FALSE, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'true');
INSERT INTO data VALUES (2, 'false');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);

-- Tag: window_functions_window_functions_operators_test_select_6614
SELECT category, SUM(amount) as total FROM sales GROUP BY category HAVING NOT (SUM(amount) < 100);
-- Tag: window_functions_window_functions_operators_test_select_6615
SELECT group_id, NOT MAX(active) as all_inactive FROM flags GROUP BY group_id ORDER BY group_id;
-- Tag: window_functions_window_functions_operators_test_select_6616
SELECT category FROM items GROUP BY category HAVING NOT (COUNT(*) = 1);
-- Tag: window_functions_window_functions_operators_test_select_6617
SELECT id, NOT (value = MAX(value) OVER ()) as not_max FROM scores ORDER BY id;
WITH cte AS (SELECT id, active FROM data) SELECT id FROM cte WHERE NOT active ORDER BY id;
WITH filtered AS (SELECT id FROM data WHERE NOT (value < 15)) SELECT * FROM filtered ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6618
SELECT id FROM (SELECT id, flag FROM t1 UNION SELECT id, flag FROM t2) AS combined WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6619
SELECT id, (NOT EXISTS (SELECT 1 FROM orders WHERE customer_id = customers.id)) as has_no_orders FROM customers ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6620
SELECT NOT (SELECT value FROM flags WHERE id = 1) as inverted;
-- Tag: window_functions_window_functions_operators_test_select_6621
SELECT COUNT(*) FROM large WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6622
SELECT id FROM data WHERE NOT ((a AND b) OR c);
-- Tag: window_functions_window_functions_operators_test_select_6623
SELECT id FROM nulls WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6624
SELECT id FROM nums WHERE NOT a < b;
-- Tag: window_functions_window_functions_operators_test_select_6625
SELECT id FROM complex WHERE NOT a AND b OR c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6626
SELECT NOT;
-- Tag: window_functions_window_functions_operators_test_select_6627
SELECT NOT 42;
-- Tag: window_functions_window_functions_operators_test_select_6628
SELECT NOT 'hello';
-- Tag: window_functions_window_functions_operators_test_select_6629
SELECT id FROM data WHERE NOT CAST(value AS BOOL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6630
SELECT id FROM data WHERE NOT (CASE WHEN value > 15 THEN TRUE ELSE FALSE END) ORDER BY id;

DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, group_id INT64, active BOOL);
INSERT INTO flags VALUES (1, 1, TRUE);
INSERT INTO flags VALUES (2, 1, FALSE);
INSERT INTO flags VALUES (3, 2, FALSE);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category STRING);
INSERT INTO items VALUES (1, 'A');
INSERT INTO items VALUES (2, 'A');
INSERT INTO items VALUES (3, 'B');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (id INT64, value INT64, is_max BOOL);
INSERT INTO scores VALUES (1, 10, FALSE);
INSERT INTO scores VALUES (2, 20, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, active BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, flag BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, flag BOOL);
INSERT INTO t1 VALUES (1, TRUE);
INSERT INTO t2 VALUES (2, FALSE);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64);
INSERT INTO customers VALUES (1);
INSERT INTO customers VALUES (2);
INSERT INTO orders VALUES (1);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, value BOOL);
INSERT INTO flags VALUES (1, TRUE);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, active BOOL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO data VALUES (1, TRUE, NULL, FALSE);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, flag BOOL);
INSERT INTO nulls VALUES (1, NULL);
INSERT INTO nulls VALUES (2, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, a INT64, b INT64);
INSERT INTO nums VALUES (1, 5, 10);
DROP TABLE IF EXISTS complex;
CREATE TABLE complex (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO complex VALUES (1, TRUE, TRUE, FALSE);
INSERT INTO complex VALUES (2, FALSE, TRUE, FALSE);
INSERT INTO complex VALUES (3, TRUE, FALSE, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'true');
INSERT INTO data VALUES (2, 'false');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);

-- Tag: window_functions_window_functions_operators_test_select_6631
SELECT group_id, NOT MAX(active) as all_inactive FROM flags GROUP BY group_id ORDER BY group_id;
-- Tag: window_functions_window_functions_operators_test_select_6632
SELECT category FROM items GROUP BY category HAVING NOT (COUNT(*) = 1);
-- Tag: window_functions_window_functions_operators_test_select_6633
SELECT id, NOT (value = MAX(value) OVER ()) as not_max FROM scores ORDER BY id;
WITH cte AS (SELECT id, active FROM data) SELECT id FROM cte WHERE NOT active ORDER BY id;
WITH filtered AS (SELECT id FROM data WHERE NOT (value < 15)) SELECT * FROM filtered ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6634
SELECT id FROM (SELECT id, flag FROM t1 UNION SELECT id, flag FROM t2) AS combined WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6635
SELECT id, (NOT EXISTS (SELECT 1 FROM orders WHERE customer_id = customers.id)) as has_no_orders FROM customers ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6636
SELECT NOT (SELECT value FROM flags WHERE id = 1) as inverted;
-- Tag: window_functions_window_functions_operators_test_select_6637
SELECT COUNT(*) FROM large WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6638
SELECT id FROM data WHERE NOT ((a AND b) OR c);
-- Tag: window_functions_window_functions_operators_test_select_6639
SELECT id FROM nulls WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6640
SELECT id FROM nums WHERE NOT a < b;
-- Tag: window_functions_window_functions_operators_test_select_6641
SELECT id FROM complex WHERE NOT a AND b OR c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6642
SELECT NOT;
-- Tag: window_functions_window_functions_operators_test_select_6643
SELECT NOT 42;
-- Tag: window_functions_window_functions_operators_test_select_6644
SELECT NOT 'hello';
-- Tag: window_functions_window_functions_operators_test_select_6645
SELECT id FROM data WHERE NOT CAST(value AS BOOL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6646
SELECT id FROM data WHERE NOT (CASE WHEN value > 15 THEN TRUE ELSE FALSE END) ORDER BY id;

DROP TABLE IF EXISTS scores;
CREATE TABLE scores (id INT64, value INT64, is_max BOOL);
INSERT INTO scores VALUES (1, 10, FALSE);
INSERT INTO scores VALUES (2, 20, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, active BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, flag BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, flag BOOL);
INSERT INTO t1 VALUES (1, TRUE);
INSERT INTO t2 VALUES (2, FALSE);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64);
INSERT INTO customers VALUES (1);
INSERT INTO customers VALUES (2);
INSERT INTO orders VALUES (1);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, value BOOL);
INSERT INTO flags VALUES (1, TRUE);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, active BOOL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO data VALUES (1, TRUE, NULL, FALSE);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, flag BOOL);
INSERT INTO nulls VALUES (1, NULL);
INSERT INTO nulls VALUES (2, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, a INT64, b INT64);
INSERT INTO nums VALUES (1, 5, 10);
DROP TABLE IF EXISTS complex;
CREATE TABLE complex (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO complex VALUES (1, TRUE, TRUE, FALSE);
INSERT INTO complex VALUES (2, FALSE, TRUE, FALSE);
INSERT INTO complex VALUES (3, TRUE, FALSE, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'true');
INSERT INTO data VALUES (2, 'false');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);

-- Tag: window_functions_window_functions_operators_test_select_6647
SELECT id, NOT (value = MAX(value) OVER ()) as not_max FROM scores ORDER BY id;
WITH cte AS (SELECT id, active FROM data) SELECT id FROM cte WHERE NOT active ORDER BY id;
WITH filtered AS (SELECT id FROM data WHERE NOT (value < 15)) SELECT * FROM filtered ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6648
SELECT id FROM (SELECT id, flag FROM t1 UNION SELECT id, flag FROM t2) AS combined WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6649
SELECT id, (NOT EXISTS (SELECT 1 FROM orders WHERE customer_id = customers.id)) as has_no_orders FROM customers ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6650
SELECT NOT (SELECT value FROM flags WHERE id = 1) as inverted;
-- Tag: window_functions_window_functions_operators_test_select_6651
SELECT COUNT(*) FROM large WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6652
SELECT id FROM data WHERE NOT ((a AND b) OR c);
-- Tag: window_functions_window_functions_operators_test_select_6653
SELECT id FROM nulls WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6654
SELECT id FROM nums WHERE NOT a < b;
-- Tag: window_functions_window_functions_operators_test_select_6655
SELECT id FROM complex WHERE NOT a AND b OR c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6656
SELECT NOT;
-- Tag: window_functions_window_functions_operators_test_select_6657
SELECT NOT 42;
-- Tag: window_functions_window_functions_operators_test_select_6658
SELECT NOT 'hello';
-- Tag: window_functions_window_functions_operators_test_select_6659
SELECT id FROM data WHERE NOT CAST(value AS BOOL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6660
SELECT id FROM data WHERE NOT (CASE WHEN value > 15 THEN TRUE ELSE FALSE END) ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, active BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, flag BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, flag BOOL);
INSERT INTO t1 VALUES (1, TRUE);
INSERT INTO t2 VALUES (2, FALSE);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64);
INSERT INTO customers VALUES (1);
INSERT INTO customers VALUES (2);
INSERT INTO orders VALUES (1);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, value BOOL);
INSERT INTO flags VALUES (1, TRUE);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, active BOOL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO data VALUES (1, TRUE, NULL, FALSE);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, flag BOOL);
INSERT INTO nulls VALUES (1, NULL);
INSERT INTO nulls VALUES (2, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, a INT64, b INT64);
INSERT INTO nums VALUES (1, 5, 10);
DROP TABLE IF EXISTS complex;
CREATE TABLE complex (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO complex VALUES (1, TRUE, TRUE, FALSE);
INSERT INTO complex VALUES (2, FALSE, TRUE, FALSE);
INSERT INTO complex VALUES (3, TRUE, FALSE, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'true');
INSERT INTO data VALUES (2, 'false');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);

WITH cte AS (SELECT id, active FROM data) SELECT id FROM cte WHERE NOT active ORDER BY id;
WITH filtered AS (SELECT id FROM data WHERE NOT (value < 15)) SELECT * FROM filtered ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6661
SELECT id FROM (SELECT id, flag FROM t1 UNION SELECT id, flag FROM t2) AS combined WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6662
SELECT id, (NOT EXISTS (SELECT 1 FROM orders WHERE customer_id = customers.id)) as has_no_orders FROM customers ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6663
SELECT NOT (SELECT value FROM flags WHERE id = 1) as inverted;
-- Tag: window_functions_window_functions_operators_test_select_6664
SELECT COUNT(*) FROM large WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6665
SELECT id FROM data WHERE NOT ((a AND b) OR c);
-- Tag: window_functions_window_functions_operators_test_select_6666
SELECT id FROM nulls WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6667
SELECT id FROM nums WHERE NOT a < b;
-- Tag: window_functions_window_functions_operators_test_select_6668
SELECT id FROM complex WHERE NOT a AND b OR c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6669
SELECT NOT;
-- Tag: window_functions_window_functions_operators_test_select_6670
SELECT NOT 42;
-- Tag: window_functions_window_functions_operators_test_select_6671
SELECT NOT 'hello';
-- Tag: window_functions_window_functions_operators_test_select_6672
SELECT id FROM data WHERE NOT CAST(value AS BOOL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6673
SELECT id FROM data WHERE NOT (CASE WHEN value > 15 THEN TRUE ELSE FALSE END) ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, flag BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, flag BOOL);
INSERT INTO t1 VALUES (1, TRUE);
INSERT INTO t2 VALUES (2, FALSE);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64);
INSERT INTO customers VALUES (1);
INSERT INTO customers VALUES (2);
INSERT INTO orders VALUES (1);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, value BOOL);
INSERT INTO flags VALUES (1, TRUE);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, active BOOL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO data VALUES (1, TRUE, NULL, FALSE);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, flag BOOL);
INSERT INTO nulls VALUES (1, NULL);
INSERT INTO nulls VALUES (2, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, a INT64, b INT64);
INSERT INTO nums VALUES (1, 5, 10);
DROP TABLE IF EXISTS complex;
CREATE TABLE complex (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO complex VALUES (1, TRUE, TRUE, FALSE);
INSERT INTO complex VALUES (2, FALSE, TRUE, FALSE);
INSERT INTO complex VALUES (3, TRUE, FALSE, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'true');
INSERT INTO data VALUES (2, 'false');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);

WITH filtered AS (SELECT id FROM data WHERE NOT (value < 15)) SELECT * FROM filtered ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6674
SELECT id FROM (SELECT id, flag FROM t1 UNION SELECT id, flag FROM t2) AS combined WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6675
SELECT id, (NOT EXISTS (SELECT 1 FROM orders WHERE customer_id = customers.id)) as has_no_orders FROM customers ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6676
SELECT NOT (SELECT value FROM flags WHERE id = 1) as inverted;
-- Tag: window_functions_window_functions_operators_test_select_6677
SELECT COUNT(*) FROM large WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6678
SELECT id FROM data WHERE NOT ((a AND b) OR c);
-- Tag: window_functions_window_functions_operators_test_select_6679
SELECT id FROM nulls WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6680
SELECT id FROM nums WHERE NOT a < b;
-- Tag: window_functions_window_functions_operators_test_select_6681
SELECT id FROM complex WHERE NOT a AND b OR c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6682
SELECT NOT;
-- Tag: window_functions_window_functions_operators_test_select_6683
SELECT NOT 42;
-- Tag: window_functions_window_functions_operators_test_select_6684
SELECT NOT 'hello';
-- Tag: window_functions_window_functions_operators_test_select_6685
SELECT id FROM data WHERE NOT CAST(value AS BOOL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6686
SELECT id FROM data WHERE NOT (CASE WHEN value > 15 THEN TRUE ELSE FALSE END) ORDER BY id;

DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, flag BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, flag BOOL);
INSERT INTO t1 VALUES (1, TRUE);
INSERT INTO t2 VALUES (2, FALSE);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64);
INSERT INTO customers VALUES (1);
INSERT INTO customers VALUES (2);
INSERT INTO orders VALUES (1);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, value BOOL);
INSERT INTO flags VALUES (1, TRUE);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, active BOOL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO data VALUES (1, TRUE, NULL, FALSE);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, flag BOOL);
INSERT INTO nulls VALUES (1, NULL);
INSERT INTO nulls VALUES (2, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, a INT64, b INT64);
INSERT INTO nums VALUES (1, 5, 10);
DROP TABLE IF EXISTS complex;
CREATE TABLE complex (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO complex VALUES (1, TRUE, TRUE, FALSE);
INSERT INTO complex VALUES (2, FALSE, TRUE, FALSE);
INSERT INTO complex VALUES (3, TRUE, FALSE, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'true');
INSERT INTO data VALUES (2, 'false');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);

-- Tag: window_functions_window_functions_operators_test_select_6687
SELECT id FROM (SELECT id, flag FROM t1 UNION SELECT id, flag FROM t2) AS combined WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6688
SELECT id, (NOT EXISTS (SELECT 1 FROM orders WHERE customer_id = customers.id)) as has_no_orders FROM customers ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6689
SELECT NOT (SELECT value FROM flags WHERE id = 1) as inverted;
-- Tag: window_functions_window_functions_operators_test_select_6690
SELECT COUNT(*) FROM large WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6691
SELECT id FROM data WHERE NOT ((a AND b) OR c);
-- Tag: window_functions_window_functions_operators_test_select_6692
SELECT id FROM nulls WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6693
SELECT id FROM nums WHERE NOT a < b;
-- Tag: window_functions_window_functions_operators_test_select_6694
SELECT id FROM complex WHERE NOT a AND b OR c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6695
SELECT NOT;
-- Tag: window_functions_window_functions_operators_test_select_6696
SELECT NOT 42;
-- Tag: window_functions_window_functions_operators_test_select_6697
SELECT NOT 'hello';
-- Tag: window_functions_window_functions_operators_test_select_6698
SELECT id FROM data WHERE NOT CAST(value AS BOOL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6699
SELECT id FROM data WHERE NOT (CASE WHEN value > 15 THEN TRUE ELSE FALSE END) ORDER BY id;

DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64);
INSERT INTO customers VALUES (1);
INSERT INTO customers VALUES (2);
INSERT INTO orders VALUES (1);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, value BOOL);
INSERT INTO flags VALUES (1, TRUE);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, active BOOL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO data VALUES (1, TRUE, NULL, FALSE);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, flag BOOL);
INSERT INTO nulls VALUES (1, NULL);
INSERT INTO nulls VALUES (2, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, a INT64, b INT64);
INSERT INTO nums VALUES (1, 5, 10);
DROP TABLE IF EXISTS complex;
CREATE TABLE complex (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO complex VALUES (1, TRUE, TRUE, FALSE);
INSERT INTO complex VALUES (2, FALSE, TRUE, FALSE);
INSERT INTO complex VALUES (3, TRUE, FALSE, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'true');
INSERT INTO data VALUES (2, 'false');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);

-- Tag: window_functions_window_functions_operators_test_select_6700
SELECT id, (NOT EXISTS (SELECT 1 FROM orders WHERE customer_id = customers.id)) as has_no_orders FROM customers ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6701
SELECT NOT (SELECT value FROM flags WHERE id = 1) as inverted;
-- Tag: window_functions_window_functions_operators_test_select_6702
SELECT COUNT(*) FROM large WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6703
SELECT id FROM data WHERE NOT ((a AND b) OR c);
-- Tag: window_functions_window_functions_operators_test_select_6704
SELECT id FROM nulls WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6705
SELECT id FROM nums WHERE NOT a < b;
-- Tag: window_functions_window_functions_operators_test_select_6706
SELECT id FROM complex WHERE NOT a AND b OR c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6707
SELECT NOT;
-- Tag: window_functions_window_functions_operators_test_select_6708
SELECT NOT 42;
-- Tag: window_functions_window_functions_operators_test_select_6709
SELECT NOT 'hello';
-- Tag: window_functions_window_functions_operators_test_select_6710
SELECT id FROM data WHERE NOT CAST(value AS BOOL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6711
SELECT id FROM data WHERE NOT (CASE WHEN value > 15 THEN TRUE ELSE FALSE END) ORDER BY id;

DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, value BOOL);
INSERT INTO flags VALUES (1, TRUE);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, active BOOL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO data VALUES (1, TRUE, NULL, FALSE);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, flag BOOL);
INSERT INTO nulls VALUES (1, NULL);
INSERT INTO nulls VALUES (2, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, a INT64, b INT64);
INSERT INTO nums VALUES (1, 5, 10);
DROP TABLE IF EXISTS complex;
CREATE TABLE complex (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO complex VALUES (1, TRUE, TRUE, FALSE);
INSERT INTO complex VALUES (2, FALSE, TRUE, FALSE);
INSERT INTO complex VALUES (3, TRUE, FALSE, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'true');
INSERT INTO data VALUES (2, 'false');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);

-- Tag: window_functions_window_functions_operators_test_select_6712
SELECT NOT (SELECT value FROM flags WHERE id = 1) as inverted;
-- Tag: window_functions_window_functions_operators_test_select_6713
SELECT COUNT(*) FROM large WHERE NOT active;
-- Tag: window_functions_window_functions_operators_test_select_6714
SELECT id FROM data WHERE NOT ((a AND b) OR c);
-- Tag: window_functions_window_functions_operators_test_select_6715
SELECT id FROM nulls WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6716
SELECT id FROM nums WHERE NOT a < b;
-- Tag: window_functions_window_functions_operators_test_select_6717
SELECT id FROM complex WHERE NOT a AND b OR c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6718
SELECT NOT;
-- Tag: window_functions_window_functions_operators_test_select_6719
SELECT NOT 42;
-- Tag: window_functions_window_functions_operators_test_select_6720
SELECT NOT 'hello';
-- Tag: window_functions_window_functions_operators_test_select_6721
SELECT id FROM data WHERE NOT CAST(value AS BOOL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6722
SELECT id FROM data WHERE NOT (CASE WHEN value > 15 THEN TRUE ELSE FALSE END) ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO data VALUES (1, TRUE, NULL, FALSE);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, flag BOOL);
INSERT INTO nulls VALUES (1, NULL);
INSERT INTO nulls VALUES (2, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, a INT64, b INT64);
INSERT INTO nums VALUES (1, 5, 10);
DROP TABLE IF EXISTS complex;
CREATE TABLE complex (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO complex VALUES (1, TRUE, TRUE, FALSE);
INSERT INTO complex VALUES (2, FALSE, TRUE, FALSE);
INSERT INTO complex VALUES (3, TRUE, FALSE, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'true');
INSERT INTO data VALUES (2, 'false');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);

-- Tag: window_functions_window_functions_operators_test_select_6723
SELECT id FROM data WHERE NOT ((a AND b) OR c);
-- Tag: window_functions_window_functions_operators_test_select_6724
SELECT id FROM nulls WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6725
SELECT id FROM nums WHERE NOT a < b;
-- Tag: window_functions_window_functions_operators_test_select_6726
SELECT id FROM complex WHERE NOT a AND b OR c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6727
SELECT NOT;
-- Tag: window_functions_window_functions_operators_test_select_6728
SELECT NOT 42;
-- Tag: window_functions_window_functions_operators_test_select_6729
SELECT NOT 'hello';
-- Tag: window_functions_window_functions_operators_test_select_6730
SELECT id FROM data WHERE NOT CAST(value AS BOOL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6731
SELECT id FROM data WHERE NOT (CASE WHEN value > 15 THEN TRUE ELSE FALSE END) ORDER BY id;

DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, flag BOOL);
INSERT INTO nulls VALUES (1, NULL);
INSERT INTO nulls VALUES (2, NULL);
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (id INT64, a INT64, b INT64);
INSERT INTO nums VALUES (1, 5, 10);
DROP TABLE IF EXISTS complex;
CREATE TABLE complex (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO complex VALUES (1, TRUE, TRUE, FALSE);
INSERT INTO complex VALUES (2, FALSE, TRUE, FALSE);
INSERT INTO complex VALUES (3, TRUE, FALSE, TRUE);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'true');
INSERT INTO data VALUES (2, 'false');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
INSERT INTO data VALUES (2, 20);

-- Tag: window_functions_window_functions_operators_test_select_6732
SELECT id FROM nulls WHERE NOT flag;
-- Tag: window_functions_window_functions_operators_test_select_6733
SELECT id FROM nums WHERE NOT a < b;
-- Tag: window_functions_window_functions_operators_test_select_6734
SELECT id FROM complex WHERE NOT a AND b OR c ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6735
SELECT NOT;
-- Tag: window_functions_window_functions_operators_test_select_6736
SELECT NOT 42;
-- Tag: window_functions_window_functions_operators_test_select_6737
SELECT NOT 'hello';
-- Tag: window_functions_window_functions_operators_test_select_6738
SELECT id FROM data WHERE NOT CAST(value AS BOOL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6739
SELECT id FROM data WHERE NOT (CASE WHEN value > 15 THEN TRUE ELSE FALSE END) ORDER BY id;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, true, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 3), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'alice'), (2, 'bob');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, category STRING, amount INT64);
INSERT INTO sales VALUES (1, 'A', 100), (2, 'A', 200), (3, 'B', NULL), (4, 'B', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 1), (2, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active'), (2, 'inactive'), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 5), (2, NULL, 5), (3, 10, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, first STRING, last STRING);
INSERT INTO test VALUES (1, 'Alice', 'Smith'), (2, NULL, 'Jones'), (3, 'Bob', NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, value BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, value INT64);
INSERT INTO t1 VALUES (1, true), (2, false);
INSERT INTO t2 VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64, category STRING);
INSERT INTO test VALUES (1, 100, 'A'), (2, 200, 'A'), (3, 150, 'B');

-- Tag: window_functions_window_functions_operators_test_select_6740
SELECT id FROM test WHERE NOT flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6741
SELECT id, NOT flag AS negated FROM test;
-- Tag: window_functions_window_functions_operators_test_select_6742
SELECT id FROM test WHERE NOT (value > 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6743
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6744
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6745
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6746
SELECT id FROM test WHERE (NOT a) OR (NOT b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6747
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6748
SELECT id FROM test WHERE (NOT a) AND (NOT b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6749
SELECT id, NOT NOT NOT value AS triple_neg FROM test;
-- Tag: window_functions_window_functions_operators_test_select_6750
SELECT id FROM test WHERE NOT NOT NOT NOT NOT NOT NOT NOT NOT NOT value ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6751
SELECT id FROM test WHERE NOT NOT NOT NOT NOT NOT NOT NOT NOT value ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6752
SELECT id FROM test WHERE value NOT IN (1, 2, NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6753
SELECT id FROM test WHERE value NOT BETWEEN NULL AND 10 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6754
SELECT id FROM test WHERE name NOT LIKE NULL ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6755
SELECT category FROM sales GROUP BY category HAVING NOT (SUM(amount) > 200);
-- Tag: window_functions_window_functions_operators_test_select_6756
SELECT NOT (COUNT(value) = COUNT(*)) AS has_nulls FROM test;
-- Tag: window_functions_window_functions_operators_test_select_6757
SELECT name FROM customers c WHERE NOT EXISTS (SELECT 1 FROM orders o WHERE o.customer_id = c.id);
-- Tag: window_functions_window_functions_operators_test_select_6758
SELECT id FROM test WHERE NOT EXISTS (SELECT 1 FROM test WHERE id > 100);
-- Tag: window_functions_window_functions_operators_test_select_6759
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE NULL END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6760
SELECT id FROM test WHERE NOT (CASE status WHEN 'active' THEN true WHEN 'inactive' THEN false ELSE NULL END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6761
SELECT id FROM test WHERE NOT (a + b > 10) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6762
SELECT id FROM test WHERE NOT (CONCAT(first, last) = 'AliceSmith') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6763
SELECT id FROM test WHERE NOT (value IS NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6764
SELECT id FROM test WHERE value IS NOT NULL ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6765
SELECT id FROM test WHERE NOT (value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6766
SELECT id FROM test WHERE value IS NULL ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6767
SELECT COUNT(*) FROM large_test WHERE NOT (NOT (NOT (value OR NOT value)));
-- Tag: window_functions_window_functions_operators_test_select_6768
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_6769
SELECT id FROM test WHERE NOT name;
WITH filtered AS (SELECT id, value FROM test WHERE value IS NOT NULL) \
-- Tag: window_functions_window_functions_operators_test_select_6770
SELECT id FROM filtered WHERE NOT (value > 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6771
SELECT t1.id FROM t1 INNER JOIN t2 ON t1.id = t2.id WHERE NOT t1.active;
-- Tag: window_functions_window_functions_operators_test_select_6772
SELECT id FROM test WHERE NOT (value > (SELECT AVG(value) FROM test)) ORDER BY id;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, flag BOOL);
INSERT INTO test VALUES (1, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, true, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, true), (2, true, false), (3, false, true), (4, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 1), (2, 3), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
INSERT INTO test VALUES (1, 'alice'), (2, 'bob');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, category STRING, amount INT64);
INSERT INTO sales VALUES (1, 'A', 100), (2, 'A', 200), (3, 'B', NULL), (4, 'B', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
INSERT INTO customers VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO orders VALUES (1, 1), (2, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, status STRING);
INSERT INTO test VALUES (1, 'active'), (2, 'inactive'), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a INT64, b INT64);
INSERT INTO test VALUES (1, 10, 5), (2, NULL, 5), (3, 10, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, first STRING, last STRING);
INSERT INTO test VALUES (1, 'Alice', 'Smith'), (2, NULL, 'Jones'), (3, 'Bob', NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS large_test;
CREATE TABLE large_test (id INT64, value BOOL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, name STRING);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, active BOOL);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, value INT64);
INSERT INTO t1 VALUES (1, true), (2, false);
INSERT INTO t2 VALUES (1, 100), (2, 200);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64, category STRING);
INSERT INTO test VALUES (1, 100, 'A'), (2, 200, 'A'), (3, 150, 'B');

-- Tag: window_functions_window_functions_operators_test_select_6773
SELECT id, NOT flag AS negated FROM test;
-- Tag: window_functions_window_functions_operators_test_select_6774
SELECT id FROM test WHERE NOT (value > 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6775
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6776
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6777
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6778
SELECT id FROM test WHERE (NOT a) OR (NOT b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6779
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6780
SELECT id FROM test WHERE (NOT a) AND (NOT b) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6781
SELECT id, NOT NOT NOT value AS triple_neg FROM test;
-- Tag: window_functions_window_functions_operators_test_select_6782
SELECT id FROM test WHERE NOT NOT NOT NOT NOT NOT NOT NOT NOT NOT value ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6783
SELECT id FROM test WHERE NOT NOT NOT NOT NOT NOT NOT NOT NOT value ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6784
SELECT id FROM test WHERE value NOT IN (1, 2, NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6785
SELECT id FROM test WHERE value NOT BETWEEN NULL AND 10 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6786
SELECT id FROM test WHERE name NOT LIKE NULL ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6787
SELECT category FROM sales GROUP BY category HAVING NOT (SUM(amount) > 200);
-- Tag: window_functions_window_functions_operators_test_select_6788
SELECT NOT (COUNT(value) = COUNT(*)) AS has_nulls FROM test;
-- Tag: window_functions_window_functions_operators_test_select_6789
SELECT name FROM customers c WHERE NOT EXISTS (SELECT 1 FROM orders o WHERE o.customer_id = c.id);
-- Tag: window_functions_window_functions_operators_test_select_6790
SELECT id FROM test WHERE NOT EXISTS (SELECT 1 FROM test WHERE id > 100);
-- Tag: window_functions_window_functions_operators_test_select_6791
SELECT id FROM test WHERE NOT (CASE WHEN value > 15 THEN true ELSE NULL END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6792
SELECT id FROM test WHERE NOT (CASE status WHEN 'active' THEN true WHEN 'inactive' THEN false ELSE NULL END) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6793
SELECT id FROM test WHERE NOT (a + b > 10) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6794
SELECT id FROM test WHERE NOT (CONCAT(first, last) = 'AliceSmith') ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6795
SELECT id FROM test WHERE NOT (value IS NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6796
SELECT id FROM test WHERE value IS NOT NULL ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6797
SELECT id FROM test WHERE NOT (value IS NOT NULL) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6798
SELECT id FROM test WHERE value IS NULL ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6799
SELECT COUNT(*) FROM large_test WHERE NOT (NOT (NOT (value OR NOT value)));
-- Tag: window_functions_window_functions_operators_test_select_6800
SELECT id FROM test WHERE NOT value;
-- Tag: window_functions_window_functions_operators_test_select_6801
SELECT id FROM test WHERE NOT name;
WITH filtered AS (SELECT id, value FROM test WHERE value IS NOT NULL) \
-- Tag: window_functions_window_functions_operators_test_select_6802
SELECT id FROM filtered WHERE NOT (value > 20) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6803
SELECT t1.id FROM t1 INNER JOIN t2 ON t1.id = t2.id WHERE NOT t1.active;
-- Tag: window_functions_window_functions_operators_test_select_6804
SELECT id FROM test WHERE NOT (value > (SELECT AVG(value) FROM test)) ORDER BY id;

DROP TABLE IF EXISTS names;
CREATE TABLE names (id INT64, name STRING);
INSERT INTO names VALUES (1, 'Alice'), (2, NULL), (3, 'Bob'), (4, NULL), (5, 'Charlie');
DROP TABLE IF EXISTS names;
CREATE TABLE names (id INT64, name STRING);
INSERT INTO names VALUES (1, 'Alice'), (2, NULL), (3, 'Bob');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, ''), (2, NULL), (3, 'A');
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (id INT64, value FLOAT64);
INSERT INTO measurements VALUES (1, 1.5), (2, NULL), (3, 2.5), (4, NULL), (5, 0.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, -5.0), (2, NULL), (3, 0.0), (4, 5.0);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, active BOOL);
INSERT INTO flags VALUES (1, true), (2, NULL), (3, false), (4, NULL), (5, true);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, NULL, 10),
(2, NULL, NULL),
(3, 5, NULL),
(4, 5, 20),
(5, 10, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64, c INT64);
INSERT INTO data VALUES
(1, 1, NULL, 10),
(2, 1, NULL, 20),
(3, 1, 5, NULL),
(4, NULL, NULL, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 10, NULL),
(4, 20, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 10),
(2, 'B', 20),
(3, 'C', NULL),
(4, 'A', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES
(1, 'hello'),
(2, NULL),
(3, 'world');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, 10, NULL),
(2, NULL, 20),
(3, 30, 40);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, score INT64);
INSERT INTO a VALUES (1, 10), (2, NULL), (3, 20);
INSERT INTO b VALUES (1, 100), (2, NULL), (3, 200);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, name STRING);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, score INT64);
INSERT INTO a VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
INSERT INTO b VALUES (1, 100), (3, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
(NULL, 200.0),
('B', 50.0),
(NULL, 75.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('A', 20),
('B', NULL),
('B', NULL),
('C', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 30), (2, 10), (3, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20), (3, NULL), (4, NULL);

-- Tag: window_functions_window_functions_operators_test_select_6805
SELECT id, name FROM names ORDER BY name NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6806
SELECT id, name FROM names ORDER BY name DESC NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6807
SELECT id FROM data ORDER BY text NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6808
SELECT id FROM measurements ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6809
SELECT id FROM data ORDER BY value ASC NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6810
SELECT id FROM flags ORDER BY active NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6811
SELECT id FROM data ORDER BY a NULLS FIRST, b NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6812
SELECT id FROM data ORDER BY a NULLS LAST, b NULLS FIRST, c NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6813
SELECT id FROM data ORDER BY a * b NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6814
SELECT id FROM data
ORDER BY CASE WHEN category = 'B' THEN NULL ELSE value END NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6815
SELECT id FROM data ORDER BY UPPER(text) NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6816
SELECT id, value
FROM (SELECT id, value FROM data ORDER BY value NULLS FIRST) as sorted
LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6817
SELECT id, a, b
FROM (SELECT id, a, b FROM data ORDER BY a NULLS FIRST) as sorted
ORDER BY b NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6818
SELECT a.id
FROM a
JOIN b ON a.id = b.id
ORDER BY a.value NULLS FIRST, b.score NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6819
SELECT a.id, a.name
FROM a
LEFT JOIN b ON a.id = b.id
ORDER BY b.score NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6820
SELECT category, SUM(amount) as total
FROM sales
GROUP BY category
ORDER BY category NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6821
SELECT category, MAX(value) as max_val
FROM data
GROUP BY category
ORDER BY MAX(value) NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6822
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6823
SELECT id FROM data ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6824
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6825
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6826
SELECT id FROM data ORDER BY value NULLS FIRST LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6827
SELECT id FROM data ORDER BY value NULLS LAST OFFSET 2;

DROP TABLE IF EXISTS names;
CREATE TABLE names (id INT64, name STRING);
INSERT INTO names VALUES (1, 'Alice'), (2, NULL), (3, 'Bob');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, ''), (2, NULL), (3, 'A');
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (id INT64, value FLOAT64);
INSERT INTO measurements VALUES (1, 1.5), (2, NULL), (3, 2.5), (4, NULL), (5, 0.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, -5.0), (2, NULL), (3, 0.0), (4, 5.0);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, active BOOL);
INSERT INTO flags VALUES (1, true), (2, NULL), (3, false), (4, NULL), (5, true);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, NULL, 10),
(2, NULL, NULL),
(3, 5, NULL),
(4, 5, 20),
(5, 10, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64, c INT64);
INSERT INTO data VALUES
(1, 1, NULL, 10),
(2, 1, NULL, 20),
(3, 1, 5, NULL),
(4, NULL, NULL, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 10, NULL),
(4, 20, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 10),
(2, 'B', 20),
(3, 'C', NULL),
(4, 'A', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES
(1, 'hello'),
(2, NULL),
(3, 'world');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, 10, NULL),
(2, NULL, 20),
(3, 30, 40);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, score INT64);
INSERT INTO a VALUES (1, 10), (2, NULL), (3, 20);
INSERT INTO b VALUES (1, 100), (2, NULL), (3, 200);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, name STRING);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, score INT64);
INSERT INTO a VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
INSERT INTO b VALUES (1, 100), (3, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
(NULL, 200.0),
('B', 50.0),
(NULL, 75.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('A', 20),
('B', NULL),
('B', NULL),
('C', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 30), (2, 10), (3, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20), (3, NULL), (4, NULL);

-- Tag: window_functions_window_functions_operators_test_select_6828
SELECT id, name FROM names ORDER BY name DESC NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6829
SELECT id FROM data ORDER BY text NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6830
SELECT id FROM measurements ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6831
SELECT id FROM data ORDER BY value ASC NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6832
SELECT id FROM flags ORDER BY active NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6833
SELECT id FROM data ORDER BY a NULLS FIRST, b NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6834
SELECT id FROM data ORDER BY a NULLS LAST, b NULLS FIRST, c NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6835
SELECT id FROM data ORDER BY a * b NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6836
SELECT id FROM data
ORDER BY CASE WHEN category = 'B' THEN NULL ELSE value END NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6837
SELECT id FROM data ORDER BY UPPER(text) NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6838
SELECT id, value
FROM (SELECT id, value FROM data ORDER BY value NULLS FIRST) as sorted
LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6839
SELECT id, a, b
FROM (SELECT id, a, b FROM data ORDER BY a NULLS FIRST) as sorted
ORDER BY b NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6840
SELECT a.id
FROM a
JOIN b ON a.id = b.id
ORDER BY a.value NULLS FIRST, b.score NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6841
SELECT a.id, a.name
FROM a
LEFT JOIN b ON a.id = b.id
ORDER BY b.score NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6842
SELECT category, SUM(amount) as total
FROM sales
GROUP BY category
ORDER BY category NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6843
SELECT category, MAX(value) as max_val
FROM data
GROUP BY category
ORDER BY MAX(value) NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6844
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6845
SELECT id FROM data ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6846
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6847
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6848
SELECT id FROM data ORDER BY value NULLS FIRST LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6849
SELECT id FROM data ORDER BY value NULLS LAST OFFSET 2;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, ''), (2, NULL), (3, 'A');
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (id INT64, value FLOAT64);
INSERT INTO measurements VALUES (1, 1.5), (2, NULL), (3, 2.5), (4, NULL), (5, 0.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, -5.0), (2, NULL), (3, 0.0), (4, 5.0);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, active BOOL);
INSERT INTO flags VALUES (1, true), (2, NULL), (3, false), (4, NULL), (5, true);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, NULL, 10),
(2, NULL, NULL),
(3, 5, NULL),
(4, 5, 20),
(5, 10, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64, c INT64);
INSERT INTO data VALUES
(1, 1, NULL, 10),
(2, 1, NULL, 20),
(3, 1, 5, NULL),
(4, NULL, NULL, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 10, NULL),
(4, 20, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 10),
(2, 'B', 20),
(3, 'C', NULL),
(4, 'A', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES
(1, 'hello'),
(2, NULL),
(3, 'world');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, 10, NULL),
(2, NULL, 20),
(3, 30, 40);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, score INT64);
INSERT INTO a VALUES (1, 10), (2, NULL), (3, 20);
INSERT INTO b VALUES (1, 100), (2, NULL), (3, 200);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, name STRING);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, score INT64);
INSERT INTO a VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
INSERT INTO b VALUES (1, 100), (3, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
(NULL, 200.0),
('B', 50.0),
(NULL, 75.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('A', 20),
('B', NULL),
('B', NULL),
('C', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 30), (2, 10), (3, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20), (3, NULL), (4, NULL);

-- Tag: window_functions_window_functions_operators_test_select_6850
SELECT id FROM data ORDER BY text NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6851
SELECT id FROM measurements ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6852
SELECT id FROM data ORDER BY value ASC NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6853
SELECT id FROM flags ORDER BY active NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6854
SELECT id FROM data ORDER BY a NULLS FIRST, b NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6855
SELECT id FROM data ORDER BY a NULLS LAST, b NULLS FIRST, c NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6856
SELECT id FROM data ORDER BY a * b NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6857
SELECT id FROM data
ORDER BY CASE WHEN category = 'B' THEN NULL ELSE value END NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6858
SELECT id FROM data ORDER BY UPPER(text) NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6859
SELECT id, value
FROM (SELECT id, value FROM data ORDER BY value NULLS FIRST) as sorted
LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6860
SELECT id, a, b
FROM (SELECT id, a, b FROM data ORDER BY a NULLS FIRST) as sorted
ORDER BY b NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6861
SELECT a.id
FROM a
JOIN b ON a.id = b.id
ORDER BY a.value NULLS FIRST, b.score NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6862
SELECT a.id, a.name
FROM a
LEFT JOIN b ON a.id = b.id
ORDER BY b.score NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6863
SELECT category, SUM(amount) as total
FROM sales
GROUP BY category
ORDER BY category NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6864
SELECT category, MAX(value) as max_val
FROM data
GROUP BY category
ORDER BY MAX(value) NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6865
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6866
SELECT id FROM data ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6867
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6868
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6869
SELECT id FROM data ORDER BY value NULLS FIRST LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6870
SELECT id FROM data ORDER BY value NULLS LAST OFFSET 2;

DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (id INT64, value FLOAT64);
INSERT INTO measurements VALUES (1, 1.5), (2, NULL), (3, 2.5), (4, NULL), (5, 0.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, -5.0), (2, NULL), (3, 0.0), (4, 5.0);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, active BOOL);
INSERT INTO flags VALUES (1, true), (2, NULL), (3, false), (4, NULL), (5, true);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, NULL, 10),
(2, NULL, NULL),
(3, 5, NULL),
(4, 5, 20),
(5, 10, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64, c INT64);
INSERT INTO data VALUES
(1, 1, NULL, 10),
(2, 1, NULL, 20),
(3, 1, 5, NULL),
(4, NULL, NULL, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 10, NULL),
(4, 20, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 10),
(2, 'B', 20),
(3, 'C', NULL),
(4, 'A', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES
(1, 'hello'),
(2, NULL),
(3, 'world');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, 10, NULL),
(2, NULL, 20),
(3, 30, 40);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, score INT64);
INSERT INTO a VALUES (1, 10), (2, NULL), (3, 20);
INSERT INTO b VALUES (1, 100), (2, NULL), (3, 200);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, name STRING);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, score INT64);
INSERT INTO a VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
INSERT INTO b VALUES (1, 100), (3, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
(NULL, 200.0),
('B', 50.0),
(NULL, 75.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('A', 20),
('B', NULL),
('B', NULL),
('C', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 30), (2, 10), (3, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20), (3, NULL), (4, NULL);

-- Tag: window_functions_window_functions_operators_test_select_6871
SELECT id FROM measurements ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6872
SELECT id FROM data ORDER BY value ASC NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6873
SELECT id FROM flags ORDER BY active NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6874
SELECT id FROM data ORDER BY a NULLS FIRST, b NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6875
SELECT id FROM data ORDER BY a NULLS LAST, b NULLS FIRST, c NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6876
SELECT id FROM data ORDER BY a * b NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6877
SELECT id FROM data
ORDER BY CASE WHEN category = 'B' THEN NULL ELSE value END NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6878
SELECT id FROM data ORDER BY UPPER(text) NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6879
SELECT id, value
FROM (SELECT id, value FROM data ORDER BY value NULLS FIRST) as sorted
LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6880
SELECT id, a, b
FROM (SELECT id, a, b FROM data ORDER BY a NULLS FIRST) as sorted
ORDER BY b NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6881
SELECT a.id
FROM a
JOIN b ON a.id = b.id
ORDER BY a.value NULLS FIRST, b.score NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6882
SELECT a.id, a.name
FROM a
LEFT JOIN b ON a.id = b.id
ORDER BY b.score NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6883
SELECT category, SUM(amount) as total
FROM sales
GROUP BY category
ORDER BY category NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6884
SELECT category, MAX(value) as max_val
FROM data
GROUP BY category
ORDER BY MAX(value) NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6885
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6886
SELECT id FROM data ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6887
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6888
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6889
SELECT id FROM data ORDER BY value NULLS FIRST LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6890
SELECT id FROM data ORDER BY value NULLS LAST OFFSET 2;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value FLOAT64);
INSERT INTO data VALUES (1, -5.0), (2, NULL), (3, 0.0), (4, 5.0);
DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, active BOOL);
INSERT INTO flags VALUES (1, true), (2, NULL), (3, false), (4, NULL), (5, true);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, NULL, 10),
(2, NULL, NULL),
(3, 5, NULL),
(4, 5, 20),
(5, 10, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64, c INT64);
INSERT INTO data VALUES
(1, 1, NULL, 10),
(2, 1, NULL, 20),
(3, 1, 5, NULL),
(4, NULL, NULL, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 10, NULL),
(4, 20, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 10),
(2, 'B', 20),
(3, 'C', NULL),
(4, 'A', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES
(1, 'hello'),
(2, NULL),
(3, 'world');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, 10, NULL),
(2, NULL, 20),
(3, 30, 40);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, score INT64);
INSERT INTO a VALUES (1, 10), (2, NULL), (3, 20);
INSERT INTO b VALUES (1, 100), (2, NULL), (3, 200);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, name STRING);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, score INT64);
INSERT INTO a VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
INSERT INTO b VALUES (1, 100), (3, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
(NULL, 200.0),
('B', 50.0),
(NULL, 75.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('A', 20),
('B', NULL),
('B', NULL),
('C', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 30), (2, 10), (3, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20), (3, NULL), (4, NULL);

-- Tag: window_functions_window_functions_operators_test_select_6891
SELECT id FROM data ORDER BY value ASC NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6892
SELECT id FROM flags ORDER BY active NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6893
SELECT id FROM data ORDER BY a NULLS FIRST, b NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6894
SELECT id FROM data ORDER BY a NULLS LAST, b NULLS FIRST, c NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6895
SELECT id FROM data ORDER BY a * b NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6896
SELECT id FROM data
ORDER BY CASE WHEN category = 'B' THEN NULL ELSE value END NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6897
SELECT id FROM data ORDER BY UPPER(text) NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6898
SELECT id, value
FROM (SELECT id, value FROM data ORDER BY value NULLS FIRST) as sorted
LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6899
SELECT id, a, b
FROM (SELECT id, a, b FROM data ORDER BY a NULLS FIRST) as sorted
ORDER BY b NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6900
SELECT a.id
FROM a
JOIN b ON a.id = b.id
ORDER BY a.value NULLS FIRST, b.score NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6901
SELECT a.id, a.name
FROM a
LEFT JOIN b ON a.id = b.id
ORDER BY b.score NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6902
SELECT category, SUM(amount) as total
FROM sales
GROUP BY category
ORDER BY category NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6903
SELECT category, MAX(value) as max_val
FROM data
GROUP BY category
ORDER BY MAX(value) NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6904
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6905
SELECT id FROM data ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6906
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6907
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6908
SELECT id FROM data ORDER BY value NULLS FIRST LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6909
SELECT id FROM data ORDER BY value NULLS LAST OFFSET 2;

DROP TABLE IF EXISTS flags;
CREATE TABLE flags (id INT64, active BOOL);
INSERT INTO flags VALUES (1, true), (2, NULL), (3, false), (4, NULL), (5, true);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, NULL, 10),
(2, NULL, NULL),
(3, 5, NULL),
(4, 5, 20),
(5, 10, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64, c INT64);
INSERT INTO data VALUES
(1, 1, NULL, 10),
(2, 1, NULL, 20),
(3, 1, 5, NULL),
(4, NULL, NULL, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, 10, 5),
(2, NULL, 5),
(3, 10, NULL),
(4, 20, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES
(1, 'A', 10),
(2, 'B', 20),
(3, 'C', NULL),
(4, 'A', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES
(1, 'hello'),
(2, NULL),
(3, 'world');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b INT64);
INSERT INTO data VALUES
(1, 10, NULL),
(2, NULL, 20),
(3, 30, 40);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, value INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, score INT64);
INSERT INTO a VALUES (1, 10), (2, NULL), (3, 20);
INSERT INTO b VALUES (1, 100), (2, NULL), (3, 200);
DROP TABLE IF EXISTS a;
CREATE TABLE a (id INT64, name STRING);
DROP TABLE IF EXISTS b;
CREATE TABLE b (id INT64, score INT64);
INSERT INTO a VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie');
INSERT INTO b VALUES (1, 100), (3, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
(NULL, 200.0),
('B', 50.0),
(NULL, 75.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES
('A', 10),
('A', 20),
('B', NULL),
('B', NULL),
('C', 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 30), (2, 10), (3, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20), (3, NULL), (4, NULL);

-- Tag: window_functions_window_functions_operators_test_select_6910
SELECT id FROM flags ORDER BY active NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6911
SELECT id FROM data ORDER BY a NULLS FIRST, b NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6912
SELECT id FROM data ORDER BY a NULLS LAST, b NULLS FIRST, c NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6913
SELECT id FROM data ORDER BY a * b NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6914
SELECT id FROM data
ORDER BY CASE WHEN category = 'B' THEN NULL ELSE value END NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6915
SELECT id FROM data ORDER BY UPPER(text) NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6916
SELECT id, value
FROM (SELECT id, value FROM data ORDER BY value NULLS FIRST) as sorted
LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6917
SELECT id, a, b
FROM (SELECT id, a, b FROM data ORDER BY a NULLS FIRST) as sorted
ORDER BY b NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6918
SELECT a.id
FROM a
JOIN b ON a.id = b.id
ORDER BY a.value NULLS FIRST, b.score NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6919
SELECT a.id, a.name
FROM a
LEFT JOIN b ON a.id = b.id
ORDER BY b.score NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6920
SELECT category, SUM(amount) as total
FROM sales
GROUP BY category
ORDER BY category NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6921
SELECT category, MAX(value) as max_val
FROM data
GROUP BY category
ORDER BY MAX(value) NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6922
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6923
SELECT id FROM data ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6924
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6925
SELECT id FROM data ORDER BY value NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6926
SELECT id FROM data ORDER BY value NULLS FIRST LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6927
SELECT id FROM data ORDER BY value NULLS LAST OFFSET 2;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, 5);
INSERT INTO test VALUES (4, 30);
INSERT INTO test VALUES (5, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, 5);
INSERT INTO test VALUES (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, 5);
INSERT INTO test VALUES (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, 5);
INSERT INTO test VALUES (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (NULL), (5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (NULL, 10);
INSERT INTO test VALUES (1, 5);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, discount FLOAT64);
INSERT INTO products VALUES ('Widget', 100.0, 0.1);
INSERT INTO products VALUES ('Gadget', 50.0, 0.2);
INSERT INTO products VALUES ('Gizmo', 80.0, 0.05);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('Alice');
INSERT INTO names VALUES ('Charlotte');
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, status STRING, priority INT64);
INSERT INTO tasks VALUES (1, 'pending', 1);
INSERT INTO tasks VALUES (2, 'completed', 2);
INSERT INTO tasks VALUES (3, 'in_progress', 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (1, 20);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING);
INSERT INTO products VALUES ('Banana');
INSERT INTO products VALUES ('apple');
INSERT INTO products VALUES ('Apple');
INSERT INTO products VALUES ('Cherry');
DROP TABLE IF EXISTS words;
CREATE TABLE words (word STRING);
INSERT INTO words VALUES ('zebra');
INSERT INTO words VALUES ('pple');
INSERT INTO words VALUES ('orange');
DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_6928
SELECT value FROM test ORDER BY value ASC NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6929
SELECT value FROM test ORDER BY value ASC NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6930
SELECT value FROM test ORDER BY value DESC NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6931
SELECT value FROM test ORDER BY value DESC NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6932
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_6933
SELECT col1, col2 FROM test
ORDER BY col1 ASC NULLS LAST, col2 DESC NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6934
SELECT name, price * (1 - discount) as final_price
FROM products
ORDER BY price * (1 - discount) ASC;
-- Tag: window_functions_window_functions_operators_test_select_6935
SELECT name FROM names ORDER BY LENGTH(name) ASC;
-- Tag: window_functions_window_functions_operators_test_select_6936
SELECT id, status FROM tasks
ORDER BY CASE status
WHEN 'in_progress' THEN 1
WHEN 'pending' THEN 2
WHEN 'completed' THEN 3
END;
-- Tag: window_functions_window_functions_operators_test_select_6937
SELECT col1, col2 FROM test ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_6938
SELECT col1 FROM test ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_6939
SELECT col1 FROM test ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_6940
SELECT name FROM products ORDER BY name COLLATE NOCASE;
-- Tag: window_functions_window_functions_operators_test_select_6941
SELECT word FROM words ORDER BY word COLLATE 'sv_SE';
-- Tag: window_functions_window_functions_operators_test_select_6942
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6943
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_6944
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_6945
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_6946
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6947
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_6948
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_6949
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_6950
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_6951
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6952
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6953
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_6954
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_6955
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_6956
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, 5);
INSERT INTO test VALUES (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, 5);
INSERT INTO test VALUES (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, 5);
INSERT INTO test VALUES (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (NULL), (5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (NULL, 10);
INSERT INTO test VALUES (1, 5);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, discount FLOAT64);
INSERT INTO products VALUES ('Widget', 100.0, 0.1);
INSERT INTO products VALUES ('Gadget', 50.0, 0.2);
INSERT INTO products VALUES ('Gizmo', 80.0, 0.05);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('Alice');
INSERT INTO names VALUES ('Charlotte');
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, status STRING, priority INT64);
INSERT INTO tasks VALUES (1, 'pending', 1);
INSERT INTO tasks VALUES (2, 'completed', 2);
INSERT INTO tasks VALUES (3, 'in_progress', 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (1, 20);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING);
INSERT INTO products VALUES ('Banana');
INSERT INTO products VALUES ('apple');
INSERT INTO products VALUES ('Apple');
INSERT INTO products VALUES ('Cherry');
DROP TABLE IF EXISTS words;
CREATE TABLE words (word STRING);
INSERT INTO words VALUES ('zebra');
INSERT INTO words VALUES ('pple');
INSERT INTO words VALUES ('orange');
DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_6957
SELECT value FROM test ORDER BY value ASC NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6958
SELECT value FROM test ORDER BY value DESC NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6959
SELECT value FROM test ORDER BY value DESC NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6960
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_6961
SELECT col1, col2 FROM test
ORDER BY col1 ASC NULLS LAST, col2 DESC NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6962
SELECT name, price * (1 - discount) as final_price
FROM products
ORDER BY price * (1 - discount) ASC;
-- Tag: window_functions_window_functions_operators_test_select_6963
SELECT name FROM names ORDER BY LENGTH(name) ASC;
-- Tag: window_functions_window_functions_operators_test_select_6964
SELECT id, status FROM tasks
ORDER BY CASE status
WHEN 'in_progress' THEN 1
WHEN 'pending' THEN 2
WHEN 'completed' THEN 3
END;
-- Tag: window_functions_window_functions_operators_test_select_6965
SELECT col1, col2 FROM test ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_6966
SELECT col1 FROM test ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_6967
SELECT col1 FROM test ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_6968
SELECT name FROM products ORDER BY name COLLATE NOCASE;
-- Tag: window_functions_window_functions_operators_test_select_6969
SELECT word FROM words ORDER BY word COLLATE 'sv_SE';
-- Tag: window_functions_window_functions_operators_test_select_6970
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6971
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_6972
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_6973
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_6974
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6975
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_6976
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_6977
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_6978
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_6979
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_6980
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_6981
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_6982
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_6983
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_6984
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, 5);
INSERT INTO test VALUES (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, 5);
INSERT INTO test VALUES (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (NULL), (5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (NULL, 10);
INSERT INTO test VALUES (1, 5);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, discount FLOAT64);
INSERT INTO products VALUES ('Widget', 100.0, 0.1);
INSERT INTO products VALUES ('Gadget', 50.0, 0.2);
INSERT INTO products VALUES ('Gizmo', 80.0, 0.05);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('Alice');
INSERT INTO names VALUES ('Charlotte');
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, status STRING, priority INT64);
INSERT INTO tasks VALUES (1, 'pending', 1);
INSERT INTO tasks VALUES (2, 'completed', 2);
INSERT INTO tasks VALUES (3, 'in_progress', 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (1, 20);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING);
INSERT INTO products VALUES ('Banana');
INSERT INTO products VALUES ('apple');
INSERT INTO products VALUES ('Apple');
INSERT INTO products VALUES ('Cherry');
DROP TABLE IF EXISTS words;
CREATE TABLE words (word STRING);
INSERT INTO words VALUES ('zebra');
INSERT INTO words VALUES ('pple');
INSERT INTO words VALUES ('orange');
DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_6985
SELECT value FROM test ORDER BY value DESC NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6986
SELECT value FROM test ORDER BY value DESC NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6987
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_6988
SELECT col1, col2 FROM test
ORDER BY col1 ASC NULLS LAST, col2 DESC NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_6989
SELECT name, price * (1 - discount) as final_price
FROM products
ORDER BY price * (1 - discount) ASC;
-- Tag: window_functions_window_functions_operators_test_select_6990
SELECT name FROM names ORDER BY LENGTH(name) ASC;
-- Tag: window_functions_window_functions_operators_test_select_6991
SELECT id, status FROM tasks
ORDER BY CASE status
WHEN 'in_progress' THEN 1
WHEN 'pending' THEN 2
WHEN 'completed' THEN 3
END;
-- Tag: window_functions_window_functions_operators_test_select_6992
SELECT col1, col2 FROM test ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_6993
SELECT col1 FROM test ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_6994
SELECT col1 FROM test ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_6995
SELECT name FROM products ORDER BY name COLLATE NOCASE;
-- Tag: window_functions_window_functions_operators_test_select_6996
SELECT word FROM words ORDER BY word COLLATE 'sv_SE';
-- Tag: window_functions_window_functions_operators_test_select_6997
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_6998
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_6999
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7000
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7001
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7002
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7003
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7004
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7005
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7006
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7007
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7008
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7009
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7010
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7011
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, 5);
INSERT INTO test VALUES (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (NULL), (5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (NULL, 10);
INSERT INTO test VALUES (1, 5);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, discount FLOAT64);
INSERT INTO products VALUES ('Widget', 100.0, 0.1);
INSERT INTO products VALUES ('Gadget', 50.0, 0.2);
INSERT INTO products VALUES ('Gizmo', 80.0, 0.05);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('Alice');
INSERT INTO names VALUES ('Charlotte');
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, status STRING, priority INT64);
INSERT INTO tasks VALUES (1, 'pending', 1);
INSERT INTO tasks VALUES (2, 'completed', 2);
INSERT INTO tasks VALUES (3, 'in_progress', 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (1, 20);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING);
INSERT INTO products VALUES ('Banana');
INSERT INTO products VALUES ('apple');
INSERT INTO products VALUES ('Apple');
INSERT INTO products VALUES ('Cherry');
DROP TABLE IF EXISTS words;
CREATE TABLE words (word STRING);
INSERT INTO words VALUES ('zebra');
INSERT INTO words VALUES ('pple');
INSERT INTO words VALUES ('orange');
DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7012
SELECT value FROM test ORDER BY value DESC NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_7013
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7014
SELECT col1, col2 FROM test
ORDER BY col1 ASC NULLS LAST, col2 DESC NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_7015
SELECT name, price * (1 - discount) as final_price
FROM products
ORDER BY price * (1 - discount) ASC;
-- Tag: window_functions_window_functions_operators_test_select_7016
SELECT name FROM names ORDER BY LENGTH(name) ASC;
-- Tag: window_functions_window_functions_operators_test_select_7017
SELECT id, status FROM tasks
ORDER BY CASE status
WHEN 'in_progress' THEN 1
WHEN 'pending' THEN 2
WHEN 'completed' THEN 3
END;
-- Tag: window_functions_window_functions_operators_test_select_7018
SELECT col1, col2 FROM test ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_7019
SELECT col1 FROM test ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_7020
SELECT col1 FROM test ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_7021
SELECT name FROM products ORDER BY name COLLATE NOCASE;
-- Tag: window_functions_window_functions_operators_test_select_7022
SELECT word FROM words ORDER BY word COLLATE 'sv_SE';
-- Tag: window_functions_window_functions_operators_test_select_7023
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7024
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_7025
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7026
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7027
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7028
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7029
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7030
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7031
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7032
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7033
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7034
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7035
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7036
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7037
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (10), (NULL), (5);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (NULL, 10);
INSERT INTO test VALUES (1, 5);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, discount FLOAT64);
INSERT INTO products VALUES ('Widget', 100.0, 0.1);
INSERT INTO products VALUES ('Gadget', 50.0, 0.2);
INSERT INTO products VALUES ('Gizmo', 80.0, 0.05);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('Alice');
INSERT INTO names VALUES ('Charlotte');
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, status STRING, priority INT64);
INSERT INTO tasks VALUES (1, 'pending', 1);
INSERT INTO tasks VALUES (2, 'completed', 2);
INSERT INTO tasks VALUES (3, 'in_progress', 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (1, 20);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING);
INSERT INTO products VALUES ('Banana');
INSERT INTO products VALUES ('apple');
INSERT INTO products VALUES ('Apple');
INSERT INTO products VALUES ('Cherry');
DROP TABLE IF EXISTS words;
CREATE TABLE words (word STRING);
INSERT INTO words VALUES ('zebra');
INSERT INTO words VALUES ('pple');
INSERT INTO words VALUES ('orange');
DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7038
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7039
SELECT col1, col2 FROM test
ORDER BY col1 ASC NULLS LAST, col2 DESC NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_7040
SELECT name, price * (1 - discount) as final_price
FROM products
ORDER BY price * (1 - discount) ASC;
-- Tag: window_functions_window_functions_operators_test_select_7041
SELECT name FROM names ORDER BY LENGTH(name) ASC;
-- Tag: window_functions_window_functions_operators_test_select_7042
SELECT id, status FROM tasks
ORDER BY CASE status
WHEN 'in_progress' THEN 1
WHEN 'pending' THEN 2
WHEN 'completed' THEN 3
END;
-- Tag: window_functions_window_functions_operators_test_select_7043
SELECT col1, col2 FROM test ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_7044
SELECT col1 FROM test ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_7045
SELECT col1 FROM test ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_7046
SELECT name FROM products ORDER BY name COLLATE NOCASE;
-- Tag: window_functions_window_functions_operators_test_select_7047
SELECT word FROM words ORDER BY word COLLATE 'sv_SE';
-- Tag: window_functions_window_functions_operators_test_select_7048
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7049
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_7050
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7051
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7052
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7053
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7054
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7055
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7056
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7057
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7058
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7059
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7060
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7061
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7062
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (NULL, 10);
INSERT INTO test VALUES (1, 5);
INSERT INTO test VALUES (2, NULL);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, discount FLOAT64);
INSERT INTO products VALUES ('Widget', 100.0, 0.1);
INSERT INTO products VALUES ('Gadget', 50.0, 0.2);
INSERT INTO products VALUES ('Gizmo', 80.0, 0.05);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('Alice');
INSERT INTO names VALUES ('Charlotte');
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, status STRING, priority INT64);
INSERT INTO tasks VALUES (1, 'pending', 1);
INSERT INTO tasks VALUES (2, 'completed', 2);
INSERT INTO tasks VALUES (3, 'in_progress', 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (1, 20);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING);
INSERT INTO products VALUES ('Banana');
INSERT INTO products VALUES ('apple');
INSERT INTO products VALUES ('Apple');
INSERT INTO products VALUES ('Cherry');
DROP TABLE IF EXISTS words;
CREATE TABLE words (word STRING);
INSERT INTO words VALUES ('zebra');
INSERT INTO words VALUES ('pple');
INSERT INTO words VALUES ('orange');
DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7063
SELECT col1, col2 FROM test
ORDER BY col1 ASC NULLS LAST, col2 DESC NULLS FIRST;
-- Tag: window_functions_window_functions_operators_test_select_7064
SELECT name, price * (1 - discount) as final_price
FROM products
ORDER BY price * (1 - discount) ASC;
-- Tag: window_functions_window_functions_operators_test_select_7065
SELECT name FROM names ORDER BY LENGTH(name) ASC;
-- Tag: window_functions_window_functions_operators_test_select_7066
SELECT id, status FROM tasks
ORDER BY CASE status
WHEN 'in_progress' THEN 1
WHEN 'pending' THEN 2
WHEN 'completed' THEN 3
END;
-- Tag: window_functions_window_functions_operators_test_select_7067
SELECT col1, col2 FROM test ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_7068
SELECT col1 FROM test ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_7069
SELECT col1 FROM test ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_7070
SELECT name FROM products ORDER BY name COLLATE NOCASE;
-- Tag: window_functions_window_functions_operators_test_select_7071
SELECT word FROM words ORDER BY word COLLATE 'sv_SE';
-- Tag: window_functions_window_functions_operators_test_select_7072
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7073
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_7074
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7075
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7076
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7077
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7078
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7079
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7080
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7081
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7082
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7083
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7084
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7085
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7086
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, discount FLOAT64);
INSERT INTO products VALUES ('Widget', 100.0, 0.1);
INSERT INTO products VALUES ('Gadget', 50.0, 0.2);
INSERT INTO products VALUES ('Gizmo', 80.0, 0.05);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('Alice');
INSERT INTO names VALUES ('Charlotte');
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, status STRING, priority INT64);
INSERT INTO tasks VALUES (1, 'pending', 1);
INSERT INTO tasks VALUES (2, 'completed', 2);
INSERT INTO tasks VALUES (3, 'in_progress', 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (1, 20);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING);
INSERT INTO products VALUES ('Banana');
INSERT INTO products VALUES ('apple');
INSERT INTO products VALUES ('Apple');
INSERT INTO products VALUES ('Cherry');
DROP TABLE IF EXISTS words;
CREATE TABLE words (word STRING);
INSERT INTO words VALUES ('zebra');
INSERT INTO words VALUES ('pple');
INSERT INTO words VALUES ('orange');
DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7087
SELECT name, price * (1 - discount) as final_price
FROM products
ORDER BY price * (1 - discount) ASC;
-- Tag: window_functions_window_functions_operators_test_select_7088
SELECT name FROM names ORDER BY LENGTH(name) ASC;
-- Tag: window_functions_window_functions_operators_test_select_7089
SELECT id, status FROM tasks
ORDER BY CASE status
WHEN 'in_progress' THEN 1
WHEN 'pending' THEN 2
WHEN 'completed' THEN 3
END;
-- Tag: window_functions_window_functions_operators_test_select_7090
SELECT col1, col2 FROM test ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_7091
SELECT col1 FROM test ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_7092
SELECT col1 FROM test ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_7093
SELECT name FROM products ORDER BY name COLLATE NOCASE;
-- Tag: window_functions_window_functions_operators_test_select_7094
SELECT word FROM words ORDER BY word COLLATE 'sv_SE';
-- Tag: window_functions_window_functions_operators_test_select_7095
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7096
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_7097
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7098
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7099
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7100
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7101
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7102
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7103
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7104
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7105
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7106
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7107
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7108
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7109
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('Alice');
INSERT INTO names VALUES ('Charlotte');
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, status STRING, priority INT64);
INSERT INTO tasks VALUES (1, 'pending', 1);
INSERT INTO tasks VALUES (2, 'completed', 2);
INSERT INTO tasks VALUES (3, 'in_progress', 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (1, 20);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING);
INSERT INTO products VALUES ('Banana');
INSERT INTO products VALUES ('apple');
INSERT INTO products VALUES ('Apple');
INSERT INTO products VALUES ('Cherry');
DROP TABLE IF EXISTS words;
CREATE TABLE words (word STRING);
INSERT INTO words VALUES ('zebra');
INSERT INTO words VALUES ('pple');
INSERT INTO words VALUES ('orange');
DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7110
SELECT name FROM names ORDER BY LENGTH(name) ASC;
-- Tag: window_functions_window_functions_operators_test_select_7111
SELECT id, status FROM tasks
ORDER BY CASE status
WHEN 'in_progress' THEN 1
WHEN 'pending' THEN 2
WHEN 'completed' THEN 3
END;
-- Tag: window_functions_window_functions_operators_test_select_7112
SELECT col1, col2 FROM test ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_7113
SELECT col1 FROM test ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_7114
SELECT col1 FROM test ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_7115
SELECT name FROM products ORDER BY name COLLATE NOCASE;
-- Tag: window_functions_window_functions_operators_test_select_7116
SELECT word FROM words ORDER BY word COLLATE 'sv_SE';
-- Tag: window_functions_window_functions_operators_test_select_7117
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7118
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_7119
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7120
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7121
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7122
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7123
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7124
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7125
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7126
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7127
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7128
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7129
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7130
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7131
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, status STRING, priority INT64);
INSERT INTO tasks VALUES (1, 'pending', 1);
INSERT INTO tasks VALUES (2, 'completed', 2);
INSERT INTO tasks VALUES (3, 'in_progress', 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (1, 20);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING);
INSERT INTO products VALUES ('Banana');
INSERT INTO products VALUES ('apple');
INSERT INTO products VALUES ('Apple');
INSERT INTO products VALUES ('Cherry');
DROP TABLE IF EXISTS words;
CREATE TABLE words (word STRING);
INSERT INTO words VALUES ('zebra');
INSERT INTO words VALUES ('pple');
INSERT INTO words VALUES ('orange');
DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7132
SELECT id, status FROM tasks
ORDER BY CASE status
WHEN 'in_progress' THEN 1
WHEN 'pending' THEN 2
WHEN 'completed' THEN 3
END;
-- Tag: window_functions_window_functions_operators_test_select_7133
SELECT col1, col2 FROM test ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_7134
SELECT col1 FROM test ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_7135
SELECT col1 FROM test ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_7136
SELECT name FROM products ORDER BY name COLLATE NOCASE;
-- Tag: window_functions_window_functions_operators_test_select_7137
SELECT word FROM words ORDER BY word COLLATE 'sv_SE';
-- Tag: window_functions_window_functions_operators_test_select_7138
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7139
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_7140
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7141
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7142
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7143
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7144
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7145
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7146
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7147
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7148
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7149
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7150
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7151
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7152
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (1, 20);
INSERT INTO test VALUES (1, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING);
INSERT INTO products VALUES ('Banana');
INSERT INTO products VALUES ('apple');
INSERT INTO products VALUES ('Apple');
INSERT INTO products VALUES ('Cherry');
DROP TABLE IF EXISTS words;
CREATE TABLE words (word STRING);
INSERT INTO words VALUES ('zebra');
INSERT INTO words VALUES ('pple');
INSERT INTO words VALUES ('orange');
DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7153
SELECT col1, col2 FROM test ORDER BY 1, 2;
-- Tag: window_functions_window_functions_operators_test_select_7154
SELECT col1 FROM test ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_7155
SELECT col1 FROM test ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_7156
SELECT name FROM products ORDER BY name COLLATE NOCASE;
-- Tag: window_functions_window_functions_operators_test_select_7157
SELECT word FROM words ORDER BY word COLLATE 'sv_SE';
-- Tag: window_functions_window_functions_operators_test_select_7158
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7159
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_7160
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7161
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7162
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7163
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7164
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7165
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7166
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7167
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7168
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7169
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7170
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7171
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7172
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64, col2 INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING);
INSERT INTO products VALUES ('Banana');
INSERT INTO products VALUES ('apple');
INSERT INTO products VALUES ('Apple');
INSERT INTO products VALUES ('Cherry');
DROP TABLE IF EXISTS words;
CREATE TABLE words (word STRING);
INSERT INTO words VALUES ('zebra');
INSERT INTO words VALUES ('pple');
INSERT INTO words VALUES ('orange');
DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7173
SELECT col1 FROM test ORDER BY 3;
-- Tag: window_functions_window_functions_operators_test_select_7174
SELECT col1 FROM test ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_7175
SELECT name FROM products ORDER BY name COLLATE NOCASE;
-- Tag: window_functions_window_functions_operators_test_select_7176
SELECT word FROM words ORDER BY word COLLATE 'sv_SE';
-- Tag: window_functions_window_functions_operators_test_select_7177
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7178
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_7179
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7180
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7181
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7182
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7183
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7184
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7185
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7186
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7187
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7188
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7189
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7190
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7191
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING);
INSERT INTO products VALUES ('Banana');
INSERT INTO products VALUES ('apple');
INSERT INTO products VALUES ('Apple');
INSERT INTO products VALUES ('Cherry');
DROP TABLE IF EXISTS words;
CREATE TABLE words (word STRING);
INSERT INTO words VALUES ('zebra');
INSERT INTO words VALUES ('pple');
INSERT INTO words VALUES ('orange');
DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7192
SELECT col1 FROM test ORDER BY 0;
-- Tag: window_functions_window_functions_operators_test_select_7193
SELECT name FROM products ORDER BY name COLLATE NOCASE;
-- Tag: window_functions_window_functions_operators_test_select_7194
SELECT word FROM words ORDER BY word COLLATE 'sv_SE';
-- Tag: window_functions_window_functions_operators_test_select_7195
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7196
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_7197
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7198
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7199
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7200
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7201
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7202
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7203
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7204
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7205
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7206
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7207
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7208
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7209
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING);
INSERT INTO products VALUES ('Banana');
INSERT INTO products VALUES ('apple');
INSERT INTO products VALUES ('Apple');
INSERT INTO products VALUES ('Cherry');
DROP TABLE IF EXISTS words;
CREATE TABLE words (word STRING);
INSERT INTO words VALUES ('zebra');
INSERT INTO words VALUES ('pple');
INSERT INTO words VALUES ('orange');
DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7210
SELECT name FROM products ORDER BY name COLLATE NOCASE;
-- Tag: window_functions_window_functions_operators_test_select_7211
SELECT word FROM words ORDER BY word COLLATE 'sv_SE';
-- Tag: window_functions_window_functions_operators_test_select_7212
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7213
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_7214
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7215
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7216
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7217
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7218
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7219
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7220
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7221
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7222
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7223
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7224
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7225
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7226
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS test;
CREATE TABLE test (name STRING);
INSERT INTO test VALUES ('Bob');
INSERT INTO test VALUES (NULL);
INSERT INTO test VALUES ('alice');
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7227
SELECT name FROM test ORDER BY name COLLATE NOCASE NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7228
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_7229
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7230
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7231
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7232
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7233
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7234
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7235
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7236
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7237
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7238
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7239
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7240
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7241
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('Bob');
INSERT INTO names VALUES ('alice');
INSERT INTO names VALUES ('Charlie');
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7242
SELECT name FROM names ORDER BY UPPER(name);
-- Tag: window_functions_window_functions_operators_test_select_7243
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7244
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7245
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7246
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7247
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7248
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7249
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7250
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7251
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7252
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7253
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7254
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7255
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64, time INT64);
INSERT INTO scores VALUES ('Alice', 100, 50);
INSERT INTO scores VALUES ('Bob', 100, 45);
INSERT INTO scores VALUES ('Charlie', 90, 55);
DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7256
SELECT player, score, time FROM scores
ORDER BY score DESC, time ASC;
-- Tag: window_functions_window_functions_operators_test_select_7257
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7258
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7259
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7260
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7261
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7262
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7263
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7264
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7265
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7266
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7267
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7268
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS rankings;
CREATE TABLE rankings ( category STRING, score INT64, bonus INT64, name STRING );
INSERT INTO rankings VALUES ('A', 100, 5, 'Alice');
INSERT INTO rankings VALUES ('A', 100, 10, 'Bob');
INSERT INTO rankings VALUES ('B', 90, 15, 'Charlie');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, NULL);
INSERT INTO test VALUES (2, NULL);
INSERT INTO test VALUES (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10);
INSERT INTO test VALUES (2, 10);
INSERT INTO test VALUES (3, 10);
DROP TABLE IF EXISTS test;
CREATE TABLE test (col1 INT64);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, data STRING);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (player STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 100);
INSERT INTO scores VALUES ('Bob', 90);
INSERT INTO scores VALUES ('Charlie', 110);
INSERT INTO scores VALUES ('David', 95);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (customer_id INT64, amount FLOAT64);
INSERT INTO customers VALUES (1, 'Alice');
INSERT INTO customers VALUES (2, 'Bob');
INSERT INTO orders VALUES (1, 100.0);
INSERT INTO orders VALUES (2, 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES ('West', 150);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 5);

-- Tag: window_functions_window_functions_operators_test_select_7269
SELECT * FROM rankings
ORDER BY category ASC, score DESC, bonus DESC;
-- Tag: window_functions_window_functions_operators_test_select_7270
SELECT id FROM test ORDER BY value NULLS LAST;
-- Tag: window_functions_window_functions_operators_test_select_7271
SELECT value FROM test ORDER BY value ASC;
-- Tag: window_functions_window_functions_operators_test_select_7272
SELECT value FROM test ORDER BY value DESC;
-- Tag: window_functions_window_functions_operators_test_select_7273
SELECT id FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7274
SELECT col1 FROM test ORDER BY nonexistent;
-- Tag: window_functions_window_functions_operators_test_select_7275
SELECT t1.value, t2.data FROM t1 JOIN t2 ON t1.id = t2.id ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7276
SELECT player, score FROM scores ORDER BY score DESC LIMIT 3;
-- Tag: window_functions_window_functions_operators_test_select_7277
SELECT c.name, o.amount
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY o.amount DESC;
-- Tag: window_functions_window_functions_operators_test_select_7278
SELECT region, SUM(amount) as total
FROM sales
GROUP BY region
ORDER BY total DESC;
-- Tag: window_functions_window_functions_operators_test_select_7279
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_7280
SELECT id, value FROM test ORDER BY value ASC LIMIT 2
) AS subq
ORDER BY id DESC;

DROP TABLE IF EXISTS circular_deps;
CREATE TABLE circular_deps ( id INT64, depends_on INT64 );
INSERT INTO circular_deps VALUES
(1, 2),
(2, 3),
(3, 1);
DROP TABLE IF EXISTS tree_nodes;
CREATE TABLE tree_nodes ( id INT64, parent_id INT64, level INT64 );
INSERT INTO tree_nodes VALUES
(1, NULL, 0),
(2, 1, 1), (3, 1, 1),
(4, 2, 2), (5, 2, 2), (6, 3, 2), (7, 3, 2),
(8, 4, 3), (9, 4, 3), (10, 5, 3), (11, 5, 3);
DROP TABLE IF EXISTS nullable_hierarchy;
CREATE TABLE nullable_hierarchy ( id INT64, parent_id INT64 );
INSERT INTO nullable_hierarchy VALUES
(1, NULL),
(2, 1),
(3, NULL), -- Another root
(4, 3);
DROP TABLE IF EXISTS edges;
CREATE TABLE edges ( from_node INT64, to_node INT64 );
INSERT INTO edges VALUES
(1, 2), (1, 3),
(2, 4), (3, 4), -- Two paths to node 4
(4, 5);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( day INT64, amount INT64 );
INSERT INTO sales VALUES
(1, 100), (2, 150), (3, 200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);

WITH RECURSIVE big_numbers AS (
-- Tag: window_functions_window_functions_operators_test_select_7281
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7282
SELECT n + 1 FROM big_numbers WHERE n < 10000
)
-- Tag: window_functions_window_functions_operators_test_select_7283
SELECT COUNT(*) FROM big_numbers;
WITH RECURSIVE dependencies AS (
-- Tag: window_functions_window_functions_operators_test_select_7284
SELECT id, depends_on, 1 AS depth
FROM circular_deps
WHERE id = 1
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7285
SELECT cd.id, cd.depends_on, d.depth + 1
FROM circular_deps cd
JOIN dependencies d ON cd.id = d.depends_on
WHERE d.depth < 10 -- Safety limit
)
-- Tag: window_functions_window_functions_operators_test_select_7286
SELECT * FROM dependencies;
WITH RECURSIVE tree AS (
-- Tag: window_functions_window_functions_operators_test_select_7287
SELECT id, parent_id, level, 1 AS iteration
FROM tree_nodes
WHERE parent_id IS NULL
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7288
SELECT tn.id, tn.parent_id, tn.level, t.iteration + 1
FROM tree_nodes tn
JOIN tree t ON tn.parent_id = t.id
WHERE t.iteration < 4 -- Limit iterations
)
-- Tag: window_functions_window_functions_operators_test_select_7289
SELECT COUNT(*), MAX(level) FROM tree;
WITH RECURSIVE tree AS (
-- Tag: window_functions_window_functions_operators_test_select_7290
SELECT id, parent_id, 0 AS level
FROM nullable_hierarchy
WHERE id = 1
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7291
SELECT nh.id, nh.parent_id, t.level + 1
FROM nullable_hierarchy nh
JOIN tree t ON nh.parent_id = t.id
)
-- Tag: window_functions_window_functions_operators_test_select_7292
SELECT COUNT(*) FROM tree;
WITH RECURSIVE
numbers AS (
-- Tag: window_functions_window_functions_operators_test_select_7293
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7294
SELECT n + 1 FROM numbers WHERE n < 3
),
letters AS (
-- Tag: window_functions_window_functions_operators_test_select_7295
SELECT 'A' AS letter, 1 AS ord
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_062
SELECT
CASE ord
WHEN 1 THEN 'B'
WHEN 2 THEN 'C'
END,
ord + 1
FROM letters
WHERE ord < 3
)
-- Tag: window_functions_window_functions_operators_test_select_7296
SELECT n, letter FROM numbers CROSS JOIN letters ORDER BY n, ord;
WITH RECURSIVE paths AS (
-- Tag: window_functions_window_functions_operators_test_select_7297
SELECT DISTINCT from_node AS node, 0 AS hops
FROM edges
WHERE from_node = 1
UNION DISTINCT
-- Tag: window_functions_window_functions_operators_test_select_7298
SELECT DISTINCT e.to_node, p.hops + 1
FROM edges e
JOIN paths p ON e.from_node = p.node
WHERE p.hops < 3
)
-- Tag: window_functions_window_functions_operators_test_select_7299
SELECT * FROM paths ORDER BY node;
WITH RECURSIVE running_total AS (
-- Tag: window_functions_window_functions_operators_test_select_7300
SELECT day, amount, amount AS total
FROM sales
WHERE day = 1
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7301
SELECT s.day, s.amount, rt.total + s.amount
FROM sales s
JOIN running_total rt ON s.day = rt.day + 1
)
-- Tag: window_functions_window_functions_operators_test_select_7302
SELECT * FROM running_total ORDER BY day;
WITH RECURSIVE broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7303
SELECT 1 AS n, 'A' AS letter
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7304
SELECT n + 1 FROM broken WHERE n < 5 -- Missing 'letter' column!
)
-- Tag: window_functions_window_functions_operators_test_select_7305
SELECT * FROM broken;
WITH RECURSIVE type_broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7306
SELECT 1 AS value
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7307
SELECT 'not a number' FROM type_broken WHERE value < 5 -- Type mismatch!
)
-- Tag: window_functions_window_functions_operators_test_select_7308
SELECT * FROM type_broken;
WITH RECURSIVE broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7309
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7310
SELECT n + 1
FROM non_existent_table -- Table doesn't exist!
WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7311
SELECT * FROM broken;
WITH numbers AS ( -- Missing RECURSIVE!
-- Tag: window_functions_window_functions_operators_test_select_7312
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7313
SELECT n + 1 FROM numbers WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7314
SELECT * FROM numbers;
WITH RECURSIVE empty_start AS (
-- Tag: window_functions_window_functions_operators_test_select_7315
SELECT id FROM data WHERE id = 999 -- No matching rows
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7316
SELECT id + 1 FROM empty_start WHERE id < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7317
SELECT COUNT(*) FROM empty_start;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7318
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7319
SELECT n + 1 FROM nums WHERE n < 100
)
-- Tag: window_functions_window_functions_operators_test_select_7320
SELECT * FROM nums LIMIT 5;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7321
SELECT 5 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7322
SELECT n - 1 FROM nums WHERE n > 1
)
-- Tag: window_functions_window_functions_operators_test_select_7323
SELECT * FROM nums ORDER BY n ASC;
-- Tag: window_functions_window_functions_operators_test_select_7324
SELECT *
FROM (
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7325
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7326
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7327
SELECT n * 2 AS doubled FROM nums
) AS doubled_nums
WHERE doubled >= 4;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7328
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7329
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_063
SELECT
n,
ROW_NUMBER() OVER (ORDER BY n DESC) AS rev_rank
FROM nums;

DROP TABLE IF EXISTS nullable_hierarchy;
CREATE TABLE nullable_hierarchy ( id INT64, parent_id INT64 );
INSERT INTO nullable_hierarchy VALUES
(1, NULL),
(2, 1),
(3, NULL), -- Another root
(4, 3);
DROP TABLE IF EXISTS edges;
CREATE TABLE edges ( from_node INT64, to_node INT64 );
INSERT INTO edges VALUES
(1, 2), (1, 3),
(2, 4), (3, 4), -- Two paths to node 4
(4, 5);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( day INT64, amount INT64 );
INSERT INTO sales VALUES
(1, 100), (2, 150), (3, 200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);

WITH RECURSIVE tree AS (
-- Tag: window_functions_window_functions_operators_test_select_7330
SELECT id, parent_id, 0 AS level
FROM nullable_hierarchy
WHERE id = 1
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7331
SELECT nh.id, nh.parent_id, t.level + 1
FROM nullable_hierarchy nh
JOIN tree t ON nh.parent_id = t.id
)
-- Tag: window_functions_window_functions_operators_test_select_7332
SELECT COUNT(*) FROM tree;
WITH RECURSIVE
numbers AS (
-- Tag: window_functions_window_functions_operators_test_select_7333
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7334
SELECT n + 1 FROM numbers WHERE n < 3
),
letters AS (
-- Tag: window_functions_window_functions_operators_test_select_7335
SELECT 'A' AS letter, 1 AS ord
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_064
SELECT
CASE ord
WHEN 1 THEN 'B'
WHEN 2 THEN 'C'
END,
ord + 1
FROM letters
WHERE ord < 3
)
-- Tag: window_functions_window_functions_operators_test_select_7336
SELECT n, letter FROM numbers CROSS JOIN letters ORDER BY n, ord;
WITH RECURSIVE paths AS (
-- Tag: window_functions_window_functions_operators_test_select_7337
SELECT DISTINCT from_node AS node, 0 AS hops
FROM edges
WHERE from_node = 1
UNION DISTINCT
-- Tag: window_functions_window_functions_operators_test_select_7338
SELECT DISTINCT e.to_node, p.hops + 1
FROM edges e
JOIN paths p ON e.from_node = p.node
WHERE p.hops < 3
)
-- Tag: window_functions_window_functions_operators_test_select_7339
SELECT * FROM paths ORDER BY node;
WITH RECURSIVE running_total AS (
-- Tag: window_functions_window_functions_operators_test_select_7340
SELECT day, amount, amount AS total
FROM sales
WHERE day = 1
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7341
SELECT s.day, s.amount, rt.total + s.amount
FROM sales s
JOIN running_total rt ON s.day = rt.day + 1
)
-- Tag: window_functions_window_functions_operators_test_select_7342
SELECT * FROM running_total ORDER BY day;
WITH RECURSIVE broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7343
SELECT 1 AS n, 'A' AS letter
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7344
SELECT n + 1 FROM broken WHERE n < 5 -- Missing 'letter' column!
)
-- Tag: window_functions_window_functions_operators_test_select_7345
SELECT * FROM broken;
WITH RECURSIVE type_broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7346
SELECT 1 AS value
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7347
SELECT 'not a number' FROM type_broken WHERE value < 5 -- Type mismatch!
)
-- Tag: window_functions_window_functions_operators_test_select_7348
SELECT * FROM type_broken;
WITH RECURSIVE broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7349
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7350
SELECT n + 1
FROM non_existent_table -- Table doesn't exist!
WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7351
SELECT * FROM broken;
WITH numbers AS ( -- Missing RECURSIVE!
-- Tag: window_functions_window_functions_operators_test_select_7352
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7353
SELECT n + 1 FROM numbers WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7354
SELECT * FROM numbers;
WITH RECURSIVE empty_start AS (
-- Tag: window_functions_window_functions_operators_test_select_7355
SELECT id FROM data WHERE id = 999 -- No matching rows
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7356
SELECT id + 1 FROM empty_start WHERE id < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7357
SELECT COUNT(*) FROM empty_start;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7358
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7359
SELECT n + 1 FROM nums WHERE n < 100
)
-- Tag: window_functions_window_functions_operators_test_select_7360
SELECT * FROM nums LIMIT 5;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7361
SELECT 5 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7362
SELECT n - 1 FROM nums WHERE n > 1
)
-- Tag: window_functions_window_functions_operators_test_select_7363
SELECT * FROM nums ORDER BY n ASC;
-- Tag: window_functions_window_functions_operators_test_select_7364
SELECT *
FROM (
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7365
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7366
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7367
SELECT n * 2 AS doubled FROM nums
) AS doubled_nums
WHERE doubled >= 4;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7368
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7369
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_065
SELECT
n,
ROW_NUMBER() OVER (ORDER BY n DESC) AS rev_rank
FROM nums;

DROP TABLE IF EXISTS edges;
CREATE TABLE edges ( from_node INT64, to_node INT64 );
INSERT INTO edges VALUES
(1, 2), (1, 3),
(2, 4), (3, 4), -- Two paths to node 4
(4, 5);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( day INT64, amount INT64 );
INSERT INTO sales VALUES
(1, 100), (2, 150), (3, 200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);

WITH RECURSIVE
numbers AS (
-- Tag: window_functions_window_functions_operators_test_select_7370
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7371
SELECT n + 1 FROM numbers WHERE n < 3
),
letters AS (
-- Tag: window_functions_window_functions_operators_test_select_7372
SELECT 'A' AS letter, 1 AS ord
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_066
SELECT
CASE ord
WHEN 1 THEN 'B'
WHEN 2 THEN 'C'
END,
ord + 1
FROM letters
WHERE ord < 3
)
-- Tag: window_functions_window_functions_operators_test_select_7373
SELECT n, letter FROM numbers CROSS JOIN letters ORDER BY n, ord;
WITH RECURSIVE paths AS (
-- Tag: window_functions_window_functions_operators_test_select_7374
SELECT DISTINCT from_node AS node, 0 AS hops
FROM edges
WHERE from_node = 1
UNION DISTINCT
-- Tag: window_functions_window_functions_operators_test_select_7375
SELECT DISTINCT e.to_node, p.hops + 1
FROM edges e
JOIN paths p ON e.from_node = p.node
WHERE p.hops < 3
)
-- Tag: window_functions_window_functions_operators_test_select_7376
SELECT * FROM paths ORDER BY node;
WITH RECURSIVE running_total AS (
-- Tag: window_functions_window_functions_operators_test_select_7377
SELECT day, amount, amount AS total
FROM sales
WHERE day = 1
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7378
SELECT s.day, s.amount, rt.total + s.amount
FROM sales s
JOIN running_total rt ON s.day = rt.day + 1
)
-- Tag: window_functions_window_functions_operators_test_select_7379
SELECT * FROM running_total ORDER BY day;
WITH RECURSIVE broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7380
SELECT 1 AS n, 'A' AS letter
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7381
SELECT n + 1 FROM broken WHERE n < 5 -- Missing 'letter' column!
)
-- Tag: window_functions_window_functions_operators_test_select_7382
SELECT * FROM broken;
WITH RECURSIVE type_broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7383
SELECT 1 AS value
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7384
SELECT 'not a number' FROM type_broken WHERE value < 5 -- Type mismatch!
)
-- Tag: window_functions_window_functions_operators_test_select_7385
SELECT * FROM type_broken;
WITH RECURSIVE broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7386
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7387
SELECT n + 1
FROM non_existent_table -- Table doesn't exist!
WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7388
SELECT * FROM broken;
WITH numbers AS ( -- Missing RECURSIVE!
-- Tag: window_functions_window_functions_operators_test_select_7389
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7390
SELECT n + 1 FROM numbers WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7391
SELECT * FROM numbers;
WITH RECURSIVE empty_start AS (
-- Tag: window_functions_window_functions_operators_test_select_7392
SELECT id FROM data WHERE id = 999 -- No matching rows
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7393
SELECT id + 1 FROM empty_start WHERE id < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7394
SELECT COUNT(*) FROM empty_start;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7395
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7396
SELECT n + 1 FROM nums WHERE n < 100
)
-- Tag: window_functions_window_functions_operators_test_select_7397
SELECT * FROM nums LIMIT 5;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7398
SELECT 5 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7399
SELECT n - 1 FROM nums WHERE n > 1
)
-- Tag: window_functions_window_functions_operators_test_select_7400
SELECT * FROM nums ORDER BY n ASC;
-- Tag: window_functions_window_functions_operators_test_select_7401
SELECT *
FROM (
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7402
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7403
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7404
SELECT n * 2 AS doubled FROM nums
) AS doubled_nums
WHERE doubled >= 4;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7405
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7406
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_067
SELECT
n,
ROW_NUMBER() OVER (ORDER BY n DESC) AS rev_rank
FROM nums;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( day INT64, amount INT64 );
INSERT INTO sales VALUES
(1, 100), (2, 150), (3, 200);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);

WITH RECURSIVE running_total AS (
-- Tag: window_functions_window_functions_operators_test_select_7407
SELECT day, amount, amount AS total
FROM sales
WHERE day = 1
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7408
SELECT s.day, s.amount, rt.total + s.amount
FROM sales s
JOIN running_total rt ON s.day = rt.day + 1
)
-- Tag: window_functions_window_functions_operators_test_select_7409
SELECT * FROM running_total ORDER BY day;
WITH RECURSIVE broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7410
SELECT 1 AS n, 'A' AS letter
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7411
SELECT n + 1 FROM broken WHERE n < 5 -- Missing 'letter' column!
)
-- Tag: window_functions_window_functions_operators_test_select_7412
SELECT * FROM broken;
WITH RECURSIVE type_broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7413
SELECT 1 AS value
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7414
SELECT 'not a number' FROM type_broken WHERE value < 5 -- Type mismatch!
)
-- Tag: window_functions_window_functions_operators_test_select_7415
SELECT * FROM type_broken;
WITH RECURSIVE broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7416
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7417
SELECT n + 1
FROM non_existent_table -- Table doesn't exist!
WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7418
SELECT * FROM broken;
WITH numbers AS ( -- Missing RECURSIVE!
-- Tag: window_functions_window_functions_operators_test_select_7419
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7420
SELECT n + 1 FROM numbers WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7421
SELECT * FROM numbers;
WITH RECURSIVE empty_start AS (
-- Tag: window_functions_window_functions_operators_test_select_7422
SELECT id FROM data WHERE id = 999 -- No matching rows
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7423
SELECT id + 1 FROM empty_start WHERE id < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7424
SELECT COUNT(*) FROM empty_start;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7425
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7426
SELECT n + 1 FROM nums WHERE n < 100
)
-- Tag: window_functions_window_functions_operators_test_select_7427
SELECT * FROM nums LIMIT 5;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7428
SELECT 5 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7429
SELECT n - 1 FROM nums WHERE n > 1
)
-- Tag: window_functions_window_functions_operators_test_select_7430
SELECT * FROM nums ORDER BY n ASC;
-- Tag: window_functions_window_functions_operators_test_select_7431
SELECT *
FROM (
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7432
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7433
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7434
SELECT n * 2 AS doubled FROM nums
) AS doubled_nums
WHERE doubled >= 4;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7435
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7436
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_068
SELECT
n,
ROW_NUMBER() OVER (ORDER BY n DESC) AS rev_rank
FROM nums;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);

WITH RECURSIVE broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7437
SELECT 1 AS n, 'A' AS letter
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7438
SELECT n + 1 FROM broken WHERE n < 5 -- Missing 'letter' column!
)
-- Tag: window_functions_window_functions_operators_test_select_7439
SELECT * FROM broken;
WITH RECURSIVE type_broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7440
SELECT 1 AS value
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7441
SELECT 'not a number' FROM type_broken WHERE value < 5 -- Type mismatch!
)
-- Tag: window_functions_window_functions_operators_test_select_7442
SELECT * FROM type_broken;
WITH RECURSIVE broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7443
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7444
SELECT n + 1
FROM non_existent_table -- Table doesn't exist!
WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7445
SELECT * FROM broken;
WITH numbers AS ( -- Missing RECURSIVE!
-- Tag: window_functions_window_functions_operators_test_select_7446
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7447
SELECT n + 1 FROM numbers WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7448
SELECT * FROM numbers;
WITH RECURSIVE empty_start AS (
-- Tag: window_functions_window_functions_operators_test_select_7449
SELECT id FROM data WHERE id = 999 -- No matching rows
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7450
SELECT id + 1 FROM empty_start WHERE id < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7451
SELECT COUNT(*) FROM empty_start;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7452
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7453
SELECT n + 1 FROM nums WHERE n < 100
)
-- Tag: window_functions_window_functions_operators_test_select_7454
SELECT * FROM nums LIMIT 5;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7455
SELECT 5 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7456
SELECT n - 1 FROM nums WHERE n > 1
)
-- Tag: window_functions_window_functions_operators_test_select_7457
SELECT * FROM nums ORDER BY n ASC;
-- Tag: window_functions_window_functions_operators_test_select_7458
SELECT *
FROM (
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7459
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7460
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7461
SELECT n * 2 AS doubled FROM nums
) AS doubled_nums
WHERE doubled >= 4;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7462
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7463
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_069
SELECT
n,
ROW_NUMBER() OVER (ORDER BY n DESC) AS rev_rank
FROM nums;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);

WITH RECURSIVE type_broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7464
SELECT 1 AS value
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7465
SELECT 'not a number' FROM type_broken WHERE value < 5 -- Type mismatch!
)
-- Tag: window_functions_window_functions_operators_test_select_7466
SELECT * FROM type_broken;
WITH RECURSIVE broken AS (
-- Tag: window_functions_window_functions_operators_test_select_7467
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7468
SELECT n + 1
FROM non_existent_table -- Table doesn't exist!
WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7469
SELECT * FROM broken;
WITH numbers AS ( -- Missing RECURSIVE!
-- Tag: window_functions_window_functions_operators_test_select_7470
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7471
SELECT n + 1 FROM numbers WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7472
SELECT * FROM numbers;
WITH RECURSIVE empty_start AS (
-- Tag: window_functions_window_functions_operators_test_select_7473
SELECT id FROM data WHERE id = 999 -- No matching rows
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7474
SELECT id + 1 FROM empty_start WHERE id < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7475
SELECT COUNT(*) FROM empty_start;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7476
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7477
SELECT n + 1 FROM nums WHERE n < 100
)
-- Tag: window_functions_window_functions_operators_test_select_7478
SELECT * FROM nums LIMIT 5;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7479
SELECT 5 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7480
SELECT n - 1 FROM nums WHERE n > 1
)
-- Tag: window_functions_window_functions_operators_test_select_7481
SELECT * FROM nums ORDER BY n ASC;
-- Tag: window_functions_window_functions_operators_test_select_7482
SELECT *
FROM (
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7483
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7484
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7485
SELECT n * 2 AS doubled FROM nums
) AS doubled_nums
WHERE doubled >= 4;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7486
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7487
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_070
SELECT
n,
ROW_NUMBER() OVER (ORDER BY n DESC) AS rev_rank
FROM nums;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);

WITH numbers AS ( -- Missing RECURSIVE!
-- Tag: window_functions_window_functions_operators_test_select_7488
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7489
SELECT n + 1 FROM numbers WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7490
SELECT * FROM numbers;
WITH RECURSIVE empty_start AS (
-- Tag: window_functions_window_functions_operators_test_select_7491
SELECT id FROM data WHERE id = 999 -- No matching rows
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7492
SELECT id + 1 FROM empty_start WHERE id < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7493
SELECT COUNT(*) FROM empty_start;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7494
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7495
SELECT n + 1 FROM nums WHERE n < 100
)
-- Tag: window_functions_window_functions_operators_test_select_7496
SELECT * FROM nums LIMIT 5;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7497
SELECT 5 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7498
SELECT n - 1 FROM nums WHERE n > 1
)
-- Tag: window_functions_window_functions_operators_test_select_7499
SELECT * FROM nums ORDER BY n ASC;
-- Tag: window_functions_window_functions_operators_test_select_7500
SELECT *
FROM (
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7501
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7502
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7503
SELECT n * 2 AS doubled FROM nums
) AS doubled_nums
WHERE doubled >= 4;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7504
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7505
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_071
SELECT
n,
ROW_NUMBER() OVER (ORDER BY n DESC) AS rev_rank
FROM nums;

WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7506
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7507
SELECT n + 1 FROM nums WHERE n < 100
)
-- Tag: window_functions_window_functions_operators_test_select_7508
SELECT * FROM nums LIMIT 5;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7509
SELECT 5 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7510
SELECT n - 1 FROM nums WHERE n > 1
)
-- Tag: window_functions_window_functions_operators_test_select_7511
SELECT * FROM nums ORDER BY n ASC;
-- Tag: window_functions_window_functions_operators_test_select_7512
SELECT *
FROM (
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7513
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7514
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7515
SELECT n * 2 AS doubled FROM nums
) AS doubled_nums
WHERE doubled >= 4;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7516
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7517
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_072
SELECT
n,
ROW_NUMBER() OVER (ORDER BY n DESC) AS rev_rank
FROM nums;

WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7518
SELECT 5 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7519
SELECT n - 1 FROM nums WHERE n > 1
)
-- Tag: window_functions_window_functions_operators_test_select_7520
SELECT * FROM nums ORDER BY n ASC;
-- Tag: window_functions_window_functions_operators_test_select_7521
SELECT *
FROM (
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7522
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7523
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7524
SELECT n * 2 AS doubled FROM nums
) AS doubled_nums
WHERE doubled >= 4;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7525
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7526
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_073
SELECT
n,
ROW_NUMBER() OVER (ORDER BY n DESC) AS rev_rank
FROM nums;

-- Tag: window_functions_window_functions_operators_test_select_7527
SELECT *
FROM (
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7528
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7529
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_7530
SELECT n * 2 AS doubled FROM nums
) AS doubled_nums
WHERE doubled >= 4;
WITH RECURSIVE nums AS (
-- Tag: window_functions_window_functions_operators_test_select_7531
SELECT 1 AS n
UNION ALL
-- Tag: window_functions_window_functions_operators_test_select_7532
SELECT n + 1 FROM nums WHERE n < 5
)
-- Tag: window_functions_window_functions_operators_test_select_074
SELECT
n,
ROW_NUMBER() OVER (ORDER BY n DESC) AS rev_rank
FROM nums;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS multi;
CREATE TABLE multi (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO multi VALUES (10), (20), (10);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64);
INSERT INTO orders VALUES
(1, 100),
(2, 100),
(3, 200),
(4, 100);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (value STRING);
INSERT INTO data VALUES (1), (2);
INSERT INTO config VALUES ('123');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, price FLOAT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (discount_pct INT64);
INSERT INTO items VALUES (1, 100.0), (2, 200.0);
INSERT INTO config VALUES (10);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS config;
CREATE TABLE config (prefix STRING);
INSERT INTO users VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO config VALUES ('User: ');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS messages;
CREATE TABLE messages (text STRING);
INSERT INTO data VALUES (1), (2);
INSERT INTO messages VALUES ('Hello World');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64, in_stock BOOL);
DROP TABLE IF EXISTS thresholds;
CREATE TABLE thresholds (min_price FLOAT64);
INSERT INTO products VALUES
(1, 50.0, true),
(2, 150.0, true),
(3, 75.0, false);
INSERT INTO thresholds VALUES (100.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, value INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (special_value INT64);
INSERT INTO items VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO config VALUES (20);
DROP TABLE IF EXISTS values;
CREATE TABLE values (id INT64, num INT64);
DROP TABLE IF EXISTS range;
CREATE TABLE range (min INT64, max INT64);
INSERT INTO values VALUES (1, 5), (2, 15), (3, 25);
INSERT INTO range VALUES (10, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2), (3);
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, name STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, cat_id INT64, price FLOAT64);
INSERT INTO categories VALUES (1, 'Electronics'), (2, 'Clothing');
INSERT INTO items VALUES
(1, 1, 100.0),
(2, 1, 200.0),
(3, 2, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO set1 VALUES (42);
INSERT INTO set2 VALUES (99);
DROP TABLE IF EXISTS regions;
CREATE TABLE regions (id INT64, name STRING);
DROP TABLE IF EXISTS stores;
CREATE TABLE stores (id INT64, region_id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (store_id INT64, amount FLOAT64);
INSERT INTO regions VALUES (1, 'North'), (2, 'South');
INSERT INTO stores VALUES (1, 1, 'Store A'), (2, 1, 'Store B'), (3, 2, 'Store C');
INSERT INTO sales VALUES
(1, 100.0),
(1, 150.0),
(2, 200.0),
(3, 300.0);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, name STRING);
INSERT INTO events VALUES (1, 'Event A'), (2, 'Event B');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO data VALUES (1), (2);
INSERT INTO config VALUES (0);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (id INT64, value FLOAT64);
DROP TABLE IF EXISTS calibration;
CREATE TABLE calibration (offset FLOAT64, scale FLOAT64);
INSERT INTO measurements VALUES (1, 10.0), (2, 20.0);
INSERT INTO calibration VALUES (5.0, 2.0);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO numbers VALUES (1, 17), (2, 23);
INSERT INTO config VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value FLOAT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
DROP TABLE IF EXISTS targets;
CREATE TABLE targets (target FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
INSERT INTO targets VALUES (120.0);

-- Tag: window_functions_window_functions_operators_test_select_7533
SELECT id, (SELECT DISTINCT value FROM multi) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7534
SELECT (SELECT COUNT(DISTINCT customer_id) FROM orders) as unique_customers;
-- Tag: window_functions_window_functions_operators_test_select_7535
SELECT id, (SELECT CAST(value AS INT64) FROM config) as int_val FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7536
SELECT id, price, price * (SELECT discount_pct FROM config) / 100.0 as discount
FROM items
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7537
SELECT id, CONCAT((SELECT prefix FROM config), name) as formatted_name
FROM users
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7538
SELECT id,
(SELECT UPPER(text) FROM messages) as upper_msg,
(SELECT LOWER(text) FROM messages) as lower_msg
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7539
SELECT id, price
FROM products
WHERE in_stock = true AND price > (SELECT min_price FROM thresholds)
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7540
SELECT id
FROM items
WHERE value < 15 OR value = (SELECT special_value FROM config)
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7541
SELECT id
FROM values
WHERE num BETWEEN (SELECT min FROM range) AND (SELECT max FROM range)
ORDER BY id;
WITH stats AS (
-- Tag: window_functions_window_functions_operators_test_select_7542
SELECT AVG(id) as avg_id FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_7543
SELECT id, (SELECT avg_id FROM stats) as average
FROM data
ORDER BY id;
WITH category_data AS (
-- Tag: window_functions_window_functions_operators_test_select_7544
SELECT id, name FROM categories
)
-- Tag: window_functions_window_functions_operators_test_select_7545
SELECT c.name,
(SELECT MAX(price) FROM items WHERE cat_id = c.id) as max_price
FROM category_data c
ORDER BY c.name;
-- Tag: window_functions_window_functions_operators_test_select_7546
SELECT id,
(SELECT value FROM set1
UNION
-- Tag: window_functions_window_functions_operators_test_select_7547
SELECT value FROM set2
ORDER BY value
LIMIT 1) as min_value
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7548
SELECT r.name,
(SELECT SUM(amount)
FROM sales s
WHERE s.store_id IN (SELECT id FROM stores WHERE region_id = r.id)) as region_total
FROM regions r
ORDER BY r.name;
-- Tag: window_functions_window_functions_operators_test_select_7549
SELECT id, name, (SELECT CURRENT_DATE()) as today
FROM events
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7550
SELECT id, 100 / (SELECT divisor FROM config) as result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7551
SELECT id,
value,
(value + (SELECT offset FROM calibration)) * (SELECT scale FROM calibration) as calibrated
FROM measurements
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7552
SELECT id, value, value % (SELECT divisor FROM config) as remainder
FROM numbers
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7553
SELECT id, (SELECT SUM(value) FROM nulls) as sum_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7554
SELECT id, (SELECT AVG(value) FROM nulls) as avg_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7555
SELECT id,
(SELECT MIN(value) FROM nulls) as min_val,
(SELECT MAX(value) FROM nulls) as max_val
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7556
SELECT product,
SUM(amount) as total,
SUM(amount) - (SELECT target FROM targets) as over_under
FROM sales
GROUP BY product
ORDER BY product;

DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, price FLOAT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (discount_pct INT64);
INSERT INTO items VALUES (1, 100.0), (2, 200.0);
INSERT INTO config VALUES (10);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS config;
CREATE TABLE config (prefix STRING);
INSERT INTO users VALUES (1, 'Alice'), (2, 'Bob');
INSERT INTO config VALUES ('User: ');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS messages;
CREATE TABLE messages (text STRING);
INSERT INTO data VALUES (1), (2);
INSERT INTO messages VALUES ('Hello World');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64, in_stock BOOL);
DROP TABLE IF EXISTS thresholds;
CREATE TABLE thresholds (min_price FLOAT64);
INSERT INTO products VALUES
(1, 50.0, true),
(2, 150.0, true),
(3, 75.0, false);
INSERT INTO thresholds VALUES (100.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, value INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (special_value INT64);
INSERT INTO items VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO config VALUES (20);
DROP TABLE IF EXISTS values;
CREATE TABLE values (id INT64, num INT64);
DROP TABLE IF EXISTS range;
CREATE TABLE range (min INT64, max INT64);
INSERT INTO values VALUES (1, 5), (2, 15), (3, 25);
INSERT INTO range VALUES (10, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2), (3);
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, name STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, cat_id INT64, price FLOAT64);
INSERT INTO categories VALUES (1, 'Electronics'), (2, 'Clothing');
INSERT INTO items VALUES
(1, 1, 100.0),
(2, 1, 200.0),
(3, 2, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO set1 VALUES (42);
INSERT INTO set2 VALUES (99);
DROP TABLE IF EXISTS regions;
CREATE TABLE regions (id INT64, name STRING);
DROP TABLE IF EXISTS stores;
CREATE TABLE stores (id INT64, region_id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (store_id INT64, amount FLOAT64);
INSERT INTO regions VALUES (1, 'North'), (2, 'South');
INSERT INTO stores VALUES (1, 1, 'Store A'), (2, 1, 'Store B'), (3, 2, 'Store C');
INSERT INTO sales VALUES
(1, 100.0),
(1, 150.0),
(2, 200.0),
(3, 300.0);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, name STRING);
INSERT INTO events VALUES (1, 'Event A'), (2, 'Event B');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO data VALUES (1), (2);
INSERT INTO config VALUES (0);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (id INT64, value FLOAT64);
DROP TABLE IF EXISTS calibration;
CREATE TABLE calibration (offset FLOAT64, scale FLOAT64);
INSERT INTO measurements VALUES (1, 10.0), (2, 20.0);
INSERT INTO calibration VALUES (5.0, 2.0);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO numbers VALUES (1, 17), (2, 23);
INSERT INTO config VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value FLOAT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
DROP TABLE IF EXISTS targets;
CREATE TABLE targets (target FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
INSERT INTO targets VALUES (120.0);

-- Tag: window_functions_window_functions_operators_test_select_7557
SELECT id, price, price * (SELECT discount_pct FROM config) / 100.0 as discount
FROM items
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7558
SELECT id, CONCAT((SELECT prefix FROM config), name) as formatted_name
FROM users
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7559
SELECT id,
(SELECT UPPER(text) FROM messages) as upper_msg,
(SELECT LOWER(text) FROM messages) as lower_msg
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7560
SELECT id, price
FROM products
WHERE in_stock = true AND price > (SELECT min_price FROM thresholds)
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7561
SELECT id
FROM items
WHERE value < 15 OR value = (SELECT special_value FROM config)
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7562
SELECT id
FROM values
WHERE num BETWEEN (SELECT min FROM range) AND (SELECT max FROM range)
ORDER BY id;
WITH stats AS (
-- Tag: window_functions_window_functions_operators_test_select_7563
SELECT AVG(id) as avg_id FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_7564
SELECT id, (SELECT avg_id FROM stats) as average
FROM data
ORDER BY id;
WITH category_data AS (
-- Tag: window_functions_window_functions_operators_test_select_7565
SELECT id, name FROM categories
)
-- Tag: window_functions_window_functions_operators_test_select_7566
SELECT c.name,
(SELECT MAX(price) FROM items WHERE cat_id = c.id) as max_price
FROM category_data c
ORDER BY c.name;
-- Tag: window_functions_window_functions_operators_test_select_7567
SELECT id,
(SELECT value FROM set1
UNION
-- Tag: window_functions_window_functions_operators_test_select_7568
SELECT value FROM set2
ORDER BY value
LIMIT 1) as min_value
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7569
SELECT r.name,
(SELECT SUM(amount)
FROM sales s
WHERE s.store_id IN (SELECT id FROM stores WHERE region_id = r.id)) as region_total
FROM regions r
ORDER BY r.name;
-- Tag: window_functions_window_functions_operators_test_select_7570
SELECT id, name, (SELECT CURRENT_DATE()) as today
FROM events
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7571
SELECT id, 100 / (SELECT divisor FROM config) as result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7572
SELECT id,
value,
(value + (SELECT offset FROM calibration)) * (SELECT scale FROM calibration) as calibrated
FROM measurements
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7573
SELECT id, value, value % (SELECT divisor FROM config) as remainder
FROM numbers
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7574
SELECT id, (SELECT SUM(value) FROM nulls) as sum_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7575
SELECT id, (SELECT AVG(value) FROM nulls) as avg_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7576
SELECT id,
(SELECT MIN(value) FROM nulls) as min_val,
(SELECT MAX(value) FROM nulls) as max_val
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7577
SELECT product,
SUM(amount) as total,
SUM(amount) - (SELECT target FROM targets) as over_under
FROM sales
GROUP BY product
ORDER BY product;

DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64, in_stock BOOL);
DROP TABLE IF EXISTS thresholds;
CREATE TABLE thresholds (min_price FLOAT64);
INSERT INTO products VALUES
(1, 50.0, true),
(2, 150.0, true),
(3, 75.0, false);
INSERT INTO thresholds VALUES (100.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, value INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (special_value INT64);
INSERT INTO items VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO config VALUES (20);
DROP TABLE IF EXISTS values;
CREATE TABLE values (id INT64, num INT64);
DROP TABLE IF EXISTS range;
CREATE TABLE range (min INT64, max INT64);
INSERT INTO values VALUES (1, 5), (2, 15), (3, 25);
INSERT INTO range VALUES (10, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2), (3);
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, name STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, cat_id INT64, price FLOAT64);
INSERT INTO categories VALUES (1, 'Electronics'), (2, 'Clothing');
INSERT INTO items VALUES
(1, 1, 100.0),
(2, 1, 200.0),
(3, 2, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO set1 VALUES (42);
INSERT INTO set2 VALUES (99);
DROP TABLE IF EXISTS regions;
CREATE TABLE regions (id INT64, name STRING);
DROP TABLE IF EXISTS stores;
CREATE TABLE stores (id INT64, region_id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (store_id INT64, amount FLOAT64);
INSERT INTO regions VALUES (1, 'North'), (2, 'South');
INSERT INTO stores VALUES (1, 1, 'Store A'), (2, 1, 'Store B'), (3, 2, 'Store C');
INSERT INTO sales VALUES
(1, 100.0),
(1, 150.0),
(2, 200.0),
(3, 300.0);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, name STRING);
INSERT INTO events VALUES (1, 'Event A'), (2, 'Event B');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO data VALUES (1), (2);
INSERT INTO config VALUES (0);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (id INT64, value FLOAT64);
DROP TABLE IF EXISTS calibration;
CREATE TABLE calibration (offset FLOAT64, scale FLOAT64);
INSERT INTO measurements VALUES (1, 10.0), (2, 20.0);
INSERT INTO calibration VALUES (5.0, 2.0);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO numbers VALUES (1, 17), (2, 23);
INSERT INTO config VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value FLOAT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
DROP TABLE IF EXISTS targets;
CREATE TABLE targets (target FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
INSERT INTO targets VALUES (120.0);

-- Tag: window_functions_window_functions_operators_test_select_7578
SELECT id, price
FROM products
WHERE in_stock = true AND price > (SELECT min_price FROM thresholds)
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7579
SELECT id
FROM items
WHERE value < 15 OR value = (SELECT special_value FROM config)
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7580
SELECT id
FROM values
WHERE num BETWEEN (SELECT min FROM range) AND (SELECT max FROM range)
ORDER BY id;
WITH stats AS (
-- Tag: window_functions_window_functions_operators_test_select_7581
SELECT AVG(id) as avg_id FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_7582
SELECT id, (SELECT avg_id FROM stats) as average
FROM data
ORDER BY id;
WITH category_data AS (
-- Tag: window_functions_window_functions_operators_test_select_7583
SELECT id, name FROM categories
)
-- Tag: window_functions_window_functions_operators_test_select_7584
SELECT c.name,
(SELECT MAX(price) FROM items WHERE cat_id = c.id) as max_price
FROM category_data c
ORDER BY c.name;
-- Tag: window_functions_window_functions_operators_test_select_7585
SELECT id,
(SELECT value FROM set1
UNION
-- Tag: window_functions_window_functions_operators_test_select_7586
SELECT value FROM set2
ORDER BY value
LIMIT 1) as min_value
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7587
SELECT r.name,
(SELECT SUM(amount)
FROM sales s
WHERE s.store_id IN (SELECT id FROM stores WHERE region_id = r.id)) as region_total
FROM regions r
ORDER BY r.name;
-- Tag: window_functions_window_functions_operators_test_select_7588
SELECT id, name, (SELECT CURRENT_DATE()) as today
FROM events
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7589
SELECT id, 100 / (SELECT divisor FROM config) as result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7590
SELECT id,
value,
(value + (SELECT offset FROM calibration)) * (SELECT scale FROM calibration) as calibrated
FROM measurements
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7591
SELECT id, value, value % (SELECT divisor FROM config) as remainder
FROM numbers
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7592
SELECT id, (SELECT SUM(value) FROM nulls) as sum_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7593
SELECT id, (SELECT AVG(value) FROM nulls) as avg_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7594
SELECT id,
(SELECT MIN(value) FROM nulls) as min_val,
(SELECT MAX(value) FROM nulls) as max_val
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7595
SELECT product,
SUM(amount) as total,
SUM(amount) - (SELECT target FROM targets) as over_under
FROM sales
GROUP BY product
ORDER BY product;

DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, value INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (special_value INT64);
INSERT INTO items VALUES (1, 10), (2, 20), (3, 30);
INSERT INTO config VALUES (20);
DROP TABLE IF EXISTS values;
CREATE TABLE values (id INT64, num INT64);
DROP TABLE IF EXISTS range;
CREATE TABLE range (min INT64, max INT64);
INSERT INTO values VALUES (1, 5), (2, 15), (3, 25);
INSERT INTO range VALUES (10, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2), (3);
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, name STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, cat_id INT64, price FLOAT64);
INSERT INTO categories VALUES (1, 'Electronics'), (2, 'Clothing');
INSERT INTO items VALUES
(1, 1, 100.0),
(2, 1, 200.0),
(3, 2, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO set1 VALUES (42);
INSERT INTO set2 VALUES (99);
DROP TABLE IF EXISTS regions;
CREATE TABLE regions (id INT64, name STRING);
DROP TABLE IF EXISTS stores;
CREATE TABLE stores (id INT64, region_id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (store_id INT64, amount FLOAT64);
INSERT INTO regions VALUES (1, 'North'), (2, 'South');
INSERT INTO stores VALUES (1, 1, 'Store A'), (2, 1, 'Store B'), (3, 2, 'Store C');
INSERT INTO sales VALUES
(1, 100.0),
(1, 150.0),
(2, 200.0),
(3, 300.0);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, name STRING);
INSERT INTO events VALUES (1, 'Event A'), (2, 'Event B');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO data VALUES (1), (2);
INSERT INTO config VALUES (0);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (id INT64, value FLOAT64);
DROP TABLE IF EXISTS calibration;
CREATE TABLE calibration (offset FLOAT64, scale FLOAT64);
INSERT INTO measurements VALUES (1, 10.0), (2, 20.0);
INSERT INTO calibration VALUES (5.0, 2.0);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO numbers VALUES (1, 17), (2, 23);
INSERT INTO config VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value FLOAT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
DROP TABLE IF EXISTS targets;
CREATE TABLE targets (target FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
INSERT INTO targets VALUES (120.0);

-- Tag: window_functions_window_functions_operators_test_select_7596
SELECT id
FROM items
WHERE value < 15 OR value = (SELECT special_value FROM config)
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7597
SELECT id
FROM values
WHERE num BETWEEN (SELECT min FROM range) AND (SELECT max FROM range)
ORDER BY id;
WITH stats AS (
-- Tag: window_functions_window_functions_operators_test_select_7598
SELECT AVG(id) as avg_id FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_7599
SELECT id, (SELECT avg_id FROM stats) as average
FROM data
ORDER BY id;
WITH category_data AS (
-- Tag: window_functions_window_functions_operators_test_select_7600
SELECT id, name FROM categories
)
-- Tag: window_functions_window_functions_operators_test_select_7601
SELECT c.name,
(SELECT MAX(price) FROM items WHERE cat_id = c.id) as max_price
FROM category_data c
ORDER BY c.name;
-- Tag: window_functions_window_functions_operators_test_select_7602
SELECT id,
(SELECT value FROM set1
UNION
-- Tag: window_functions_window_functions_operators_test_select_7603
SELECT value FROM set2
ORDER BY value
LIMIT 1) as min_value
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7604
SELECT r.name,
(SELECT SUM(amount)
FROM sales s
WHERE s.store_id IN (SELECT id FROM stores WHERE region_id = r.id)) as region_total
FROM regions r
ORDER BY r.name;
-- Tag: window_functions_window_functions_operators_test_select_7605
SELECT id, name, (SELECT CURRENT_DATE()) as today
FROM events
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7606
SELECT id, 100 / (SELECT divisor FROM config) as result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7607
SELECT id,
value,
(value + (SELECT offset FROM calibration)) * (SELECT scale FROM calibration) as calibrated
FROM measurements
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7608
SELECT id, value, value % (SELECT divisor FROM config) as remainder
FROM numbers
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7609
SELECT id, (SELECT SUM(value) FROM nulls) as sum_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7610
SELECT id, (SELECT AVG(value) FROM nulls) as avg_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7611
SELECT id,
(SELECT MIN(value) FROM nulls) as min_val,
(SELECT MAX(value) FROM nulls) as max_val
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7612
SELECT product,
SUM(amount) as total,
SUM(amount) - (SELECT target FROM targets) as over_under
FROM sales
GROUP BY product
ORDER BY product;

DROP TABLE IF EXISTS values;
CREATE TABLE values (id INT64, num INT64);
DROP TABLE IF EXISTS range;
CREATE TABLE range (min INT64, max INT64);
INSERT INTO values VALUES (1, 5), (2, 15), (3, 25);
INSERT INTO range VALUES (10, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2), (3);
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, name STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, cat_id INT64, price FLOAT64);
INSERT INTO categories VALUES (1, 'Electronics'), (2, 'Clothing');
INSERT INTO items VALUES
(1, 1, 100.0),
(2, 1, 200.0),
(3, 2, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO set1 VALUES (42);
INSERT INTO set2 VALUES (99);
DROP TABLE IF EXISTS regions;
CREATE TABLE regions (id INT64, name STRING);
DROP TABLE IF EXISTS stores;
CREATE TABLE stores (id INT64, region_id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (store_id INT64, amount FLOAT64);
INSERT INTO regions VALUES (1, 'North'), (2, 'South');
INSERT INTO stores VALUES (1, 1, 'Store A'), (2, 1, 'Store B'), (3, 2, 'Store C');
INSERT INTO sales VALUES
(1, 100.0),
(1, 150.0),
(2, 200.0),
(3, 300.0);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, name STRING);
INSERT INTO events VALUES (1, 'Event A'), (2, 'Event B');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO data VALUES (1), (2);
INSERT INTO config VALUES (0);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (id INT64, value FLOAT64);
DROP TABLE IF EXISTS calibration;
CREATE TABLE calibration (offset FLOAT64, scale FLOAT64);
INSERT INTO measurements VALUES (1, 10.0), (2, 20.0);
INSERT INTO calibration VALUES (5.0, 2.0);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO numbers VALUES (1, 17), (2, 23);
INSERT INTO config VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value FLOAT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
DROP TABLE IF EXISTS targets;
CREATE TABLE targets (target FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
INSERT INTO targets VALUES (120.0);

-- Tag: window_functions_window_functions_operators_test_select_7613
SELECT id
FROM values
WHERE num BETWEEN (SELECT min FROM range) AND (SELECT max FROM range)
ORDER BY id;
WITH stats AS (
-- Tag: window_functions_window_functions_operators_test_select_7614
SELECT AVG(id) as avg_id FROM data
)
-- Tag: window_functions_window_functions_operators_test_select_7615
SELECT id, (SELECT avg_id FROM stats) as average
FROM data
ORDER BY id;
WITH category_data AS (
-- Tag: window_functions_window_functions_operators_test_select_7616
SELECT id, name FROM categories
)
-- Tag: window_functions_window_functions_operators_test_select_7617
SELECT c.name,
(SELECT MAX(price) FROM items WHERE cat_id = c.id) as max_price
FROM category_data c
ORDER BY c.name;
-- Tag: window_functions_window_functions_operators_test_select_7618
SELECT id,
(SELECT value FROM set1
UNION
-- Tag: window_functions_window_functions_operators_test_select_7619
SELECT value FROM set2
ORDER BY value
LIMIT 1) as min_value
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7620
SELECT r.name,
(SELECT SUM(amount)
FROM sales s
WHERE s.store_id IN (SELECT id FROM stores WHERE region_id = r.id)) as region_total
FROM regions r
ORDER BY r.name;
-- Tag: window_functions_window_functions_operators_test_select_7621
SELECT id, name, (SELECT CURRENT_DATE()) as today
FROM events
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7622
SELECT id, 100 / (SELECT divisor FROM config) as result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7623
SELECT id,
value,
(value + (SELECT offset FROM calibration)) * (SELECT scale FROM calibration) as calibrated
FROM measurements
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7624
SELECT id, value, value % (SELECT divisor FROM config) as remainder
FROM numbers
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7625
SELECT id, (SELECT SUM(value) FROM nulls) as sum_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7626
SELECT id, (SELECT AVG(value) FROM nulls) as avg_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7627
SELECT id,
(SELECT MIN(value) FROM nulls) as min_val,
(SELECT MAX(value) FROM nulls) as max_val
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7628
SELECT product,
SUM(amount) as total,
SUM(amount) - (SELECT target FROM targets) as over_under
FROM sales
GROUP BY product
ORDER BY product;

DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, name STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, cat_id INT64, price FLOAT64);
INSERT INTO categories VALUES (1, 'Electronics'), (2, 'Clothing');
INSERT INTO items VALUES
(1, 1, 100.0),
(2, 1, 200.0),
(3, 2, 50.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO set1 VALUES (42);
INSERT INTO set2 VALUES (99);
DROP TABLE IF EXISTS regions;
CREATE TABLE regions (id INT64, name STRING);
DROP TABLE IF EXISTS stores;
CREATE TABLE stores (id INT64, region_id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (store_id INT64, amount FLOAT64);
INSERT INTO regions VALUES (1, 'North'), (2, 'South');
INSERT INTO stores VALUES (1, 1, 'Store A'), (2, 1, 'Store B'), (3, 2, 'Store C');
INSERT INTO sales VALUES
(1, 100.0),
(1, 150.0),
(2, 200.0),
(3, 300.0);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, name STRING);
INSERT INTO events VALUES (1, 'Event A'), (2, 'Event B');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO data VALUES (1), (2);
INSERT INTO config VALUES (0);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (id INT64, value FLOAT64);
DROP TABLE IF EXISTS calibration;
CREATE TABLE calibration (offset FLOAT64, scale FLOAT64);
INSERT INTO measurements VALUES (1, 10.0), (2, 20.0);
INSERT INTO calibration VALUES (5.0, 2.0);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO numbers VALUES (1, 17), (2, 23);
INSERT INTO config VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value FLOAT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
DROP TABLE IF EXISTS targets;
CREATE TABLE targets (target FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
INSERT INTO targets VALUES (120.0);

WITH category_data AS (
-- Tag: window_functions_window_functions_operators_test_select_7629
SELECT id, name FROM categories
)
-- Tag: window_functions_window_functions_operators_test_select_7630
SELECT c.name,
(SELECT MAX(price) FROM items WHERE cat_id = c.id) as max_price
FROM category_data c
ORDER BY c.name;
-- Tag: window_functions_window_functions_operators_test_select_7631
SELECT id,
(SELECT value FROM set1
UNION
-- Tag: window_functions_window_functions_operators_test_select_7632
SELECT value FROM set2
ORDER BY value
LIMIT 1) as min_value
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7633
SELECT r.name,
(SELECT SUM(amount)
FROM sales s
WHERE s.store_id IN (SELECT id FROM stores WHERE region_id = r.id)) as region_total
FROM regions r
ORDER BY r.name;
-- Tag: window_functions_window_functions_operators_test_select_7634
SELECT id, name, (SELECT CURRENT_DATE()) as today
FROM events
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7635
SELECT id, 100 / (SELECT divisor FROM config) as result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7636
SELECT id,
value,
(value + (SELECT offset FROM calibration)) * (SELECT scale FROM calibration) as calibrated
FROM measurements
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7637
SELECT id, value, value % (SELECT divisor FROM config) as remainder
FROM numbers
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7638
SELECT id, (SELECT SUM(value) FROM nulls) as sum_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7639
SELECT id, (SELECT AVG(value) FROM nulls) as avg_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7640
SELECT id,
(SELECT MIN(value) FROM nulls) as min_val,
(SELECT MAX(value) FROM nulls) as max_val
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7641
SELECT product,
SUM(amount) as total,
SUM(amount) - (SELECT target FROM targets) as over_under
FROM sales
GROUP BY product
ORDER BY product;

DROP TABLE IF EXISTS regions;
CREATE TABLE regions (id INT64, name STRING);
DROP TABLE IF EXISTS stores;
CREATE TABLE stores (id INT64, region_id INT64, name STRING);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (store_id INT64, amount FLOAT64);
INSERT INTO regions VALUES (1, 'North'), (2, 'South');
INSERT INTO stores VALUES (1, 1, 'Store A'), (2, 1, 'Store B'), (3, 2, 'Store C');
INSERT INTO sales VALUES
(1, 100.0),
(1, 150.0),
(2, 200.0),
(3, 300.0);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, name STRING);
INSERT INTO events VALUES (1, 'Event A'), (2, 'Event B');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO data VALUES (1), (2);
INSERT INTO config VALUES (0);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (id INT64, value FLOAT64);
DROP TABLE IF EXISTS calibration;
CREATE TABLE calibration (offset FLOAT64, scale FLOAT64);
INSERT INTO measurements VALUES (1, 10.0), (2, 20.0);
INSERT INTO calibration VALUES (5.0, 2.0);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO numbers VALUES (1, 17), (2, 23);
INSERT INTO config VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value FLOAT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
DROP TABLE IF EXISTS targets;
CREATE TABLE targets (target FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
INSERT INTO targets VALUES (120.0);

-- Tag: window_functions_window_functions_operators_test_select_7642
SELECT r.name,
(SELECT SUM(amount)
FROM sales s
WHERE s.store_id IN (SELECT id FROM stores WHERE region_id = r.id)) as region_total
FROM regions r
ORDER BY r.name;
-- Tag: window_functions_window_functions_operators_test_select_7643
SELECT id, name, (SELECT CURRENT_DATE()) as today
FROM events
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7644
SELECT id, 100 / (SELECT divisor FROM config) as result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7645
SELECT id,
value,
(value + (SELECT offset FROM calibration)) * (SELECT scale FROM calibration) as calibrated
FROM measurements
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7646
SELECT id, value, value % (SELECT divisor FROM config) as remainder
FROM numbers
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7647
SELECT id, (SELECT SUM(value) FROM nulls) as sum_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7648
SELECT id, (SELECT AVG(value) FROM nulls) as avg_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7649
SELECT id,
(SELECT MIN(value) FROM nulls) as min_val,
(SELECT MAX(value) FROM nulls) as max_val
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7650
SELECT product,
SUM(amount) as total,
SUM(amount) - (SELECT target FROM targets) as over_under
FROM sales
GROUP BY product
ORDER BY product;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO data VALUES (1), (2);
INSERT INTO config VALUES (0);
DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (id INT64, value FLOAT64);
DROP TABLE IF EXISTS calibration;
CREATE TABLE calibration (offset FLOAT64, scale FLOAT64);
INSERT INTO measurements VALUES (1, 10.0), (2, 20.0);
INSERT INTO calibration VALUES (5.0, 2.0);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO numbers VALUES (1, 17), (2, 23);
INSERT INTO config VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value FLOAT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
DROP TABLE IF EXISTS targets;
CREATE TABLE targets (target FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
INSERT INTO targets VALUES (120.0);

-- Tag: window_functions_window_functions_operators_test_select_7651
SELECT id, 100 / (SELECT divisor FROM config) as result
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7652
SELECT id,
value,
(value + (SELECT offset FROM calibration)) * (SELECT scale FROM calibration) as calibrated
FROM measurements
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7653
SELECT id, value, value % (SELECT divisor FROM config) as remainder
FROM numbers
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7654
SELECT id, (SELECT SUM(value) FROM nulls) as sum_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7655
SELECT id, (SELECT AVG(value) FROM nulls) as avg_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7656
SELECT id,
(SELECT MIN(value) FROM nulls) as min_val,
(SELECT MAX(value) FROM nulls) as max_val
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7657
SELECT product,
SUM(amount) as total,
SUM(amount) - (SELECT target FROM targets) as over_under
FROM sales
GROUP BY product
ORDER BY product;

DROP TABLE IF EXISTS measurements;
CREATE TABLE measurements (id INT64, value FLOAT64);
DROP TABLE IF EXISTS calibration;
CREATE TABLE calibration (offset FLOAT64, scale FLOAT64);
INSERT INTO measurements VALUES (1, 10.0), (2, 20.0);
INSERT INTO calibration VALUES (5.0, 2.0);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (divisor INT64);
INSERT INTO numbers VALUES (1, 17), (2, 23);
INSERT INTO config VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value FLOAT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO nulls VALUES (NULL), (NULL);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
DROP TABLE IF EXISTS targets;
CREATE TABLE targets (target FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
INSERT INTO targets VALUES (120.0);

-- Tag: window_functions_window_functions_operators_test_select_7658
SELECT id,
value,
(value + (SELECT offset FROM calibration)) * (SELECT scale FROM calibration) as calibrated
FROM measurements
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7659
SELECT id, value, value % (SELECT divisor FROM config) as remainder
FROM numbers
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7660
SELECT id, (SELECT SUM(value) FROM nulls) as sum_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7661
SELECT id, (SELECT AVG(value) FROM nulls) as avg_nulls FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7662
SELECT id,
(SELECT MIN(value) FROM nulls) as min_val,
(SELECT MAX(value) FROM nulls) as max_val
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7663
SELECT product,
SUM(amount) as total,
SUM(amount) - (SELECT target FROM targets) as over_under
FROM sales
GROUP BY product
ORDER BY product;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
DROP TABLE IF EXISTS targets;
CREATE TABLE targets (target FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
INSERT INTO targets VALUES (120.0);

-- Tag: window_functions_window_functions_operators_test_select_7664
SELECT product,
SUM(amount) as total,
SUM(amount) - (SELECT target FROM targets) as over_under
FROM sales
GROUP BY product
ORDER BY product;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, dept_id INT64, salary FLOAT64);
INSERT INTO employees VALUES
(1, 'Alice', 1, 50000.0),
(2, 'Bob', 1, 60000.0),
(3, 'Charlie', 2, 55000.0),
(4, 'David', 2, 65000.0);
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, name STRING);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 1, 'Alice'),
(2, 1, 'Bob'),
(3, 2, 'Charlie');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING, price FLOAT64);
INSERT INTO products VALUES
(1, 'Electronics', 100.0),
(2, 'Electronics', 200.0),
(3, 'Clothing', 50.0),
(4, 'Clothing', 75.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product_id INT64, quantity INT64);
INSERT INTO sales VALUES
(1, 100, 5),
(2, 100, 10),
(3, 200, 8);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (value INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (value INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, category STRING);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, category STRING, value INT64);
INSERT INTO outer_table VALUES (1, 'A'), (2, 'B');
INSERT INTO inner_table VALUES (1, 'A', 100);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS values;
CREATE TABLE values (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO values VALUES (10), (20), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING);
DROP TABLE IF EXISTS salaries;
CREATE TABLE salaries (emp_id INT64, amount FLOAT64, year INT64);
INSERT INTO employees VALUES (1, 'Alice');
INSERT INTO salaries VALUES
(1, 50000.0, 2021),
(1, 55000.0, 2022),
(1, 60000.0, 2023);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64);
INSERT INTO employees VALUES
(1, 'Alice', 50000.0),
(2, 'Bob', 60000.0),
(3, 'Charlie', 55000.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES
(1, 'A', 100.0),
(2, 'B', 50.0),
(3, 'C', 150.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, price FLOAT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (tax_rate FLOAT64);
INSERT INTO items VALUES (1, 100.0), (2, 200.0);
INSERT INTO config VALUES (0.1);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
DROP TABLE IF EXISTS thresholds;
CREATE TABLE thresholds (expensive_threshold FLOAT64);
INSERT INTO products VALUES (1, 50.0), (2, 150.0);
INSERT INTO thresholds VALUES (100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (value INT64);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (multiplier INT64);
INSERT INTO data VALUES (1);
INSERT INTO level1 VALUES (10);
INSERT INTO level2 VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS values;
CREATE TABLE values (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO values VALUES (10), (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS dual_cols;
CREATE TABLE dual_cols (a INT64, b INT64);
INSERT INTO data VALUES (1);
INSERT INTO dual_cols VALUES (10, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
INSERT INTO orders VALUES (1, 100, 50.0), (2, 100, 75.0), (3, 200, 60.0);
INSERT INTO customers VALUES (100, 'Alice'), (200, 'Bob');
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary FLOAT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 1, 50000.0),
(2, 1, 60000.0),
(3, 2, 55000.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category INT64, price FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS stats;
CREATE TABLE stats (min INT64, max INT64, avg FLOAT64);
INSERT INTO data VALUES (1), (2), (3);
INSERT INTO stats VALUES (1, 100, 50.5);

-- Tag: window_functions_window_functions_operators_test_select_7665
SELECT e1.name, e1.salary,
(SELECT AVG(e2.salary)
FROM employees e2
WHERE e2.dept_id = e1.dept_id) as dept_avg
FROM employees e1
ORDER BY e1.name;
-- Tag: window_functions_window_functions_operators_test_select_7666
SELECT d.name,
(SELECT COUNT(*) FROM employees e WHERE e.dept_id = d.id) as emp_count
FROM departments d
ORDER BY d.name;
-- Tag: window_functions_window_functions_operators_test_select_7667
SELECT p1.id, p1.category, p1.price,
(SELECT MAX(p2.price)
FROM products p2
WHERE p2.category = p1.category) as max_price
FROM products p1
ORDER BY p1.id;
-- Tag: window_functions_window_functions_operators_test_select_7668
SELECT s1.id, s1.quantity,
(SELECT SUM(s2.quantity)
FROM sales s2
WHERE s2.product_id = s1.product_id) as total_qty
FROM sales s1
ORDER BY s1.id;
-- Tag: window_functions_window_functions_operators_test_select_7669
SELECT id, (SELECT value FROM data WHERE id = 2) as null_val FROM data WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_7670
SELECT id, (SELECT id FROM data WHERE id = 999) as missing FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7671
SELECT id, (SELECT value FROM empty) as empty_val FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7672
SELECT id, (SELECT COUNT(*) FROM empty) as count FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7673
SELECT o.id, o.category,
(SELECT SUM(i.value) FROM inner_table i WHERE i.category = o.category) as total
FROM outer_table o
ORDER BY o.id;
-- Tag: window_functions_window_functions_operators_test_select_7674
SELECT id, (SELECT value FROM values ORDER BY value DESC LIMIT 1) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7675
SELECT e.name,
(SELECT s.amount FROM salaries s WHERE s.emp_id = e.id ORDER BY s.year DESC LIMIT 1) as latest_salary
FROM employees e;
-- Tag: window_functions_window_functions_operators_test_select_7676
SELECT name, salary
FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees)
ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_7677
SELECT product, SUM(amount) as total,
(SELECT SUM(amount) FROM sales) as grand_total
FROM sales
GROUP BY product
ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_7678
SELECT category, SUM(amount) as total
FROM sales
GROUP BY category
HAVING SUM(amount) > (SELECT AVG(amount) FROM sales)
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_7679
SELECT name, price
FROM products
ORDER BY price - (SELECT AVG(price) FROM products) DESC;
-- Tag: window_functions_window_functions_operators_test_select_7680
SELECT id, price, price * (1 + (SELECT tax_rate FROM config)) as total
FROM items
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7681
SELECT id,
CASE
WHEN price > (SELECT expensive_threshold FROM thresholds) THEN 'Expensive'
ELSE 'Affordable'
END as category
FROM products
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7682
SELECT id,
(SELECT value * (SELECT multiplier FROM level2) FROM level1) as result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7683
SELECT id, (SELECT value FROM values) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7684
SELECT id, (SELECT a, b FROM dual_cols) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7685
SELECT id, (SELECT undefined_col FROM data) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7686
SELECT c.name, o.amount,
(SELECT AVG(amount) FROM orders) as overall_avg
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY c.name, o.amount;
-- Tag: window_functions_window_functions_operators_test_select_7687
SELECT d.name,
(SELECT MAX(e.salary) FROM employees e WHERE e.dept_id = d.id) as max_salary
FROM departments d
ORDER BY d.name;
-- Tag: window_functions_window_functions_operators_test_select_7688
SELECT i1.id, i1.price,
(SELECT AVG(i2.price) FROM items i2 WHERE i2.category = i1.category) as category_avg
FROM items i1
WHERE i1.id < 10
ORDER BY i1.id;
-- Tag: window_functions_window_functions_operators_test_select_7689
SELECT id,
(SELECT min FROM stats) as min_val,
(SELECT max FROM stats) as max_val,
(SELECT avg FROM stats) as avg_val
FROM data
ORDER BY id;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, product_id INT64, quantity INT64);
INSERT INTO sales VALUES
(1, 100, 5),
(2, 100, 10),
(3, 200, 8);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (value INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (value INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, category STRING);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, category STRING, value INT64);
INSERT INTO outer_table VALUES (1, 'A'), (2, 'B');
INSERT INTO inner_table VALUES (1, 'A', 100);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS values;
CREATE TABLE values (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO values VALUES (10), (20), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING);
DROP TABLE IF EXISTS salaries;
CREATE TABLE salaries (emp_id INT64, amount FLOAT64, year INT64);
INSERT INTO employees VALUES (1, 'Alice');
INSERT INTO salaries VALUES
(1, 50000.0, 2021),
(1, 55000.0, 2022),
(1, 60000.0, 2023);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64);
INSERT INTO employees VALUES
(1, 'Alice', 50000.0),
(2, 'Bob', 60000.0),
(3, 'Charlie', 55000.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES
(1, 'A', 100.0),
(2, 'B', 50.0),
(3, 'C', 150.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, price FLOAT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (tax_rate FLOAT64);
INSERT INTO items VALUES (1, 100.0), (2, 200.0);
INSERT INTO config VALUES (0.1);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
DROP TABLE IF EXISTS thresholds;
CREATE TABLE thresholds (expensive_threshold FLOAT64);
INSERT INTO products VALUES (1, 50.0), (2, 150.0);
INSERT INTO thresholds VALUES (100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (value INT64);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (multiplier INT64);
INSERT INTO data VALUES (1);
INSERT INTO level1 VALUES (10);
INSERT INTO level2 VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS values;
CREATE TABLE values (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO values VALUES (10), (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS dual_cols;
CREATE TABLE dual_cols (a INT64, b INT64);
INSERT INTO data VALUES (1);
INSERT INTO dual_cols VALUES (10, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
INSERT INTO orders VALUES (1, 100, 50.0), (2, 100, 75.0), (3, 200, 60.0);
INSERT INTO customers VALUES (100, 'Alice'), (200, 'Bob');
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary FLOAT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 1, 50000.0),
(2, 1, 60000.0),
(3, 2, 55000.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category INT64, price FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS stats;
CREATE TABLE stats (min INT64, max INT64, avg FLOAT64);
INSERT INTO data VALUES (1), (2), (3);
INSERT INTO stats VALUES (1, 100, 50.5);

-- Tag: window_functions_window_functions_operators_test_select_7690
SELECT s1.id, s1.quantity,
(SELECT SUM(s2.quantity)
FROM sales s2
WHERE s2.product_id = s1.product_id) as total_qty
FROM sales s1
ORDER BY s1.id;
-- Tag: window_functions_window_functions_operators_test_select_7691
SELECT id, (SELECT value FROM data WHERE id = 2) as null_val FROM data WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_7692
SELECT id, (SELECT id FROM data WHERE id = 999) as missing FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7693
SELECT id, (SELECT value FROM empty) as empty_val FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7694
SELECT id, (SELECT COUNT(*) FROM empty) as count FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7695
SELECT o.id, o.category,
(SELECT SUM(i.value) FROM inner_table i WHERE i.category = o.category) as total
FROM outer_table o
ORDER BY o.id;
-- Tag: window_functions_window_functions_operators_test_select_7696
SELECT id, (SELECT value FROM values ORDER BY value DESC LIMIT 1) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7697
SELECT e.name,
(SELECT s.amount FROM salaries s WHERE s.emp_id = e.id ORDER BY s.year DESC LIMIT 1) as latest_salary
FROM employees e;
-- Tag: window_functions_window_functions_operators_test_select_7698
SELECT name, salary
FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees)
ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_7699
SELECT product, SUM(amount) as total,
(SELECT SUM(amount) FROM sales) as grand_total
FROM sales
GROUP BY product
ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_7700
SELECT category, SUM(amount) as total
FROM sales
GROUP BY category
HAVING SUM(amount) > (SELECT AVG(amount) FROM sales)
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_7701
SELECT name, price
FROM products
ORDER BY price - (SELECT AVG(price) FROM products) DESC;
-- Tag: window_functions_window_functions_operators_test_select_7702
SELECT id, price, price * (1 + (SELECT tax_rate FROM config)) as total
FROM items
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7703
SELECT id,
CASE
WHEN price > (SELECT expensive_threshold FROM thresholds) THEN 'Expensive'
ELSE 'Affordable'
END as category
FROM products
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7704
SELECT id,
(SELECT value * (SELECT multiplier FROM level2) FROM level1) as result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7705
SELECT id, (SELECT value FROM values) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7706
SELECT id, (SELECT a, b FROM dual_cols) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7707
SELECT id, (SELECT undefined_col FROM data) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7708
SELECT c.name, o.amount,
(SELECT AVG(amount) FROM orders) as overall_avg
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY c.name, o.amount;
-- Tag: window_functions_window_functions_operators_test_select_7709
SELECT d.name,
(SELECT MAX(e.salary) FROM employees e WHERE e.dept_id = d.id) as max_salary
FROM departments d
ORDER BY d.name;
-- Tag: window_functions_window_functions_operators_test_select_7710
SELECT i1.id, i1.price,
(SELECT AVG(i2.price) FROM items i2 WHERE i2.category = i1.category) as category_avg
FROM items i1
WHERE i1.id < 10
ORDER BY i1.id;
-- Tag: window_functions_window_functions_operators_test_select_7711
SELECT id,
(SELECT min FROM stats) as min_val,
(SELECT max FROM stats) as max_val,
(SELECT avg FROM stats) as avg_val
FROM data
ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (value INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (value INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64, category STRING);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (id INT64, category STRING, value INT64);
INSERT INTO outer_table VALUES (1, 'A'), (2, 'B');
INSERT INTO inner_table VALUES (1, 'A', 100);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS values;
CREATE TABLE values (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO values VALUES (10), (20), (30);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING);
DROP TABLE IF EXISTS salaries;
CREATE TABLE salaries (emp_id INT64, amount FLOAT64, year INT64);
INSERT INTO employees VALUES (1, 'Alice');
INSERT INTO salaries VALUES
(1, 50000.0, 2021),
(1, 55000.0, 2022),
(1, 60000.0, 2023);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64);
INSERT INTO employees VALUES
(1, 'Alice', 50000.0),
(2, 'Bob', 60000.0),
(3, 'Charlie', 55000.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES
(1, 'A', 100.0),
(2, 'B', 50.0),
(3, 'C', 150.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, price FLOAT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (tax_rate FLOAT64);
INSERT INTO items VALUES (1, 100.0), (2, 200.0);
INSERT INTO config VALUES (0.1);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
DROP TABLE IF EXISTS thresholds;
CREATE TABLE thresholds (expensive_threshold FLOAT64);
INSERT INTO products VALUES (1, 50.0), (2, 150.0);
INSERT INTO thresholds VALUES (100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (value INT64);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (multiplier INT64);
INSERT INTO data VALUES (1);
INSERT INTO level1 VALUES (10);
INSERT INTO level2 VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS values;
CREATE TABLE values (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO values VALUES (10), (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS dual_cols;
CREATE TABLE dual_cols (a INT64, b INT64);
INSERT INTO data VALUES (1);
INSERT INTO dual_cols VALUES (10, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
INSERT INTO orders VALUES (1, 100, 50.0), (2, 100, 75.0), (3, 200, 60.0);
INSERT INTO customers VALUES (100, 'Alice'), (200, 'Bob');
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary FLOAT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 1, 50000.0),
(2, 1, 60000.0),
(3, 2, 55000.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category INT64, price FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS stats;
CREATE TABLE stats (min INT64, max INT64, avg FLOAT64);
INSERT INTO data VALUES (1), (2), (3);
INSERT INTO stats VALUES (1, 100, 50.5);

-- Tag: window_functions_window_functions_operators_test_select_7712
SELECT id, (SELECT value FROM data WHERE id = 2) as null_val FROM data WHERE id = 1;
-- Tag: window_functions_window_functions_operators_test_select_7713
SELECT id, (SELECT id FROM data WHERE id = 999) as missing FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7714
SELECT id, (SELECT value FROM empty) as empty_val FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7715
SELECT id, (SELECT COUNT(*) FROM empty) as count FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7716
SELECT o.id, o.category,
(SELECT SUM(i.value) FROM inner_table i WHERE i.category = o.category) as total
FROM outer_table o
ORDER BY o.id;
-- Tag: window_functions_window_functions_operators_test_select_7717
SELECT id, (SELECT value FROM values ORDER BY value DESC LIMIT 1) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7718
SELECT e.name,
(SELECT s.amount FROM salaries s WHERE s.emp_id = e.id ORDER BY s.year DESC LIMIT 1) as latest_salary
FROM employees e;
-- Tag: window_functions_window_functions_operators_test_select_7719
SELECT name, salary
FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees)
ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_7720
SELECT product, SUM(amount) as total,
(SELECT SUM(amount) FROM sales) as grand_total
FROM sales
GROUP BY product
ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_7721
SELECT category, SUM(amount) as total
FROM sales
GROUP BY category
HAVING SUM(amount) > (SELECT AVG(amount) FROM sales)
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_7722
SELECT name, price
FROM products
ORDER BY price - (SELECT AVG(price) FROM products) DESC;
-- Tag: window_functions_window_functions_operators_test_select_7723
SELECT id, price, price * (1 + (SELECT tax_rate FROM config)) as total
FROM items
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7724
SELECT id,
CASE
WHEN price > (SELECT expensive_threshold FROM thresholds) THEN 'Expensive'
ELSE 'Affordable'
END as category
FROM products
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7725
SELECT id,
(SELECT value * (SELECT multiplier FROM level2) FROM level1) as result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7726
SELECT id, (SELECT value FROM values) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7727
SELECT id, (SELECT a, b FROM dual_cols) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7728
SELECT id, (SELECT undefined_col FROM data) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7729
SELECT c.name, o.amount,
(SELECT AVG(amount) FROM orders) as overall_avg
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY c.name, o.amount;
-- Tag: window_functions_window_functions_operators_test_select_7730
SELECT d.name,
(SELECT MAX(e.salary) FROM employees e WHERE e.dept_id = d.id) as max_salary
FROM departments d
ORDER BY d.name;
-- Tag: window_functions_window_functions_operators_test_select_7731
SELECT i1.id, i1.price,
(SELECT AVG(i2.price) FROM items i2 WHERE i2.category = i1.category) as category_avg
FROM items i1
WHERE i1.id < 10
ORDER BY i1.id;
-- Tag: window_functions_window_functions_operators_test_select_7732
SELECT id,
(SELECT min FROM stats) as min_val,
(SELECT max FROM stats) as max_val,
(SELECT avg FROM stats) as avg_val
FROM data
ORDER BY id;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING);
DROP TABLE IF EXISTS salaries;
CREATE TABLE salaries (emp_id INT64, amount FLOAT64, year INT64);
INSERT INTO employees VALUES (1, 'Alice');
INSERT INTO salaries VALUES
(1, 50000.0, 2021),
(1, 55000.0, 2022),
(1, 60000.0, 2023);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64);
INSERT INTO employees VALUES
(1, 'Alice', 50000.0),
(2, 'Bob', 60000.0),
(3, 'Charlie', 55000.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES
(1, 'A', 100.0),
(2, 'B', 50.0),
(3, 'C', 150.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, price FLOAT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (tax_rate FLOAT64);
INSERT INTO items VALUES (1, 100.0), (2, 200.0);
INSERT INTO config VALUES (0.1);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
DROP TABLE IF EXISTS thresholds;
CREATE TABLE thresholds (expensive_threshold FLOAT64);
INSERT INTO products VALUES (1, 50.0), (2, 150.0);
INSERT INTO thresholds VALUES (100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (value INT64);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (multiplier INT64);
INSERT INTO data VALUES (1);
INSERT INTO level1 VALUES (10);
INSERT INTO level2 VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS values;
CREATE TABLE values (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO values VALUES (10), (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS dual_cols;
CREATE TABLE dual_cols (a INT64, b INT64);
INSERT INTO data VALUES (1);
INSERT INTO dual_cols VALUES (10, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
INSERT INTO orders VALUES (1, 100, 50.0), (2, 100, 75.0), (3, 200, 60.0);
INSERT INTO customers VALUES (100, 'Alice'), (200, 'Bob');
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary FLOAT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 1, 50000.0),
(2, 1, 60000.0),
(3, 2, 55000.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category INT64, price FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS stats;
CREATE TABLE stats (min INT64, max INT64, avg FLOAT64);
INSERT INTO data VALUES (1), (2), (3);
INSERT INTO stats VALUES (1, 100, 50.5);

-- Tag: window_functions_window_functions_operators_test_select_7733
SELECT e.name,
(SELECT s.amount FROM salaries s WHERE s.emp_id = e.id ORDER BY s.year DESC LIMIT 1) as latest_salary
FROM employees e;
-- Tag: window_functions_window_functions_operators_test_select_7734
SELECT name, salary
FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees)
ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_7735
SELECT product, SUM(amount) as total,
(SELECT SUM(amount) FROM sales) as grand_total
FROM sales
GROUP BY product
ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_7736
SELECT category, SUM(amount) as total
FROM sales
GROUP BY category
HAVING SUM(amount) > (SELECT AVG(amount) FROM sales)
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_7737
SELECT name, price
FROM products
ORDER BY price - (SELECT AVG(price) FROM products) DESC;
-- Tag: window_functions_window_functions_operators_test_select_7738
SELECT id, price, price * (1 + (SELECT tax_rate FROM config)) as total
FROM items
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7739
SELECT id,
CASE
WHEN price > (SELECT expensive_threshold FROM thresholds) THEN 'Expensive'
ELSE 'Affordable'
END as category
FROM products
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7740
SELECT id,
(SELECT value * (SELECT multiplier FROM level2) FROM level1) as result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7741
SELECT id, (SELECT value FROM values) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7742
SELECT id, (SELECT a, b FROM dual_cols) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7743
SELECT id, (SELECT undefined_col FROM data) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7744
SELECT c.name, o.amount,
(SELECT AVG(amount) FROM orders) as overall_avg
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY c.name, o.amount;
-- Tag: window_functions_window_functions_operators_test_select_7745
SELECT d.name,
(SELECT MAX(e.salary) FROM employees e WHERE e.dept_id = d.id) as max_salary
FROM departments d
ORDER BY d.name;
-- Tag: window_functions_window_functions_operators_test_select_7746
SELECT i1.id, i1.price,
(SELECT AVG(i2.price) FROM items i2 WHERE i2.category = i1.category) as category_avg
FROM items i1
WHERE i1.id < 10
ORDER BY i1.id;
-- Tag: window_functions_window_functions_operators_test_select_7747
SELECT id,
(SELECT min FROM stats) as min_val,
(SELECT max FROM stats) as max_val,
(SELECT avg FROM stats) as avg_val
FROM data
ORDER BY id;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, name STRING, salary FLOAT64);
INSERT INTO employees VALUES
(1, 'Alice', 50000.0),
(2, 'Bob', 60000.0),
(3, 'Charlie', 55000.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 200.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (category STRING, amount FLOAT64);
INSERT INTO sales VALUES
('A', 100.0),
('A', 150.0),
('B', 50.0);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES
(1, 'A', 100.0),
(2, 'B', 50.0),
(3, 'C', 150.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, price FLOAT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (tax_rate FLOAT64);
INSERT INTO items VALUES (1, 100.0), (2, 200.0);
INSERT INTO config VALUES (0.1);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
DROP TABLE IF EXISTS thresholds;
CREATE TABLE thresholds (expensive_threshold FLOAT64);
INSERT INTO products VALUES (1, 50.0), (2, 150.0);
INSERT INTO thresholds VALUES (100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (value INT64);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (multiplier INT64);
INSERT INTO data VALUES (1);
INSERT INTO level1 VALUES (10);
INSERT INTO level2 VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS values;
CREATE TABLE values (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO values VALUES (10), (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS dual_cols;
CREATE TABLE dual_cols (a INT64, b INT64);
INSERT INTO data VALUES (1);
INSERT INTO dual_cols VALUES (10, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
INSERT INTO orders VALUES (1, 100, 50.0), (2, 100, 75.0), (3, 200, 60.0);
INSERT INTO customers VALUES (100, 'Alice'), (200, 'Bob');
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary FLOAT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 1, 50000.0),
(2, 1, 60000.0),
(3, 2, 55000.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category INT64, price FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS stats;
CREATE TABLE stats (min INT64, max INT64, avg FLOAT64);
INSERT INTO data VALUES (1), (2), (3);
INSERT INTO stats VALUES (1, 100, 50.5);

-- Tag: window_functions_window_functions_operators_test_select_7748
SELECT name, salary
FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees)
ORDER BY name;
-- Tag: window_functions_window_functions_operators_test_select_7749
SELECT product, SUM(amount) as total,
(SELECT SUM(amount) FROM sales) as grand_total
FROM sales
GROUP BY product
ORDER BY product;
-- Tag: window_functions_window_functions_operators_test_select_7750
SELECT category, SUM(amount) as total
FROM sales
GROUP BY category
HAVING SUM(amount) > (SELECT AVG(amount) FROM sales)
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_7751
SELECT name, price
FROM products
ORDER BY price - (SELECT AVG(price) FROM products) DESC;
-- Tag: window_functions_window_functions_operators_test_select_7752
SELECT id, price, price * (1 + (SELECT tax_rate FROM config)) as total
FROM items
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7753
SELECT id,
CASE
WHEN price > (SELECT expensive_threshold FROM thresholds) THEN 'Expensive'
ELSE 'Affordable'
END as category
FROM products
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7754
SELECT id,
(SELECT value * (SELECT multiplier FROM level2) FROM level1) as result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7755
SELECT id, (SELECT value FROM values) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7756
SELECT id, (SELECT a, b FROM dual_cols) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7757
SELECT id, (SELECT undefined_col FROM data) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7758
SELECT c.name, o.amount,
(SELECT AVG(amount) FROM orders) as overall_avg
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY c.name, o.amount;
-- Tag: window_functions_window_functions_operators_test_select_7759
SELECT d.name,
(SELECT MAX(e.salary) FROM employees e WHERE e.dept_id = d.id) as max_salary
FROM departments d
ORDER BY d.name;
-- Tag: window_functions_window_functions_operators_test_select_7760
SELECT i1.id, i1.price,
(SELECT AVG(i2.price) FROM items i2 WHERE i2.category = i1.category) as category_avg
FROM items i1
WHERE i1.id < 10
ORDER BY i1.id;
-- Tag: window_functions_window_functions_operators_test_select_7761
SELECT id,
(SELECT min FROM stats) as min_val,
(SELECT max FROM stats) as max_val,
(SELECT avg FROM stats) as avg_val
FROM data
ORDER BY id;

DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, price FLOAT64);
INSERT INTO products VALUES
(1, 'A', 100.0),
(2, 'B', 50.0),
(3, 'C', 150.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, price FLOAT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (tax_rate FLOAT64);
INSERT INTO items VALUES (1, 100.0), (2, 200.0);
INSERT INTO config VALUES (0.1);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
DROP TABLE IF EXISTS thresholds;
CREATE TABLE thresholds (expensive_threshold FLOAT64);
INSERT INTO products VALUES (1, 50.0), (2, 150.0);
INSERT INTO thresholds VALUES (100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (value INT64);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (multiplier INT64);
INSERT INTO data VALUES (1);
INSERT INTO level1 VALUES (10);
INSERT INTO level2 VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS values;
CREATE TABLE values (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO values VALUES (10), (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS dual_cols;
CREATE TABLE dual_cols (a INT64, b INT64);
INSERT INTO data VALUES (1);
INSERT INTO dual_cols VALUES (10, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
INSERT INTO orders VALUES (1, 100, 50.0), (2, 100, 75.0), (3, 200, 60.0);
INSERT INTO customers VALUES (100, 'Alice'), (200, 'Bob');
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary FLOAT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 1, 50000.0),
(2, 1, 60000.0),
(3, 2, 55000.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category INT64, price FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS stats;
CREATE TABLE stats (min INT64, max INT64, avg FLOAT64);
INSERT INTO data VALUES (1), (2), (3);
INSERT INTO stats VALUES (1, 100, 50.5);

-- Tag: window_functions_window_functions_operators_test_select_7762
SELECT name, price
FROM products
ORDER BY price - (SELECT AVG(price) FROM products) DESC;
-- Tag: window_functions_window_functions_operators_test_select_7763
SELECT id, price, price * (1 + (SELECT tax_rate FROM config)) as total
FROM items
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7764
SELECT id,
CASE
WHEN price > (SELECT expensive_threshold FROM thresholds) THEN 'Expensive'
ELSE 'Affordable'
END as category
FROM products
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7765
SELECT id,
(SELECT value * (SELECT multiplier FROM level2) FROM level1) as result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7766
SELECT id, (SELECT value FROM values) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7767
SELECT id, (SELECT a, b FROM dual_cols) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7768
SELECT id, (SELECT undefined_col FROM data) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7769
SELECT c.name, o.amount,
(SELECT AVG(amount) FROM orders) as overall_avg
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY c.name, o.amount;
-- Tag: window_functions_window_functions_operators_test_select_7770
SELECT d.name,
(SELECT MAX(e.salary) FROM employees e WHERE e.dept_id = d.id) as max_salary
FROM departments d
ORDER BY d.name;
-- Tag: window_functions_window_functions_operators_test_select_7771
SELECT i1.id, i1.price,
(SELECT AVG(i2.price) FROM items i2 WHERE i2.category = i1.category) as category_avg
FROM items i1
WHERE i1.id < 10
ORDER BY i1.id;
-- Tag: window_functions_window_functions_operators_test_select_7772
SELECT id,
(SELECT min FROM stats) as min_val,
(SELECT max FROM stats) as max_val,
(SELECT avg FROM stats) as avg_val
FROM data
ORDER BY id;

DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, price FLOAT64);
DROP TABLE IF EXISTS config;
CREATE TABLE config (tax_rate FLOAT64);
INSERT INTO items VALUES (1, 100.0), (2, 200.0);
INSERT INTO config VALUES (0.1);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
DROP TABLE IF EXISTS thresholds;
CREATE TABLE thresholds (expensive_threshold FLOAT64);
INSERT INTO products VALUES (1, 50.0), (2, 150.0);
INSERT INTO thresholds VALUES (100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (value INT64);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (multiplier INT64);
INSERT INTO data VALUES (1);
INSERT INTO level1 VALUES (10);
INSERT INTO level2 VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS values;
CREATE TABLE values (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO values VALUES (10), (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS dual_cols;
CREATE TABLE dual_cols (a INT64, b INT64);
INSERT INTO data VALUES (1);
INSERT INTO dual_cols VALUES (10, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
INSERT INTO orders VALUES (1, 100, 50.0), (2, 100, 75.0), (3, 200, 60.0);
INSERT INTO customers VALUES (100, 'Alice'), (200, 'Bob');
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary FLOAT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 1, 50000.0),
(2, 1, 60000.0),
(3, 2, 55000.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category INT64, price FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS stats;
CREATE TABLE stats (min INT64, max INT64, avg FLOAT64);
INSERT INTO data VALUES (1), (2), (3);
INSERT INTO stats VALUES (1, 100, 50.5);

-- Tag: window_functions_window_functions_operators_test_select_7773
SELECT id, price, price * (1 + (SELECT tax_rate FROM config)) as total
FROM items
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7774
SELECT id,
CASE
WHEN price > (SELECT expensive_threshold FROM thresholds) THEN 'Expensive'
ELSE 'Affordable'
END as category
FROM products
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7775
SELECT id,
(SELECT value * (SELECT multiplier FROM level2) FROM level1) as result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7776
SELECT id, (SELECT value FROM values) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7777
SELECT id, (SELECT a, b FROM dual_cols) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7778
SELECT id, (SELECT undefined_col FROM data) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7779
SELECT c.name, o.amount,
(SELECT AVG(amount) FROM orders) as overall_avg
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY c.name, o.amount;
-- Tag: window_functions_window_functions_operators_test_select_7780
SELECT d.name,
(SELECT MAX(e.salary) FROM employees e WHERE e.dept_id = d.id) as max_salary
FROM departments d
ORDER BY d.name;
-- Tag: window_functions_window_functions_operators_test_select_7781
SELECT i1.id, i1.price,
(SELECT AVG(i2.price) FROM items i2 WHERE i2.category = i1.category) as category_avg
FROM items i1
WHERE i1.id < 10
ORDER BY i1.id;
-- Tag: window_functions_window_functions_operators_test_select_7782
SELECT id,
(SELECT min FROM stats) as min_val,
(SELECT max FROM stats) as max_val,
(SELECT avg FROM stats) as avg_val
FROM data
ORDER BY id;

DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, price FLOAT64);
DROP TABLE IF EXISTS thresholds;
CREATE TABLE thresholds (expensive_threshold FLOAT64);
INSERT INTO products VALUES (1, 50.0), (2, 150.0);
INSERT INTO thresholds VALUES (100.0);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS level1;
CREATE TABLE level1 (value INT64);
DROP TABLE IF EXISTS level2;
CREATE TABLE level2 (multiplier INT64);
INSERT INTO data VALUES (1);
INSERT INTO level1 VALUES (10);
INSERT INTO level2 VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS values;
CREATE TABLE values (value INT64);
INSERT INTO data VALUES (1);
INSERT INTO values VALUES (10), (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS dual_cols;
CREATE TABLE dual_cols (a INT64, b INT64);
INSERT INTO data VALUES (1);
INSERT INTO dual_cols VALUES (10, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
INSERT INTO orders VALUES (1, 100, 50.0), (2, 100, 75.0), (3, 200, 60.0);
INSERT INTO customers VALUES (100, 'Alice'), (200, 'Bob');
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary FLOAT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 1, 50000.0),
(2, 1, 60000.0),
(3, 2, 55000.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category INT64, price FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS stats;
CREATE TABLE stats (min INT64, max INT64, avg FLOAT64);
INSERT INTO data VALUES (1), (2), (3);
INSERT INTO stats VALUES (1, 100, 50.5);

-- Tag: window_functions_window_functions_operators_test_select_7783
SELECT id,
CASE
WHEN price > (SELECT expensive_threshold FROM thresholds) THEN 'Expensive'
ELSE 'Affordable'
END as category
FROM products
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7784
SELECT id,
(SELECT value * (SELECT multiplier FROM level2) FROM level1) as result
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7785
SELECT id, (SELECT value FROM values) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7786
SELECT id, (SELECT a, b FROM dual_cols) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7787
SELECT id, (SELECT undefined_col FROM data) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7788
SELECT c.name, o.amount,
(SELECT AVG(amount) FROM orders) as overall_avg
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY c.name, o.amount;
-- Tag: window_functions_window_functions_operators_test_select_7789
SELECT d.name,
(SELECT MAX(e.salary) FROM employees e WHERE e.dept_id = d.id) as max_salary
FROM departments d
ORDER BY d.name;
-- Tag: window_functions_window_functions_operators_test_select_7790
SELECT i1.id, i1.price,
(SELECT AVG(i2.price) FROM items i2 WHERE i2.category = i1.category) as category_avg
FROM items i1
WHERE i1.id < 10
ORDER BY i1.id;
-- Tag: window_functions_window_functions_operators_test_select_7791
SELECT id,
(SELECT min FROM stats) as min_val,
(SELECT max FROM stats) as max_val,
(SELECT avg FROM stats) as avg_val
FROM data
ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
DROP TABLE IF EXISTS customers;
CREATE TABLE customers (id INT64, name STRING);
INSERT INTO orders VALUES (1, 100, 50.0), (2, 100, 75.0), (3, 200, 60.0);
INSERT INTO customers VALUES (100, 'Alice'), (200, 'Bob');
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (id INT64, name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept_id INT64, salary FLOAT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 1, 50000.0),
(2, 1, 60000.0),
(3, 2, 55000.0);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, category INT64, price FLOAT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
DROP TABLE IF EXISTS stats;
CREATE TABLE stats (min INT64, max INT64, avg FLOAT64);
INSERT INTO data VALUES (1), (2), (3);
INSERT INTO stats VALUES (1, 100, 50.5);

-- Tag: window_functions_window_functions_operators_test_select_7792
SELECT id, (SELECT undefined_col FROM data) as val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_7793
SELECT c.name, o.amount,
(SELECT AVG(amount) FROM orders) as overall_avg
FROM customers c
JOIN orders o ON c.id = o.customer_id
ORDER BY c.name, o.amount;
-- Tag: window_functions_window_functions_operators_test_select_7794
SELECT d.name,
(SELECT MAX(e.salary) FROM employees e WHERE e.dept_id = d.id) as max_salary
FROM departments d
ORDER BY d.name;
-- Tag: window_functions_window_functions_operators_test_select_7795
SELECT i1.id, i1.price,
(SELECT AVG(i2.price) FROM items i2 WHERE i2.category = i1.category) as category_avg
FROM items i1
WHERE i1.id < 10
ORDER BY i1.id;
-- Tag: window_functions_window_functions_operators_test_select_7796
SELECT id,
(SELECT min FROM stats) as min_val,
(SELECT max FROM stats) as max_val,
(SELECT avg FROM stats) as avg_val
FROM data
ORDER BY id;

CREATE SEQUENCE seq_curr_err;
CREATE SEQUENCE seq_noadvance;
CREATE SEQUENCE seq_set;
CREATE SEQUENCE seq_setcall;
CREATE SEQUENCE seq_setmax MAXVALUE 100 NO CYCLE;
CREATE SEQUENCE seq_last;
CREATE SEQUENCE seq1;
CREATE SEQUENCE seq2 START WITH 100;
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING, PRIMARY KEY (id));
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
INSERT INTO items (name) VALUES ('Item3');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING, PRIMARY KEY (id));
INSERT INTO items (id, name) VALUES (10, 'Item10');
INSERT INTO items (name) VALUES ('Item11');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING, PRIMARY KEY (id));
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id SERIAL, name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id BIGSERIAL, name STRING);
INSERT INTO items (name) VALUES ('Item1');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id SERIAL, name STRING);
INSERT INTO items (name) VALUES ('Item1');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 IDENTITY(1, 1), name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 IDENTITY(100, 5), name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (id, name) VALUES (10, 'Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING);
INSERT INTO items (id, name) OVERRIDING SYSTEM VALUE VALUES (100, 'Item100');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 GENERATED BY DEFAULT AS IDENTITY, name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (id, name) VALUES (100, 'Item100');
INSERT INTO items (name) VALUES ('Item101');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 GENERATED BY DEFAULT AS IDENTITY (START WITH 1000 INCREMENT BY 10), name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
CREATE SEQUENCE seq_gap;
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (NEXTVAL('seq_gap'), 'Item1');
INSERT INTO items VALUES (NEXTVAL('seq_gap'), 'Item2');
CREATE SEQUENCE seq_a START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE seq_b START WITH 100 INCREMENT BY 10;
CREATE SEQUENCE seq_overflow START WITH 9223372036854775806 INCREMENT BY 1 NO CYCLE;
CREATE SEQUENCE seq_default;
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 DEFAULT NEXTVAL('seq_default'), name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');

-- Tag: window_functions_window_functions_operators_test_select_7797
SELECT CURRVAL('seq_curr_err');
-- Tag: window_functions_window_functions_operators_test_select_7798
SELECT NEXTVAL('seq_noadvance');
-- Tag: window_functions_window_functions_operators_test_select_7799
SELECT CURRVAL('seq_noadvance');
-- Tag: window_functions_window_functions_operators_test_select_7800
SELECT CURRVAL('seq_noadvance');
-- Tag: window_functions_window_functions_operators_test_select_7801
SELECT NEXTVAL('seq_noadvance') as val;
-- Tag: window_functions_window_functions_operators_test_select_7802
SELECT SETVAL('seq_set', 100);
-- Tag: window_functions_window_functions_operators_test_select_7803
SELECT NEXTVAL('seq_set') as val;
-- Tag: window_functions_window_functions_operators_test_select_7804
SELECT SETVAL('seq_setcall', 50, true);
-- Tag: window_functions_window_functions_operators_test_select_7805
SELECT NEXTVAL('seq_setcall') as val;
-- Tag: window_functions_window_functions_operators_test_select_7806
SELECT SETVAL('seq_setcall', 100, false);
-- Tag: window_functions_window_functions_operators_test_select_7807
SELECT NEXTVAL('seq_setcall') as val;
-- Tag: window_functions_window_functions_operators_test_select_7808
SELECT SETVAL('seq_setmax', 150);
-- Tag: window_functions_window_functions_operators_test_select_7809
SELECT NEXTVAL('seq_setmax');
-- Tag: window_functions_window_functions_operators_test_select_7810
SELECT NEXTVAL('seq_last');
-- Tag: window_functions_window_functions_operators_test_select_7811
SELECT LASTVAL() as val;
-- Tag: window_functions_window_functions_operators_test_select_7812
SELECT NEXTVAL('seq1');
-- Tag: window_functions_window_functions_operators_test_select_7813
SELECT NEXTVAL('seq2');
-- Tag: window_functions_window_functions_operators_test_select_7814
SELECT LASTVAL() as val;
-- Tag: window_functions_window_functions_operators_test_select_7815
SELECT LASTVAL();
-- Tag: window_functions_window_functions_operators_test_select_7816
SELECT id, name FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7817
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7818
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7819
SELECT id FROM items;
-- Tag: window_functions_window_functions_operators_test_select_7820
SELECT CURRVAL('items_id_seq');
-- Tag: window_functions_window_functions_operators_test_select_7821
SELECT CURRVAL('items_id_seq') as val;
-- Tag: window_functions_window_functions_operators_test_select_7822
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7823
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7824
SELECT id FROM items;
-- Tag: window_functions_window_functions_operators_test_select_7825
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7826
SELECT id FROM items ORDER BY id;
BEGIN;
ROLLBACK;
-- Tag: window_functions_window_functions_operators_test_select_7827
SELECT id FROM items;
-- Tag: window_functions_window_functions_operators_test_select_7828
SELECT NEXTVAL('seq_a') as a, NEXTVAL('seq_b') as b;
-- Tag: window_functions_window_functions_operators_test_select_7829
SELECT NEXTVAL('seq_overflow');
-- Tag: window_functions_window_functions_operators_test_select_7830
SELECT NEXTVAL('seq_overflow');
-- Tag: window_functions_window_functions_operators_test_select_7831
SELECT NEXTVAL('seq_overflow');
-- Tag: window_functions_window_functions_operators_test_select_7832
SELECT id FROM items ORDER BY id;

CREATE SEQUENCE seq_noadvance;
CREATE SEQUENCE seq_set;
CREATE SEQUENCE seq_setcall;
CREATE SEQUENCE seq_setmax MAXVALUE 100 NO CYCLE;
CREATE SEQUENCE seq_last;
CREATE SEQUENCE seq1;
CREATE SEQUENCE seq2 START WITH 100;
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING, PRIMARY KEY (id));
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
INSERT INTO items (name) VALUES ('Item3');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING, PRIMARY KEY (id));
INSERT INTO items (id, name) VALUES (10, 'Item10');
INSERT INTO items (name) VALUES ('Item11');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING, PRIMARY KEY (id));
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id SERIAL, name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id BIGSERIAL, name STRING);
INSERT INTO items (name) VALUES ('Item1');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id SERIAL, name STRING);
INSERT INTO items (name) VALUES ('Item1');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 IDENTITY(1, 1), name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 IDENTITY(100, 5), name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (id, name) VALUES (10, 'Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING);
INSERT INTO items (id, name) OVERRIDING SYSTEM VALUE VALUES (100, 'Item100');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 GENERATED BY DEFAULT AS IDENTITY, name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (id, name) VALUES (100, 'Item100');
INSERT INTO items (name) VALUES ('Item101');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 GENERATED BY DEFAULT AS IDENTITY (START WITH 1000 INCREMENT BY 10), name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
CREATE SEQUENCE seq_gap;
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (NEXTVAL('seq_gap'), 'Item1');
INSERT INTO items VALUES (NEXTVAL('seq_gap'), 'Item2');
CREATE SEQUENCE seq_a START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE seq_b START WITH 100 INCREMENT BY 10;
CREATE SEQUENCE seq_overflow START WITH 9223372036854775806 INCREMENT BY 1 NO CYCLE;
CREATE SEQUENCE seq_default;
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 DEFAULT NEXTVAL('seq_default'), name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');

-- Tag: window_functions_window_functions_operators_test_select_7833
SELECT NEXTVAL('seq_noadvance');
-- Tag: window_functions_window_functions_operators_test_select_7834
SELECT CURRVAL('seq_noadvance');
-- Tag: window_functions_window_functions_operators_test_select_7835
SELECT CURRVAL('seq_noadvance');
-- Tag: window_functions_window_functions_operators_test_select_7836
SELECT NEXTVAL('seq_noadvance') as val;
-- Tag: window_functions_window_functions_operators_test_select_7837
SELECT SETVAL('seq_set', 100);
-- Tag: window_functions_window_functions_operators_test_select_7838
SELECT NEXTVAL('seq_set') as val;
-- Tag: window_functions_window_functions_operators_test_select_7839
SELECT SETVAL('seq_setcall', 50, true);
-- Tag: window_functions_window_functions_operators_test_select_7840
SELECT NEXTVAL('seq_setcall') as val;
-- Tag: window_functions_window_functions_operators_test_select_7841
SELECT SETVAL('seq_setcall', 100, false);
-- Tag: window_functions_window_functions_operators_test_select_7842
SELECT NEXTVAL('seq_setcall') as val;
-- Tag: window_functions_window_functions_operators_test_select_7843
SELECT SETVAL('seq_setmax', 150);
-- Tag: window_functions_window_functions_operators_test_select_7844
SELECT NEXTVAL('seq_setmax');
-- Tag: window_functions_window_functions_operators_test_select_7845
SELECT NEXTVAL('seq_last');
-- Tag: window_functions_window_functions_operators_test_select_7846
SELECT LASTVAL() as val;
-- Tag: window_functions_window_functions_operators_test_select_7847
SELECT NEXTVAL('seq1');
-- Tag: window_functions_window_functions_operators_test_select_7848
SELECT NEXTVAL('seq2');
-- Tag: window_functions_window_functions_operators_test_select_7849
SELECT LASTVAL() as val;
-- Tag: window_functions_window_functions_operators_test_select_7850
SELECT LASTVAL();
-- Tag: window_functions_window_functions_operators_test_select_7851
SELECT id, name FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7852
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7853
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7854
SELECT id FROM items;
-- Tag: window_functions_window_functions_operators_test_select_7855
SELECT CURRVAL('items_id_seq');
-- Tag: window_functions_window_functions_operators_test_select_7856
SELECT CURRVAL('items_id_seq') as val;
-- Tag: window_functions_window_functions_operators_test_select_7857
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7858
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7859
SELECT id FROM items;
-- Tag: window_functions_window_functions_operators_test_select_7860
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7861
SELECT id FROM items ORDER BY id;
BEGIN;
ROLLBACK;
-- Tag: window_functions_window_functions_operators_test_select_7862
SELECT id FROM items;
-- Tag: window_functions_window_functions_operators_test_select_7863
SELECT NEXTVAL('seq_a') as a, NEXTVAL('seq_b') as b;
-- Tag: window_functions_window_functions_operators_test_select_7864
SELECT NEXTVAL('seq_overflow');
-- Tag: window_functions_window_functions_operators_test_select_7865
SELECT NEXTVAL('seq_overflow');
-- Tag: window_functions_window_functions_operators_test_select_7866
SELECT NEXTVAL('seq_overflow');
-- Tag: window_functions_window_functions_operators_test_select_7867
SELECT id FROM items ORDER BY id;

DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING, PRIMARY KEY (id));
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
INSERT INTO items (name) VALUES ('Item3');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING, PRIMARY KEY (id));
INSERT INTO items (id, name) VALUES (10, 'Item10');
INSERT INTO items (name) VALUES ('Item11');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING, PRIMARY KEY (id));
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id SERIAL, name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id BIGSERIAL, name STRING);
INSERT INTO items (name) VALUES ('Item1');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id SERIAL, name STRING);
INSERT INTO items (name) VALUES ('Item1');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 IDENTITY(1, 1), name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 IDENTITY(100, 5), name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (id, name) VALUES (10, 'Item2');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 , name STRING);
INSERT INTO items (id, name) OVERRIDING SYSTEM VALUE VALUES (100, 'Item100');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 GENERATED BY DEFAULT AS IDENTITY, name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (id, name) VALUES (100, 'Item100');
INSERT INTO items (name) VALUES ('Item101');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 GENERATED BY DEFAULT AS IDENTITY (START WITH 1000 INCREMENT BY 10), name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');
CREATE SEQUENCE seq_gap;
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (NEXTVAL('seq_gap'), 'Item1');
INSERT INTO items VALUES (NEXTVAL('seq_gap'), 'Item2');
CREATE SEQUENCE seq_a START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE seq_b START WITH 100 INCREMENT BY 10;
CREATE SEQUENCE seq_overflow START WITH 9223372036854775806 INCREMENT BY 1 NO CYCLE;
CREATE SEQUENCE seq_default;
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 DEFAULT NEXTVAL('seq_default'), name STRING);
INSERT INTO items (name) VALUES ('Item1');
INSERT INTO items (name) VALUES ('Item2');

-- Tag: window_functions_window_functions_operators_test_select_7868
SELECT LASTVAL();
-- Tag: window_functions_window_functions_operators_test_select_7869
SELECT id, name FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7870
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7871
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7872
SELECT id FROM items;
-- Tag: window_functions_window_functions_operators_test_select_7873
SELECT CURRVAL('items_id_seq');
-- Tag: window_functions_window_functions_operators_test_select_7874
SELECT CURRVAL('items_id_seq') as val;
-- Tag: window_functions_window_functions_operators_test_select_7875
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7876
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7877
SELECT id FROM items;
-- Tag: window_functions_window_functions_operators_test_select_7878
SELECT id FROM items ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7879
SELECT id FROM items ORDER BY id;
BEGIN;
ROLLBACK;
-- Tag: window_functions_window_functions_operators_test_select_7880
SELECT id FROM items;
-- Tag: window_functions_window_functions_operators_test_select_7881
SELECT NEXTVAL('seq_a') as a, NEXTVAL('seq_b') as b;
-- Tag: window_functions_window_functions_operators_test_select_7882
SELECT NEXTVAL('seq_overflow');
-- Tag: window_functions_window_functions_operators_test_select_7883
SELECT NEXTVAL('seq_overflow');
-- Tag: window_functions_window_functions_operators_test_select_7884
SELECT NEXTVAL('seq_overflow');
-- Tag: window_functions_window_functions_operators_test_select_7885
SELECT id FROM items ORDER BY id;

DROP TABLE IF EXISTS user_permissions;
CREATE TABLE user_permissions ( user_id INT64, role STRING, permissions INT64 );
INSERT INTO user_permissions VALUES
(1, 'admin', 15),  -- All permissions
(2, 'admin', 15),  -- All permissions
(3, 'editor', 7),  -- READ|WRITE|EXECUTE
(4, 'editor', 3),  -- READ|WRITE
(5, 'viewer', 1),  -- READ only
(6, 'viewer', 1),  -- READ only
(7, 'viewer', NULL) -- NULL permissions (disabled account);
DROP TABLE IF EXISTS server_health_log;
CREATE TABLE server_health_log ( timestamp INT64, server_id INT64, is_healthy BOOL, is_reachable BOOL );
INSERT INTO server_health_log VALUES
(1, 101, true, true),
(2, 101, true, true),
(3, 101, false, true), -- Unhealthy but reachable
(4, 102, true, true),
(5, 102, true, false), -- Healthy but unreachable
(6, 102, true, true),
(7, 103, NULL, true),  -- Health status unknown
(8, 103, true, NULL)  -- Reachability unknown;
DROP TABLE IF EXISTS events;
CREATE TABLE events ( category STRING, event_name STRING, severity INT64 );
INSERT INTO events VALUES
('security', 'login_attempt', 1),
('security', 'permission_denied', 2),
('security', 'data_breach', 5),
('performance', 'slow_query', 2),
('performance', 'timeout', 3),
('error', 'null_pointer', 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( id INT64, flag1 BOOL, flag2 BOOL, flag3 BOOL );
INSERT INTO test VALUES
(1, true, NULL, false),  -- TRUE AND NULL = NULL
(2, false, NULL, true),  -- FALSE AND NULL = FALSE (short-circuit)
(3, true, NULL, true),  -- TRUE OR NULL = TRUE (short-circuit)
(4, NULL, false, true),  -- NULL OR FALSE = NULL
(5, NULL, true, false)  -- NULL OR TRUE = TRUE (short-circuit);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( group_id INT64, value INT64 );
INSERT INTO test VALUES (1, 7), (1, 3), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( category STRING, flag BOOL );
INSERT INTO test VALUES
('A', NULL),
('A', NULL),
('B', true),
('B', NULL);
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64, name STRING, manager_id INT64 );
INSERT INTO users VALUES
(1, 'Alice', NULL),  -- Top-level manager
(2, 'Bob', 1),
(3, 'Charlie', 1),
(4, 'David', 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('hello');
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( region STRING, product STRING, revenue INT64 );
INSERT INTO sales VALUES
('North', 'Widget', 1000),
('North', 'Gadget', 500),
('South', 'Widget', 2000),
('South', 'Gadget', 3000);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( group_id INT64, permissions INT64, is_active BOOL );
INSERT INTO test VALUES
(1, 15, true),
(1, 7, true),
(1, 3, false),
(2, 1, true),
(2, 1, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( val1 INT64, val2 INT64, val3 INT64 );
INSERT INTO test VALUES
(NULL, NULL, 100),
(NULL, 200, 100),
(300, 200, 100);

-- Tag: window_functions_window_functions_operators_test_select_7886
SELECT role, BIT_AND(NVL(permissions, 0)) as common_perms
FROM user_permissions
GROUP BY role
HAVING (BIT_AND(NVL(permissions, 0)) & 1) = 1
ORDER BY role;
-- Tag: window_functions_window_functions_operators_test_select_075
SELECT
server_id,
BOOL_AND(is_healthy) as all_healthy,
BOOL_OR(is_reachable) as ever_reachable,
COUNT(*) as sample_count,
FROM server_health_log
GROUP BY server_id
ORDER BY server_id;
-- Tag: window_functions_window_functions_operators_test_select_076
SELECT
TRANSLATE(category, '_', ' ') as clean_category,
JSON_AGG(event_name) as events,
AVG(severity) as avg_severity
FROM events
GROUP BY category
HAVING AVG(severity) >= 2
ORDER BY avg_severity DESC;
-- Tag: window_functions_window_functions_operators_test_select_7887
SELECT id FROM test WHERE flag1 AND flag2 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7888
SELECT id FROM test WHERE flag1 OR flag3 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7889
SELECT group_id, BIT_AND(value) as bit_and_result
FROM test
WHERE group_id <= 5
GROUP BY group_id
ORDER BY group_id;
-- Tag: window_functions_window_functions_operators_test_select_7890
SELECT category, BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_077
SELECT
u1.name as employee,
(SELECT name FROM users WHERE id = u1.manager_id),
'CEO') as reports_to
FROM users u1
ORDER BY u1.id;
-- Tag: window_functions_window_functions_operators_test_select_7891
SELECT BIT_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7892
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7893
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7894
SELECT region, product
FROM sales
GROUP BY region, product
HAVING SUM(revenue) > 1000
ORDER BY region, product;
-- Tag: window_functions_window_functions_operators_test_select_7895
SELECT group_id, COUNT(*) as member_count
FROM test
GROUP BY group_id
HAVING (BIT_AND(permissions) & 1) = 1
AND BOOL_OR(is_active) = true
AND BOOL_AND(is_active) = false
ORDER BY group_id;
-- Tag: window_functions_window_functions_operators_test_select_7896
SELECT value, NVL(value, value) as nvl_result FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7897
SELECT NVL(val1, NVL(val2, val3)) as result FROM test ORDER BY result;

DROP TABLE IF EXISTS server_health_log;
CREATE TABLE server_health_log ( timestamp INT64, server_id INT64, is_healthy BOOL, is_reachable BOOL );
INSERT INTO server_health_log VALUES
(1, 101, true, true),
(2, 101, true, true),
(3, 101, false, true), -- Unhealthy but reachable
(4, 102, true, true),
(5, 102, true, false), -- Healthy but unreachable
(6, 102, true, true),
(7, 103, NULL, true),  -- Health status unknown
(8, 103, true, NULL)  -- Reachability unknown;
DROP TABLE IF EXISTS events;
CREATE TABLE events ( category STRING, event_name STRING, severity INT64 );
INSERT INTO events VALUES
('security', 'login_attempt', 1),
('security', 'permission_denied', 2),
('security', 'data_breach', 5),
('performance', 'slow_query', 2),
('performance', 'timeout', 3),
('error', 'null_pointer', 3);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( id INT64, flag1 BOOL, flag2 BOOL, flag3 BOOL );
INSERT INTO test VALUES
(1, true, NULL, false),  -- TRUE AND NULL = NULL
(2, false, NULL, true),  -- FALSE AND NULL = FALSE (short-circuit)
(3, true, NULL, true),  -- TRUE OR NULL = TRUE (short-circuit)
(4, NULL, false, true),  -- NULL OR FALSE = NULL
(5, NULL, true, false)  -- NULL OR TRUE = TRUE (short-circuit);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( group_id INT64, value INT64 );
INSERT INTO test VALUES (1, 7), (1, 3), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( category STRING, flag BOOL );
INSERT INTO test VALUES
('A', NULL),
('A', NULL),
('B', true),
('B', NULL);
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64, name STRING, manager_id INT64 );
INSERT INTO users VALUES
(1, 'Alice', NULL),  -- Top-level manager
(2, 'Bob', 1),
(3, 'Charlie', 1),
(4, 'David', 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('hello');
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( region STRING, product STRING, revenue INT64 );
INSERT INTO sales VALUES
('North', 'Widget', 1000),
('North', 'Gadget', 500),
('South', 'Widget', 2000),
('South', 'Gadget', 3000);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( group_id INT64, permissions INT64, is_active BOOL );
INSERT INTO test VALUES
(1, 15, true),
(1, 7, true),
(1, 3, false),
(2, 1, true),
(2, 1, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( val1 INT64, val2 INT64, val3 INT64 );
INSERT INTO test VALUES
(NULL, NULL, 100),
(NULL, 200, 100),
(300, 200, 100);

-- Tag: window_functions_window_functions_operators_test_select_078
SELECT
server_id,
BOOL_AND(is_healthy) as all_healthy,
BOOL_OR(is_reachable) as ever_reachable,
COUNT(*) as sample_count,
FROM server_health_log
GROUP BY server_id
ORDER BY server_id;
-- Tag: window_functions_window_functions_operators_test_select_079
SELECT
TRANSLATE(category, '_', ' ') as clean_category,
JSON_AGG(event_name) as events,
AVG(severity) as avg_severity
FROM events
GROUP BY category
HAVING AVG(severity) >= 2
ORDER BY avg_severity DESC;
-- Tag: window_functions_window_functions_operators_test_select_7898
SELECT id FROM test WHERE flag1 AND flag2 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7899
SELECT id FROM test WHERE flag1 OR flag3 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7900
SELECT group_id, BIT_AND(value) as bit_and_result
FROM test
WHERE group_id <= 5
GROUP BY group_id
ORDER BY group_id;
-- Tag: window_functions_window_functions_operators_test_select_7901
SELECT category, BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_080
SELECT
u1.name as employee,
(SELECT name FROM users WHERE id = u1.manager_id),
'CEO') as reports_to
FROM users u1
ORDER BY u1.id;
-- Tag: window_functions_window_functions_operators_test_select_7902
SELECT BIT_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7903
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7904
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7905
SELECT region, product
FROM sales
GROUP BY region, product
HAVING SUM(revenue) > 1000
ORDER BY region, product;
-- Tag: window_functions_window_functions_operators_test_select_7906
SELECT group_id, COUNT(*) as member_count
FROM test
GROUP BY group_id
HAVING (BIT_AND(permissions) & 1) = 1
AND BOOL_OR(is_active) = true
AND BOOL_AND(is_active) = false
ORDER BY group_id;
-- Tag: window_functions_window_functions_operators_test_select_7907
SELECT value, NVL(value, value) as nvl_result FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7908
SELECT NVL(val1, NVL(val2, val3)) as result FROM test ORDER BY result;

DROP TABLE IF EXISTS test;
CREATE TABLE test ( id INT64, flag1 BOOL, flag2 BOOL, flag3 BOOL );
INSERT INTO test VALUES
(1, true, NULL, false),  -- TRUE AND NULL = NULL
(2, false, NULL, true),  -- FALSE AND NULL = FALSE (short-circuit)
(3, true, NULL, true),  -- TRUE OR NULL = TRUE (short-circuit)
(4, NULL, false, true),  -- NULL OR FALSE = NULL
(5, NULL, true, false)  -- NULL OR TRUE = TRUE (short-circuit);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( group_id INT64, value INT64 );
INSERT INTO test VALUES (1, 7), (1, 3), (3, 15);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( category STRING, flag BOOL );
INSERT INTO test VALUES
('A', NULL),
('A', NULL),
('B', true),
('B', NULL);
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64, name STRING, manager_id INT64 );
INSERT INTO users VALUES
(1, 'Alice', NULL),  -- Top-level manager
(2, 'Bob', 1),
(3, 'Charlie', 1),
(4, 'David', 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('hello');
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( region STRING, product STRING, revenue INT64 );
INSERT INTO sales VALUES
('North', 'Widget', 1000),
('North', 'Gadget', 500),
('South', 'Widget', 2000),
('South', 'Gadget', 3000);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( group_id INT64, permissions INT64, is_active BOOL );
INSERT INTO test VALUES
(1, 15, true),
(1, 7, true),
(1, 3, false),
(2, 1, true),
(2, 1, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( val1 INT64, val2 INT64, val3 INT64 );
INSERT INTO test VALUES
(NULL, NULL, 100),
(NULL, 200, 100),
(300, 200, 100);

-- Tag: window_functions_window_functions_operators_test_select_7909
SELECT id FROM test WHERE flag1 AND flag2 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7910
SELECT id FROM test WHERE flag1 OR flag3 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_7911
SELECT group_id, BIT_AND(value) as bit_and_result
FROM test
WHERE group_id <= 5
GROUP BY group_id
ORDER BY group_id;
-- Tag: window_functions_window_functions_operators_test_select_7912
SELECT category, BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_081
SELECT
u1.name as employee,
(SELECT name FROM users WHERE id = u1.manager_id),
'CEO') as reports_to
FROM users u1
ORDER BY u1.id;
-- Tag: window_functions_window_functions_operators_test_select_7913
SELECT BIT_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7914
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7915
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7916
SELECT region, product
FROM sales
GROUP BY region, product
HAVING SUM(revenue) > 1000
ORDER BY region, product;
-- Tag: window_functions_window_functions_operators_test_select_7917
SELECT group_id, COUNT(*) as member_count
FROM test
GROUP BY group_id
HAVING (BIT_AND(permissions) & 1) = 1
AND BOOL_OR(is_active) = true
AND BOOL_AND(is_active) = false
ORDER BY group_id;
-- Tag: window_functions_window_functions_operators_test_select_7918
SELECT value, NVL(value, value) as nvl_result FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7919
SELECT NVL(val1, NVL(val2, val3)) as result FROM test ORDER BY result;

DROP TABLE IF EXISTS test;
CREATE TABLE test ( category STRING, flag BOOL );
INSERT INTO test VALUES
('A', NULL),
('A', NULL),
('B', true),
('B', NULL);
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64, name STRING, manager_id INT64 );
INSERT INTO users VALUES
(1, 'Alice', NULL),  -- Top-level manager
(2, 'Bob', 1),
(3, 'Charlie', 1),
(4, 'David', 2);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value STRING);
INSERT INTO test VALUES ('hello');
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales ( region STRING, product STRING, revenue INT64 );
INSERT INTO sales VALUES
('North', 'Widget', 1000),
('North', 'Gadget', 500),
('South', 'Widget', 2000),
('South', 'Gadget', 3000);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( group_id INT64, permissions INT64, is_active BOOL );
INSERT INTO test VALUES
(1, 15, true),
(1, 7, true),
(1, 3, false),
(2, 1, true),
(2, 1, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (value INT64);
INSERT INTO test VALUES (42), (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test ( val1 INT64, val2 INT64, val3 INT64 );
INSERT INTO test VALUES
(NULL, NULL, 100),
(NULL, 200, 100),
(300, 200, 100);

-- Tag: window_functions_window_functions_operators_test_select_7920
SELECT category, BOOL_AND(flag) as all_true, BOOL_OR(flag) as any_true
FROM test
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_082
SELECT
u1.name as employee,
(SELECT name FROM users WHERE id = u1.manager_id),
'CEO') as reports_to
FROM users u1
ORDER BY u1.id;
-- Tag: window_functions_window_functions_operators_test_select_7921
SELECT BIT_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7922
SELECT BOOL_AND(value) FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7923
SELECT BIT_AND(value) as result FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7924
SELECT region, product
FROM sales
GROUP BY region, product
HAVING SUM(revenue) > 1000
ORDER BY region, product;
-- Tag: window_functions_window_functions_operators_test_select_7925
SELECT group_id, COUNT(*) as member_count
FROM test
GROUP BY group_id
HAVING (BIT_AND(permissions) & 1) = 1
AND BOOL_OR(is_active) = true
AND BOOL_AND(is_active) = false
ORDER BY group_id;
-- Tag: window_functions_window_functions_operators_test_select_7926
SELECT value, NVL(value, value) as nvl_result FROM test ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_7927
SELECT NVL(val1, NVL(val2, val3)) as result FROM test ORDER BY result;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, x FLOAT64, y FLOAT64);
INSERT INTO test VALUES (1, 1.0, 2.0), (2, 2.0, 4.0), (3, 3.0, 6.0), (4, 4.0, 8.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, x FLOAT64, y FLOAT64);
INSERT INTO test VALUES (1, 1.0, 8.0), (2, 2.0, 6.0), (3, 3.0, 4.0), (4, 4.0, 2.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, x FLOAT64, y FLOAT64);
INSERT INTO test VALUES (1, 1.0, 3.0), (2, 2.0, 1.0), (3, 3.0, 4.0), (4, 4.0, 2.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, x FLOAT64, y FLOAT64);
INSERT INTO test VALUES (1, 1.0, 2.0), (2, 2.0, 4.0), (3, 3.0, 6.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, x FLOAT64, y FLOAT64);
INSERT INTO test VALUES (1, 1.0, 2.0), (2, 2.0, 4.0), (3, 3.0, 6.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 2.0), (3, 'A', 3.0), (4, 'B', 10.0), (5, 'B', 20.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 5.0), (3, 'A', 9.0), (4, 'B', 2.0), (5, 'B', 4.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
INSERT INTO test VALUES (1, 5.0), (2, 5.0), (3, 5.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 2.0), (3, 'A', 3.0), (4, 'B', 10.0), (5, 'B', 10.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 2.0), (3, 'B', 10.0);

-- Tag: window_functions_window_functions_operators_test_select_7928
SELECT CORR(x, y) AS correlation FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7929
SELECT CORR(x, y) AS correlation FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7930
SELECT CORR(x, y) AS correlation FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7931
SELECT COVAR_POP(x, y) AS covariance FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7932
SELECT COVAR_SAMP(x, y) AS covariance FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7933
SELECT category, STDDEV(value) AS stddev FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_7934
SELECT category, MEDIAN(value) AS median FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_7935
SELECT STDDEV(value) AS stddev FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7936
SELECT STDDEV(value) AS stddev, MEDIAN(value) AS median FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7937
SELECT category FROM test GROUP BY category HAVING STDDEV(value) > 0.5;
-- Tag: window_functions_window_functions_operators_test_select_7938
SELECT id, value, STDDEV(value) OVER (PARTITION BY category) AS category_stddev FROM test ORDER BY id;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, x FLOAT64, y FLOAT64);
INSERT INTO test VALUES (1, 1.0, 8.0), (2, 2.0, 6.0), (3, 3.0, 4.0), (4, 4.0, 2.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, x FLOAT64, y FLOAT64);
INSERT INTO test VALUES (1, 1.0, 3.0), (2, 2.0, 1.0), (3, 3.0, 4.0), (4, 4.0, 2.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, x FLOAT64, y FLOAT64);
INSERT INTO test VALUES (1, 1.0, 2.0), (2, 2.0, 4.0), (3, 3.0, 6.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, x FLOAT64, y FLOAT64);
INSERT INTO test VALUES (1, 1.0, 2.0), (2, 2.0, 4.0), (3, 3.0, 6.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 2.0), (3, 'A', 3.0), (4, 'B', 10.0), (5, 'B', 20.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 5.0), (3, 'A', 9.0), (4, 'B', 2.0), (5, 'B', 4.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
INSERT INTO test VALUES (1, 5.0), (2, 5.0), (3, 5.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 2.0), (3, 'A', 3.0), (4, 'B', 10.0), (5, 'B', 10.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 2.0), (3, 'B', 10.0);

-- Tag: window_functions_window_functions_operators_test_select_7939
SELECT CORR(x, y) AS correlation FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7940
SELECT CORR(x, y) AS correlation FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7941
SELECT COVAR_POP(x, y) AS covariance FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7942
SELECT COVAR_SAMP(x, y) AS covariance FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7943
SELECT category, STDDEV(value) AS stddev FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_7944
SELECT category, MEDIAN(value) AS median FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_7945
SELECT STDDEV(value) AS stddev FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7946
SELECT STDDEV(value) AS stddev, MEDIAN(value) AS median FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7947
SELECT category FROM test GROUP BY category HAVING STDDEV(value) > 0.5;
-- Tag: window_functions_window_functions_operators_test_select_7948
SELECT id, value, STDDEV(value) OVER (PARTITION BY category) AS category_stddev FROM test ORDER BY id;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, x FLOAT64, y FLOAT64);
INSERT INTO test VALUES (1, 1.0, 3.0), (2, 2.0, 1.0), (3, 3.0, 4.0), (4, 4.0, 2.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, x FLOAT64, y FLOAT64);
INSERT INTO test VALUES (1, 1.0, 2.0), (2, 2.0, 4.0), (3, 3.0, 6.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, x FLOAT64, y FLOAT64);
INSERT INTO test VALUES (1, 1.0, 2.0), (2, 2.0, 4.0), (3, 3.0, 6.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 2.0), (3, 'A', 3.0), (4, 'B', 10.0), (5, 'B', 20.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 5.0), (3, 'A', 9.0), (4, 'B', 2.0), (5, 'B', 4.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
INSERT INTO test VALUES (1, 5.0), (2, 5.0), (3, 5.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 2.0), (3, 'A', 3.0), (4, 'B', 10.0), (5, 'B', 10.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 2.0), (3, 'B', 10.0);

-- Tag: window_functions_window_functions_operators_test_select_7949
SELECT CORR(x, y) AS correlation FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7950
SELECT COVAR_POP(x, y) AS covariance FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7951
SELECT COVAR_SAMP(x, y) AS covariance FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7952
SELECT category, STDDEV(value) AS stddev FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_7953
SELECT category, MEDIAN(value) AS median FROM test GROUP BY category ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_7954
SELECT STDDEV(value) AS stddev FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7955
SELECT STDDEV(value) AS stddev, MEDIAN(value) AS median FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7956
SELECT category FROM test GROUP BY category HAVING STDDEV(value) > 0.5;
-- Tag: window_functions_window_functions_operators_test_select_7957
SELECT id, value, STDDEV(value) OVER (PARTITION BY category) AS category_stddev FROM test ORDER BY id;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 2.0), (3, 'A', 3.0), (4, 'B', 10.0), (5, 'B', 10.0);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, category STRING, value FLOAT64);
INSERT INTO test VALUES (1, 'A', 1.0), (2, 'A', 2.0), (3, 'B', 10.0);

-- Tag: window_functions_window_functions_operators_test_select_7958
SELECT STDDEV(value) AS stddev, MEDIAN(value) AS median FROM test;
-- Tag: window_functions_window_functions_operators_test_select_7959
SELECT category FROM test GROUP BY category HAVING STDDEV(value) > 0.5;
-- Tag: window_functions_window_functions_operators_test_select_7960
SELECT id, value, STDDEV(value) OVER (PARTITION BY category) AS category_stddev FROM test ORDER BY id;

DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING NOT NULL);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING NOT NULL);
INSERT INTO users VALUES (1, NULL);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, code STRING NOT NULL);
INSERT INTO items VALUES (1, '');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 NOT NULL, name STRING NOT NULL, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (NULL, 'Gadget', 19.99);
INSERT INTO products VALUES (2, NULL, 29.99);
INSERT INTO products VALUES (3, 'Thing', NULL);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 NOT NULL);
INSERT INTO numbers VALUES (0);
DROP TABLE IF EXISTS counters;
CREATE TABLE counters (id INT64 PRIMARY KEY, count INT64 DEFAULT 0);
INSERT INTO counters (id) VALUES (1);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, status STRING DEFAULT 'active');
INSERT INTO users (id, name) VALUES (1, 'Alice');
DROP TABLE IF EXISTS settings;
CREATE TABLE settings (key STRING PRIMARY KEY, value STRING DEFAULT 'default');
INSERT INTO settings VALUES ('key1', 'custom');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64 PRIMARY KEY, message STRING, error STRING DEFAULT NULL);
INSERT INTO logs (id, message) VALUES (1, 'Info');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, name STRING, discount FLOAT64 DEFAULT 0.0);
INSERT INTO products (id, name) VALUES (1, 'Widget');
DROP TABLE IF EXISTS features;
CREATE TABLE features (id INT64 PRIMARY KEY, name STRING, enabled BOOL DEFAULT true);
INSERT INTO features (id, name) VALUES (1, 'Feature A');
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64 PRIMARY KEY, status STRING DEFAULT 'pending', priority INT64 DEFAULT 1, archived BOOL DEFAULT false);
INSERT INTO records (id) VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64 PRIMARY KEY, name STRING, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
INSERT INTO events (id, name) VALUES (1, 'Event A');
DROP TABLE IF EXISTS daily_logs;
CREATE TABLE daily_logs (id INT64 PRIMARY KEY, message STRING, log_date DATE DEFAULT CURRENT_DATE);
INSERT INTO daily_logs (id, message) VALUES (1, 'Log entry');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING);
INSERT INTO users VALUES (1, 'alice@example.com', 'Alice');
INSERT INTO users VALUES (2, 'bob@example.com', 'Bob');
INSERT INTO users VALUES (3, 'alice@example.com', 'Alice2');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, NULL);
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (3, NULL);
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, username STRING UNIQUE);
INSERT INTO accounts VALUES (1, 'alice');
INSERT INTO accounts VALUES (2, 'ALICE');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, '');
INSERT INTO items VALUES (2, '');
DROP TABLE IF EXISTS reservations;
CREATE TABLE reservations (id INT64 PRIMARY KEY, room_number INT64, date DATE, UNIQUE (room_number, date));
INSERT INTO reservations VALUES (1, 101, DATE '2024-01-15');
INSERT INTO reservations VALUES (2, 101, DATE '2024-01-16');
INSERT INTO reservations VALUES (3, 102, DATE '2024-01-15');
INSERT INTO reservations VALUES (4, 101, DATE '2024-01-15');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, username STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com', 'alice123');
INSERT INTO users VALUES (2, 'alice@example.com', 'bob456');
INSERT INTO users VALUES (3, 'carol@example.com', 'alice123');
INSERT INTO users VALUES (4, 'dave@example.com', 'dave789');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, 9.99);
INSERT INTO products VALUES (2, 0);
INSERT INTO products VALUES (3, -5.00);
DROP TABLE IF EXISTS ratings;
CREATE TABLE ratings (id INT64 PRIMARY KEY, score INT64 CHECK (score >= 1 AND score <= 5));
INSERT INTO ratings VALUES (1, 1);
INSERT INTO ratings VALUES (2, 3);
INSERT INTO ratings VALUES (3, 5);
INSERT INTO ratings VALUES (4, 0);
INSERT INTO ratings VALUES (5, 6);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, username STRING CHECK (LENGTH(username) >= 3));
INSERT INTO users VALUES (1, 'alice');
INSERT INTO users VALUES (2, 'ab');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64 PRIMARY KEY, quantity INT64, discount FLOAT64, CHECK (quantity > 0 AND discount >= 0 AND discount <= 1.0));
INSERT INTO orders VALUES (1, 5, 0.1);
INSERT INTO orders VALUES (2, 0, 0.5);
INSERT INTO orders VALUES (3, 10, -0.1);
INSERT INTO orders VALUES (4, 10, 1.5);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (NULL, 'bob@example.com');
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (1, 'charlie@example.com');
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL, username STRING NOT NULL);
INSERT INTO accounts VALUES (1, 'alice@example.com', 'alice');
INSERT INTO accounts VALUES (2, 'alice@example.com', 'bob');
INSERT INTO accounts VALUES (3, NULL, 'charlie');
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64 PRIMARY KEY, sku STRING UNIQUE NOT NULL, name STRING NOT NULL, price FLOAT64 DEFAULT 0.0 CHECK (price >= 0), stock INT64 DEFAULT 0 CHECK (stock >= 0) );
INSERT INTO products VALUES (1, 'SKU001', 'Widget', 9.99, 100);
INSERT INTO products (id, sku, name) VALUES (2, 'SKU002', 'Gadget');
INSERT INTO products (id, sku, name) VALUES (1, 'SKU003', 'Test');
INSERT INTO products VALUES (3, 'SKU001', 'Test', 5.0, 10);
INSERT INTO products VALUES (4, 'SKU004', 'Test', -5.0, 10);
INSERT INTO products VALUES (5, 'SKU005', NULL, 5.0, 10);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com'), (2, 'bob@example.com'), (3, 'charlie@example.com');
INSERT INTO users VALUES (10, 'dave@example.com'), (10, 'eve@example.com');
INSERT INTO users VALUES (20, 'frank@example.com'), (21, 'frank@example.com');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 PRIMARY KEY);
INSERT INTO numbers VALUES (500);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, 'test@#$%^&*()');
INSERT INTO items VALUES (2, '');
INSERT INTO items VALUES (3, '');
INSERT INTO items VALUES (4, 'test@#$%^&*()');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value STRING NOT NULL UNIQUE);
INSERT INTO test VALUES (1, 'first');
INSERT INTO test VALUES (1, 'second');
INSERT INTO test VALUES (2, 'first');
INSERT INTO test VALUES (3, NULL);

-- Tag: window_functions_window_functions_operators_test_select_7961
SELECT * FROM users;
-- Tag: window_functions_window_functions_operators_test_select_7962
SELECT code FROM items;
-- Tag: window_functions_window_functions_operators_test_select_7963
SELECT value FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_7964
SELECT id, count FROM counters;
-- Tag: window_functions_window_functions_operators_test_select_7965
SELECT status FROM users;
-- Tag: window_functions_window_functions_operators_test_select_7966
SELECT value FROM settings WHERE key = 'key1';
-- Tag: window_functions_window_functions_operators_test_select_7967
SELECT error FROM logs;
-- Tag: window_functions_window_functions_operators_test_select_7968
SELECT discount FROM products;
-- Tag: window_functions_window_functions_operators_test_select_7969
SELECT enabled FROM features;
-- Tag: window_functions_window_functions_operators_test_select_7970
SELECT status, priority, archived FROM records;
-- Tag: window_functions_window_functions_operators_test_select_7971
SELECT created_at FROM events;
-- Tag: window_functions_window_functions_operators_test_select_7972
SELECT log_date FROM daily_logs;
-- Tag: window_functions_window_functions_operators_test_select_7973
SELECT * FROM users;
-- Tag: window_functions_window_functions_operators_test_select_7974
SELECT * FROM accounts;
-- Tag: window_functions_window_functions_operators_test_select_7975
SELECT price FROM products;
-- Tag: window_functions_window_functions_operators_test_select_7976
SELECT price, stock FROM products WHERE id = 2;
UPDATE users SET email = 'alice@example.com' WHERE id = 2;
UPDATE users SET email = NULL WHERE id = 1;
UPDATE users SET email = 'robert@example.com' WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_7977
SELECT COUNT(*) FROM numbers;

DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING NOT NULL);
INSERT INTO users VALUES (1, NULL);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, code STRING NOT NULL);
INSERT INTO items VALUES (1, '');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 NOT NULL, name STRING NOT NULL, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (NULL, 'Gadget', 19.99);
INSERT INTO products VALUES (2, NULL, 29.99);
INSERT INTO products VALUES (3, 'Thing', NULL);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 NOT NULL);
INSERT INTO numbers VALUES (0);
DROP TABLE IF EXISTS counters;
CREATE TABLE counters (id INT64 PRIMARY KEY, count INT64 DEFAULT 0);
INSERT INTO counters (id) VALUES (1);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, status STRING DEFAULT 'active');
INSERT INTO users (id, name) VALUES (1, 'Alice');
DROP TABLE IF EXISTS settings;
CREATE TABLE settings (key STRING PRIMARY KEY, value STRING DEFAULT 'default');
INSERT INTO settings VALUES ('key1', 'custom');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64 PRIMARY KEY, message STRING, error STRING DEFAULT NULL);
INSERT INTO logs (id, message) VALUES (1, 'Info');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, name STRING, discount FLOAT64 DEFAULT 0.0);
INSERT INTO products (id, name) VALUES (1, 'Widget');
DROP TABLE IF EXISTS features;
CREATE TABLE features (id INT64 PRIMARY KEY, name STRING, enabled BOOL DEFAULT true);
INSERT INTO features (id, name) VALUES (1, 'Feature A');
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64 PRIMARY KEY, status STRING DEFAULT 'pending', priority INT64 DEFAULT 1, archived BOOL DEFAULT false);
INSERT INTO records (id) VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64 PRIMARY KEY, name STRING, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
INSERT INTO events (id, name) VALUES (1, 'Event A');
DROP TABLE IF EXISTS daily_logs;
CREATE TABLE daily_logs (id INT64 PRIMARY KEY, message STRING, log_date DATE DEFAULT CURRENT_DATE);
INSERT INTO daily_logs (id, message) VALUES (1, 'Log entry');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING);
INSERT INTO users VALUES (1, 'alice@example.com', 'Alice');
INSERT INTO users VALUES (2, 'bob@example.com', 'Bob');
INSERT INTO users VALUES (3, 'alice@example.com', 'Alice2');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, NULL);
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (3, NULL);
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, username STRING UNIQUE);
INSERT INTO accounts VALUES (1, 'alice');
INSERT INTO accounts VALUES (2, 'ALICE');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, '');
INSERT INTO items VALUES (2, '');
DROP TABLE IF EXISTS reservations;
CREATE TABLE reservations (id INT64 PRIMARY KEY, room_number INT64, date DATE, UNIQUE (room_number, date));
INSERT INTO reservations VALUES (1, 101, DATE '2024-01-15');
INSERT INTO reservations VALUES (2, 101, DATE '2024-01-16');
INSERT INTO reservations VALUES (3, 102, DATE '2024-01-15');
INSERT INTO reservations VALUES (4, 101, DATE '2024-01-15');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, username STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com', 'alice123');
INSERT INTO users VALUES (2, 'alice@example.com', 'bob456');
INSERT INTO users VALUES (3, 'carol@example.com', 'alice123');
INSERT INTO users VALUES (4, 'dave@example.com', 'dave789');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, 9.99);
INSERT INTO products VALUES (2, 0);
INSERT INTO products VALUES (3, -5.00);
DROP TABLE IF EXISTS ratings;
CREATE TABLE ratings (id INT64 PRIMARY KEY, score INT64 CHECK (score >= 1 AND score <= 5));
INSERT INTO ratings VALUES (1, 1);
INSERT INTO ratings VALUES (2, 3);
INSERT INTO ratings VALUES (3, 5);
INSERT INTO ratings VALUES (4, 0);
INSERT INTO ratings VALUES (5, 6);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, username STRING CHECK (LENGTH(username) >= 3));
INSERT INTO users VALUES (1, 'alice');
INSERT INTO users VALUES (2, 'ab');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64 PRIMARY KEY, quantity INT64, discount FLOAT64, CHECK (quantity > 0 AND discount >= 0 AND discount <= 1.0));
INSERT INTO orders VALUES (1, 5, 0.1);
INSERT INTO orders VALUES (2, 0, 0.5);
INSERT INTO orders VALUES (3, 10, -0.1);
INSERT INTO orders VALUES (4, 10, 1.5);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (NULL, 'bob@example.com');
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (1, 'charlie@example.com');
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL, username STRING NOT NULL);
INSERT INTO accounts VALUES (1, 'alice@example.com', 'alice');
INSERT INTO accounts VALUES (2, 'alice@example.com', 'bob');
INSERT INTO accounts VALUES (3, NULL, 'charlie');
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64 PRIMARY KEY, sku STRING UNIQUE NOT NULL, name STRING NOT NULL, price FLOAT64 DEFAULT 0.0 CHECK (price >= 0), stock INT64 DEFAULT 0 CHECK (stock >= 0) );
INSERT INTO products VALUES (1, 'SKU001', 'Widget', 9.99, 100);
INSERT INTO products (id, sku, name) VALUES (2, 'SKU002', 'Gadget');
INSERT INTO products (id, sku, name) VALUES (1, 'SKU003', 'Test');
INSERT INTO products VALUES (3, 'SKU001', 'Test', 5.0, 10);
INSERT INTO products VALUES (4, 'SKU004', 'Test', -5.0, 10);
INSERT INTO products VALUES (5, 'SKU005', NULL, 5.0, 10);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com'), (2, 'bob@example.com'), (3, 'charlie@example.com');
INSERT INTO users VALUES (10, 'dave@example.com'), (10, 'eve@example.com');
INSERT INTO users VALUES (20, 'frank@example.com'), (21, 'frank@example.com');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 PRIMARY KEY);
INSERT INTO numbers VALUES (500);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, 'test@#$%^&*()');
INSERT INTO items VALUES (2, '');
INSERT INTO items VALUES (3, '');
INSERT INTO items VALUES (4, 'test@#$%^&*()');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value STRING NOT NULL UNIQUE);
INSERT INTO test VALUES (1, 'first');
INSERT INTO test VALUES (1, 'second');
INSERT INTO test VALUES (2, 'first');
INSERT INTO test VALUES (3, NULL);

-- Tag: window_functions_window_functions_operators_test_select_7978
SELECT code FROM items;
-- Tag: window_functions_window_functions_operators_test_select_7979
SELECT value FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_7980
SELECT id, count FROM counters;
-- Tag: window_functions_window_functions_operators_test_select_7981
SELECT status FROM users;
-- Tag: window_functions_window_functions_operators_test_select_7982
SELECT value FROM settings WHERE key = 'key1';
-- Tag: window_functions_window_functions_operators_test_select_7983
SELECT error FROM logs;
-- Tag: window_functions_window_functions_operators_test_select_7984
SELECT discount FROM products;
-- Tag: window_functions_window_functions_operators_test_select_7985
SELECT enabled FROM features;
-- Tag: window_functions_window_functions_operators_test_select_7986
SELECT status, priority, archived FROM records;
-- Tag: window_functions_window_functions_operators_test_select_7987
SELECT created_at FROM events;
-- Tag: window_functions_window_functions_operators_test_select_7988
SELECT log_date FROM daily_logs;
-- Tag: window_functions_window_functions_operators_test_select_7989
SELECT * FROM users;
-- Tag: window_functions_window_functions_operators_test_select_7990
SELECT * FROM accounts;
-- Tag: window_functions_window_functions_operators_test_select_7991
SELECT price FROM products;
-- Tag: window_functions_window_functions_operators_test_select_7992
SELECT price, stock FROM products WHERE id = 2;
UPDATE users SET email = 'alice@example.com' WHERE id = 2;
UPDATE users SET email = NULL WHERE id = 1;
UPDATE users SET email = 'robert@example.com' WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_7993
SELECT COUNT(*) FROM numbers;

DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, code STRING NOT NULL);
INSERT INTO items VALUES (1, '');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 NOT NULL, name STRING NOT NULL, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (NULL, 'Gadget', 19.99);
INSERT INTO products VALUES (2, NULL, 29.99);
INSERT INTO products VALUES (3, 'Thing', NULL);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 NOT NULL);
INSERT INTO numbers VALUES (0);
DROP TABLE IF EXISTS counters;
CREATE TABLE counters (id INT64 PRIMARY KEY, count INT64 DEFAULT 0);
INSERT INTO counters (id) VALUES (1);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, status STRING DEFAULT 'active');
INSERT INTO users (id, name) VALUES (1, 'Alice');
DROP TABLE IF EXISTS settings;
CREATE TABLE settings (key STRING PRIMARY KEY, value STRING DEFAULT 'default');
INSERT INTO settings VALUES ('key1', 'custom');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64 PRIMARY KEY, message STRING, error STRING DEFAULT NULL);
INSERT INTO logs (id, message) VALUES (1, 'Info');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, name STRING, discount FLOAT64 DEFAULT 0.0);
INSERT INTO products (id, name) VALUES (1, 'Widget');
DROP TABLE IF EXISTS features;
CREATE TABLE features (id INT64 PRIMARY KEY, name STRING, enabled BOOL DEFAULT true);
INSERT INTO features (id, name) VALUES (1, 'Feature A');
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64 PRIMARY KEY, status STRING DEFAULT 'pending', priority INT64 DEFAULT 1, archived BOOL DEFAULT false);
INSERT INTO records (id) VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64 PRIMARY KEY, name STRING, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
INSERT INTO events (id, name) VALUES (1, 'Event A');
DROP TABLE IF EXISTS daily_logs;
CREATE TABLE daily_logs (id INT64 PRIMARY KEY, message STRING, log_date DATE DEFAULT CURRENT_DATE);
INSERT INTO daily_logs (id, message) VALUES (1, 'Log entry');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING);
INSERT INTO users VALUES (1, 'alice@example.com', 'Alice');
INSERT INTO users VALUES (2, 'bob@example.com', 'Bob');
INSERT INTO users VALUES (3, 'alice@example.com', 'Alice2');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, NULL);
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (3, NULL);
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, username STRING UNIQUE);
INSERT INTO accounts VALUES (1, 'alice');
INSERT INTO accounts VALUES (2, 'ALICE');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, '');
INSERT INTO items VALUES (2, '');
DROP TABLE IF EXISTS reservations;
CREATE TABLE reservations (id INT64 PRIMARY KEY, room_number INT64, date DATE, UNIQUE (room_number, date));
INSERT INTO reservations VALUES (1, 101, DATE '2024-01-15');
INSERT INTO reservations VALUES (2, 101, DATE '2024-01-16');
INSERT INTO reservations VALUES (3, 102, DATE '2024-01-15');
INSERT INTO reservations VALUES (4, 101, DATE '2024-01-15');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, username STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com', 'alice123');
INSERT INTO users VALUES (2, 'alice@example.com', 'bob456');
INSERT INTO users VALUES (3, 'carol@example.com', 'alice123');
INSERT INTO users VALUES (4, 'dave@example.com', 'dave789');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, 9.99);
INSERT INTO products VALUES (2, 0);
INSERT INTO products VALUES (3, -5.00);
DROP TABLE IF EXISTS ratings;
CREATE TABLE ratings (id INT64 PRIMARY KEY, score INT64 CHECK (score >= 1 AND score <= 5));
INSERT INTO ratings VALUES (1, 1);
INSERT INTO ratings VALUES (2, 3);
INSERT INTO ratings VALUES (3, 5);
INSERT INTO ratings VALUES (4, 0);
INSERT INTO ratings VALUES (5, 6);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, username STRING CHECK (LENGTH(username) >= 3));
INSERT INTO users VALUES (1, 'alice');
INSERT INTO users VALUES (2, 'ab');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64 PRIMARY KEY, quantity INT64, discount FLOAT64, CHECK (quantity > 0 AND discount >= 0 AND discount <= 1.0));
INSERT INTO orders VALUES (1, 5, 0.1);
INSERT INTO orders VALUES (2, 0, 0.5);
INSERT INTO orders VALUES (3, 10, -0.1);
INSERT INTO orders VALUES (4, 10, 1.5);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (NULL, 'bob@example.com');
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (1, 'charlie@example.com');
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL, username STRING NOT NULL);
INSERT INTO accounts VALUES (1, 'alice@example.com', 'alice');
INSERT INTO accounts VALUES (2, 'alice@example.com', 'bob');
INSERT INTO accounts VALUES (3, NULL, 'charlie');
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64 PRIMARY KEY, sku STRING UNIQUE NOT NULL, name STRING NOT NULL, price FLOAT64 DEFAULT 0.0 CHECK (price >= 0), stock INT64 DEFAULT 0 CHECK (stock >= 0) );
INSERT INTO products VALUES (1, 'SKU001', 'Widget', 9.99, 100);
INSERT INTO products (id, sku, name) VALUES (2, 'SKU002', 'Gadget');
INSERT INTO products (id, sku, name) VALUES (1, 'SKU003', 'Test');
INSERT INTO products VALUES (3, 'SKU001', 'Test', 5.0, 10);
INSERT INTO products VALUES (4, 'SKU004', 'Test', -5.0, 10);
INSERT INTO products VALUES (5, 'SKU005', NULL, 5.0, 10);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com'), (2, 'bob@example.com'), (3, 'charlie@example.com');
INSERT INTO users VALUES (10, 'dave@example.com'), (10, 'eve@example.com');
INSERT INTO users VALUES (20, 'frank@example.com'), (21, 'frank@example.com');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 PRIMARY KEY);
INSERT INTO numbers VALUES (500);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, 'test@#$%^&*()');
INSERT INTO items VALUES (2, '');
INSERT INTO items VALUES (3, '');
INSERT INTO items VALUES (4, 'test@#$%^&*()');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value STRING NOT NULL UNIQUE);
INSERT INTO test VALUES (1, 'first');
INSERT INTO test VALUES (1, 'second');
INSERT INTO test VALUES (2, 'first');
INSERT INTO test VALUES (3, NULL);

-- Tag: window_functions_window_functions_operators_test_select_7994
SELECT code FROM items;
-- Tag: window_functions_window_functions_operators_test_select_7995
SELECT value FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_7996
SELECT id, count FROM counters;
-- Tag: window_functions_window_functions_operators_test_select_7997
SELECT status FROM users;
-- Tag: window_functions_window_functions_operators_test_select_7998
SELECT value FROM settings WHERE key = 'key1';
-- Tag: window_functions_window_functions_operators_test_select_7999
SELECT error FROM logs;
-- Tag: window_functions_window_functions_operators_test_select_8000
SELECT discount FROM products;
-- Tag: window_functions_window_functions_operators_test_select_8001
SELECT enabled FROM features;
-- Tag: window_functions_window_functions_operators_test_select_8002
SELECT status, priority, archived FROM records;
-- Tag: window_functions_window_functions_operators_test_select_8003
SELECT created_at FROM events;
-- Tag: window_functions_window_functions_operators_test_select_8004
SELECT log_date FROM daily_logs;
-- Tag: window_functions_window_functions_operators_test_select_8005
SELECT * FROM users;
-- Tag: window_functions_window_functions_operators_test_select_8006
SELECT * FROM accounts;
-- Tag: window_functions_window_functions_operators_test_select_8007
SELECT price FROM products;
-- Tag: window_functions_window_functions_operators_test_select_8008
SELECT price, stock FROM products WHERE id = 2;
UPDATE users SET email = 'alice@example.com' WHERE id = 2;
UPDATE users SET email = NULL WHERE id = 1;
UPDATE users SET email = 'robert@example.com' WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_8009
SELECT COUNT(*) FROM numbers;

DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 NOT NULL, name STRING NOT NULL, price FLOAT64);
INSERT INTO products VALUES (1, 'Widget', 9.99);
INSERT INTO products VALUES (NULL, 'Gadget', 19.99);
INSERT INTO products VALUES (2, NULL, 29.99);
INSERT INTO products VALUES (3, 'Thing', NULL);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 NOT NULL);
INSERT INTO numbers VALUES (0);
DROP TABLE IF EXISTS counters;
CREATE TABLE counters (id INT64 PRIMARY KEY, count INT64 DEFAULT 0);
INSERT INTO counters (id) VALUES (1);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, status STRING DEFAULT 'active');
INSERT INTO users (id, name) VALUES (1, 'Alice');
DROP TABLE IF EXISTS settings;
CREATE TABLE settings (key STRING PRIMARY KEY, value STRING DEFAULT 'default');
INSERT INTO settings VALUES ('key1', 'custom');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64 PRIMARY KEY, message STRING, error STRING DEFAULT NULL);
INSERT INTO logs (id, message) VALUES (1, 'Info');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, name STRING, discount FLOAT64 DEFAULT 0.0);
INSERT INTO products (id, name) VALUES (1, 'Widget');
DROP TABLE IF EXISTS features;
CREATE TABLE features (id INT64 PRIMARY KEY, name STRING, enabled BOOL DEFAULT true);
INSERT INTO features (id, name) VALUES (1, 'Feature A');
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64 PRIMARY KEY, status STRING DEFAULT 'pending', priority INT64 DEFAULT 1, archived BOOL DEFAULT false);
INSERT INTO records (id) VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64 PRIMARY KEY, name STRING, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
INSERT INTO events (id, name) VALUES (1, 'Event A');
DROP TABLE IF EXISTS daily_logs;
CREATE TABLE daily_logs (id INT64 PRIMARY KEY, message STRING, log_date DATE DEFAULT CURRENT_DATE);
INSERT INTO daily_logs (id, message) VALUES (1, 'Log entry');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING);
INSERT INTO users VALUES (1, 'alice@example.com', 'Alice');
INSERT INTO users VALUES (2, 'bob@example.com', 'Bob');
INSERT INTO users VALUES (3, 'alice@example.com', 'Alice2');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, NULL);
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (3, NULL);
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, username STRING UNIQUE);
INSERT INTO accounts VALUES (1, 'alice');
INSERT INTO accounts VALUES (2, 'ALICE');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, '');
INSERT INTO items VALUES (2, '');
DROP TABLE IF EXISTS reservations;
CREATE TABLE reservations (id INT64 PRIMARY KEY, room_number INT64, date DATE, UNIQUE (room_number, date));
INSERT INTO reservations VALUES (1, 101, DATE '2024-01-15');
INSERT INTO reservations VALUES (2, 101, DATE '2024-01-16');
INSERT INTO reservations VALUES (3, 102, DATE '2024-01-15');
INSERT INTO reservations VALUES (4, 101, DATE '2024-01-15');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, username STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com', 'alice123');
INSERT INTO users VALUES (2, 'alice@example.com', 'bob456');
INSERT INTO users VALUES (3, 'carol@example.com', 'alice123');
INSERT INTO users VALUES (4, 'dave@example.com', 'dave789');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, 9.99);
INSERT INTO products VALUES (2, 0);
INSERT INTO products VALUES (3, -5.00);
DROP TABLE IF EXISTS ratings;
CREATE TABLE ratings (id INT64 PRIMARY KEY, score INT64 CHECK (score >= 1 AND score <= 5));
INSERT INTO ratings VALUES (1, 1);
INSERT INTO ratings VALUES (2, 3);
INSERT INTO ratings VALUES (3, 5);
INSERT INTO ratings VALUES (4, 0);
INSERT INTO ratings VALUES (5, 6);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, username STRING CHECK (LENGTH(username) >= 3));
INSERT INTO users VALUES (1, 'alice');
INSERT INTO users VALUES (2, 'ab');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64 PRIMARY KEY, quantity INT64, discount FLOAT64, CHECK (quantity > 0 AND discount >= 0 AND discount <= 1.0));
INSERT INTO orders VALUES (1, 5, 0.1);
INSERT INTO orders VALUES (2, 0, 0.5);
INSERT INTO orders VALUES (3, 10, -0.1);
INSERT INTO orders VALUES (4, 10, 1.5);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (NULL, 'bob@example.com');
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (1, 'charlie@example.com');
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL, username STRING NOT NULL);
INSERT INTO accounts VALUES (1, 'alice@example.com', 'alice');
INSERT INTO accounts VALUES (2, 'alice@example.com', 'bob');
INSERT INTO accounts VALUES (3, NULL, 'charlie');
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64 PRIMARY KEY, sku STRING UNIQUE NOT NULL, name STRING NOT NULL, price FLOAT64 DEFAULT 0.0 CHECK (price >= 0), stock INT64 DEFAULT 0 CHECK (stock >= 0) );
INSERT INTO products VALUES (1, 'SKU001', 'Widget', 9.99, 100);
INSERT INTO products (id, sku, name) VALUES (2, 'SKU002', 'Gadget');
INSERT INTO products (id, sku, name) VALUES (1, 'SKU003', 'Test');
INSERT INTO products VALUES (3, 'SKU001', 'Test', 5.0, 10);
INSERT INTO products VALUES (4, 'SKU004', 'Test', -5.0, 10);
INSERT INTO products VALUES (5, 'SKU005', NULL, 5.0, 10);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com'), (2, 'bob@example.com'), (3, 'charlie@example.com');
INSERT INTO users VALUES (10, 'dave@example.com'), (10, 'eve@example.com');
INSERT INTO users VALUES (20, 'frank@example.com'), (21, 'frank@example.com');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 PRIMARY KEY);
INSERT INTO numbers VALUES (500);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, 'test@#$%^&*()');
INSERT INTO items VALUES (2, '');
INSERT INTO items VALUES (3, '');
INSERT INTO items VALUES (4, 'test@#$%^&*()');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value STRING NOT NULL UNIQUE);
INSERT INTO test VALUES (1, 'first');
INSERT INTO test VALUES (1, 'second');
INSERT INTO test VALUES (2, 'first');
INSERT INTO test VALUES (3, NULL);

-- Tag: window_functions_window_functions_operators_test_select_8010
SELECT value FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_8011
SELECT id, count FROM counters;
-- Tag: window_functions_window_functions_operators_test_select_8012
SELECT status FROM users;
-- Tag: window_functions_window_functions_operators_test_select_8013
SELECT value FROM settings WHERE key = 'key1';
-- Tag: window_functions_window_functions_operators_test_select_8014
SELECT error FROM logs;
-- Tag: window_functions_window_functions_operators_test_select_8015
SELECT discount FROM products;
-- Tag: window_functions_window_functions_operators_test_select_8016
SELECT enabled FROM features;
-- Tag: window_functions_window_functions_operators_test_select_8017
SELECT status, priority, archived FROM records;
-- Tag: window_functions_window_functions_operators_test_select_8018
SELECT created_at FROM events;
-- Tag: window_functions_window_functions_operators_test_select_8019
SELECT log_date FROM daily_logs;
-- Tag: window_functions_window_functions_operators_test_select_8020
SELECT * FROM users;
-- Tag: window_functions_window_functions_operators_test_select_8021
SELECT * FROM accounts;
-- Tag: window_functions_window_functions_operators_test_select_8022
SELECT price FROM products;
-- Tag: window_functions_window_functions_operators_test_select_8023
SELECT price, stock FROM products WHERE id = 2;
UPDATE users SET email = 'alice@example.com' WHERE id = 2;
UPDATE users SET email = NULL WHERE id = 1;
UPDATE users SET email = 'robert@example.com' WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_8024
SELECT COUNT(*) FROM numbers;

DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 NOT NULL);
INSERT INTO numbers VALUES (0);
DROP TABLE IF EXISTS counters;
CREATE TABLE counters (id INT64 PRIMARY KEY, count INT64 DEFAULT 0);
INSERT INTO counters (id) VALUES (1);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, status STRING DEFAULT 'active');
INSERT INTO users (id, name) VALUES (1, 'Alice');
DROP TABLE IF EXISTS settings;
CREATE TABLE settings (key STRING PRIMARY KEY, value STRING DEFAULT 'default');
INSERT INTO settings VALUES ('key1', 'custom');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64 PRIMARY KEY, message STRING, error STRING DEFAULT NULL);
INSERT INTO logs (id, message) VALUES (1, 'Info');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, name STRING, discount FLOAT64 DEFAULT 0.0);
INSERT INTO products (id, name) VALUES (1, 'Widget');
DROP TABLE IF EXISTS features;
CREATE TABLE features (id INT64 PRIMARY KEY, name STRING, enabled BOOL DEFAULT true);
INSERT INTO features (id, name) VALUES (1, 'Feature A');
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64 PRIMARY KEY, status STRING DEFAULT 'pending', priority INT64 DEFAULT 1, archived BOOL DEFAULT false);
INSERT INTO records (id) VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64 PRIMARY KEY, name STRING, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
INSERT INTO events (id, name) VALUES (1, 'Event A');
DROP TABLE IF EXISTS daily_logs;
CREATE TABLE daily_logs (id INT64 PRIMARY KEY, message STRING, log_date DATE DEFAULT CURRENT_DATE);
INSERT INTO daily_logs (id, message) VALUES (1, 'Log entry');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING);
INSERT INTO users VALUES (1, 'alice@example.com', 'Alice');
INSERT INTO users VALUES (2, 'bob@example.com', 'Bob');
INSERT INTO users VALUES (3, 'alice@example.com', 'Alice2');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, NULL);
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (3, NULL);
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, username STRING UNIQUE);
INSERT INTO accounts VALUES (1, 'alice');
INSERT INTO accounts VALUES (2, 'ALICE');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, '');
INSERT INTO items VALUES (2, '');
DROP TABLE IF EXISTS reservations;
CREATE TABLE reservations (id INT64 PRIMARY KEY, room_number INT64, date DATE, UNIQUE (room_number, date));
INSERT INTO reservations VALUES (1, 101, DATE '2024-01-15');
INSERT INTO reservations VALUES (2, 101, DATE '2024-01-16');
INSERT INTO reservations VALUES (3, 102, DATE '2024-01-15');
INSERT INTO reservations VALUES (4, 101, DATE '2024-01-15');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, username STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com', 'alice123');
INSERT INTO users VALUES (2, 'alice@example.com', 'bob456');
INSERT INTO users VALUES (3, 'carol@example.com', 'alice123');
INSERT INTO users VALUES (4, 'dave@example.com', 'dave789');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, 9.99);
INSERT INTO products VALUES (2, 0);
INSERT INTO products VALUES (3, -5.00);
DROP TABLE IF EXISTS ratings;
CREATE TABLE ratings (id INT64 PRIMARY KEY, score INT64 CHECK (score >= 1 AND score <= 5));
INSERT INTO ratings VALUES (1, 1);
INSERT INTO ratings VALUES (2, 3);
INSERT INTO ratings VALUES (3, 5);
INSERT INTO ratings VALUES (4, 0);
INSERT INTO ratings VALUES (5, 6);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, username STRING CHECK (LENGTH(username) >= 3));
INSERT INTO users VALUES (1, 'alice');
INSERT INTO users VALUES (2, 'ab');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64 PRIMARY KEY, quantity INT64, discount FLOAT64, CHECK (quantity > 0 AND discount >= 0 AND discount <= 1.0));
INSERT INTO orders VALUES (1, 5, 0.1);
INSERT INTO orders VALUES (2, 0, 0.5);
INSERT INTO orders VALUES (3, 10, -0.1);
INSERT INTO orders VALUES (4, 10, 1.5);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (NULL, 'bob@example.com');
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (1, 'charlie@example.com');
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL, username STRING NOT NULL);
INSERT INTO accounts VALUES (1, 'alice@example.com', 'alice');
INSERT INTO accounts VALUES (2, 'alice@example.com', 'bob');
INSERT INTO accounts VALUES (3, NULL, 'charlie');
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64 PRIMARY KEY, sku STRING UNIQUE NOT NULL, name STRING NOT NULL, price FLOAT64 DEFAULT 0.0 CHECK (price >= 0), stock INT64 DEFAULT 0 CHECK (stock >= 0) );
INSERT INTO products VALUES (1, 'SKU001', 'Widget', 9.99, 100);
INSERT INTO products (id, sku, name) VALUES (2, 'SKU002', 'Gadget');
INSERT INTO products (id, sku, name) VALUES (1, 'SKU003', 'Test');
INSERT INTO products VALUES (3, 'SKU001', 'Test', 5.0, 10);
INSERT INTO products VALUES (4, 'SKU004', 'Test', -5.0, 10);
INSERT INTO products VALUES (5, 'SKU005', NULL, 5.0, 10);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com'), (2, 'bob@example.com'), (3, 'charlie@example.com');
INSERT INTO users VALUES (10, 'dave@example.com'), (10, 'eve@example.com');
INSERT INTO users VALUES (20, 'frank@example.com'), (21, 'frank@example.com');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 PRIMARY KEY);
INSERT INTO numbers VALUES (500);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, 'test@#$%^&*()');
INSERT INTO items VALUES (2, '');
INSERT INTO items VALUES (3, '');
INSERT INTO items VALUES (4, 'test@#$%^&*()');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value STRING NOT NULL UNIQUE);
INSERT INTO test VALUES (1, 'first');
INSERT INTO test VALUES (1, 'second');
INSERT INTO test VALUES (2, 'first');
INSERT INTO test VALUES (3, NULL);

-- Tag: window_functions_window_functions_operators_test_select_8025
SELECT value FROM numbers;
-- Tag: window_functions_window_functions_operators_test_select_8026
SELECT id, count FROM counters;
-- Tag: window_functions_window_functions_operators_test_select_8027
SELECT status FROM users;
-- Tag: window_functions_window_functions_operators_test_select_8028
SELECT value FROM settings WHERE key = 'key1';
-- Tag: window_functions_window_functions_operators_test_select_8029
SELECT error FROM logs;
-- Tag: window_functions_window_functions_operators_test_select_8030
SELECT discount FROM products;
-- Tag: window_functions_window_functions_operators_test_select_8031
SELECT enabled FROM features;
-- Tag: window_functions_window_functions_operators_test_select_8032
SELECT status, priority, archived FROM records;
-- Tag: window_functions_window_functions_operators_test_select_8033
SELECT created_at FROM events;
-- Tag: window_functions_window_functions_operators_test_select_8034
SELECT log_date FROM daily_logs;
-- Tag: window_functions_window_functions_operators_test_select_8035
SELECT * FROM users;
-- Tag: window_functions_window_functions_operators_test_select_8036
SELECT * FROM accounts;
-- Tag: window_functions_window_functions_operators_test_select_8037
SELECT price FROM products;
-- Tag: window_functions_window_functions_operators_test_select_8038
SELECT price, stock FROM products WHERE id = 2;
UPDATE users SET email = 'alice@example.com' WHERE id = 2;
UPDATE users SET email = NULL WHERE id = 1;
UPDATE users SET email = 'robert@example.com' WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_8039
SELECT COUNT(*) FROM numbers;

DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64 PRIMARY KEY, message STRING, error STRING DEFAULT NULL);
INSERT INTO logs (id, message) VALUES (1, 'Info');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, name STRING, discount FLOAT64 DEFAULT 0.0);
INSERT INTO products (id, name) VALUES (1, 'Widget');
DROP TABLE IF EXISTS features;
CREATE TABLE features (id INT64 PRIMARY KEY, name STRING, enabled BOOL DEFAULT true);
INSERT INTO features (id, name) VALUES (1, 'Feature A');
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64 PRIMARY KEY, status STRING DEFAULT 'pending', priority INT64 DEFAULT 1, archived BOOL DEFAULT false);
INSERT INTO records (id) VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64 PRIMARY KEY, name STRING, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
INSERT INTO events (id, name) VALUES (1, 'Event A');
DROP TABLE IF EXISTS daily_logs;
CREATE TABLE daily_logs (id INT64 PRIMARY KEY, message STRING, log_date DATE DEFAULT CURRENT_DATE);
INSERT INTO daily_logs (id, message) VALUES (1, 'Log entry');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING);
INSERT INTO users VALUES (1, 'alice@example.com', 'Alice');
INSERT INTO users VALUES (2, 'bob@example.com', 'Bob');
INSERT INTO users VALUES (3, 'alice@example.com', 'Alice2');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, NULL);
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (3, NULL);
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, username STRING UNIQUE);
INSERT INTO accounts VALUES (1, 'alice');
INSERT INTO accounts VALUES (2, 'ALICE');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, '');
INSERT INTO items VALUES (2, '');
DROP TABLE IF EXISTS reservations;
CREATE TABLE reservations (id INT64 PRIMARY KEY, room_number INT64, date DATE, UNIQUE (room_number, date));
INSERT INTO reservations VALUES (1, 101, DATE '2024-01-15');
INSERT INTO reservations VALUES (2, 101, DATE '2024-01-16');
INSERT INTO reservations VALUES (3, 102, DATE '2024-01-15');
INSERT INTO reservations VALUES (4, 101, DATE '2024-01-15');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, username STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com', 'alice123');
INSERT INTO users VALUES (2, 'alice@example.com', 'bob456');
INSERT INTO users VALUES (3, 'carol@example.com', 'alice123');
INSERT INTO users VALUES (4, 'dave@example.com', 'dave789');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, 9.99);
INSERT INTO products VALUES (2, 0);
INSERT INTO products VALUES (3, -5.00);
DROP TABLE IF EXISTS ratings;
CREATE TABLE ratings (id INT64 PRIMARY KEY, score INT64 CHECK (score >= 1 AND score <= 5));
INSERT INTO ratings VALUES (1, 1);
INSERT INTO ratings VALUES (2, 3);
INSERT INTO ratings VALUES (3, 5);
INSERT INTO ratings VALUES (4, 0);
INSERT INTO ratings VALUES (5, 6);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, username STRING CHECK (LENGTH(username) >= 3));
INSERT INTO users VALUES (1, 'alice');
INSERT INTO users VALUES (2, 'ab');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64 PRIMARY KEY, quantity INT64, discount FLOAT64, CHECK (quantity > 0 AND discount >= 0 AND discount <= 1.0));
INSERT INTO orders VALUES (1, 5, 0.1);
INSERT INTO orders VALUES (2, 0, 0.5);
INSERT INTO orders VALUES (3, 10, -0.1);
INSERT INTO orders VALUES (4, 10, 1.5);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (NULL, 'bob@example.com');
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (1, 'charlie@example.com');
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL, username STRING NOT NULL);
INSERT INTO accounts VALUES (1, 'alice@example.com', 'alice');
INSERT INTO accounts VALUES (2, 'alice@example.com', 'bob');
INSERT INTO accounts VALUES (3, NULL, 'charlie');
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64 PRIMARY KEY, sku STRING UNIQUE NOT NULL, name STRING NOT NULL, price FLOAT64 DEFAULT 0.0 CHECK (price >= 0), stock INT64 DEFAULT 0 CHECK (stock >= 0) );
INSERT INTO products VALUES (1, 'SKU001', 'Widget', 9.99, 100);
INSERT INTO products (id, sku, name) VALUES (2, 'SKU002', 'Gadget');
INSERT INTO products (id, sku, name) VALUES (1, 'SKU003', 'Test');
INSERT INTO products VALUES (3, 'SKU001', 'Test', 5.0, 10);
INSERT INTO products VALUES (4, 'SKU004', 'Test', -5.0, 10);
INSERT INTO products VALUES (5, 'SKU005', NULL, 5.0, 10);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com'), (2, 'bob@example.com'), (3, 'charlie@example.com');
INSERT INTO users VALUES (10, 'dave@example.com'), (10, 'eve@example.com');
INSERT INTO users VALUES (20, 'frank@example.com'), (21, 'frank@example.com');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 PRIMARY KEY);
INSERT INTO numbers VALUES (500);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, 'test@#$%^&*()');
INSERT INTO items VALUES (2, '');
INSERT INTO items VALUES (3, '');
INSERT INTO items VALUES (4, 'test@#$%^&*()');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value STRING NOT NULL UNIQUE);
INSERT INTO test VALUES (1, 'first');
INSERT INTO test VALUES (1, 'second');
INSERT INTO test VALUES (2, 'first');
INSERT INTO test VALUES (3, NULL);

-- Tag: window_functions_window_functions_operators_test_select_8040
SELECT error FROM logs;
-- Tag: window_functions_window_functions_operators_test_select_8041
SELECT discount FROM products;
-- Tag: window_functions_window_functions_operators_test_select_8042
SELECT enabled FROM features;
-- Tag: window_functions_window_functions_operators_test_select_8043
SELECT status, priority, archived FROM records;
-- Tag: window_functions_window_functions_operators_test_select_8044
SELECT created_at FROM events;
-- Tag: window_functions_window_functions_operators_test_select_8045
SELECT log_date FROM daily_logs;
-- Tag: window_functions_window_functions_operators_test_select_8046
SELECT * FROM users;
-- Tag: window_functions_window_functions_operators_test_select_8047
SELECT * FROM accounts;
-- Tag: window_functions_window_functions_operators_test_select_8048
SELECT price FROM products;
-- Tag: window_functions_window_functions_operators_test_select_8049
SELECT price, stock FROM products WHERE id = 2;
UPDATE users SET email = 'alice@example.com' WHERE id = 2;
UPDATE users SET email = NULL WHERE id = 1;
UPDATE users SET email = 'robert@example.com' WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_8050
SELECT COUNT(*) FROM numbers;

DROP TABLE IF EXISTS features;
CREATE TABLE features (id INT64 PRIMARY KEY, name STRING, enabled BOOL DEFAULT true);
INSERT INTO features (id, name) VALUES (1, 'Feature A');
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64 PRIMARY KEY, status STRING DEFAULT 'pending', priority INT64 DEFAULT 1, archived BOOL DEFAULT false);
INSERT INTO records (id) VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64 PRIMARY KEY, name STRING, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
INSERT INTO events (id, name) VALUES (1, 'Event A');
DROP TABLE IF EXISTS daily_logs;
CREATE TABLE daily_logs (id INT64 PRIMARY KEY, message STRING, log_date DATE DEFAULT CURRENT_DATE);
INSERT INTO daily_logs (id, message) VALUES (1, 'Log entry');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING);
INSERT INTO users VALUES (1, 'alice@example.com', 'Alice');
INSERT INTO users VALUES (2, 'bob@example.com', 'Bob');
INSERT INTO users VALUES (3, 'alice@example.com', 'Alice2');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, NULL);
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (3, NULL);
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, username STRING UNIQUE);
INSERT INTO accounts VALUES (1, 'alice');
INSERT INTO accounts VALUES (2, 'ALICE');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, '');
INSERT INTO items VALUES (2, '');
DROP TABLE IF EXISTS reservations;
CREATE TABLE reservations (id INT64 PRIMARY KEY, room_number INT64, date DATE, UNIQUE (room_number, date));
INSERT INTO reservations VALUES (1, 101, DATE '2024-01-15');
INSERT INTO reservations VALUES (2, 101, DATE '2024-01-16');
INSERT INTO reservations VALUES (3, 102, DATE '2024-01-15');
INSERT INTO reservations VALUES (4, 101, DATE '2024-01-15');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, username STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com', 'alice123');
INSERT INTO users VALUES (2, 'alice@example.com', 'bob456');
INSERT INTO users VALUES (3, 'carol@example.com', 'alice123');
INSERT INTO users VALUES (4, 'dave@example.com', 'dave789');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, 9.99);
INSERT INTO products VALUES (2, 0);
INSERT INTO products VALUES (3, -5.00);
DROP TABLE IF EXISTS ratings;
CREATE TABLE ratings (id INT64 PRIMARY KEY, score INT64 CHECK (score >= 1 AND score <= 5));
INSERT INTO ratings VALUES (1, 1);
INSERT INTO ratings VALUES (2, 3);
INSERT INTO ratings VALUES (3, 5);
INSERT INTO ratings VALUES (4, 0);
INSERT INTO ratings VALUES (5, 6);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, username STRING CHECK (LENGTH(username) >= 3));
INSERT INTO users VALUES (1, 'alice');
INSERT INTO users VALUES (2, 'ab');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64 PRIMARY KEY, quantity INT64, discount FLOAT64, CHECK (quantity > 0 AND discount >= 0 AND discount <= 1.0));
INSERT INTO orders VALUES (1, 5, 0.1);
INSERT INTO orders VALUES (2, 0, 0.5);
INSERT INTO orders VALUES (3, 10, -0.1);
INSERT INTO orders VALUES (4, 10, 1.5);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (NULL, 'bob@example.com');
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (1, 'charlie@example.com');
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL, username STRING NOT NULL);
INSERT INTO accounts VALUES (1, 'alice@example.com', 'alice');
INSERT INTO accounts VALUES (2, 'alice@example.com', 'bob');
INSERT INTO accounts VALUES (3, NULL, 'charlie');
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64 PRIMARY KEY, sku STRING UNIQUE NOT NULL, name STRING NOT NULL, price FLOAT64 DEFAULT 0.0 CHECK (price >= 0), stock INT64 DEFAULT 0 CHECK (stock >= 0) );
INSERT INTO products VALUES (1, 'SKU001', 'Widget', 9.99, 100);
INSERT INTO products (id, sku, name) VALUES (2, 'SKU002', 'Gadget');
INSERT INTO products (id, sku, name) VALUES (1, 'SKU003', 'Test');
INSERT INTO products VALUES (3, 'SKU001', 'Test', 5.0, 10);
INSERT INTO products VALUES (4, 'SKU004', 'Test', -5.0, 10);
INSERT INTO products VALUES (5, 'SKU005', NULL, 5.0, 10);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com'), (2, 'bob@example.com'), (3, 'charlie@example.com');
INSERT INTO users VALUES (10, 'dave@example.com'), (10, 'eve@example.com');
INSERT INTO users VALUES (20, 'frank@example.com'), (21, 'frank@example.com');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 PRIMARY KEY);
INSERT INTO numbers VALUES (500);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, 'test@#$%^&*()');
INSERT INTO items VALUES (2, '');
INSERT INTO items VALUES (3, '');
INSERT INTO items VALUES (4, 'test@#$%^&*()');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value STRING NOT NULL UNIQUE);
INSERT INTO test VALUES (1, 'first');
INSERT INTO test VALUES (1, 'second');
INSERT INTO test VALUES (2, 'first');
INSERT INTO test VALUES (3, NULL);

-- Tag: window_functions_window_functions_operators_test_select_8051
SELECT enabled FROM features;
-- Tag: window_functions_window_functions_operators_test_select_8052
SELECT status, priority, archived FROM records;
-- Tag: window_functions_window_functions_operators_test_select_8053
SELECT created_at FROM events;
-- Tag: window_functions_window_functions_operators_test_select_8054
SELECT log_date FROM daily_logs;
-- Tag: window_functions_window_functions_operators_test_select_8055
SELECT * FROM users;
-- Tag: window_functions_window_functions_operators_test_select_8056
SELECT * FROM accounts;
-- Tag: window_functions_window_functions_operators_test_select_8057
SELECT price FROM products;
-- Tag: window_functions_window_functions_operators_test_select_8058
SELECT price, stock FROM products WHERE id = 2;
UPDATE users SET email = 'alice@example.com' WHERE id = 2;
UPDATE users SET email = NULL WHERE id = 1;
UPDATE users SET email = 'robert@example.com' WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_8059
SELECT COUNT(*) FROM numbers;

DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, NULL);
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (3, NULL);
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, username STRING UNIQUE);
INSERT INTO accounts VALUES (1, 'alice');
INSERT INTO accounts VALUES (2, 'ALICE');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, '');
INSERT INTO items VALUES (2, '');
DROP TABLE IF EXISTS reservations;
CREATE TABLE reservations (id INT64 PRIMARY KEY, room_number INT64, date DATE, UNIQUE (room_number, date));
INSERT INTO reservations VALUES (1, 101, DATE '2024-01-15');
INSERT INTO reservations VALUES (2, 101, DATE '2024-01-16');
INSERT INTO reservations VALUES (3, 102, DATE '2024-01-15');
INSERT INTO reservations VALUES (4, 101, DATE '2024-01-15');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, username STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com', 'alice123');
INSERT INTO users VALUES (2, 'alice@example.com', 'bob456');
INSERT INTO users VALUES (3, 'carol@example.com', 'alice123');
INSERT INTO users VALUES (4, 'dave@example.com', 'dave789');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, 9.99);
INSERT INTO products VALUES (2, 0);
INSERT INTO products VALUES (3, -5.00);
DROP TABLE IF EXISTS ratings;
CREATE TABLE ratings (id INT64 PRIMARY KEY, score INT64 CHECK (score >= 1 AND score <= 5));
INSERT INTO ratings VALUES (1, 1);
INSERT INTO ratings VALUES (2, 3);
INSERT INTO ratings VALUES (3, 5);
INSERT INTO ratings VALUES (4, 0);
INSERT INTO ratings VALUES (5, 6);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, username STRING CHECK (LENGTH(username) >= 3));
INSERT INTO users VALUES (1, 'alice');
INSERT INTO users VALUES (2, 'ab');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64 PRIMARY KEY, quantity INT64, discount FLOAT64, CHECK (quantity > 0 AND discount >= 0 AND discount <= 1.0));
INSERT INTO orders VALUES (1, 5, 0.1);
INSERT INTO orders VALUES (2, 0, 0.5);
INSERT INTO orders VALUES (3, 10, -0.1);
INSERT INTO orders VALUES (4, 10, 1.5);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (NULL, 'bob@example.com');
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (1, 'charlie@example.com');
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL, username STRING NOT NULL);
INSERT INTO accounts VALUES (1, 'alice@example.com', 'alice');
INSERT INTO accounts VALUES (2, 'alice@example.com', 'bob');
INSERT INTO accounts VALUES (3, NULL, 'charlie');
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64 PRIMARY KEY, sku STRING UNIQUE NOT NULL, name STRING NOT NULL, price FLOAT64 DEFAULT 0.0 CHECK (price >= 0), stock INT64 DEFAULT 0 CHECK (stock >= 0) );
INSERT INTO products VALUES (1, 'SKU001', 'Widget', 9.99, 100);
INSERT INTO products (id, sku, name) VALUES (2, 'SKU002', 'Gadget');
INSERT INTO products (id, sku, name) VALUES (1, 'SKU003', 'Test');
INSERT INTO products VALUES (3, 'SKU001', 'Test', 5.0, 10);
INSERT INTO products VALUES (4, 'SKU004', 'Test', -5.0, 10);
INSERT INTO products VALUES (5, 'SKU005', NULL, 5.0, 10);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com'), (2, 'bob@example.com'), (3, 'charlie@example.com');
INSERT INTO users VALUES (10, 'dave@example.com'), (10, 'eve@example.com');
INSERT INTO users VALUES (20, 'frank@example.com'), (21, 'frank@example.com');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 PRIMARY KEY);
INSERT INTO numbers VALUES (500);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, 'test@#$%^&*()');
INSERT INTO items VALUES (2, '');
INSERT INTO items VALUES (3, '');
INSERT INTO items VALUES (4, 'test@#$%^&*()');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value STRING NOT NULL UNIQUE);
INSERT INTO test VALUES (1, 'first');
INSERT INTO test VALUES (1, 'second');
INSERT INTO test VALUES (2, 'first');
INSERT INTO test VALUES (3, NULL);

-- Tag: window_functions_window_functions_operators_test_select_8060
SELECT * FROM users;
-- Tag: window_functions_window_functions_operators_test_select_8061
SELECT * FROM accounts;
-- Tag: window_functions_window_functions_operators_test_select_8062
SELECT price FROM products;
-- Tag: window_functions_window_functions_operators_test_select_8063
SELECT price, stock FROM products WHERE id = 2;
UPDATE users SET email = 'alice@example.com' WHERE id = 2;
UPDATE users SET email = NULL WHERE id = 1;
UPDATE users SET email = 'robert@example.com' WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_8064
SELECT COUNT(*) FROM numbers;

DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, username STRING UNIQUE);
INSERT INTO accounts VALUES (1, 'alice');
INSERT INTO accounts VALUES (2, 'ALICE');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, '');
INSERT INTO items VALUES (2, '');
DROP TABLE IF EXISTS reservations;
CREATE TABLE reservations (id INT64 PRIMARY KEY, room_number INT64, date DATE, UNIQUE (room_number, date));
INSERT INTO reservations VALUES (1, 101, DATE '2024-01-15');
INSERT INTO reservations VALUES (2, 101, DATE '2024-01-16');
INSERT INTO reservations VALUES (3, 102, DATE '2024-01-15');
INSERT INTO reservations VALUES (4, 101, DATE '2024-01-15');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE, username STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com', 'alice123');
INSERT INTO users VALUES (2, 'alice@example.com', 'bob456');
INSERT INTO users VALUES (3, 'carol@example.com', 'alice123');
INSERT INTO users VALUES (4, 'dave@example.com', 'dave789');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, 9.99);
INSERT INTO products VALUES (2, 0);
INSERT INTO products VALUES (3, -5.00);
DROP TABLE IF EXISTS ratings;
CREATE TABLE ratings (id INT64 PRIMARY KEY, score INT64 CHECK (score >= 1 AND score <= 5));
INSERT INTO ratings VALUES (1, 1);
INSERT INTO ratings VALUES (2, 3);
INSERT INTO ratings VALUES (3, 5);
INSERT INTO ratings VALUES (4, 0);
INSERT INTO ratings VALUES (5, 6);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, username STRING CHECK (LENGTH(username) >= 3));
INSERT INTO users VALUES (1, 'alice');
INSERT INTO users VALUES (2, 'ab');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price FLOAT64 CHECK (price > 0));
INSERT INTO products VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64 PRIMARY KEY, quantity INT64, discount FLOAT64, CHECK (quantity > 0 AND discount >= 0 AND discount <= 1.0));
INSERT INTO orders VALUES (1, 5, 0.1);
INSERT INTO orders VALUES (2, 0, 0.5);
INSERT INTO orders VALUES (3, 10, -0.1);
INSERT INTO orders VALUES (4, 10, 1.5);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (NULL, 'bob@example.com');
INSERT INTO users VALUES (2, NULL);
INSERT INTO users VALUES (1, 'charlie@example.com');
DROP TABLE IF EXISTS accounts;
CREATE TABLE accounts (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL, username STRING NOT NULL);
INSERT INTO accounts VALUES (1, 'alice@example.com', 'alice');
INSERT INTO accounts VALUES (2, 'alice@example.com', 'bob');
INSERT INTO accounts VALUES (3, NULL, 'charlie');
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64 PRIMARY KEY, sku STRING UNIQUE NOT NULL, name STRING NOT NULL, price FLOAT64 DEFAULT 0.0 CHECK (price >= 0), stock INT64 DEFAULT 0 CHECK (stock >= 0) );
INSERT INTO products VALUES (1, 'SKU001', 'Widget', 9.99, 100);
INSERT INTO products (id, sku, name) VALUES (2, 'SKU002', 'Gadget');
INSERT INTO products (id, sku, name) VALUES (1, 'SKU003', 'Test');
INSERT INTO products VALUES (3, 'SKU001', 'Test', 5.0, 10);
INSERT INTO products VALUES (4, 'SKU004', 'Test', -5.0, 10);
INSERT INTO products VALUES (5, 'SKU005', NULL, 5.0, 10);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE NOT NULL);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, email STRING UNIQUE);
INSERT INTO users VALUES (1, 'alice@example.com'), (2, 'bob@example.com'), (3, 'charlie@example.com');
INSERT INTO users VALUES (10, 'dave@example.com'), (10, 'eve@example.com');
INSERT INTO users VALUES (20, 'frank@example.com'), (21, 'frank@example.com');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (value INT64 PRIMARY KEY);
INSERT INTO numbers VALUES (500);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64 PRIMARY KEY, code STRING UNIQUE);
INSERT INTO items VALUES (1, 'test@#$%^&*()');
INSERT INTO items VALUES (2, '');
INSERT INTO items VALUES (3, '');
INSERT INTO items VALUES (4, 'test@#$%^&*()');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64 PRIMARY KEY, value STRING NOT NULL UNIQUE);
INSERT INTO test VALUES (1, 'first');
INSERT INTO test VALUES (1, 'second');
INSERT INTO test VALUES (2, 'first');
INSERT INTO test VALUES (3, NULL);

-- Tag: window_functions_window_functions_operators_test_select_8065
SELECT * FROM accounts;
-- Tag: window_functions_window_functions_operators_test_select_8066
SELECT price FROM products;
-- Tag: window_functions_window_functions_operators_test_select_8067
SELECT price, stock FROM products WHERE id = 2;
UPDATE users SET email = 'alice@example.com' WHERE id = 2;
UPDATE users SET email = NULL WHERE id = 1;
UPDATE users SET email = 'robert@example.com' WHERE id = 2;
-- Tag: window_functions_window_functions_operators_test_select_8068
SELECT COUNT(*) FROM numbers;

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8069
SELECT TRUE AND TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8070
SELECT TRUE AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8071
SELECT TRUE AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8072
SELECT FALSE AND TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8073
SELECT FALSE AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8074
SELECT FALSE AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8075
SELECT NULL AND TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8076
SELECT NULL AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8077
SELECT NULL AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8078
SELECT TRUE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8079
SELECT TRUE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8080
SELECT TRUE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8081
SELECT FALSE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8082
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8083
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8084
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8085
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8086
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8087
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8088
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8089
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8090
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8091
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8092
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8093
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8094
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8095
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8096
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8097
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8098
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8099
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8100
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8101
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8102
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8103
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8104
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8105
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8106
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8107
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8108
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8109
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8110
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8111
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8112
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8113
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8114
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8115
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8116
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8117
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_083
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8118
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8119
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8120
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8121
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8122
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8123
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8124
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8125
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8126
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8127
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8128
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8129
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8130
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8131
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8132
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8133
SELECT TRUE AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8134
SELECT TRUE AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8135
SELECT FALSE AND TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8136
SELECT FALSE AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8137
SELECT FALSE AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8138
SELECT NULL AND TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8139
SELECT NULL AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8140
SELECT NULL AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8141
SELECT TRUE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8142
SELECT TRUE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8143
SELECT TRUE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8144
SELECT FALSE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8145
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8146
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8147
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8148
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8149
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8150
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8151
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8152
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8153
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8154
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8155
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8156
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8157
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8158
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8159
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8160
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8161
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8162
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8163
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8164
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8165
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8166
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8167
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8168
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8169
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8170
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8171
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8172
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8173
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8174
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8175
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8176
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8177
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8178
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8179
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8180
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_084
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8181
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8182
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8183
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8184
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8185
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8186
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8187
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8188
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8189
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8190
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8191
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8192
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8193
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8194
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8195
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8196
SELECT TRUE AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8197
SELECT FALSE AND TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8198
SELECT FALSE AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8199
SELECT FALSE AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8200
SELECT NULL AND TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8201
SELECT NULL AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8202
SELECT NULL AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8203
SELECT TRUE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8204
SELECT TRUE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8205
SELECT TRUE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8206
SELECT FALSE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8207
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8208
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8209
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8210
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8211
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8212
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8213
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8214
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8215
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8216
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8217
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8218
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8219
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8220
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8221
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8222
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8223
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8224
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8225
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8226
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8227
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8228
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8229
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8230
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8231
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8232
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8233
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8234
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8235
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8236
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8237
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8238
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8239
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8240
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8241
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8242
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_085
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8243
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8244
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8245
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8246
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8247
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8248
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8249
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8250
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8251
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8252
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8253
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8254
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8255
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8256
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8257
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8258
SELECT FALSE AND TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8259
SELECT FALSE AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8260
SELECT FALSE AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8261
SELECT NULL AND TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8262
SELECT NULL AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8263
SELECT NULL AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8264
SELECT TRUE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8265
SELECT TRUE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8266
SELECT TRUE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8267
SELECT FALSE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8268
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8269
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8270
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8271
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8272
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8273
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8274
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8275
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8276
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8277
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8278
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8279
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8280
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8281
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8282
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8283
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8284
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8285
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8286
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8287
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8288
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8289
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8290
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8291
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8292
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8293
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8294
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8295
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8296
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8297
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8298
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8299
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8300
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8301
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8302
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8303
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_086
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8304
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8305
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8306
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8307
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8308
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8309
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8310
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8311
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8312
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8313
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8314
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8315
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8316
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8317
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8318
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8319
SELECT FALSE AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8320
SELECT FALSE AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8321
SELECT NULL AND TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8322
SELECT NULL AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8323
SELECT NULL AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8324
SELECT TRUE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8325
SELECT TRUE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8326
SELECT TRUE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8327
SELECT FALSE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8328
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8329
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8330
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8331
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8332
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8333
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8334
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8335
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8336
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8337
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8338
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8339
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8340
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8341
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8342
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8343
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8344
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8345
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8346
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8347
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8348
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8349
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8350
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8351
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8352
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8353
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8354
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8355
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8356
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8357
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8358
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8359
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8360
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8361
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8362
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8363
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_087
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8364
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8365
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8366
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8367
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8368
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8369
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8370
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8371
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8372
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8373
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8374
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8375
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8376
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8377
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8378
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8379
SELECT FALSE AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8380
SELECT NULL AND TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8381
SELECT NULL AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8382
SELECT NULL AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8383
SELECT TRUE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8384
SELECT TRUE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8385
SELECT TRUE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8386
SELECT FALSE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8387
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8388
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8389
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8390
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8391
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8392
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8393
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8394
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8395
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8396
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8397
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8398
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8399
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8400
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8401
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8402
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8403
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8404
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8405
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8406
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8407
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8408
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8409
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8410
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8411
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8412
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8413
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8414
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8415
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8416
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8417
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8418
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8419
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8420
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8421
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8422
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_088
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8423
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8424
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8425
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8426
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8427
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8428
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8429
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8430
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8431
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8432
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8433
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8434
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8435
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8436
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8437
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8438
SELECT NULL AND TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8439
SELECT NULL AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8440
SELECT NULL AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8441
SELECT TRUE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8442
SELECT TRUE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8443
SELECT TRUE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8444
SELECT FALSE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8445
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8446
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8447
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8448
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8449
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8450
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8451
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8452
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8453
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8454
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8455
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8456
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8457
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8458
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8459
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8460
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8461
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8462
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8463
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8464
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8465
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8466
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8467
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8468
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8469
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8470
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8471
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8472
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8473
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8474
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8475
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8476
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8477
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8478
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8479
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8480
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_089
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8481
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8482
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8483
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8484
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8485
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8486
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8487
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8488
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8489
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8490
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8491
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8492
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8493
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8494
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8495
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8496
SELECT NULL AND FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8497
SELECT NULL AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8498
SELECT TRUE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8499
SELECT TRUE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8500
SELECT TRUE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8501
SELECT FALSE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8502
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8503
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8504
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8505
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8506
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8507
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8508
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8509
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8510
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8511
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8512
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8513
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8514
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8515
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8516
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8517
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8518
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8519
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8520
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8521
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8522
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8523
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8524
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8525
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8526
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8527
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8528
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8529
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8530
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8531
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8532
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8533
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8534
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8535
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8536
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8537
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_090
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8538
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8539
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8540
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8541
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8542
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8543
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8544
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8545
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8546
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8547
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8548
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8549
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8550
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8551
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8552
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8553
SELECT NULL AND NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8554
SELECT TRUE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8555
SELECT TRUE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8556
SELECT TRUE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8557
SELECT FALSE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8558
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8559
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8560
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8561
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8562
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8563
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8564
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8565
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8566
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8567
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8568
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8569
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8570
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8571
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8572
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8573
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8574
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8575
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8576
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8577
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8578
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8579
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8580
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8581
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8582
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8583
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8584
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8585
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8586
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8587
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8588
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8589
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8590
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8591
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8592
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8593
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_091
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8594
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8595
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8596
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8597
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8598
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8599
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8600
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8601
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8602
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8603
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8604
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8605
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8606
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8607
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8608
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8609
SELECT TRUE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8610
SELECT TRUE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8611
SELECT TRUE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8612
SELECT FALSE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8613
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8614
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8615
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8616
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8617
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8618
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8619
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8620
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8621
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8622
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8623
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8624
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8625
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8626
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8627
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8628
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8629
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8630
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8631
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8632
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8633
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8634
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8635
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8636
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8637
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8638
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8639
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8640
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8641
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8642
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8643
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8644
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8645
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8646
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8647
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8648
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_092
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8649
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8650
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8651
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8652
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8653
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8654
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8655
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8656
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8657
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8658
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8659
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8660
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8661
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8662
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8663
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8664
SELECT TRUE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8665
SELECT TRUE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8666
SELECT FALSE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8667
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8668
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8669
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8670
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8671
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8672
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8673
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8674
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8675
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8676
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8677
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8678
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8679
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8680
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8681
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8682
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8683
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8684
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8685
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8686
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8687
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8688
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8689
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8690
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8691
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8692
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8693
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8694
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8695
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8696
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8697
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8698
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8699
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8700
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8701
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8702
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_093
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8703
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8704
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8705
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8706
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8707
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8708
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8709
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8710
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8711
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8712
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8713
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8714
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8715
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8716
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8717
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8718
SELECT TRUE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8719
SELECT FALSE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8720
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8721
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8722
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8723
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8724
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8725
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8726
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8727
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8728
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8729
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8730
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8731
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8732
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8733
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8734
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8735
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8736
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8737
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8738
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8739
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8740
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8741
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8742
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8743
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8744
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8745
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8746
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8747
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8748
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8749
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8750
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8751
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8752
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8753
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8754
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8755
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_094
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8756
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8757
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8758
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8759
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8760
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8761
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8762
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8763
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8764
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8765
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8766
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8767
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8768
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8769
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8770
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8771
SELECT FALSE OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8772
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8773
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8774
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8775
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8776
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8777
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8778
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8779
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8780
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8781
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8782
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8783
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8784
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8785
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8786
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8787
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8788
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8789
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8790
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8791
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8792
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8793
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8794
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8795
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8796
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8797
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8798
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8799
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8800
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8801
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8802
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8803
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8804
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8805
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8806
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8807
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_095
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8808
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8809
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8810
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8811
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8812
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8813
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8814
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8815
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8816
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8817
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8818
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8819
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8820
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8821
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8822
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8823
SELECT FALSE OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8824
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8825
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8826
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8827
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8828
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8829
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8830
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8831
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8832
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8833
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8834
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8835
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8836
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8837
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8838
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8839
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8840
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8841
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8842
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8843
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8844
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8845
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8846
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8847
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8848
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8849
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8850
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8851
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8852
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8853
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8854
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8855
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8856
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8857
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8858
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_096
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8859
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8860
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8861
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8862
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8863
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8864
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8865
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8866
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8867
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8868
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8869
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8870
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8871
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8872
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8873
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8874
SELECT FALSE OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8875
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8876
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8877
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8878
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8879
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8880
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8881
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8882
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8883
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8884
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8885
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8886
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8887
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8888
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8889
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8890
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8891
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8892
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8893
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8894
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8895
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8896
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8897
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8898
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8899
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8900
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8901
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8902
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8903
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8904
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8905
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8906
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8907
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8908
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_097
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8909
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8910
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8911
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8912
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8913
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8914
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8915
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8916
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8917
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8918
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8919
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8920
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8921
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8922
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8923
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8924
SELECT NULL OR TRUE as result;
-- Tag: window_functions_window_functions_operators_test_select_8925
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8926
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8927
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8928
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8929
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8930
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8931
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8932
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8933
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8934
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8935
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8936
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8937
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8938
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8939
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8940
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8941
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8942
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8943
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8944
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8945
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8946
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8947
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8948
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8949
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8950
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8951
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8952
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8953
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8954
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8955
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8956
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_8957
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_098
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_8958
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_8959
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_8960
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_8961
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_8962
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8963
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_8964
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_8965
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8966
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_8967
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8968
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_8969
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8970
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_8971
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_8972
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_8973
SELECT NULL OR FALSE as result;
-- Tag: window_functions_window_functions_operators_test_select_8974
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8975
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8976
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8977
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8978
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8979
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_8980
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_8981
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8982
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_8983
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8984
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_8985
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_8986
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8987
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_8988
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_8989
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_8990
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_8991
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8992
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8993
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8994
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8995
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8996
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8997
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_8998
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_8999
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9000
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9001
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9002
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9003
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9004
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9005
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_099
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9006
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9007
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9008
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9009
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9010
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9011
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9012
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9013
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9014
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9015
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9016
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9017
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9018
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9019
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9020
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9021
SELECT NULL OR NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9022
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9023
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9024
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9025
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9026
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_9027
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9028
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9029
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9030
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9031
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_9032
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_9033
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9034
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9035
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_9036
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9037
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9038
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9039
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9040
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9041
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9042
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9043
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9044
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9045
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9046
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9047
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9048
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9049
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9050
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9051
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9052
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_100
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9053
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9054
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9055
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9056
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9057
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9058
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9059
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9060
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9061
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9062
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9063
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9064
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9065
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9066
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9067
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9068
SELECT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9069
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9070
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9071
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9072
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_9073
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9074
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9075
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9076
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9077
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_9078
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_9079
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9080
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9081
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_9082
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9083
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9084
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9085
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9086
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9087
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9088
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9089
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9090
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9091
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9092
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9093
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9094
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9095
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9096
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9097
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9098
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_101
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9099
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9100
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9101
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9102
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9103
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9104
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9105
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9106
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9107
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9108
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9109
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9110
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9111
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9112
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9113
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9114
SELECT NOT NOT NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9115
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9116
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9117
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_9118
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9119
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9120
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9121
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9122
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_9123
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_9124
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9125
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9126
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_9127
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9128
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9129
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9130
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9131
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9132
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9133
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9134
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9135
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9136
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9137
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9138
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9139
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9140
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9141
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9142
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9143
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_102
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9144
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9145
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9146
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9147
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9148
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9149
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9150
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9151
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9152
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9153
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9154
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9155
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9156
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9157
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9158
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9159
SELECT NULL = NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9160
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9161
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_9162
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9163
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9164
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9165
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9166
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_9167
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_9168
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9169
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9170
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_9171
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9172
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9173
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9174
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9175
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9176
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9177
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9178
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9179
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9180
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9181
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9182
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9183
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9184
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9185
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9186
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9187
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_103
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9188
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9189
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9190
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9191
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9192
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9193
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9194
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9195
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9196
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9197
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9198
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9199
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9200
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9201
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9202
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9203
SELECT NULL != NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9204
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_9205
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9206
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9207
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9208
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9209
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_9210
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_9211
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9212
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9213
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_9214
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9215
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9216
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9217
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9218
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9219
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9220
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9221
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9222
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9223
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9224
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9225
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9226
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9227
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9228
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9229
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9230
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_104
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9231
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9232
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9233
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9234
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9235
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9236
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9237
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9238
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9239
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9240
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9241
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9242
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9243
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9244
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9245
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9246
SELECT NULL < 5 as result;
-- Tag: window_functions_window_functions_operators_test_select_9247
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9248
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9249
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9250
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9251
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_9252
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_9253
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9254
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9255
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_9256
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9257
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9258
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9259
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9260
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9261
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9262
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9263
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9264
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9265
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9266
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9267
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9268
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9269
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9270
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9271
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9272
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_105
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9273
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9274
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9275
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9276
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9277
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9278
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9279
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9280
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9281
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9282
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9283
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9284
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9285
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9286
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9287
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9288
SELECT 10 > NULL as result;
-- Tag: window_functions_window_functions_operators_test_select_9289
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9290
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9291
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9292
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_9293
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_9294
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9295
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9296
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_9297
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9298
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9299
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9300
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9301
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9302
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9303
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9304
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9305
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9306
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9307
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9308
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9309
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9310
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9311
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9312
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9313
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_106
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9314
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9315
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9316
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9317
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9318
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9319
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9320
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9321
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9322
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9323
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9324
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9325
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9326
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9327
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9328
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9329
SELECT val, val IS NULL as is_null_result FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9330
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9331
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9332
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_9333
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_9334
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9335
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9336
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_9337
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9338
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9339
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9340
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9341
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9342
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9343
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9344
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9345
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9346
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9347
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9348
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9349
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9350
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9351
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9352
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9353
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_107
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9354
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9355
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9356
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9357
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9358
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9359
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9360
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9361
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9362
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9363
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9364
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9365
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9366
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9367
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9368
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9369
SELECT val, val IS NOT NULL as is_not_null FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9370
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9371
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_9372
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_9373
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9374
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9375
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_9376
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9377
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9378
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9379
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9380
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9381
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9382
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9383
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9384
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9385
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9386
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9387
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9388
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9389
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9390
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9391
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9392
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_108
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9393
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9394
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9395
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9396
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9397
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9398
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9399
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9400
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9401
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9402
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9403
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9404
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9405
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9406
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9407
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, TRUE);
INSERT INTO data VALUES (2, FALSE);
INSERT INTO data VALUES (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9408
SELECT id FROM data WHERE flag ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9409
SELECT id FROM data WHERE NULL = 5;
-- Tag: window_functions_window_functions_operators_test_select_9410
SELECT val FROM data WHERE val = NULL;
-- Tag: window_functions_window_functions_operators_test_select_9411
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9412
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9413
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_9414
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9415
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9416
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9417
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9418
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9419
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9420
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9421
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9422
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9423
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9424
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9425
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9426
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9427
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9428
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9429
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9430
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_109
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9431
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9432
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9433
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9434
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9435
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9436
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9437
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9438
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9439
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9440
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9441
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9442
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9443
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9444
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9445
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9446
SELECT val FROM data WHERE val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9447
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9448
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_9449
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9450
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9451
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9452
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9453
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9454
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9455
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9456
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9457
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9458
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9459
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9460
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9461
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9462
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9463
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9464
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9465
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_110
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9466
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9467
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9468
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9469
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9470
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9471
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9472
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9473
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9474
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9475
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9476
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9477
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9478
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9479
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9480
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a BOOL, b BOOL);
INSERT INTO data VALUES (1, TRUE, TRUE);
INSERT INTO data VALUES (2, TRUE, NULL);
INSERT INTO data VALUES (3, FALSE, NULL);
INSERT INTO data VALUES (4, NULL, TRUE);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9481
SELECT id FROM data WHERE a AND b ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9482
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_9483
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9484
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9485
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9486
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9487
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9488
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9489
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9490
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9491
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9492
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9493
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9494
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9495
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9496
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9497
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9498
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9499
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_111
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9500
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9501
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9502
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9503
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9504
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9505
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9506
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9507
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9508
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9509
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9510
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9511
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9512
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9513
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9514
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, val INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t2 VALUES (1, NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9515
SELECT t1.id FROM t1 JOIN t2 ON t1.val = t2.val;
-- Tag: window_functions_window_functions_operators_test_select_9516
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9517
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9518
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9519
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9520
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9521
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9522
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9523
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9524
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9525
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9526
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9527
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9528
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9529
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9530
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9531
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9532
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_112
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9533
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9534
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9535
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9536
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9537
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9538
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9539
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9540
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9541
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9542
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9543
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9544
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9545
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9546
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9547
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64);
INSERT INTO t1 VALUES (1, NULL);
INSERT INTO t1 VALUES (2, 42);
INSERT INTO t2 VALUES (1);
DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9548
SELECT t1.id FROM t1 JOIN t2 ON t1.id = t2.id WHERE t1.val IS NULL;
-- Tag: window_functions_window_functions_operators_test_select_9549
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9550
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9551
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9552
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9553
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9554
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9555
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9556
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9557
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9558
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9559
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9560
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9561
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9562
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9563
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9564
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_113
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9565
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9566
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9567
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9568
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9569
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9570
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9571
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9572
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9573
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9574
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9575
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9576
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9577
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9578
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9579
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS left_table;
CREATE TABLE left_table (id INT64, val STRING);
DROP TABLE IF EXISTS right_table;
CREATE TABLE right_table (id INT64, data STRING);
INSERT INTO left_table VALUES (1, 'A');
INSERT INTO left_table VALUES (2, 'B');
INSERT INTO right_table VALUES (1, 'X');
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (5);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9580
SELECT lt.id, lt.val, rt.data
FROM left_table lt
LEFT JOIN right_table rt ON lt.id = rt.id
ORDER BY lt.id;
-- Tag: window_functions_window_functions_operators_test_select_9581
SELECT COUNT(*) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9582
SELECT COUNT(val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9583
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9584
SELECT SUM(val) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9585
SELECT AVG(val) as average FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9586
SELECT MIN(val) as min_val, MAX(val) as max_val FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9587
SELECT COUNT(DISTINCT val) as cnt FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9588
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9589
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9590
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9591
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9592
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9593
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9594
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9595
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_114
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9596
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9597
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9598
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9599
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9600
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9601
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9602
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9603
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9604
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9605
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9606
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9607
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9608
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9609
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9610
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9611
SELECT CASE WHEN NULL THEN 'yes' ELSE 'no' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9612
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9613
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9614
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9615
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9616
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9617
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9618
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_115
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9619
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9620
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9621
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9622
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9623
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9624
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9625
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9626
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9627
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9628
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9629
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9630
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9631
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9632
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9633
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9634
SELECT CASE WHEN NULL = NULL THEN 'match' ELSE 'no match' END as result;
-- Tag: window_functions_window_functions_operators_test_select_9635
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9636
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9637
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9638
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9639
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9640
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_116
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9641
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9642
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9643
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9644
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9645
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9646
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9647
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9648
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9649
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9650
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9651
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9652
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9653
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9654
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9655
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9656
SELECT val,
CASE WHEN val = 1 THEN 'one' ELSE NULL END as category
FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9657
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9658
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9659
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9660
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9661
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_117
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9662
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9663
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9664
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9665
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9666
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9667
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9668
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9669
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9670
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9671
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9672
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9673
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9674
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9675
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9676
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (99);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9677
SELECT CASE WHEN val = 1 THEN 'one' WHEN val = 2 THEN 'two' END as category FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9678
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9679
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9680
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9681
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_118
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9682
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9683
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9684
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9685
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9686
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9687
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9688
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9689
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9690
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9691
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9692
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9693
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9694
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9695
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9696
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9697
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9698
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9699
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9700
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_119
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9701
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9702
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9703
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9704
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9705
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9706
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9707
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9708
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9709
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9710
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9711
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9712
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9713
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9714
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9715
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9716
SELECT val FROM data WHERE val IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9717
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9718
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_120
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9719
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9720
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9721
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9722
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9723
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9724
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9725
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9726
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9727
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9728
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9729
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9730
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9731
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9732
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9733
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9734
SELECT val FROM data WHERE val NOT IN (1, 2, NULL);
-- Tag: window_functions_window_functions_operators_test_select_9735
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_121
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9736
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9737
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9738
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9739
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9740
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9741
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9742
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9743
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9744
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9745
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9746
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9747
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9748
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9749
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9750
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS outer_table;
CREATE TABLE outer_table (id INT64);
DROP TABLE IF EXISTS inner_table;
CREATE TABLE inner_table (val INT64);
INSERT INTO outer_table VALUES (1);
INSERT INTO inner_table VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9751
SELECT id FROM outer_table WHERE EXISTS (SELECT val FROM inner_table);
-- Tag: window_functions_window_functions_operators_test_select_122
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9752
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9753
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9754
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9755
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9756
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9757
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9758
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9759
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9760
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9761
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9762
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9763
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9764
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9765
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9766
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_123
SELECT
NULL + 5 as add_result,
10 - NULL as sub_result,
NULL * 3 as mul_result,
20 / NULL as div_result;
-- Tag: window_functions_window_functions_operators_test_select_9767
SELECT CONCAT('Hello', NULL, 'World') as result;
-- Tag: window_functions_window_functions_operators_test_select_9768
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9769
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9770
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9771
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9772
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9773
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9774
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9775
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9776
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9777
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9778
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9779
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9780
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9781
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9782
SELECT ((NULL + 5) * 2) - 3 as result;
-- Tag: window_functions_window_functions_operators_test_select_9783
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9784
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9785
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9786
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9787
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9788
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9789
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9790
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9791
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9792
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9793
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9794
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9795
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9796
SELECT COALESCE(NULL, NULL, 42, 50) as result;
-- Tag: window_functions_window_functions_operators_test_select_9797
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9798
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9799
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9800
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9801
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9802
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9803
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9804
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9805
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9806
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9807
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9808
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9809
SELECT COALESCE(NULL, NULL, NULL) as result;
-- Tag: window_functions_window_functions_operators_test_select_9810
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9811
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9812
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9813
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9814
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9815
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9816
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9817
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9818
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9819
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9820
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9821
SELECT NULLIF(5, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9822
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9823
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9824
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9825
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9826
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9827
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9828
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9829
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9830
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9831
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9832
SELECT NULLIF(5, 10) as result;
-- Tag: window_functions_window_functions_operators_test_select_9833
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9834
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9835
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9836
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9837
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9838
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9839
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9840
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9841
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9842
SELECT NULLIF(NULL, 5) as result;
-- Tag: window_functions_window_functions_operators_test_select_9843
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9844
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9845
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9846
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9847
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9848
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9849
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9850
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9851
SELECT IFNULL(NULL, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9852
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9853
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9854
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9855
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9856
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9857
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9858
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9859
SELECT IFNULL(10, 42) as result;
-- Tag: window_functions_window_functions_operators_test_select_9860
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9861
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9862
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9863
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9864
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9865
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
INSERT INTO data VALUES (3);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9866
SELECT val FROM data ORDER BY val;
-- Tag: window_functions_window_functions_operators_test_select_9867
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9868
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9869
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9870
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9871
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, amount INT64);
INSERT INTO sales VALUES ('East', 100);
INSERT INTO sales VALUES (NULL, 50);
INSERT INTO sales VALUES ('East', 200);
INSERT INTO sales VALUES (NULL, 75);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (2);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (val INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (val INT64);
INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (NULL);
INSERT INTO t2 VALUES (1);
INSERT INTO t2 VALUES (NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (val INT64);
DROP TABLE IF EXISTS empty;
CREATE TABLE empty (val INT64);
INSERT INTO data VALUES (5);

-- Tag: window_functions_window_functions_operators_test_select_9872
SELECT region, amount,
SUM(amount) OVER (PARTITION BY region) as partition_sum
FROM sales
ORDER BY region, amount;
-- Tag: window_functions_window_functions_operators_test_select_9873
SELECT val FROM t1 UNION SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9874
SELECT val FROM t1 INTERSECT SELECT val FROM t2;
-- Tag: window_functions_window_functions_operators_test_select_9875
SELECT val FROM data WHERE val > ALL (SELECT val FROM empty);
-- Tag: window_functions_window_functions_operators_test_select_9876
SELECT val FROM data WHERE val > ANY (SELECT val FROM empty);

DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, i INT64, f FLOAT64);
INSERT INTO data VALUES (1, 10, 10.0), (2, 10, 10.1), (3, 10, 9.9);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, i INT64, f FLOAT64);
INSERT INTO data VALUES (1, 3, 2.5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a INT64, b STRING);
INSERT INTO data VALUES (1, 10, '5');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value STRING);
INSERT INTO data VALUES (1, 'A', '100'), (2, 'B', 'N/A'), (3, 'A', '200');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text_num STRING);
INSERT INTO data VALUES (1, '10'), (2, '20'), (3, '5');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text_num STRING);
INSERT INTO data VALUES (1, '10'), (2, '20'), (3, '30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category STRING, value INT64);
INSERT INTO data VALUES (1, 'A', 10), (2, 'A', 20), (3, 'B', 30);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_val STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO config VALUES ('50');
INSERT INTO data VALUES (1, 30), (2, 60), (3, 40);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 42);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, large INT64);
INSERT INTO data VALUES (1, 9007199254740993);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, flag BOOL);
INSERT INTO data VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, num INT64);
INSERT INTO data VALUES (1, 0), (2, 1), (3, -5), (4, 42), (5, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'true'), (2, 'false'), (3, 'TRUE'), (4, 'FALSE'), (5, '1'), (6, '0');

-- Tag: window_functions_window_functions_operators_test_select_9877
SELECT id FROM data WHERE i = f ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9878
SELECT i * f as product FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9879
SELECT a + CAST(b AS INT64) as sum FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9880
SELECT id,
CASE WHEN category = 'A' THEN CAST(value AS INT64)
ELSE 0
END as parsed_value
FROM data
ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9881
SELECT id FROM data WHERE CAST(text_num AS INT64) > 8 ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9882
SELECT SUM(CAST(text_num AS INT64)) as total FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9883
SELECT category, CAST(SUM(value) AS STRING) as total_str
FROM data
GROUP BY category
ORDER BY category;
-- Tag: window_functions_window_functions_operators_test_select_9884
SELECT id FROM data WHERE value < (SELECT CAST(max_val AS INT64) FROM config) ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9885
SELECT CAST(CAST(value AS STRING) AS INT64) as roundtrip FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9886
SELECT CAST(CAST(large AS FLOAT64) AS INT64) as roundtrip FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9887
SELECT id, CAST(flag AS INT64) as int_flag FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9888
SELECT id, CAST(num AS BOOL) as bool_val FROM data ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9889
SELECT id, CAST(text AS BOOL) as bool_val FROM data ORDER BY id;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 10);

-- Tag: window_functions_window_functions_operators_test_select_9890
SELECT value, ROW_NUMBER() OVER (ORDER BY value NULLS LAST) as row_num
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9891
SELECT category, value,
COUNT(*) OVER (PARTITION BY category) as count
FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30), (40), (50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64, amount INT64);
INSERT INTO data VALUES (10, 100), (20, 200), (20, 300), (30, 400);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (month INT64, revenue INT64);
INSERT INTO sales VALUES (1, 100), (2, 150), (3, 120), (4, 180);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (name STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 90), ('Bob', 85), ('Carol', 95), ('Dave', 80);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (month INT64, revenue INT64);
INSERT INTO sales VALUES (1, 100), (2, 150), (3, 120), (4, 180), (5, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (year INT64, quarter INT64, revenue INT64);
INSERT INTO sales VALUES (2023, 1, 100), (2023, 2, 120), (2024, 1, 150), (2024, 2, 180);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, revenue INT64);
INSERT INTO sales VALUES ('A', 100), ('A', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, revenue INT64);
INSERT INTO sales VALUES ('A', 100), ('B', 150);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (name STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 90), ('Bob', NULL), ('Carol', 85), ('Dave', NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30);

-- Tag: window_functions_window_functions_operators_test_select_9892
SELECT value, NTH_VALUE(value, 5) OVER (ORDER BY value) AS fifth_value FROM data ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_9893
SELECT value, SUM(value) OVER (ORDER BY value ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS moving_sum FROM data ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_9894
SELECT value, SUM(value) OVER (ORDER BY value ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING) AS next_sum FROM data ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_9895
SELECT value, SUM(value) OVER (ORDER BY value ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_sum FROM data ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_9896
SELECT value, SUM(value) OVER (ORDER BY value ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS window_sum FROM data ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_9897
SELECT value, SUM(value) OVER (ORDER BY value RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_sum FROM data ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_9898
SELECT value, amount, SUM(amount) OVER (ORDER BY value RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS range_sum FROM data ORDER BY value, amount;
-- Tag: window_functions_window_functions_operators_test_select_124
SELECT
month,
revenue,
ROW_NUMBER() OVER (ORDER BY revenue DESC) AS row_num,
RANK() OVER (ORDER BY revenue DESC) AS rank,
LAG(revenue) OVER (ORDER BY month) AS prev_revenue,
LEAD(revenue) OVER (ORDER BY month) AS next_revenue
FROM sales
ORDER BY month;
-- Tag: window_functions_window_functions_operators_test_select_9899
SELECT name, score, rank
FROM (SELECT name, score, RANK() OVER (ORDER BY score DESC) AS rank FROM scores)
WHERE rank <= 2
ORDER BY rank, name;
-- Tag: window_functions_window_functions_operators_test_select_125
SELECT
month,
revenue,
AVG(revenue) OVER (ORDER BY month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ma3
FROM sales
ORDER BY month;
-- Tag: window_functions_window_functions_operators_test_select_126
SELECT
year,
quarter,
revenue,
LAG(revenue, 2) OVER (PARTITION BY quarter ORDER BY year) AS prev_year_revenue
FROM sales
ORDER BY year, quarter;
-- Tag: window_functions_window_functions_operators_test_select_9900
SELECT product, revenue, ROW_NUMBER() OVER (PARTITION BY product ORDER BY revenue) AS row_num FROM sales;
-- Tag: window_functions_window_functions_operators_test_select_9901
SELECT product, revenue, LAG(revenue) OVER (PARTITION BY product ORDER BY revenue) AS prev_revenue FROM sales;
-- Tag: window_functions_window_functions_operators_test_select_9902
SELECT value, LAG(value) OVER (ORDER BY value NULLS FIRST) AS prev_value FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9903
SELECT value, SUM(value) OVER (ORDER BY value ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS window_sum FROM data ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_9904
SELECT name, score, RANK() OVER (ORDER BY score DESC NULLS LAST) AS rank FROM scores;
-- Tag: window_functions_window_functions_operators_test_select_9905
SELECT value, LAG(value) OVER (ORDER BY value NULLS FIRST) AS prev_value FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9906
SELECT NTILE(0) OVER (ORDER BY value) AS bucket FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9907
SELECT LAG(value, -1) OVER (ORDER BY value) AS result FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9908
SELECT NTH_VALUE(value, 0) OVER (ORDER BY value) AS result FROM data;

DROP TABLE IF EXISTS scores;
CREATE TABLE scores (name STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 90), ('Bob', 85), ('Carol', 95), ('Dave', 80);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (month INT64, revenue INT64);
INSERT INTO sales VALUES (1, 100), (2, 150), (3, 120), (4, 180), (5, 200);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (year INT64, quarter INT64, revenue INT64);
INSERT INTO sales VALUES (2023, 1, 100), (2023, 2, 120), (2024, 1, 150), (2024, 2, 180);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, revenue INT64);
INSERT INTO sales VALUES ('A', 100), ('A', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, revenue INT64);
INSERT INTO sales VALUES ('A', 100), ('B', 150);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (name STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 90), ('Bob', NULL), ('Carol', 85), ('Dave', NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30);

-- Tag: window_functions_window_functions_operators_test_select_9909
SELECT name, score, rank
FROM (SELECT name, score, RANK() OVER (ORDER BY score DESC) AS rank FROM scores)
WHERE rank <= 2
ORDER BY rank, name;
-- Tag: window_functions_window_functions_operators_test_select_127
SELECT
month,
revenue,
AVG(revenue) OVER (ORDER BY month ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS ma3
FROM sales
ORDER BY month;
-- Tag: window_functions_window_functions_operators_test_select_128
SELECT
year,
quarter,
revenue,
LAG(revenue, 2) OVER (PARTITION BY quarter ORDER BY year) AS prev_year_revenue
FROM sales
ORDER BY year, quarter;
-- Tag: window_functions_window_functions_operators_test_select_9910
SELECT product, revenue, ROW_NUMBER() OVER (PARTITION BY product ORDER BY revenue) AS row_num FROM sales;
-- Tag: window_functions_window_functions_operators_test_select_9911
SELECT product, revenue, LAG(revenue) OVER (PARTITION BY product ORDER BY revenue) AS prev_revenue FROM sales;
-- Tag: window_functions_window_functions_operators_test_select_9912
SELECT value, LAG(value) OVER (ORDER BY value NULLS FIRST) AS prev_value FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9913
SELECT value, SUM(value) OVER (ORDER BY value ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS window_sum FROM data ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_9914
SELECT name, score, RANK() OVER (ORDER BY score DESC NULLS LAST) AS rank FROM scores;
-- Tag: window_functions_window_functions_operators_test_select_9915
SELECT value, LAG(value) OVER (ORDER BY value NULLS FIRST) AS prev_value FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9916
SELECT NTILE(0) OVER (ORDER BY value) AS bucket FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9917
SELECT LAG(value, -1) OVER (ORDER BY value) AS result FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9918
SELECT NTH_VALUE(value, 0) OVER (ORDER BY value) AS result FROM data;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (30), (NULL), (50);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (name STRING, score INT64);
INSERT INTO scores VALUES ('Alice', 90), ('Bob', NULL), ('Carol', 85), ('Dave', NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (20), (30);

-- Tag: window_functions_window_functions_operators_test_select_9919
SELECT value, LAG(value) OVER (ORDER BY value NULLS FIRST) AS prev_value FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9920
SELECT value, SUM(value) OVER (ORDER BY value ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS window_sum FROM data ORDER BY value;
-- Tag: window_functions_window_functions_operators_test_select_9921
SELECT name, score, RANK() OVER (ORDER BY score DESC NULLS LAST) AS rank FROM scores;
-- Tag: window_functions_window_functions_operators_test_select_9922
SELECT value, LAG(value) OVER (ORDER BY value NULLS FIRST) AS prev_value FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9923
SELECT NTILE(0) OVER (ORDER BY value) AS bucket FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9924
SELECT LAG(value, -1) OVER (ORDER BY value) AS result FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9925
SELECT NTH_VALUE(value, 0) OVER (ORDER BY value) AS result FROM data;

DROP TABLE IF EXISTS employees;
CREATE TABLE employees (id INT64, dept STRING, salary INT64);
INSERT INTO employees VALUES
(1, 'Eng', 100000), (2, 'Eng', 120000), (3, 'Sales', 80000), (4, 'Sales', 90000);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, region STRING, amount INT64);
INSERT INTO sales VALUES
(1, 'East', 1000), (2, 'East', 1200), (3, 'West', 900), (4, 'West', 1100);

-- Tag: window_functions_window_functions_operators_test_select_9926
SELECT * FROM (
-- Tag: window_functions_window_functions_operators_test_select_9927
SELECT id, dept, salary,
RANK() OVER (PARTITION BY dept ORDER BY salary DESC) as dept_rank
FROM employees
) ranked WHERE dept_rank = 1;
-- Tag: window_functions_window_functions_operators_test_select_9928
SELECT id, region, amount,
RANK() OVER (ORDER BY amount DESC) as overall_rank,
RANK() OVER (PARTITION BY region ORDER BY amount DESC) as region_rank,
ROW_NUMBER() OVER (ORDER BY id) as seq
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES (NULL, 1);
INSERT INTO data VALUES (NULL, 2);
INSERT INTO data VALUES ('A', 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (region STRING, dept STRING, value INT64);
INSERT INTO data VALUES ('East', 'Sales', 100);
INSERT INTO data VALUES ('East', 'Sales', 200);
INSERT INTO data VALUES ('East', 'Eng', 150);
INSERT INTO data VALUES ('West', 'Sales', 120);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 1);
INSERT INTO data VALUES ('A', 2);
INSERT INTO data VALUES ('B', 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES ('A', 100.0);
INSERT INTO sales VALUES ('A', 200.0);
INSERT INTO sales VALUES ('B', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount FLOAT64);
INSERT INTO sales VALUES ('East', 'A', 100.0);
INSERT INTO sales VALUES ('East', 'B', 200.0);
INSERT INTO sales VALUES ('West', 'A', 150.0);

-- Tag: window_functions_window_functions_operators_test_select_9929
SELECT category, value, \
ROW_NUMBER() OVER (PARTITION BY category ORDER BY value) as rn \
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9930
SELECT region, dept, value, \
ROW_NUMBER() OVER (PARTITION BY region, dept ORDER BY value) as rn \
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9931
SELECT value, ROW_NUMBER() OVER (ORDER BY value) as rn FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9932
SELECT value, \
SUM(value) OVER (ORDER BY value ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) \
as running_sum \
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9933
SELECT value, LAG(value) OVER (ORDER BY value) as prev FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9934
SELECT category, SUM(value) FROM data GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_9935
SELECT category, value, SUM(value) OVER (PARTITION BY category) as sum FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9936
SELECT id, category, \
ROW_NUMBER() OVER (PARTITION BY category ORDER BY id) as rn, \
RANK() OVER (PARTITION BY category ORDER BY id) as rank \
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9937
SELECT value, ROW_NUMBER() OVER (ORDER BY value) as rn \
FROM data \
WHERE value > 5;
-- Tag: window_functions_window_functions_operators_test_select_9938
SELECT product, SUM(amount) as total, \
RANK() OVER (ORDER BY SUM(amount) DESC) as rank \
FROM sales \
GROUP BY product \
HAVING RANK() OVER (ORDER BY SUM(amount) DESC) = 1;
-- Tag: window_functions_window_functions_operators_test_select_9939
SELECT region, product, amount, \
ROW_NUMBER() OVER (PARTITION BY region ORDER BY amount) as rn_region, \
ROW_NUMBER() OVER (PARTITION BY product ORDER BY amount) as rn_product, \
ROW_NUMBER() OVER (ORDER BY amount) as rn_overall \
FROM sales;

DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (NULL);
INSERT INTO data VALUES (10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (category STRING, value INT64);
INSERT INTO data VALUES ('A', 1);
INSERT INTO data VALUES ('A', 2);
INSERT INTO data VALUES ('B', 3);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, category INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product STRING, amount FLOAT64);
INSERT INTO sales VALUES ('A', 100.0);
INSERT INTO sales VALUES ('A', 200.0);
INSERT INTO sales VALUES ('B', 50.0);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (region STRING, product STRING, amount FLOAT64);
INSERT INTO sales VALUES ('East', 'A', 100.0);
INSERT INTO sales VALUES ('East', 'B', 200.0);
INSERT INTO sales VALUES ('West', 'A', 150.0);

-- Tag: window_functions_window_functions_operators_test_select_9940
SELECT value, \
SUM(value) OVER (ORDER BY value ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) \
as running_sum \
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9941
SELECT value, LAG(value) OVER (ORDER BY value) as prev FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9942
SELECT category, SUM(value) FROM data GROUP BY category;
-- Tag: window_functions_window_functions_operators_test_select_9943
SELECT category, value, SUM(value) OVER (PARTITION BY category) as sum FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9944
SELECT id, category, \
ROW_NUMBER() OVER (PARTITION BY category ORDER BY id) as rn, \
RANK() OVER (PARTITION BY category ORDER BY id) as rank \
FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9945
SELECT value, ROW_NUMBER() OVER (ORDER BY value) as rn \
FROM data \
WHERE value > 5;
-- Tag: window_functions_window_functions_operators_test_select_9946
SELECT product, SUM(amount) as total, \
RANK() OVER (ORDER BY SUM(amount) DESC) as rank \
FROM sales \
GROUP BY product \
HAVING RANK() OVER (ORDER BY SUM(amount) DESC) = 1;
-- Tag: window_functions_window_functions_operators_test_select_9947
SELECT region, product, amount, \
ROW_NUMBER() OVER (PARTITION BY region ORDER BY amount) as rn_region, \
ROW_NUMBER() OVER (PARTITION BY product ORDER BY amount) as rn_product, \
ROW_NUMBER() OVER (ORDER BY amount) as rn_overall \
FROM sales;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);

-- Tag: window_functions_window_functions_operators_test_select_9948
SELECT COUNT(*) FROM (SELECT id, RANK() OVER (ORDER BY value) AS rank FROM test) t;
-- Tag: window_functions_window_functions_operators_test_select_9949
SELECT id, \
RANK() OVER (ORDER BY value) AS rank, \
DENSE_RANK() OVER (ORDER BY value) AS dense_rank, \
LAG(value) OVER (ORDER BY id) AS prev, \
LEAD(value) OVER (ORDER BY id) AS next \
FROM test ORDER BY id;
-- Tag: window_functions_window_functions_operators_test_select_9950
SELECT * FROM (SELECT id, value, RANK() OVER (ORDER BY value DESC) AS rank FROM test) t WHERE rank <= 2;

DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 30);

-- Tag: window_functions_window_functions_operators_test_select_9951
SELECT * FROM (SELECT id, value, RANK() OVER (ORDER BY value DESC) AS rank FROM test) t WHERE rank <= 2;

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, amount INT64);
INSERT INTO sales VALUES (1, 100), (2, 150), (3, 120);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 100);

-- Tag: window_functions_window_functions_operators_test_select_9952
SELECT * FROM ( \
-- Tag: window_functions_window_functions_operators_test_select_9953
SELECT amount, RANK() OVER (ORDER BY amount DESC) as rank \
FROM sales \
) WHERE rank <= 2 \
ORDER BY rank;
-- Tag: window_functions_window_functions_operators_test_select_9954
SELECT RANK() OVER () as rank FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9955
SELECT LAG(value, -1) OVER (ORDER BY id) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9956
SELECT SUM(value) OVER (ORDER BY id) FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9957
SELECT RANK() OVER (ORDER BY value) as rank FROM data;
-- Tag: window_functions_window_functions_operators_test_select_9958
SELECT value, RANK() OVER (ORDER BY value) as rank FROM data;

