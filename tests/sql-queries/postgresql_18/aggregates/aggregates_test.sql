-- ============================================================================
-- Aggregates - PostgreSQL 18
-- ============================================================================
-- Source: Migrated from 19 test files
-- Description: Aggregate function operations and grouping
--
-- PostgreSQL: Full support
-- BigQuery: Limited or no support
-- SQL Standard: PostgreSQL 18 specific
-- ============================================================================

DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@EXAMPLE.com');
INSERT INTO users VALUES (2, 'Bob@Example.COM');
INSERT INTO users VALUES (3, 'charlie@test.org');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, sku STRING);
INSERT INTO products VALUES (1, 'ELEC-12345');
INSERT INTO products VALUES (2, 'elec-67890');
INSERT INTO products VALUES (3, 'FURN-11111');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1B2');
INSERT INTO codes VALUES (2, 'a1b2');
INSERT INTO codes VALUES (3, 'A12B');
INSERT INTO codes VALUES (4, 'a_b_');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, NULL);
DROP TABLE IF EXISTS international;
CREATE TABLE international (id INT64, name STRING);
INSERT INTO international VALUES (1, 'José');
INSERT INTO international VALUES (2, 'JOSÉ');
INSERT INTO international VALUES (3, 'josé');
INSERT INTO international VALUES (4, 'John');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, text STRING);
INSERT INTO strings VALUES (1, '');
INSERT INTO strings VALUES (2, 'hello');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report_2024.pdf');
INSERT INTO files VALUES (2, 'REPORT_2024.PDF');
INSERT INTO files VALUES (3, 'report_2023.pdf');
INSERT INTO files VALUES (4, 'summary_2024.pdf');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'user@example.com');
INSERT INTO users VALUES (2, 'USER@EXAMPLE.COM');
INSERT INTO users VALUES (3, 'user@test.org');
DROP TABLE IF EXISTS paths;
CREATE TABLE paths (id INT64, path STRING);
INSERT INTO paths VALUES (1, '/home/user/file.txt');
INSERT INTO paths VALUES (2, '/HOME/USER/FILE.TXT');
INSERT INTO paths VALUES (3, '/var/log/system.log');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ789');
INSERT INTO data VALUES (3, 'ABC');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
INSERT INTO products VALUES (1, 'Electronics');
INSERT INTO products VALUES (2, 'Furniture');
INSERT INTO products VALUES (3, 'Clothing');
INSERT INTO products VALUES (4, 'Food');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AB');
INSERT INTO codes VALUES (3, 'ABB');
INSERT INTO codes VALUES (4, 'ABBB');
INSERT INTO codes VALUES (5, 'AC');
DROP TABLE IF EXISTS ids;
CREATE TABLE ids (id INT64, identifier STRING);
INSERT INTO ids VALUES (1, 'ABC123');
INSERT INTO ids VALUES (2, 'XYZ456');
INSERT INTO ids VALUES (3, 'ABC');
INSERT INTO ids VALUES (4, '123456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, 'hello world');
INSERT INTO data VALUES (3, 'say hello');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
INSERT INTO users VALUES (3, 'charlie@test.org');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1');
INSERT INTO codes VALUES (2, 'A12');
INSERT INTO codes VALUES (3, 'B1');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '50%');
INSERT INTO data VALUES (2, '50percent');
INSERT INTO data VALUES (3, '100%');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, NULL);
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'document.pdf');
INSERT INTO files VALUES (2, 'image.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64, email STRING);
INSERT INTO contacts VALUES (1, 'user@example.com');
INSERT INTO contacts VALUES (2, 'invalid.email');
INSERT INTO contacts VALUES (3, 'test@test.org');
INSERT INTO contacts VALUES (4, '@invalid.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC');
INSERT INTO data VALUES (2, 'abc');
INSERT INTO data VALUES (3, 'AbC');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AA');
INSERT INTO codes VALUES (3, 'AAA');
INSERT INTO codes VALUES (4, 'AAAA');
INSERT INTO codes VALUES (5, 'AAAAA');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, category STRING);
INSERT INTO products VALUES (1, 'Laptop Dell', 'Electronics');
INSERT INTO products VALUES (2, 'LAPTOP HP', 'Electronics');
INSERT INTO products VALUES (3, 'Chair Oak', 'Furniture');
INSERT INTO products VALUES (4, 'laptop Lenovo', 'Electronics');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING, type STRING);
INSERT INTO files VALUES (1, 'doc1.pdf', 'document');
INSERT INTO files VALUES (2, 'img1.jpg', 'image');
INSERT INTO files VALUES (3, 'doc2.pdf', 'document');
INSERT INTO files VALUES (4, 'data.csv', 'data');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'alice@EXAMPLE.com', true);
INSERT INTO users VALUES (2, 'bob@EXAMPLE.com', false);
INSERT INTO users VALUES (3, 'charlie@test.org', true);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, user_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (101, 1, 100.0);
INSERT INTO orders VALUES (102, 3, 200.0);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'EMP[0-9]+');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (code_id INT64, code STRING);
INSERT INTO codes VALUES (1, 'EMP001');
INSERT INTO codes VALUES (2, 'EMP002');
INSERT INTO codes VALUES (3, 'MGR001');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report.PDF');
INSERT INTO files VALUES (2, 'image.JPG');
INSERT INTO files VALUES (3, 'data.CSV');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '');
INSERT INTO data VALUES (2, 'hello');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS names;
CREATE TABLE names (id INT64, name STRING);
INSERT INTO names VALUES (1, 'café');
INSERT INTO names VALUES (2, 'cafe\u{0301}');

SELECT id FROM users WHERE email ILIKE '%example.com%' ORDER BY id;
SELECT id FROM products WHERE sku ILIKE 'ELEC-%' ORDER BY id;
SELECT id FROM codes WHERE code ILIKE 'A_B_' ORDER BY id;
SELECT id FROM data WHERE text ILIKE '%HELLO%' ORDER BY id;
SELECT id FROM international WHERE name ILIKE 'josé' ORDER BY id;
SELECT id FROM strings WHERE text ILIKE '' ORDER BY id;
SELECT id FROM files WHERE filename ILIKE 'REPORT_____%.PDF' ORDER BY id;
SELECT id FROM users WHERE email NOT ILIKE '%EXAMPLE.COM%' ORDER BY id;
SELECT id FROM paths WHERE path ILIKE '/HOME/%' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC[0-9]+' ORDER BY id;
SELECT id FROM products WHERE category SIMILAR TO 'Electronics|Furniture' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'AB*' ORDER BY id;
SELECT id FROM ids WHERE identifier SIMILAR TO '[A-Z][A-Z][A-Z][0-9][0-9][0-9]' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'hello' ORDER BY id;
SELECT id FROM users WHERE email SIMILAR TO '%@example.com' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO '_1' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '50!%' ESCAPE '!' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'h%' ORDER BY id;
SELECT id FROM files WHERE filename NOT SIMILAR TO '%.pdf' ORDER BY id;
SELECT id FROM contacts WHERE email SIMILAR TO '%[a-z0-9]+@[a-z0-9]+\.[a-z][a-z]+' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'A{2,4}' ORDER BY id;
SELECT id FROM products WHERE name ILIKE '%laptop%' AND category = 'Electronics' ORDER BY id;
SELECT id FROM files WHERE filename SIMILAR TO 'doc[0-9]+.pdf' AND type IN ('document', 'archive') ORDER BY id;
SELECT order_id FROM orders WHERE user_id IN (SELECT id FROM users WHERE email ILIKE '%example.com%') ORDER BY order_id;
SELECT c.code_id FROM codes c, patterns p WHERE c.code SIMILAR TO p.pattern ORDER BY c.code_id;
SELECT id, CASE
WHEN filename ILIKE '%.pdf' THEN 'Document'
WHEN filename ILIKE '%.jpg' THEN 'Image'
ELSE 'Other'
END as file_type
FROM files
ORDER BY id;
SELECT id FROM logs WHERE message ILIKE '%needle%';
SELECT id FROM data WHERE text SIMILAR TO '' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '[a-z';
SELECT id FROM data WHERE text SIMILAR TO '%test%' ESCAPE 'AB';
SELECT id FROM names WHERE name ILIKE 'café' ORDER BY id;

-- ============================================================================
-- Test: test_ilike_wildcard_percent
-- Source: comparison_operators_advanced_tdd.rs:37
-- ============================================================================
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, sku STRING);
INSERT INTO products VALUES (1, 'ELEC-12345');
INSERT INTO products VALUES (2, 'elec-67890');
INSERT INTO products VALUES (3, 'FURN-11111');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1B2');
INSERT INTO codes VALUES (2, 'a1b2');
INSERT INTO codes VALUES (3, 'A12B');
INSERT INTO codes VALUES (4, 'a_b_');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, NULL);
DROP TABLE IF EXISTS international;
CREATE TABLE international (id INT64, name STRING);
INSERT INTO international VALUES (1, 'José');
INSERT INTO international VALUES (2, 'JOSÉ');
INSERT INTO international VALUES (3, 'josé');
INSERT INTO international VALUES (4, 'John');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, text STRING);
INSERT INTO strings VALUES (1, '');
INSERT INTO strings VALUES (2, 'hello');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report_2024.pdf');
INSERT INTO files VALUES (2, 'REPORT_2024.PDF');
INSERT INTO files VALUES (3, 'report_2023.pdf');
INSERT INTO files VALUES (4, 'summary_2024.pdf');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'user@example.com');
INSERT INTO users VALUES (2, 'USER@EXAMPLE.COM');
INSERT INTO users VALUES (3, 'user@test.org');
DROP TABLE IF EXISTS paths;
CREATE TABLE paths (id INT64, path STRING);
INSERT INTO paths VALUES (1, '/home/user/file.txt');
INSERT INTO paths VALUES (2, '/HOME/USER/FILE.TXT');
INSERT INTO paths VALUES (3, '/var/log/system.log');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ789');
INSERT INTO data VALUES (3, 'ABC');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
INSERT INTO products VALUES (1, 'Electronics');
INSERT INTO products VALUES (2, 'Furniture');
INSERT INTO products VALUES (3, 'Clothing');
INSERT INTO products VALUES (4, 'Food');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AB');
INSERT INTO codes VALUES (3, 'ABB');
INSERT INTO codes VALUES (4, 'ABBB');
INSERT INTO codes VALUES (5, 'AC');
DROP TABLE IF EXISTS ids;
CREATE TABLE ids (id INT64, identifier STRING);
INSERT INTO ids VALUES (1, 'ABC123');
INSERT INTO ids VALUES (2, 'XYZ456');
INSERT INTO ids VALUES (3, 'ABC');
INSERT INTO ids VALUES (4, '123456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, 'hello world');
INSERT INTO data VALUES (3, 'say hello');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
INSERT INTO users VALUES (3, 'charlie@test.org');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1');
INSERT INTO codes VALUES (2, 'A12');
INSERT INTO codes VALUES (3, 'B1');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '50%');
INSERT INTO data VALUES (2, '50percent');
INSERT INTO data VALUES (3, '100%');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, NULL);
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'document.pdf');
INSERT INTO files VALUES (2, 'image.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64, email STRING);
INSERT INTO contacts VALUES (1, 'user@example.com');
INSERT INTO contacts VALUES (2, 'invalid.email');
INSERT INTO contacts VALUES (3, 'test@test.org');
INSERT INTO contacts VALUES (4, '@invalid.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC');
INSERT INTO data VALUES (2, 'abc');
INSERT INTO data VALUES (3, 'AbC');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AA');
INSERT INTO codes VALUES (3, 'AAA');
INSERT INTO codes VALUES (4, 'AAAA');
INSERT INTO codes VALUES (5, 'AAAAA');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, category STRING);
INSERT INTO products VALUES (1, 'Laptop Dell', 'Electronics');
INSERT INTO products VALUES (2, 'LAPTOP HP', 'Electronics');
INSERT INTO products VALUES (3, 'Chair Oak', 'Furniture');
INSERT INTO products VALUES (4, 'laptop Lenovo', 'Electronics');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING, type STRING);
INSERT INTO files VALUES (1, 'doc1.pdf', 'document');
INSERT INTO files VALUES (2, 'img1.jpg', 'image');
INSERT INTO files VALUES (3, 'doc2.pdf', 'document');
INSERT INTO files VALUES (4, 'data.csv', 'data');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'alice@EXAMPLE.com', true);
INSERT INTO users VALUES (2, 'bob@EXAMPLE.com', false);
INSERT INTO users VALUES (3, 'charlie@test.org', true);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, user_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (101, 1, 100.0);
INSERT INTO orders VALUES (102, 3, 200.0);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'EMP[0-9]+');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (code_id INT64, code STRING);
INSERT INTO codes VALUES (1, 'EMP001');
INSERT INTO codes VALUES (2, 'EMP002');
INSERT INTO codes VALUES (3, 'MGR001');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report.PDF');
INSERT INTO files VALUES (2, 'image.JPG');
INSERT INTO files VALUES (3, 'data.CSV');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '');
INSERT INTO data VALUES (2, 'hello');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS names;
CREATE TABLE names (id INT64, name STRING);
INSERT INTO names VALUES (1, 'café');
INSERT INTO names VALUES (2, 'cafe\u{0301}');

SELECT id FROM products WHERE sku ILIKE 'ELEC-%' ORDER BY id;
SELECT id FROM codes WHERE code ILIKE 'A_B_' ORDER BY id;
SELECT id FROM data WHERE text ILIKE '%HELLO%' ORDER BY id;
SELECT id FROM international WHERE name ILIKE 'josé' ORDER BY id;
SELECT id FROM strings WHERE text ILIKE '' ORDER BY id;
SELECT id FROM files WHERE filename ILIKE 'REPORT_____%.PDF' ORDER BY id;
SELECT id FROM users WHERE email NOT ILIKE '%EXAMPLE.COM%' ORDER BY id;
SELECT id FROM paths WHERE path ILIKE '/HOME/%' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC[0-9]+' ORDER BY id;
SELECT id FROM products WHERE category SIMILAR TO 'Electronics|Furniture' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'AB*' ORDER BY id;
SELECT id FROM ids WHERE identifier SIMILAR TO '[A-Z][A-Z][A-Z][0-9][0-9][0-9]' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'hello' ORDER BY id;
SELECT id FROM users WHERE email SIMILAR TO '%@example.com' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO '_1' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '50!%' ESCAPE '!' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'h%' ORDER BY id;
SELECT id FROM files WHERE filename NOT SIMILAR TO '%.pdf' ORDER BY id;
SELECT id FROM contacts WHERE email SIMILAR TO '%[a-z0-9]+@[a-z0-9]+\.[a-z][a-z]+' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'A{2,4}' ORDER BY id;
SELECT id FROM products WHERE name ILIKE '%laptop%' AND category = 'Electronics' ORDER BY id;
SELECT id FROM files WHERE filename SIMILAR TO 'doc[0-9]+.pdf' AND type IN ('document', 'archive') ORDER BY id;
SELECT order_id FROM orders WHERE user_id IN (SELECT id FROM users WHERE email ILIKE '%example.com%') ORDER BY order_id;
SELECT c.code_id FROM codes c, patterns p WHERE c.code SIMILAR TO p.pattern ORDER BY c.code_id;
SELECT id, CASE
WHEN filename ILIKE '%.pdf' THEN 'Document'
WHEN filename ILIKE '%.jpg' THEN 'Image'
ELSE 'Other'
END as file_type
FROM files
ORDER BY id;
SELECT id FROM logs WHERE message ILIKE '%needle%';
SELECT id FROM data WHERE text SIMILAR TO '' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '[a-z';
SELECT id FROM data WHERE text SIMILAR TO '%test%' ESCAPE 'AB';
SELECT id FROM names WHERE name ILIKE 'café' ORDER BY id;

-- ============================================================================
-- Test: test_ilike_wildcard_underscore
-- Source: comparison_operators_advanced_tdd.rs:61
-- ============================================================================
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1B2');
INSERT INTO codes VALUES (2, 'a1b2');
INSERT INTO codes VALUES (3, 'A12B');
INSERT INTO codes VALUES (4, 'a_b_');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, NULL);
DROP TABLE IF EXISTS international;
CREATE TABLE international (id INT64, name STRING);
INSERT INTO international VALUES (1, 'José');
INSERT INTO international VALUES (2, 'JOSÉ');
INSERT INTO international VALUES (3, 'josé');
INSERT INTO international VALUES (4, 'John');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, text STRING);
INSERT INTO strings VALUES (1, '');
INSERT INTO strings VALUES (2, 'hello');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report_2024.pdf');
INSERT INTO files VALUES (2, 'REPORT_2024.PDF');
INSERT INTO files VALUES (3, 'report_2023.pdf');
INSERT INTO files VALUES (4, 'summary_2024.pdf');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'user@example.com');
INSERT INTO users VALUES (2, 'USER@EXAMPLE.COM');
INSERT INTO users VALUES (3, 'user@test.org');
DROP TABLE IF EXISTS paths;
CREATE TABLE paths (id INT64, path STRING);
INSERT INTO paths VALUES (1, '/home/user/file.txt');
INSERT INTO paths VALUES (2, '/HOME/USER/FILE.TXT');
INSERT INTO paths VALUES (3, '/var/log/system.log');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ789');
INSERT INTO data VALUES (3, 'ABC');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
INSERT INTO products VALUES (1, 'Electronics');
INSERT INTO products VALUES (2, 'Furniture');
INSERT INTO products VALUES (3, 'Clothing');
INSERT INTO products VALUES (4, 'Food');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AB');
INSERT INTO codes VALUES (3, 'ABB');
INSERT INTO codes VALUES (4, 'ABBB');
INSERT INTO codes VALUES (5, 'AC');
DROP TABLE IF EXISTS ids;
CREATE TABLE ids (id INT64, identifier STRING);
INSERT INTO ids VALUES (1, 'ABC123');
INSERT INTO ids VALUES (2, 'XYZ456');
INSERT INTO ids VALUES (3, 'ABC');
INSERT INTO ids VALUES (4, '123456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, 'hello world');
INSERT INTO data VALUES (3, 'say hello');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
INSERT INTO users VALUES (3, 'charlie@test.org');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1');
INSERT INTO codes VALUES (2, 'A12');
INSERT INTO codes VALUES (3, 'B1');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '50%');
INSERT INTO data VALUES (2, '50percent');
INSERT INTO data VALUES (3, '100%');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, NULL);
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'document.pdf');
INSERT INTO files VALUES (2, 'image.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64, email STRING);
INSERT INTO contacts VALUES (1, 'user@example.com');
INSERT INTO contacts VALUES (2, 'invalid.email');
INSERT INTO contacts VALUES (3, 'test@test.org');
INSERT INTO contacts VALUES (4, '@invalid.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC');
INSERT INTO data VALUES (2, 'abc');
INSERT INTO data VALUES (3, 'AbC');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AA');
INSERT INTO codes VALUES (3, 'AAA');
INSERT INTO codes VALUES (4, 'AAAA');
INSERT INTO codes VALUES (5, 'AAAAA');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, category STRING);
INSERT INTO products VALUES (1, 'Laptop Dell', 'Electronics');
INSERT INTO products VALUES (2, 'LAPTOP HP', 'Electronics');
INSERT INTO products VALUES (3, 'Chair Oak', 'Furniture');
INSERT INTO products VALUES (4, 'laptop Lenovo', 'Electronics');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING, type STRING);
INSERT INTO files VALUES (1, 'doc1.pdf', 'document');
INSERT INTO files VALUES (2, 'img1.jpg', 'image');
INSERT INTO files VALUES (3, 'doc2.pdf', 'document');
INSERT INTO files VALUES (4, 'data.csv', 'data');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'alice@EXAMPLE.com', true);
INSERT INTO users VALUES (2, 'bob@EXAMPLE.com', false);
INSERT INTO users VALUES (3, 'charlie@test.org', true);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, user_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (101, 1, 100.0);
INSERT INTO orders VALUES (102, 3, 200.0);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'EMP[0-9]+');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (code_id INT64, code STRING);
INSERT INTO codes VALUES (1, 'EMP001');
INSERT INTO codes VALUES (2, 'EMP002');
INSERT INTO codes VALUES (3, 'MGR001');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report.PDF');
INSERT INTO files VALUES (2, 'image.JPG');
INSERT INTO files VALUES (3, 'data.CSV');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '');
INSERT INTO data VALUES (2, 'hello');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS names;
CREATE TABLE names (id INT64, name STRING);
INSERT INTO names VALUES (1, 'café');
INSERT INTO names VALUES (2, 'cafe\u{0301}');

SELECT id FROM codes WHERE code ILIKE 'A_B_' ORDER BY id;
SELECT id FROM data WHERE text ILIKE '%HELLO%' ORDER BY id;
SELECT id FROM international WHERE name ILIKE 'josé' ORDER BY id;
SELECT id FROM strings WHERE text ILIKE '' ORDER BY id;
SELECT id FROM files WHERE filename ILIKE 'REPORT_____%.PDF' ORDER BY id;
SELECT id FROM users WHERE email NOT ILIKE '%EXAMPLE.COM%' ORDER BY id;
SELECT id FROM paths WHERE path ILIKE '/HOME/%' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC[0-9]+' ORDER BY id;
SELECT id FROM products WHERE category SIMILAR TO 'Electronics|Furniture' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'AB*' ORDER BY id;
SELECT id FROM ids WHERE identifier SIMILAR TO '[A-Z][A-Z][A-Z][0-9][0-9][0-9]' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'hello' ORDER BY id;
SELECT id FROM users WHERE email SIMILAR TO '%@example.com' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO '_1' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '50!%' ESCAPE '!' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'h%' ORDER BY id;
SELECT id FROM files WHERE filename NOT SIMILAR TO '%.pdf' ORDER BY id;
SELECT id FROM contacts WHERE email SIMILAR TO '%[a-z0-9]+@[a-z0-9]+\.[a-z][a-z]+' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'A{2,4}' ORDER BY id;
SELECT id FROM products WHERE name ILIKE '%laptop%' AND category = 'Electronics' ORDER BY id;
SELECT id FROM files WHERE filename SIMILAR TO 'doc[0-9]+.pdf' AND type IN ('document', 'archive') ORDER BY id;
SELECT order_id FROM orders WHERE user_id IN (SELECT id FROM users WHERE email ILIKE '%example.com%') ORDER BY order_id;
SELECT c.code_id FROM codes c, patterns p WHERE c.code SIMILAR TO p.pattern ORDER BY c.code_id;
SELECT id, CASE
WHEN filename ILIKE '%.pdf' THEN 'Document'
WHEN filename ILIKE '%.jpg' THEN 'Image'
ELSE 'Other'
END as file_type
FROM files
ORDER BY id;
SELECT id FROM logs WHERE message ILIKE '%needle%';
SELECT id FROM data WHERE text SIMILAR TO '' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '[a-z';
SELECT id FROM data WHERE text SIMILAR TO '%test%' ESCAPE 'AB';
SELECT id FROM names WHERE name ILIKE 'café' ORDER BY id;

-- ============================================================================
-- Test: test_ilike_null_handling
-- Source: comparison_operators_advanced_tdd.rs:88
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, NULL);
DROP TABLE IF EXISTS international;
CREATE TABLE international (id INT64, name STRING);
INSERT INTO international VALUES (1, 'José');
INSERT INTO international VALUES (2, 'JOSÉ');
INSERT INTO international VALUES (3, 'josé');
INSERT INTO international VALUES (4, 'John');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, text STRING);
INSERT INTO strings VALUES (1, '');
INSERT INTO strings VALUES (2, 'hello');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report_2024.pdf');
INSERT INTO files VALUES (2, 'REPORT_2024.PDF');
INSERT INTO files VALUES (3, 'report_2023.pdf');
INSERT INTO files VALUES (4, 'summary_2024.pdf');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'user@example.com');
INSERT INTO users VALUES (2, 'USER@EXAMPLE.COM');
INSERT INTO users VALUES (3, 'user@test.org');
DROP TABLE IF EXISTS paths;
CREATE TABLE paths (id INT64, path STRING);
INSERT INTO paths VALUES (1, '/home/user/file.txt');
INSERT INTO paths VALUES (2, '/HOME/USER/FILE.TXT');
INSERT INTO paths VALUES (3, '/var/log/system.log');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ789');
INSERT INTO data VALUES (3, 'ABC');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
INSERT INTO products VALUES (1, 'Electronics');
INSERT INTO products VALUES (2, 'Furniture');
INSERT INTO products VALUES (3, 'Clothing');
INSERT INTO products VALUES (4, 'Food');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AB');
INSERT INTO codes VALUES (3, 'ABB');
INSERT INTO codes VALUES (4, 'ABBB');
INSERT INTO codes VALUES (5, 'AC');
DROP TABLE IF EXISTS ids;
CREATE TABLE ids (id INT64, identifier STRING);
INSERT INTO ids VALUES (1, 'ABC123');
INSERT INTO ids VALUES (2, 'XYZ456');
INSERT INTO ids VALUES (3, 'ABC');
INSERT INTO ids VALUES (4, '123456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, 'hello world');
INSERT INTO data VALUES (3, 'say hello');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
INSERT INTO users VALUES (3, 'charlie@test.org');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1');
INSERT INTO codes VALUES (2, 'A12');
INSERT INTO codes VALUES (3, 'B1');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '50%');
INSERT INTO data VALUES (2, '50percent');
INSERT INTO data VALUES (3, '100%');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, NULL);
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'document.pdf');
INSERT INTO files VALUES (2, 'image.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64, email STRING);
INSERT INTO contacts VALUES (1, 'user@example.com');
INSERT INTO contacts VALUES (2, 'invalid.email');
INSERT INTO contacts VALUES (3, 'test@test.org');
INSERT INTO contacts VALUES (4, '@invalid.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC');
INSERT INTO data VALUES (2, 'abc');
INSERT INTO data VALUES (3, 'AbC');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AA');
INSERT INTO codes VALUES (3, 'AAA');
INSERT INTO codes VALUES (4, 'AAAA');
INSERT INTO codes VALUES (5, 'AAAAA');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, category STRING);
INSERT INTO products VALUES (1, 'Laptop Dell', 'Electronics');
INSERT INTO products VALUES (2, 'LAPTOP HP', 'Electronics');
INSERT INTO products VALUES (3, 'Chair Oak', 'Furniture');
INSERT INTO products VALUES (4, 'laptop Lenovo', 'Electronics');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING, type STRING);
INSERT INTO files VALUES (1, 'doc1.pdf', 'document');
INSERT INTO files VALUES (2, 'img1.jpg', 'image');
INSERT INTO files VALUES (3, 'doc2.pdf', 'document');
INSERT INTO files VALUES (4, 'data.csv', 'data');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'alice@EXAMPLE.com', true);
INSERT INTO users VALUES (2, 'bob@EXAMPLE.com', false);
INSERT INTO users VALUES (3, 'charlie@test.org', true);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, user_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (101, 1, 100.0);
INSERT INTO orders VALUES (102, 3, 200.0);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'EMP[0-9]+');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (code_id INT64, code STRING);
INSERT INTO codes VALUES (1, 'EMP001');
INSERT INTO codes VALUES (2, 'EMP002');
INSERT INTO codes VALUES (3, 'MGR001');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report.PDF');
INSERT INTO files VALUES (2, 'image.JPG');
INSERT INTO files VALUES (3, 'data.CSV');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '');
INSERT INTO data VALUES (2, 'hello');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS names;
CREATE TABLE names (id INT64, name STRING);
INSERT INTO names VALUES (1, 'café');
INSERT INTO names VALUES (2, 'cafe\u{0301}');

SELECT id FROM data WHERE text ILIKE '%HELLO%' ORDER BY id;
SELECT id FROM international WHERE name ILIKE 'josé' ORDER BY id;
SELECT id FROM strings WHERE text ILIKE '' ORDER BY id;
SELECT id FROM files WHERE filename ILIKE 'REPORT_____%.PDF' ORDER BY id;
SELECT id FROM users WHERE email NOT ILIKE '%EXAMPLE.COM%' ORDER BY id;
SELECT id FROM paths WHERE path ILIKE '/HOME/%' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC[0-9]+' ORDER BY id;
SELECT id FROM products WHERE category SIMILAR TO 'Electronics|Furniture' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'AB*' ORDER BY id;
SELECT id FROM ids WHERE identifier SIMILAR TO '[A-Z][A-Z][A-Z][0-9][0-9][0-9]' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'hello' ORDER BY id;
SELECT id FROM users WHERE email SIMILAR TO '%@example.com' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO '_1' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '50!%' ESCAPE '!' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'h%' ORDER BY id;
SELECT id FROM files WHERE filename NOT SIMILAR TO '%.pdf' ORDER BY id;
SELECT id FROM contacts WHERE email SIMILAR TO '%[a-z0-9]+@[a-z0-9]+\.[a-z][a-z]+' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'A{2,4}' ORDER BY id;
SELECT id FROM products WHERE name ILIKE '%laptop%' AND category = 'Electronics' ORDER BY id;
SELECT id FROM files WHERE filename SIMILAR TO 'doc[0-9]+.pdf' AND type IN ('document', 'archive') ORDER BY id;
SELECT order_id FROM orders WHERE user_id IN (SELECT id FROM users WHERE email ILIKE '%example.com%') ORDER BY order_id;
SELECT c.code_id FROM codes c, patterns p WHERE c.code SIMILAR TO p.pattern ORDER BY c.code_id;
SELECT id, CASE
WHEN filename ILIKE '%.pdf' THEN 'Document'
WHEN filename ILIKE '%.jpg' THEN 'Image'
ELSE 'Other'
END as file_type
FROM files
ORDER BY id;
SELECT id FROM logs WHERE message ILIKE '%needle%';
SELECT id FROM data WHERE text SIMILAR TO '' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '[a-z';
SELECT id FROM data WHERE text SIMILAR TO '%test%' ESCAPE 'AB';
SELECT id FROM names WHERE name ILIKE 'café' ORDER BY id;

-- ============================================================================
-- Test: test_ilike_unicode_case_insensitive
-- Source: comparison_operators_advanced_tdd.rs:109
-- ============================================================================
DROP TABLE IF EXISTS international;
CREATE TABLE international (id INT64, name STRING);
INSERT INTO international VALUES (1, 'José');
INSERT INTO international VALUES (2, 'JOSÉ');
INSERT INTO international VALUES (3, 'josé');
INSERT INTO international VALUES (4, 'John');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, text STRING);
INSERT INTO strings VALUES (1, '');
INSERT INTO strings VALUES (2, 'hello');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report_2024.pdf');
INSERT INTO files VALUES (2, 'REPORT_2024.PDF');
INSERT INTO files VALUES (3, 'report_2023.pdf');
INSERT INTO files VALUES (4, 'summary_2024.pdf');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'user@example.com');
INSERT INTO users VALUES (2, 'USER@EXAMPLE.COM');
INSERT INTO users VALUES (3, 'user@test.org');
DROP TABLE IF EXISTS paths;
CREATE TABLE paths (id INT64, path STRING);
INSERT INTO paths VALUES (1, '/home/user/file.txt');
INSERT INTO paths VALUES (2, '/HOME/USER/FILE.TXT');
INSERT INTO paths VALUES (3, '/var/log/system.log');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ789');
INSERT INTO data VALUES (3, 'ABC');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
INSERT INTO products VALUES (1, 'Electronics');
INSERT INTO products VALUES (2, 'Furniture');
INSERT INTO products VALUES (3, 'Clothing');
INSERT INTO products VALUES (4, 'Food');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AB');
INSERT INTO codes VALUES (3, 'ABB');
INSERT INTO codes VALUES (4, 'ABBB');
INSERT INTO codes VALUES (5, 'AC');
DROP TABLE IF EXISTS ids;
CREATE TABLE ids (id INT64, identifier STRING);
INSERT INTO ids VALUES (1, 'ABC123');
INSERT INTO ids VALUES (2, 'XYZ456');
INSERT INTO ids VALUES (3, 'ABC');
INSERT INTO ids VALUES (4, '123456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, 'hello world');
INSERT INTO data VALUES (3, 'say hello');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
INSERT INTO users VALUES (3, 'charlie@test.org');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1');
INSERT INTO codes VALUES (2, 'A12');
INSERT INTO codes VALUES (3, 'B1');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '50%');
INSERT INTO data VALUES (2, '50percent');
INSERT INTO data VALUES (3, '100%');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, NULL);
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'document.pdf');
INSERT INTO files VALUES (2, 'image.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64, email STRING);
INSERT INTO contacts VALUES (1, 'user@example.com');
INSERT INTO contacts VALUES (2, 'invalid.email');
INSERT INTO contacts VALUES (3, 'test@test.org');
INSERT INTO contacts VALUES (4, '@invalid.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC');
INSERT INTO data VALUES (2, 'abc');
INSERT INTO data VALUES (3, 'AbC');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AA');
INSERT INTO codes VALUES (3, 'AAA');
INSERT INTO codes VALUES (4, 'AAAA');
INSERT INTO codes VALUES (5, 'AAAAA');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, category STRING);
INSERT INTO products VALUES (1, 'Laptop Dell', 'Electronics');
INSERT INTO products VALUES (2, 'LAPTOP HP', 'Electronics');
INSERT INTO products VALUES (3, 'Chair Oak', 'Furniture');
INSERT INTO products VALUES (4, 'laptop Lenovo', 'Electronics');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING, type STRING);
INSERT INTO files VALUES (1, 'doc1.pdf', 'document');
INSERT INTO files VALUES (2, 'img1.jpg', 'image');
INSERT INTO files VALUES (3, 'doc2.pdf', 'document');
INSERT INTO files VALUES (4, 'data.csv', 'data');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'alice@EXAMPLE.com', true);
INSERT INTO users VALUES (2, 'bob@EXAMPLE.com', false);
INSERT INTO users VALUES (3, 'charlie@test.org', true);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, user_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (101, 1, 100.0);
INSERT INTO orders VALUES (102, 3, 200.0);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'EMP[0-9]+');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (code_id INT64, code STRING);
INSERT INTO codes VALUES (1, 'EMP001');
INSERT INTO codes VALUES (2, 'EMP002');
INSERT INTO codes VALUES (3, 'MGR001');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report.PDF');
INSERT INTO files VALUES (2, 'image.JPG');
INSERT INTO files VALUES (3, 'data.CSV');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '');
INSERT INTO data VALUES (2, 'hello');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS names;
CREATE TABLE names (id INT64, name STRING);
INSERT INTO names VALUES (1, 'café');
INSERT INTO names VALUES (2, 'cafe\u{0301}');

SELECT id FROM international WHERE name ILIKE 'josé' ORDER BY id;
SELECT id FROM strings WHERE text ILIKE '' ORDER BY id;
SELECT id FROM files WHERE filename ILIKE 'REPORT_____%.PDF' ORDER BY id;
SELECT id FROM users WHERE email NOT ILIKE '%EXAMPLE.COM%' ORDER BY id;
SELECT id FROM paths WHERE path ILIKE '/HOME/%' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC[0-9]+' ORDER BY id;
SELECT id FROM products WHERE category SIMILAR TO 'Electronics|Furniture' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'AB*' ORDER BY id;
SELECT id FROM ids WHERE identifier SIMILAR TO '[A-Z][A-Z][A-Z][0-9][0-9][0-9]' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'hello' ORDER BY id;
SELECT id FROM users WHERE email SIMILAR TO '%@example.com' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO '_1' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '50!%' ESCAPE '!' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'h%' ORDER BY id;
SELECT id FROM files WHERE filename NOT SIMILAR TO '%.pdf' ORDER BY id;
SELECT id FROM contacts WHERE email SIMILAR TO '%[a-z0-9]+@[a-z0-9]+\.[a-z][a-z]+' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'A{2,4}' ORDER BY id;
SELECT id FROM products WHERE name ILIKE '%laptop%' AND category = 'Electronics' ORDER BY id;
SELECT id FROM files WHERE filename SIMILAR TO 'doc[0-9]+.pdf' AND type IN ('document', 'archive') ORDER BY id;
SELECT order_id FROM orders WHERE user_id IN (SELECT id FROM users WHERE email ILIKE '%example.com%') ORDER BY order_id;
SELECT c.code_id FROM codes c, patterns p WHERE c.code SIMILAR TO p.pattern ORDER BY c.code_id;
SELECT id, CASE
WHEN filename ILIKE '%.pdf' THEN 'Document'
WHEN filename ILIKE '%.jpg' THEN 'Image'
ELSE 'Other'
END as file_type
FROM files
ORDER BY id;
SELECT id FROM logs WHERE message ILIKE '%needle%';
SELECT id FROM data WHERE text SIMILAR TO '' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '[a-z';
SELECT id FROM data WHERE text SIMILAR TO '%test%' ESCAPE 'AB';
SELECT id FROM names WHERE name ILIKE 'café' ORDER BY id;

-- ============================================================================
-- Test: test_ilike_empty_string
-- Source: comparison_operators_advanced_tdd.rs:136
-- ============================================================================
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, text STRING);
INSERT INTO strings VALUES (1, '');
INSERT INTO strings VALUES (2, 'hello');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report_2024.pdf');
INSERT INTO files VALUES (2, 'REPORT_2024.PDF');
INSERT INTO files VALUES (3, 'report_2023.pdf');
INSERT INTO files VALUES (4, 'summary_2024.pdf');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'user@example.com');
INSERT INTO users VALUES (2, 'USER@EXAMPLE.COM');
INSERT INTO users VALUES (3, 'user@test.org');
DROP TABLE IF EXISTS paths;
CREATE TABLE paths (id INT64, path STRING);
INSERT INTO paths VALUES (1, '/home/user/file.txt');
INSERT INTO paths VALUES (2, '/HOME/USER/FILE.TXT');
INSERT INTO paths VALUES (3, '/var/log/system.log');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ789');
INSERT INTO data VALUES (3, 'ABC');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
INSERT INTO products VALUES (1, 'Electronics');
INSERT INTO products VALUES (2, 'Furniture');
INSERT INTO products VALUES (3, 'Clothing');
INSERT INTO products VALUES (4, 'Food');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AB');
INSERT INTO codes VALUES (3, 'ABB');
INSERT INTO codes VALUES (4, 'ABBB');
INSERT INTO codes VALUES (5, 'AC');
DROP TABLE IF EXISTS ids;
CREATE TABLE ids (id INT64, identifier STRING);
INSERT INTO ids VALUES (1, 'ABC123');
INSERT INTO ids VALUES (2, 'XYZ456');
INSERT INTO ids VALUES (3, 'ABC');
INSERT INTO ids VALUES (4, '123456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, 'hello world');
INSERT INTO data VALUES (3, 'say hello');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
INSERT INTO users VALUES (3, 'charlie@test.org');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1');
INSERT INTO codes VALUES (2, 'A12');
INSERT INTO codes VALUES (3, 'B1');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '50%');
INSERT INTO data VALUES (2, '50percent');
INSERT INTO data VALUES (3, '100%');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, NULL);
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'document.pdf');
INSERT INTO files VALUES (2, 'image.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64, email STRING);
INSERT INTO contacts VALUES (1, 'user@example.com');
INSERT INTO contacts VALUES (2, 'invalid.email');
INSERT INTO contacts VALUES (3, 'test@test.org');
INSERT INTO contacts VALUES (4, '@invalid.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC');
INSERT INTO data VALUES (2, 'abc');
INSERT INTO data VALUES (3, 'AbC');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AA');
INSERT INTO codes VALUES (3, 'AAA');
INSERT INTO codes VALUES (4, 'AAAA');
INSERT INTO codes VALUES (5, 'AAAAA');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, category STRING);
INSERT INTO products VALUES (1, 'Laptop Dell', 'Electronics');
INSERT INTO products VALUES (2, 'LAPTOP HP', 'Electronics');
INSERT INTO products VALUES (3, 'Chair Oak', 'Furniture');
INSERT INTO products VALUES (4, 'laptop Lenovo', 'Electronics');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING, type STRING);
INSERT INTO files VALUES (1, 'doc1.pdf', 'document');
INSERT INTO files VALUES (2, 'img1.jpg', 'image');
INSERT INTO files VALUES (3, 'doc2.pdf', 'document');
INSERT INTO files VALUES (4, 'data.csv', 'data');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'alice@EXAMPLE.com', true);
INSERT INTO users VALUES (2, 'bob@EXAMPLE.com', false);
INSERT INTO users VALUES (3, 'charlie@test.org', true);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, user_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (101, 1, 100.0);
INSERT INTO orders VALUES (102, 3, 200.0);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'EMP[0-9]+');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (code_id INT64, code STRING);
INSERT INTO codes VALUES (1, 'EMP001');
INSERT INTO codes VALUES (2, 'EMP002');
INSERT INTO codes VALUES (3, 'MGR001');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report.PDF');
INSERT INTO files VALUES (2, 'image.JPG');
INSERT INTO files VALUES (3, 'data.CSV');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '');
INSERT INTO data VALUES (2, 'hello');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS names;
CREATE TABLE names (id INT64, name STRING);
INSERT INTO names VALUES (1, 'café');
INSERT INTO names VALUES (2, 'cafe\u{0301}');

SELECT id FROM strings WHERE text ILIKE '' ORDER BY id;
SELECT id FROM files WHERE filename ILIKE 'REPORT_____%.PDF' ORDER BY id;
SELECT id FROM users WHERE email NOT ILIKE '%EXAMPLE.COM%' ORDER BY id;
SELECT id FROM paths WHERE path ILIKE '/HOME/%' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC[0-9]+' ORDER BY id;
SELECT id FROM products WHERE category SIMILAR TO 'Electronics|Furniture' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'AB*' ORDER BY id;
SELECT id FROM ids WHERE identifier SIMILAR TO '[A-Z][A-Z][A-Z][0-9][0-9][0-9]' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'hello' ORDER BY id;
SELECT id FROM users WHERE email SIMILAR TO '%@example.com' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO '_1' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '50!%' ESCAPE '!' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'h%' ORDER BY id;
SELECT id FROM files WHERE filename NOT SIMILAR TO '%.pdf' ORDER BY id;
SELECT id FROM contacts WHERE email SIMILAR TO '%[a-z0-9]+@[a-z0-9]+\.[a-z][a-z]+' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'A{2,4}' ORDER BY id;
SELECT id FROM products WHERE name ILIKE '%laptop%' AND category = 'Electronics' ORDER BY id;
SELECT id FROM files WHERE filename SIMILAR TO 'doc[0-9]+.pdf' AND type IN ('document', 'archive') ORDER BY id;
SELECT order_id FROM orders WHERE user_id IN (SELECT id FROM users WHERE email ILIKE '%example.com%') ORDER BY order_id;
SELECT c.code_id FROM codes c, patterns p WHERE c.code SIMILAR TO p.pattern ORDER BY c.code_id;
SELECT id, CASE
WHEN filename ILIKE '%.pdf' THEN 'Document'
WHEN filename ILIKE '%.jpg' THEN 'Image'
ELSE 'Other'
END as file_type
FROM files
ORDER BY id;
SELECT id FROM logs WHERE message ILIKE '%needle%';
SELECT id FROM data WHERE text SIMILAR TO '' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '[a-z';
SELECT id FROM data WHERE text SIMILAR TO '%test%' ESCAPE 'AB';
SELECT id FROM names WHERE name ILIKE 'café' ORDER BY id;

-- ============================================================================
-- Test: test_ilike_complex_pattern
-- Source: comparison_operators_advanced_tdd.rs:157
-- ============================================================================
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report_2024.pdf');
INSERT INTO files VALUES (2, 'REPORT_2024.PDF');
INSERT INTO files VALUES (3, 'report_2023.pdf');
INSERT INTO files VALUES (4, 'summary_2024.pdf');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'user@example.com');
INSERT INTO users VALUES (2, 'USER@EXAMPLE.COM');
INSERT INTO users VALUES (3, 'user@test.org');
DROP TABLE IF EXISTS paths;
CREATE TABLE paths (id INT64, path STRING);
INSERT INTO paths VALUES (1, '/home/user/file.txt');
INSERT INTO paths VALUES (2, '/HOME/USER/FILE.TXT');
INSERT INTO paths VALUES (3, '/var/log/system.log');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC123');
INSERT INTO data VALUES (2, 'XYZ789');
INSERT INTO data VALUES (3, 'ABC');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, category STRING);
INSERT INTO products VALUES (1, 'Electronics');
INSERT INTO products VALUES (2, 'Furniture');
INSERT INTO products VALUES (3, 'Clothing');
INSERT INTO products VALUES (4, 'Food');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AB');
INSERT INTO codes VALUES (3, 'ABB');
INSERT INTO codes VALUES (4, 'ABBB');
INSERT INTO codes VALUES (5, 'AC');
DROP TABLE IF EXISTS ids;
CREATE TABLE ids (id INT64, identifier STRING);
INSERT INTO ids VALUES (1, 'ABC123');
INSERT INTO ids VALUES (2, 'XYZ456');
INSERT INTO ids VALUES (3, 'ABC');
INSERT INTO ids VALUES (4, '123456');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, 'hello world');
INSERT INTO data VALUES (3, 'say hello');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@example.com');
INSERT INTO users VALUES (3, 'charlie@test.org');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1');
INSERT INTO codes VALUES (2, 'A12');
INSERT INTO codes VALUES (3, 'B1');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '50%');
INSERT INTO data VALUES (2, '50percent');
INSERT INTO data VALUES (3, '100%');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, 'hello');
INSERT INTO data VALUES (2, NULL);
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'document.pdf');
INSERT INTO files VALUES (2, 'image.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64, email STRING);
INSERT INTO contacts VALUES (1, 'user@example.com');
INSERT INTO contacts VALUES (2, 'invalid.email');
INSERT INTO contacts VALUES (3, 'test@test.org');
INSERT INTO contacts VALUES (4, '@invalid.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, code STRING);
INSERT INTO data VALUES (1, 'ABC');
INSERT INTO data VALUES (2, 'abc');
INSERT INTO data VALUES (3, 'AbC');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A');
INSERT INTO codes VALUES (2, 'AA');
INSERT INTO codes VALUES (3, 'AAA');
INSERT INTO codes VALUES (4, 'AAAA');
INSERT INTO codes VALUES (5, 'AAAAA');
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, name STRING, category STRING);
INSERT INTO products VALUES (1, 'Laptop Dell', 'Electronics');
INSERT INTO products VALUES (2, 'LAPTOP HP', 'Electronics');
INSERT INTO products VALUES (3, 'Chair Oak', 'Furniture');
INSERT INTO products VALUES (4, 'laptop Lenovo', 'Electronics');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING, type STRING);
INSERT INTO files VALUES (1, 'doc1.pdf', 'document');
INSERT INTO files VALUES (2, 'img1.jpg', 'image');
INSERT INTO files VALUES (3, 'doc2.pdf', 'document');
INSERT INTO files VALUES (4, 'data.csv', 'data');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'alice@EXAMPLE.com', true);
INSERT INTO users VALUES (2, 'bob@EXAMPLE.com', false);
INSERT INTO users VALUES (3, 'charlie@test.org', true);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (order_id INT64, user_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (101, 1, 100.0);
INSERT INTO orders VALUES (102, 3, 200.0);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'EMP[0-9]+');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (code_id INT64, code STRING);
INSERT INTO codes VALUES (1, 'EMP001');
INSERT INTO codes VALUES (2, 'EMP002');
INSERT INTO codes VALUES (3, 'MGR001');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report.PDF');
INSERT INTO files VALUES (2, 'image.JPG');
INSERT INTO files VALUES (3, 'data.CSV');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
INSERT INTO data VALUES (1, '');
INSERT INTO data VALUES (2, 'hello');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, text STRING);
DROP TABLE IF EXISTS names;
CREATE TABLE names (id INT64, name STRING);
INSERT INTO names VALUES (1, 'café');
INSERT INTO names VALUES (2, 'cafe\u{0301}');

SELECT id FROM files WHERE filename ILIKE 'REPORT_____%.PDF' ORDER BY id;
SELECT id FROM users WHERE email NOT ILIKE '%EXAMPLE.COM%' ORDER BY id;
SELECT id FROM paths WHERE path ILIKE '/HOME/%' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC[0-9]+' ORDER BY id;
SELECT id FROM products WHERE category SIMILAR TO 'Electronics|Furniture' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'AB*' ORDER BY id;
SELECT id FROM ids WHERE identifier SIMILAR TO '[A-Z][A-Z][A-Z][0-9][0-9][0-9]' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'hello' ORDER BY id;
SELECT id FROM users WHERE email SIMILAR TO '%@example.com' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO '_1' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '50!%' ESCAPE '!' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO 'h%' ORDER BY id;
SELECT id FROM files WHERE filename NOT SIMILAR TO '%.pdf' ORDER BY id;
SELECT id FROM contacts WHERE email SIMILAR TO '%[a-z0-9]+@[a-z0-9]+\.[a-z][a-z]+' ORDER BY id;
SELECT id FROM data WHERE code SIMILAR TO 'ABC' ORDER BY id;
SELECT id FROM codes WHERE code SIMILAR TO 'A{2,4}' ORDER BY id;
SELECT id FROM products WHERE name ILIKE '%laptop%' AND category = 'Electronics' ORDER BY id;
SELECT id FROM files WHERE filename SIMILAR TO 'doc[0-9]+.pdf' AND type IN ('document', 'archive') ORDER BY id;
SELECT order_id FROM orders WHERE user_id IN (SELECT id FROM users WHERE email ILIKE '%example.com%') ORDER BY order_id;
SELECT c.code_id FROM codes c, patterns p WHERE c.code SIMILAR TO p.pattern ORDER BY c.code_id;
SELECT id, CASE
WHEN filename ILIKE '%.pdf' THEN 'Document'
WHEN filename ILIKE '%.jpg' THEN 'Image'
ELSE 'Other'
END as file_type
FROM files
ORDER BY id;
SELECT id FROM logs WHERE message ILIKE '%needle%';
SELECT id FROM data WHERE text SIMILAR TO '' ORDER BY id;
SELECT id FROM data WHERE text SIMILAR TO '[a-z';
SELECT id FROM data WHERE text SIMILAR TO '%test%' ESCAPE 'AB';
SELECT id FROM names WHERE name ILIKE 'café' ORDER BY id;

-- ============================================================================
-- Test: test_like_mixed_wildcards_complex
-- Source: comparison_operators_comprehensive_tdd.rs:16
-- ============================================================================
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, filename STRING);
INSERT INTO files VALUES (1, 'report_2024_01.pdf');
INSERT INTO files VALUES (2, 'report_2024_12.pdf');
INSERT INTO files VALUES (3, 'summary_2024.pdf');
INSERT INTO files VALUES (4, 'report_24_01.pdf');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'ERROR: database connection failed');
INSERT INTO logs VALUES (2, 'INFO: connection established');
INSERT INTO logs VALUES (3, 'ERROR: network timeout');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'ALICE');
INSERT INTO users VALUES (3, 'alice');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, '');
INSERT INTO items VALUES (2, 'text');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'a');
INSERT INTO items VALUES (2, 'ab');
INSERT INTO items VALUES (3, 'abc');
INSERT INTO items VALUES (4, '');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1');
INSERT INTO codes VALUES (2, 'AB1');
INSERT INTO codes VALUES (3, 'ABC1');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, value STRING, pattern STRING);
INSERT INTO items VALUES (1, 'test', '%es%');
INSERT INTO items VALUES (2, 'test', NULL);
DROP TABLE IF EXISTS texts;
CREATE TABLE texts (id INT64, content STRING);
INSERT INTO texts VALUES (1, 'line1
line2');
INSERT INTO texts VALUES (2, 'singleline');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'café');
INSERT INTO users VALUES (2, 'José');
INSERT INTO users VALUES (3, '北京');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'item');
INSERT INTO items VALUES (2, NULL);
INSERT INTO items VALUES (3, 'test');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'test');
INSERT INTO items VALUES (2, 'other');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@gmail.com');
INSERT INTO emails VALUES (2, 'admin@company.com');
INSERT INTO emails VALUES (3, 'test@yahoo.com');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT filename FROM files WHERE filename LIKE 'report_____%.pdf';
SELECT message FROM logs WHERE message LIKE '%ERROR%connection%';
SELECT name FROM users WHERE name LIKE 'A%';
SELECT id FROM items WHERE text LIKE '';
SELECT id FROM items WHERE text LIKE '%';
SELECT code FROM codes WHERE code LIKE '___';
SELECT id FROM items WHERE value LIKE pattern;
SELECT id FROM texts WHERE content LIKE '%
%';
SELECT name FROM users WHERE name LIKE '%é';
SELECT id FROM items WHERE text LIKE 'a%';
SELECT id FROM items WHERE name NOT LIKE '%';
SELECT id FROM items WHERE name LIKE 'test%';
SELECT id FROM items WHERE NOT (name NOT LIKE 'test%');
SELECT address FROM emails WHERE address NOT LIKE '%@gmail.com' AND address NOT LIKE '%@yahoo.com';
SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_multiple_percent_wildcards
-- Source: comparison_operators_comprehensive_tdd.rs:44
-- ============================================================================
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'ERROR: database connection failed');
INSERT INTO logs VALUES (2, 'INFO: connection established');
INSERT INTO logs VALUES (3, 'ERROR: network timeout');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'ALICE');
INSERT INTO users VALUES (3, 'alice');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, '');
INSERT INTO items VALUES (2, 'text');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'a');
INSERT INTO items VALUES (2, 'ab');
INSERT INTO items VALUES (3, 'abc');
INSERT INTO items VALUES (4, '');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1');
INSERT INTO codes VALUES (2, 'AB1');
INSERT INTO codes VALUES (3, 'ABC1');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, value STRING, pattern STRING);
INSERT INTO items VALUES (1, 'test', '%es%');
INSERT INTO items VALUES (2, 'test', NULL);
DROP TABLE IF EXISTS texts;
CREATE TABLE texts (id INT64, content STRING);
INSERT INTO texts VALUES (1, 'line1
line2');
INSERT INTO texts VALUES (2, 'singleline');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'café');
INSERT INTO users VALUES (2, 'José');
INSERT INTO users VALUES (3, '北京');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'item');
INSERT INTO items VALUES (2, NULL);
INSERT INTO items VALUES (3, 'test');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'test');
INSERT INTO items VALUES (2, 'other');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@gmail.com');
INSERT INTO emails VALUES (2, 'admin@company.com');
INSERT INTO emails VALUES (3, 'test@yahoo.com');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT message FROM logs WHERE message LIKE '%ERROR%connection%';
SELECT name FROM users WHERE name LIKE 'A%';
SELECT id FROM items WHERE text LIKE '';
SELECT id FROM items WHERE text LIKE '%';
SELECT code FROM codes WHERE code LIKE '___';
SELECT id FROM items WHERE value LIKE pattern;
SELECT id FROM texts WHERE content LIKE '%
%';
SELECT name FROM users WHERE name LIKE '%é';
SELECT id FROM items WHERE text LIKE 'a%';
SELECT id FROM items WHERE name NOT LIKE '%';
SELECT id FROM items WHERE name LIKE 'test%';
SELECT id FROM items WHERE NOT (name NOT LIKE 'test%');
SELECT address FROM emails WHERE address NOT LIKE '%@gmail.com' AND address NOT LIKE '%@yahoo.com';
SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_case_sensitivity
-- Source: comparison_operators_comprehensive_tdd.rs:69
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'ALICE');
INSERT INTO users VALUES (3, 'alice');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, '');
INSERT INTO items VALUES (2, 'text');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'a');
INSERT INTO items VALUES (2, 'ab');
INSERT INTO items VALUES (3, 'abc');
INSERT INTO items VALUES (4, '');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1');
INSERT INTO codes VALUES (2, 'AB1');
INSERT INTO codes VALUES (3, 'ABC1');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, value STRING, pattern STRING);
INSERT INTO items VALUES (1, 'test', '%es%');
INSERT INTO items VALUES (2, 'test', NULL);
DROP TABLE IF EXISTS texts;
CREATE TABLE texts (id INT64, content STRING);
INSERT INTO texts VALUES (1, 'line1
line2');
INSERT INTO texts VALUES (2, 'singleline');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'café');
INSERT INTO users VALUES (2, 'José');
INSERT INTO users VALUES (3, '北京');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'item');
INSERT INTO items VALUES (2, NULL);
INSERT INTO items VALUES (3, 'test');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'test');
INSERT INTO items VALUES (2, 'other');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@gmail.com');
INSERT INTO emails VALUES (2, 'admin@company.com');
INSERT INTO emails VALUES (3, 'test@yahoo.com');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT name FROM users WHERE name LIKE 'A%';
SELECT id FROM items WHERE text LIKE '';
SELECT id FROM items WHERE text LIKE '%';
SELECT code FROM codes WHERE code LIKE '___';
SELECT id FROM items WHERE value LIKE pattern;
SELECT id FROM texts WHERE content LIKE '%
%';
SELECT name FROM users WHERE name LIKE '%é';
SELECT id FROM items WHERE text LIKE 'a%';
SELECT id FROM items WHERE name NOT LIKE '%';
SELECT id FROM items WHERE name LIKE 'test%';
SELECT id FROM items WHERE NOT (name NOT LIKE 'test%');
SELECT address FROM emails WHERE address NOT LIKE '%@gmail.com' AND address NOT LIKE '%@yahoo.com';
SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_empty_pattern
-- Source: comparison_operators_comprehensive_tdd.rs:94
-- ============================================================================
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, '');
INSERT INTO items VALUES (2, 'text');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'a');
INSERT INTO items VALUES (2, 'ab');
INSERT INTO items VALUES (3, 'abc');
INSERT INTO items VALUES (4, '');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1');
INSERT INTO codes VALUES (2, 'AB1');
INSERT INTO codes VALUES (3, 'ABC1');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, value STRING, pattern STRING);
INSERT INTO items VALUES (1, 'test', '%es%');
INSERT INTO items VALUES (2, 'test', NULL);
DROP TABLE IF EXISTS texts;
CREATE TABLE texts (id INT64, content STRING);
INSERT INTO texts VALUES (1, 'line1
line2');
INSERT INTO texts VALUES (2, 'singleline');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'café');
INSERT INTO users VALUES (2, 'José');
INSERT INTO users VALUES (3, '北京');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'item');
INSERT INTO items VALUES (2, NULL);
INSERT INTO items VALUES (3, 'test');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'test');
INSERT INTO items VALUES (2, 'other');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@gmail.com');
INSERT INTO emails VALUES (2, 'admin@company.com');
INSERT INTO emails VALUES (3, 'test@yahoo.com');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id FROM items WHERE text LIKE '';
SELECT id FROM items WHERE text LIKE '%';
SELECT code FROM codes WHERE code LIKE '___';
SELECT id FROM items WHERE value LIKE pattern;
SELECT id FROM texts WHERE content LIKE '%
%';
SELECT name FROM users WHERE name LIKE '%é';
SELECT id FROM items WHERE text LIKE 'a%';
SELECT id FROM items WHERE name NOT LIKE '%';
SELECT id FROM items WHERE name LIKE 'test%';
SELECT id FROM items WHERE NOT (name NOT LIKE 'test%');
SELECT address FROM emails WHERE address NOT LIKE '%@gmail.com' AND address NOT LIKE '%@yahoo.com';
SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_pattern_only_wildcards
-- Source: comparison_operators_comprehensive_tdd.rs:116
-- ============================================================================
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'a');
INSERT INTO items VALUES (2, 'ab');
INSERT INTO items VALUES (3, 'abc');
INSERT INTO items VALUES (4, '');
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1');
INSERT INTO codes VALUES (2, 'AB1');
INSERT INTO codes VALUES (3, 'ABC1');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, value STRING, pattern STRING);
INSERT INTO items VALUES (1, 'test', '%es%');
INSERT INTO items VALUES (2, 'test', NULL);
DROP TABLE IF EXISTS texts;
CREATE TABLE texts (id INT64, content STRING);
INSERT INTO texts VALUES (1, 'line1
line2');
INSERT INTO texts VALUES (2, 'singleline');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'café');
INSERT INTO users VALUES (2, 'José');
INSERT INTO users VALUES (3, '北京');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'item');
INSERT INTO items VALUES (2, NULL);
INSERT INTO items VALUES (3, 'test');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'test');
INSERT INTO items VALUES (2, 'other');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@gmail.com');
INSERT INTO emails VALUES (2, 'admin@company.com');
INSERT INTO emails VALUES (3, 'test@yahoo.com');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id FROM items WHERE text LIKE '%';
SELECT code FROM codes WHERE code LIKE '___';
SELECT id FROM items WHERE value LIKE pattern;
SELECT id FROM texts WHERE content LIKE '%
%';
SELECT name FROM users WHERE name LIKE '%é';
SELECT id FROM items WHERE text LIKE 'a%';
SELECT id FROM items WHERE name NOT LIKE '%';
SELECT id FROM items WHERE name LIKE 'test%';
SELECT id FROM items WHERE NOT (name NOT LIKE 'test%');
SELECT address FROM emails WHERE address NOT LIKE '%@gmail.com' AND address NOT LIKE '%@yahoo.com';
SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_underscore_count_exact
-- Source: comparison_operators_comprehensive_tdd.rs:144
-- ============================================================================
DROP TABLE IF EXISTS codes;
CREATE TABLE codes (id INT64, code STRING);
INSERT INTO codes VALUES (1, 'A1');
INSERT INTO codes VALUES (2, 'AB1');
INSERT INTO codes VALUES (3, 'ABC1');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, value STRING, pattern STRING);
INSERT INTO items VALUES (1, 'test', '%es%');
INSERT INTO items VALUES (2, 'test', NULL);
DROP TABLE IF EXISTS texts;
CREATE TABLE texts (id INT64, content STRING);
INSERT INTO texts VALUES (1, 'line1
line2');
INSERT INTO texts VALUES (2, 'singleline');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'café');
INSERT INTO users VALUES (2, 'José');
INSERT INTO users VALUES (3, '北京');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'item');
INSERT INTO items VALUES (2, NULL);
INSERT INTO items VALUES (3, 'test');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'test');
INSERT INTO items VALUES (2, 'other');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@gmail.com');
INSERT INTO emails VALUES (2, 'admin@company.com');
INSERT INTO emails VALUES (3, 'test@yahoo.com');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT code FROM codes WHERE code LIKE '___';
SELECT id FROM items WHERE value LIKE pattern;
SELECT id FROM texts WHERE content LIKE '%
%';
SELECT name FROM users WHERE name LIKE '%é';
SELECT id FROM items WHERE text LIKE 'a%';
SELECT id FROM items WHERE name NOT LIKE '%';
SELECT id FROM items WHERE name LIKE 'test%';
SELECT id FROM items WHERE NOT (name NOT LIKE 'test%');
SELECT address FROM emails WHERE address NOT LIKE '%@gmail.com' AND address NOT LIKE '%@yahoo.com';
SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_null_pattern
-- Source: comparison_operators_comprehensive_tdd.rs:169
-- ============================================================================
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, value STRING, pattern STRING);
INSERT INTO items VALUES (1, 'test', '%es%');
INSERT INTO items VALUES (2, 'test', NULL);
DROP TABLE IF EXISTS texts;
CREATE TABLE texts (id INT64, content STRING);
INSERT INTO texts VALUES (1, 'line1
line2');
INSERT INTO texts VALUES (2, 'singleline');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'café');
INSERT INTO users VALUES (2, 'José');
INSERT INTO users VALUES (3, '北京');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'item');
INSERT INTO items VALUES (2, NULL);
INSERT INTO items VALUES (3, 'test');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'test');
INSERT INTO items VALUES (2, 'other');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@gmail.com');
INSERT INTO emails VALUES (2, 'admin@company.com');
INSERT INTO emails VALUES (3, 'test@yahoo.com');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id FROM items WHERE value LIKE pattern;
SELECT id FROM texts WHERE content LIKE '%
%';
SELECT name FROM users WHERE name LIKE '%é';
SELECT id FROM items WHERE text LIKE 'a%';
SELECT id FROM items WHERE name NOT LIKE '%';
SELECT id FROM items WHERE name LIKE 'test%';
SELECT id FROM items WHERE NOT (name NOT LIKE 'test%');
SELECT address FROM emails WHERE address NOT LIKE '%@gmail.com' AND address NOT LIKE '%@yahoo.com';
SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_with_newlines
-- Source: comparison_operators_comprehensive_tdd.rs:191
-- ============================================================================
DROP TABLE IF EXISTS texts;
CREATE TABLE texts (id INT64, content STRING);
INSERT INTO texts VALUES (1, 'line1
line2');
INSERT INTO texts VALUES (2, 'singleline');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'café');
INSERT INTO users VALUES (2, 'José');
INSERT INTO users VALUES (3, '北京');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'item');
INSERT INTO items VALUES (2, NULL);
INSERT INTO items VALUES (3, 'test');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'test');
INSERT INTO items VALUES (2, 'other');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@gmail.com');
INSERT INTO emails VALUES (2, 'admin@company.com');
INSERT INTO emails VALUES (3, 'test@yahoo.com');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id FROM texts WHERE content LIKE '%
%';
SELECT name FROM users WHERE name LIKE '%é';
SELECT id FROM items WHERE text LIKE 'a%';
SELECT id FROM items WHERE name NOT LIKE '%';
SELECT id FROM items WHERE name LIKE 'test%';
SELECT id FROM items WHERE NOT (name NOT LIKE 'test%');
SELECT address FROM emails WHERE address NOT LIKE '%@gmail.com' AND address NOT LIKE '%@yahoo.com';
SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_with_unicode
-- Source: comparison_operators_comprehensive_tdd.rs:213
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'café');
INSERT INTO users VALUES (2, 'José');
INSERT INTO users VALUES (3, '北京');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'item');
INSERT INTO items VALUES (2, NULL);
INSERT INTO items VALUES (3, 'test');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'test');
INSERT INTO items VALUES (2, 'other');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@gmail.com');
INSERT INTO emails VALUES (2, 'admin@company.com');
INSERT INTO emails VALUES (3, 'test@yahoo.com');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT name FROM users WHERE name LIKE '%é';
SELECT id FROM items WHERE text LIKE 'a%';
SELECT id FROM items WHERE name NOT LIKE '%';
SELECT id FROM items WHERE name LIKE 'test%';
SELECT id FROM items WHERE NOT (name NOT LIKE 'test%');
SELECT address FROM emails WHERE address NOT LIKE '%@gmail.com' AND address NOT LIKE '%@yahoo.com';
SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_very_long_string
-- Source: comparison_operators_comprehensive_tdd.rs:238
-- ============================================================================
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'item');
INSERT INTO items VALUES (2, NULL);
INSERT INTO items VALUES (3, 'test');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'test');
INSERT INTO items VALUES (2, 'other');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@gmail.com');
INSERT INTO emails VALUES (2, 'admin@company.com');
INSERT INTO emails VALUES (3, 'test@yahoo.com');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id FROM items WHERE text LIKE 'a%';
SELECT id FROM items WHERE name NOT LIKE '%';
SELECT id FROM items WHERE name LIKE 'test%';
SELECT id FROM items WHERE NOT (name NOT LIKE 'test%');
SELECT address FROM emails WHERE address NOT LIKE '%@gmail.com' AND address NOT LIKE '%@yahoo.com';
SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_not_like_with_null_value
-- Source: comparison_operators_comprehensive_tdd.rs:262
-- ============================================================================
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'item');
INSERT INTO items VALUES (2, NULL);
INSERT INTO items VALUES (3, 'test');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'test');
INSERT INTO items VALUES (2, 'other');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@gmail.com');
INSERT INTO emails VALUES (2, 'admin@company.com');
INSERT INTO emails VALUES (3, 'test@yahoo.com');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id FROM items WHERE name NOT LIKE '%';
SELECT id FROM items WHERE name LIKE 'test%';
SELECT id FROM items WHERE NOT (name NOT LIKE 'test%');
SELECT address FROM emails WHERE address NOT LIKE '%@gmail.com' AND address NOT LIKE '%@yahoo.com';
SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_not_like_double_negation
-- Source: comparison_operators_comprehensive_tdd.rs:287
-- ============================================================================
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, name STRING);
INSERT INTO items VALUES (1, 'test');
INSERT INTO items VALUES (2, 'other');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@gmail.com');
INSERT INTO emails VALUES (2, 'admin@company.com');
INSERT INTO emails VALUES (3, 'test@yahoo.com');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id FROM items WHERE name LIKE 'test%';
SELECT id FROM items WHERE NOT (name NOT LIKE 'test%');
SELECT address FROM emails WHERE address NOT LIKE '%@gmail.com' AND address NOT LIKE '%@yahoo.com';
SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_not_like_combined_patterns
-- Source: comparison_operators_comprehensive_tdd.rs:313
-- ============================================================================
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@gmail.com');
INSERT INTO emails VALUES (2, 'admin@company.com');
INSERT INTO emails VALUES (3, 'test@yahoo.com');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT address FROM emails WHERE address NOT LIKE '%@gmail.com' AND address NOT LIKE '%@yahoo.com';
SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_similar_to_complex_regex
-- Source: comparison_operators_comprehensive_tdd.rs:342
-- ============================================================================
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, address STRING);
INSERT INTO emails VALUES (1, 'user@example.com');
INSERT INTO emails VALUES (2, 'invalid@');
INSERT INTO emails VALUES (3, '@example.com');
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT address FROM emails WHERE address SIMILAR TO '[a-z]+@[a-z]+\.[a-z]+';
SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_similar_to_quantifier_ranges
-- Source: comparison_operators_comprehensive_tdd.rs:367
-- ============================================================================
DROP TABLE IF EXISTS passwords;
CREATE TABLE passwords (id INT64, pwd STRING);
INSERT INTO passwords VALUES (1, 'ab');
INSERT INTO passwords VALUES (2, 'abc');
INSERT INTO passwords VALUES (3, 'abcd');
INSERT INTO passwords VALUES (4, 'abcde');
INSERT INTO passwords VALUES (5, 'abcdef');
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT pwd FROM passwords WHERE pwd SIMILAR TO 'a{1}b{1}c{1,3}d*';
SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_similar_to_escape_special_chars
-- Source: comparison_operators_comprehensive_tdd.rs:399
-- ============================================================================
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, text STRING);
INSERT INTO items VALUES (1, 'test.txt');
INSERT INTO items VALUES (2, 'testXtxt');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT text FROM items WHERE text SIMILAR TO 'test\.txt';
SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_not_equal_numeric_type_coercion
-- Source: comparison_operators_comprehensive_tdd.rs:427
-- ============================================================================
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, int_val INT64, float_val FLOAT64);
INSERT INTO numbers VALUES (1, 10, 10.0);
INSERT INTO numbers VALUES (2, 20, 20.5);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id FROM numbers WHERE int_val <> float_val;
SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_not_equal_null_both_sides
-- Source: comparison_operators_comprehensive_tdd.rs:449
-- ============================================================================
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, val1 INT64, val2 INT64);
INSERT INTO items VALUES (1, NULL, NULL);
INSERT INTO items VALUES (2, 10, 20);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id FROM items WHERE val1 <> val2;
SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_not_equal_string_case_sensitive
-- Source: comparison_operators_comprehensive_tdd.rs:471
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (2, 'alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id FROM users WHERE name <> 'Alice';
SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_in_select_projection
-- Source: comparison_operators_comprehensive_tdd.rs:497
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@example.com');
INSERT INTO users VALUES (2, 'bob@test.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id, email LIKE '%@example.com' AS is_example FROM users;
SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_with_and_or_conditions
-- Source: comparison_operators_comprehensive_tdd.rs:520
-- ============================================================================
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING, size INT64);
INSERT INTO files VALUES (1, 'report.pdf', 1024);
INSERT INTO files VALUES (2, 'data.pdf', 2048);
INSERT INTO files VALUES (3, 'image.png', 512);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT name FROM files WHERE (name LIKE '%.pdf' AND size > 1500) OR name LIKE '%.png';
SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_in_subquery_exists
-- Source: comparison_operators_comprehensive_tdd.rs:547
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING);
INSERT INTO users VALUES (1, 'alice@banned.com');
INSERT INTO users VALUES (2, 'bob@allowed.com');
DROP TABLE IF EXISTS banned_domains;
CREATE TABLE banned_domains (domain STRING);
INSERT INTO banned_domains VALUES ('banned.com');
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT email FROM users u WHERE EXISTS (SELECT 1 FROM banned_domains b WHERE u.email LIKE CONCAT('%@', b.domain));
SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_in_case_expression
-- Source: comparison_operators_comprehensive_tdd.rs:576
-- ============================================================================
DROP TABLE IF EXISTS files;
CREATE TABLE files (id INT64, name STRING);
INSERT INTO files VALUES (1, 'doc.pdf');
INSERT INTO files VALUES (2, 'photo.jpg');
INSERT INTO files VALUES (3, 'data.csv');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT name, CASE WHEN name LIKE '%.pdf' THEN 'document' WHEN name LIKE '%.jpg' THEN 'image' ELSE 'data' END AS type FROM files;
UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_in_update_where
-- Source: comparison_operators_comprehensive_tdd.rs:601
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, email STRING, verified BOOL);
INSERT INTO users VALUES (1, 'user@trusted.com', false);
INSERT INTO users VALUES (2, 'user@untrusted.com', false);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

UPDATE users SET verified = true WHERE email LIKE '%@trusted.com';
SELECT id FROM users WHERE verified = true;
DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_in_delete_where
-- Source: comparison_operators_comprehensive_tdd.rs:626
-- ============================================================================
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
INSERT INTO logs VALUES (1, 'DEBUG: test');
INSERT INTO logs VALUES (2, 'INFO: normal');
INSERT INTO logs VALUES (3, 'DEBUG: another');
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

DELETE FROM logs WHERE message LIKE 'DEBUG:%';
SELECT * FROM logs;
SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_type_error_int
-- Source: comparison_operators_comprehensive_tdd.rs:656
-- ============================================================================
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
INSERT INTO numbers VALUES (1, 123);
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id FROM numbers WHERE value LIKE '123';
SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_like_type_error_bool
-- Source: comparison_operators_comprehensive_tdd.rs:674
-- ============================================================================
DROP TABLE IF EXISTS items;
CREATE TABLE items (id INT64, active BOOL);
INSERT INTO items VALUES (1, true);
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id FROM items WHERE active LIKE 'true';
SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_similar_to_type_error
-- Source: comparison_operators_comprehensive_tdd.rs:692
-- ============================================================================
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value FLOAT64);
INSERT INTO numbers VALUES (1, 123.45);
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, message STRING);
DROP TABLE IF EXISTS documents;
CREATE TABLE documents (id INT64, title STRING, content STRING);
INSERT INTO documents VALUES (1, 'SQL Guide', 'Learn SQL basics');
INSERT INTO documents VALUES (2, 'Python Tutorial', 'Python programming');
INSERT INTO documents VALUES (3, 'SQL Advanced', 'Advanced SQL techniques');

SELECT id FROM numbers WHERE value SIMILAR TO '[0-9]+';
SELECT id FROM logs WHERE message LIKE '%message%';
SELECT title FROM documents WHERE title LIKE '%SQL%' AND content LIKE '%SQL%';

-- ============================================================================
-- Test: test_not_equal_diamond_operator_numbers
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:23
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a INT64, b INT64);
INSERT INTO t VALUES (1, 5, 3);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a INT64, b INT64);
INSERT INTO t VALUES (1, 5, 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a INT64, b INT64);
INSERT INTO t VALUES (1, NULL, 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a STRING, b STRING);
INSERT INTO t VALUES (1, 'hello', 'world');
INSERT INTO t VALUES (2, 'same', 'same');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a INT64, b INT64);
INSERT INTO t VALUES (1, 5, 3);
INSERT INTO t VALUES (2, 5, 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
INSERT INTO t VALUES (4, 'abbc');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, animal STRING);
INSERT INTO t VALUES (1, 'cat');
INSERT INTO t VALUES (2, 'dog');
INSERT INTO t VALUES (3, 'bird');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, code STRING);
INSERT INTO t VALUES (1, 'a5');
INSERT INTO t VALUES (2, 'z9');
INSERT INTO t VALUES (3, '5a');
INSERT INTO t VALUES (4, 'ab');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'aaa');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaa');
INSERT INTO t VALUES (4, 'aaaa');
INSERT INTO t VALUES (5, 'aaaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'abcdef');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '100%');
INSERT INTO t VALUES (2, '100x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE a <> b;
SELECT id FROM t WHERE a <> b;
SELECT id FROM t WHERE a <> b;
SELECT id FROM t WHERE a <> b ORDER BY id;
SELECT id FROM t WHERE a <> b ORDER BY id;
SELECT id FROM t WHERE a != b ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'h%o';
SELECT id FROM t WHERE str SIMILAR TO 'a_c' ORDER BY id;
SELECT id FROM t WHERE animal SIMILAR TO '(cat|dog)' ORDER BY id;
SELECT id FROM t WHERE code SIMILAR TO '[a-z][0-9]' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'a{3}';
SELECT id FROM t WHERE str SIMILAR TO 'a{2,4}' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '100\\%';
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_not_equal_diamond_operator_equal_values
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:43
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a INT64, b INT64);
INSERT INTO t VALUES (1, 5, 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a INT64, b INT64);
INSERT INTO t VALUES (1, NULL, 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a STRING, b STRING);
INSERT INTO t VALUES (1, 'hello', 'world');
INSERT INTO t VALUES (2, 'same', 'same');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a INT64, b INT64);
INSERT INTO t VALUES (1, 5, 3);
INSERT INTO t VALUES (2, 5, 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
INSERT INTO t VALUES (4, 'abbc');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, animal STRING);
INSERT INTO t VALUES (1, 'cat');
INSERT INTO t VALUES (2, 'dog');
INSERT INTO t VALUES (3, 'bird');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, code STRING);
INSERT INTO t VALUES (1, 'a5');
INSERT INTO t VALUES (2, 'z9');
INSERT INTO t VALUES (3, '5a');
INSERT INTO t VALUES (4, 'ab');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'aaa');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaa');
INSERT INTO t VALUES (4, 'aaaa');
INSERT INTO t VALUES (5, 'aaaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'abcdef');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '100%');
INSERT INTO t VALUES (2, '100x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE a <> b;
SELECT id FROM t WHERE a <> b;
SELECT id FROM t WHERE a <> b ORDER BY id;
SELECT id FROM t WHERE a <> b ORDER BY id;
SELECT id FROM t WHERE a != b ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'h%o';
SELECT id FROM t WHERE str SIMILAR TO 'a_c' ORDER BY id;
SELECT id FROM t WHERE animal SIMILAR TO '(cat|dog)' ORDER BY id;
SELECT id FROM t WHERE code SIMILAR TO '[a-z][0-9]' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'a{3}';
SELECT id FROM t WHERE str SIMILAR TO 'a{2,4}' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '100\\%';
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_not_equal_diamond_with_null
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:62
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a INT64, b INT64);
INSERT INTO t VALUES (1, NULL, 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a STRING, b STRING);
INSERT INTO t VALUES (1, 'hello', 'world');
INSERT INTO t VALUES (2, 'same', 'same');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a INT64, b INT64);
INSERT INTO t VALUES (1, 5, 3);
INSERT INTO t VALUES (2, 5, 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
INSERT INTO t VALUES (4, 'abbc');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, animal STRING);
INSERT INTO t VALUES (1, 'cat');
INSERT INTO t VALUES (2, 'dog');
INSERT INTO t VALUES (3, 'bird');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, code STRING);
INSERT INTO t VALUES (1, 'a5');
INSERT INTO t VALUES (2, 'z9');
INSERT INTO t VALUES (3, '5a');
INSERT INTO t VALUES (4, 'ab');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'aaa');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaa');
INSERT INTO t VALUES (4, 'aaaa');
INSERT INTO t VALUES (5, 'aaaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'abcdef');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '100%');
INSERT INTO t VALUES (2, '100x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE a <> b;
SELECT id FROM t WHERE a <> b ORDER BY id;
SELECT id FROM t WHERE a <> b ORDER BY id;
SELECT id FROM t WHERE a != b ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'h%o';
SELECT id FROM t WHERE str SIMILAR TO 'a_c' ORDER BY id;
SELECT id FROM t WHERE animal SIMILAR TO '(cat|dog)' ORDER BY id;
SELECT id FROM t WHERE code SIMILAR TO '[a-z][0-9]' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'a{3}';
SELECT id FROM t WHERE str SIMILAR TO 'a{2,4}' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '100\\%';
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_not_equal_diamond_strings
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:83
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a STRING, b STRING);
INSERT INTO t VALUES (1, 'hello', 'world');
INSERT INTO t VALUES (2, 'same', 'same');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a INT64, b INT64);
INSERT INTO t VALUES (1, 5, 3);
INSERT INTO t VALUES (2, 5, 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
INSERT INTO t VALUES (4, 'abbc');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, animal STRING);
INSERT INTO t VALUES (1, 'cat');
INSERT INTO t VALUES (2, 'dog');
INSERT INTO t VALUES (3, 'bird');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, code STRING);
INSERT INTO t VALUES (1, 'a5');
INSERT INTO t VALUES (2, 'z9');
INSERT INTO t VALUES (3, '5a');
INSERT INTO t VALUES (4, 'ab');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'aaa');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaa');
INSERT INTO t VALUES (4, 'aaaa');
INSERT INTO t VALUES (5, 'aaaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'abcdef');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '100%');
INSERT INTO t VALUES (2, '100x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE a <> b ORDER BY id;
SELECT id FROM t WHERE a <> b ORDER BY id;
SELECT id FROM t WHERE a != b ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'h%o';
SELECT id FROM t WHERE str SIMILAR TO 'a_c' ORDER BY id;
SELECT id FROM t WHERE animal SIMILAR TO '(cat|dog)' ORDER BY id;
SELECT id FROM t WHERE code SIMILAR TO '[a-z][0-9]' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'a{3}';
SELECT id FROM t WHERE str SIMILAR TO 'a{2,4}' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '100\\%';
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_not_equal_diamond_vs_exclamation
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:107
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, a INT64, b INT64);
INSERT INTO t VALUES (1, 5, 3);
INSERT INTO t VALUES (2, 5, 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
INSERT INTO t VALUES (4, 'abbc');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, animal STRING);
INSERT INTO t VALUES (1, 'cat');
INSERT INTO t VALUES (2, 'dog');
INSERT INTO t VALUES (3, 'bird');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, code STRING);
INSERT INTO t VALUES (1, 'a5');
INSERT INTO t VALUES (2, 'z9');
INSERT INTO t VALUES (3, '5a');
INSERT INTO t VALUES (4, 'ab');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'aaa');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaa');
INSERT INTO t VALUES (4, 'aaaa');
INSERT INTO t VALUES (5, 'aaaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'abcdef');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '100%');
INSERT INTO t VALUES (2, '100x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE a <> b ORDER BY id;
SELECT id FROM t WHERE a != b ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'h%o';
SELECT id FROM t WHERE str SIMILAR TO 'a_c' ORDER BY id;
SELECT id FROM t WHERE animal SIMILAR TO '(cat|dog)' ORDER BY id;
SELECT id FROM t WHERE code SIMILAR TO '[a-z][0-9]' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'a{3}';
SELECT id FROM t WHERE str SIMILAR TO 'a{2,4}' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '100\\%';
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_similar_to_basic_pattern
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:142
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
INSERT INTO t VALUES (4, 'abbc');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, animal STRING);
INSERT INTO t VALUES (1, 'cat');
INSERT INTO t VALUES (2, 'dog');
INSERT INTO t VALUES (3, 'bird');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, code STRING);
INSERT INTO t VALUES (1, 'a5');
INSERT INTO t VALUES (2, 'z9');
INSERT INTO t VALUES (3, '5a');
INSERT INTO t VALUES (4, 'ab');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'aaa');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaa');
INSERT INTO t VALUES (4, 'aaaa');
INSERT INTO t VALUES (5, 'aaaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'abcdef');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '100%');
INSERT INTO t VALUES (2, '100x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str SIMILAR TO 'h%o';
SELECT id FROM t WHERE str SIMILAR TO 'a_c' ORDER BY id;
SELECT id FROM t WHERE animal SIMILAR TO '(cat|dog)' ORDER BY id;
SELECT id FROM t WHERE code SIMILAR TO '[a-z][0-9]' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'a{3}';
SELECT id FROM t WHERE str SIMILAR TO 'a{2,4}' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '100\\%';
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_similar_to_underscore_wildcard
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:167
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
INSERT INTO t VALUES (4, 'abbc');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, animal STRING);
INSERT INTO t VALUES (1, 'cat');
INSERT INTO t VALUES (2, 'dog');
INSERT INTO t VALUES (3, 'bird');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, code STRING);
INSERT INTO t VALUES (1, 'a5');
INSERT INTO t VALUES (2, 'z9');
INSERT INTO t VALUES (3, '5a');
INSERT INTO t VALUES (4, 'ab');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'aaa');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaa');
INSERT INTO t VALUES (4, 'aaaa');
INSERT INTO t VALUES (5, 'aaaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'abcdef');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '100%');
INSERT INTO t VALUES (2, '100x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str SIMILAR TO 'a_c' ORDER BY id;
SELECT id FROM t WHERE animal SIMILAR TO '(cat|dog)' ORDER BY id;
SELECT id FROM t WHERE code SIMILAR TO '[a-z][0-9]' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'a{3}';
SELECT id FROM t WHERE str SIMILAR TO 'a{2,4}' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '100\\%';
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_similar_to_alternation
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:197
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, animal STRING);
INSERT INTO t VALUES (1, 'cat');
INSERT INTO t VALUES (2, 'dog');
INSERT INTO t VALUES (3, 'bird');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, code STRING);
INSERT INTO t VALUES (1, 'a5');
INSERT INTO t VALUES (2, 'z9');
INSERT INTO t VALUES (3, '5a');
INSERT INTO t VALUES (4, 'ab');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'aaa');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaa');
INSERT INTO t VALUES (4, 'aaaa');
INSERT INTO t VALUES (5, 'aaaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'abcdef');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '100%');
INSERT INTO t VALUES (2, '100x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE animal SIMILAR TO '(cat|dog)' ORDER BY id;
SELECT id FROM t WHERE code SIMILAR TO '[a-z][0-9]' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'a{3}';
SELECT id FROM t WHERE str SIMILAR TO 'a{2,4}' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '100\\%';
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_similar_to_character_class
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:223
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, code STRING);
INSERT INTO t VALUES (1, 'a5');
INSERT INTO t VALUES (2, 'z9');
INSERT INTO t VALUES (3, '5a');
INSERT INTO t VALUES (4, 'ab');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'aaa');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaa');
INSERT INTO t VALUES (4, 'aaaa');
INSERT INTO t VALUES (5, 'aaaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'abcdef');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '100%');
INSERT INTO t VALUES (2, '100x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE code SIMILAR TO '[a-z][0-9]' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'a{3}';
SELECT id FROM t WHERE str SIMILAR TO 'a{2,4}' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '100\\%';
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_similar_to_repetition
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:253
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'aaa');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaa');
INSERT INTO t VALUES (4, 'aaaa');
INSERT INTO t VALUES (5, 'aaaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'abcdef');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '100%');
INSERT INTO t VALUES (2, '100x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str SIMILAR TO 'a{3}';
SELECT id FROM t WHERE str SIMILAR TO 'a{2,4}' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '100\\%';
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_similar_to_range_repetition
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:280
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'aa');
INSERT INTO t VALUES (3, 'aaa');
INSERT INTO t VALUES (4, 'aaaa');
INSERT INTO t VALUES (5, 'aaaaa');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'abcdef');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '100%');
INSERT INTO t VALUES (2, '100x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str SIMILAR TO 'a{2,4}' ORDER BY id;
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '100\\%';
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_similar_to_anchoring
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:313
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'abcdef');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '100%');
INSERT INTO t VALUES (2, '100x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '100\\%';
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_similar_to_escape_special_chars
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:341
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '100%');
INSERT INTO t VALUES (2, '100x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str SIMILAR TO '100\\%';
SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_similar_to_null
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:365
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str SIMILAR TO 'abc';
SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_similar_to_empty_string
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:386
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, '');
INSERT INTO t VALUES (2, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str SIMILAR TO '';
SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_match_operator_basic
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:417
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~ 'ell';
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_match_case_sensitive
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:440
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_match_anchors
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:460
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'hello world');
INSERT INTO t VALUES (3, 'say hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~ '^hello$';
SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_match_dot_wildcard
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:491
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'aXc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~ 'a.c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_match_star_quantifier
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:518
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~ 'a.*c' ORDER BY id;
SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_match_plus_quantifier
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:545
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc');
INSERT INTO t VALUES (2, 'axyzc');
INSERT INTO t VALUES (3, 'ac');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~ 'a.+c' ORDER BY id;
SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_match_optional
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:576
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, word STRING);
INSERT INTO t VALUES (1, 'color');
INSERT INTO t VALUES (2, 'colour');
INSERT INTO t VALUES (3, 'colouur');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE word ~ 'colou?r' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_match_character_class
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:603
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'b');
INSERT INTO t VALUES (3, 'c');
INSERT INTO t VALUES (4, 'd');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~ '^[abc]$' ORDER BY id;
SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_match_negated_class
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:633
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'a');
INSERT INTO t VALUES (2, 'd');
INSERT INTO t VALUES (3, 'x');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~ '^[^abc]$' ORDER BY id;
SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_not_match_basic
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:668
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str !~ 'ell';
SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_not_match_null
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:693
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, NULL);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str !~ 'abc';
SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_not_match_vs_not_regex_match
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:714
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str !~ 'ell' ORDER BY id;
SELECT id FROM t WHERE NOT (str ~ 'ell') ORDER BY id;
SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_icase_match_basic
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:749
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'hello');
INSERT INTO t VALUES (4, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~* 'hello' ORDER BY id;
SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_icase_match_pattern
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:779
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'abc123');
INSERT INTO t VALUES (2, 'ABC123');
INSERT INTO t VALUES (3, 'AbC123');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~* '^[a-z]+[0-9]+$' ORDER BY id;
SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_icase_vs_case_sensitive
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:806
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'Hello');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~ 'hello';
SELECT id FROM t WHERE str ~* 'hello';
SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_icase_not_match_basic
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:843
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello');
INSERT INTO t VALUES (2, 'HELLO');
INSERT INTO t VALUES (3, 'world');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str !~* 'hello';
SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_invalid_regex_unclosed_bracket
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:880
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~ '[abc';
SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_invalid_regex_unclosed_parenthesis
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:904
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~ '(abc';
SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_invalid_regex_invalid_repetition
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:921
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'test');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id FROM t WHERE str ~ '*abc';
SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_in_case_when
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:942
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, email STRING);
INSERT INTO t VALUES (1, 'user@example.com');
INSERT INTO t VALUES (2, 'invalid.email');
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT id, CASE WHEN email ~ '^[^@]+@[^@]+\.[^@]+$' THEN 'valid' ELSE 'invalid' END as status FROM t ORDER BY id;
SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_regex_in_having_clause
-- Source: comparison_operators_extreme_edge_cases_tdd.rs:972
-- ============================================================================
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, name STRING, price INT64);
INSERT INTO products VALUES ('electronics', 'laptop', 1000);
INSERT INTO products VALUES ('electronics', 'mouse', 20);
INSERT INTO products VALUES ('books', 'novel', 15);
DROP TABLE IF EXISTS patterns;
CREATE TABLE patterns (id INT64, pattern STRING);
INSERT INTO patterns VALUES (1, 'a%');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, str STRING);
INSERT INTO strings VALUES (1, 'apple');
INSERT INTO strings VALUES (2, 'banana');
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, str STRING);
INSERT INTO t VALUES (1, 'hello world');
INSERT INTO t VALUES (2, 'hello');
INSERT INTO t VALUES (3, 'world');

SELECT category, COUNT(*) as cnt FROM products GROUP BY category HAVING category ~ '^e';
SELECT id FROM strings WHERE str SIMILAR TO (SELECT pattern FROM patterns WHERE id = 1);
SELECT id FROM t WHERE str ~ 'hello' AND str ~ 'world';

-- ============================================================================
-- Test: test_date_functions_performance_with_large_dataset
-- Source: date_functions_comprehensive_tdd.rs:1221
-- ============================================================================
DROP TABLE IF EXISTS large_events;
CREATE TABLE large_events (id INT64, event_date DATE);

SELECT EXTRACT(MONTH FROM event_date) as month, COUNT(*) FROM large_events GROUP BY month;
SELECT DATE_ADD('2024-01-15', INTERVAL 5 INVALID_UNIT) as result;
SELECT DATE_DIFF('2024-01-20', '2024-01-15', INVALID_UNIT) as result;
SELECT EXTRACT(INVALID_FIELD FROM DATE '2024-01-15') as result;
SELECT DATE_ADD('2024-01-15', INTERVAL 999999 YEAR) as result;
SELECT DATE_SUB('2024-01-15', INTERVAL 999999 YEAR) as result;

-- ============================================================================
-- Test: test_current_date
-- Source: date_time_functions.rs:16
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT CURRENT_DATE() as today FROM data;
SELECT CURRENT_TIMESTAMP() as now FROM data;
SELECT NOW() as current_time FROM data;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM dates;
SELECT DATE_SUB(event_date, INTERVAL 7 DAY) as past_date FROM dates;
SELECT DATE_DIFF(end_date, start_date, DAY) as days FROM events;
SELECT DATE_DIFF(end_date, start_date) as days FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM dates;
SELECT EXTRACT(MONTH FROM event_date) as month FROM dates;
SELECT EXTRACT(DAY FROM event_date) as day FROM dates;
SELECT DATE_PART('year', event_date) as year FROM dates;
SELECT DATE_TRUNC('month', event_date) as truncated FROM dates;
SELECT DATE_TRUNC('year', event_date) as truncated FROM dates;
SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_current_timestamp
-- Source: date_time_functions.rs:38
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT CURRENT_TIMESTAMP() as now FROM data;
SELECT NOW() as current_time FROM data;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM dates;
SELECT DATE_SUB(event_date, INTERVAL 7 DAY) as past_date FROM dates;
SELECT DATE_DIFF(end_date, start_date, DAY) as days FROM events;
SELECT DATE_DIFF(end_date, start_date) as days FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM dates;
SELECT EXTRACT(MONTH FROM event_date) as month FROM dates;
SELECT EXTRACT(DAY FROM event_date) as day FROM dates;
SELECT DATE_PART('year', event_date) as year FROM dates;
SELECT DATE_TRUNC('month', event_date) as truncated FROM dates;
SELECT DATE_TRUNC('year', event_date) as truncated FROM dates;
SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_now_function
-- Source: date_time_functions.rs:60
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT NOW() as current_time FROM data;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM dates;
SELECT DATE_SUB(event_date, INTERVAL 7 DAY) as past_date FROM dates;
SELECT DATE_DIFF(end_date, start_date, DAY) as days FROM events;
SELECT DATE_DIFF(end_date, start_date) as days FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM dates;
SELECT EXTRACT(MONTH FROM event_date) as month FROM dates;
SELECT EXTRACT(DAY FROM event_date) as day FROM dates;
SELECT DATE_PART('year', event_date) as year FROM dates;
SELECT DATE_TRUNC('month', event_date) as truncated FROM dates;
SELECT DATE_TRUNC('year', event_date) as truncated FROM dates;
SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_date_add
-- Source: date_time_functions.rs:81
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM dates;
SELECT DATE_SUB(event_date, INTERVAL 7 DAY) as past_date FROM dates;
SELECT DATE_DIFF(end_date, start_date, DAY) as days FROM events;
SELECT DATE_DIFF(end_date, start_date) as days FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM dates;
SELECT EXTRACT(MONTH FROM event_date) as month FROM dates;
SELECT EXTRACT(DAY FROM event_date) as day FROM dates;
SELECT DATE_PART('year', event_date) as year FROM dates;
SELECT DATE_TRUNC('month', event_date) as truncated FROM dates;
SELECT DATE_TRUNC('year', event_date) as truncated FROM dates;
SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_date_sub
-- Source: date_time_functions.rs:107
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT DATE_SUB(event_date, INTERVAL 7 DAY) as past_date FROM dates;
SELECT DATE_DIFF(end_date, start_date, DAY) as days FROM events;
SELECT DATE_DIFF(end_date, start_date) as days FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM dates;
SELECT EXTRACT(MONTH FROM event_date) as month FROM dates;
SELECT EXTRACT(DAY FROM event_date) as day FROM dates;
SELECT DATE_PART('year', event_date) as year FROM dates;
SELECT DATE_TRUNC('month', event_date) as truncated FROM dates;
SELECT DATE_TRUNC('year', event_date) as truncated FROM dates;
SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_date_diff
-- Source: date_time_functions.rs:133
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT DATE_DIFF(end_date, start_date, DAY) as days FROM events;
SELECT DATE_DIFF(end_date, start_date) as days FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM dates;
SELECT EXTRACT(MONTH FROM event_date) as month FROM dates;
SELECT EXTRACT(DAY FROM event_date) as day FROM dates;
SELECT DATE_PART('year', event_date) as year FROM dates;
SELECT DATE_TRUNC('month', event_date) as truncated FROM dates;
SELECT DATE_TRUNC('year', event_date) as truncated FROM dates;
SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_datediff
-- Source: date_time_functions.rs:159
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT DATE_DIFF(end_date, start_date) as days FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM dates;
SELECT EXTRACT(MONTH FROM event_date) as month FROM dates;
SELECT EXTRACT(DAY FROM event_date) as day FROM dates;
SELECT DATE_PART('year', event_date) as year FROM dates;
SELECT DATE_TRUNC('month', event_date) as truncated FROM dates;
SELECT DATE_TRUNC('year', event_date) as truncated FROM dates;
SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_extract_year
-- Source: date_time_functions.rs:184
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT EXTRACT(YEAR FROM event_date) as year FROM dates;
SELECT EXTRACT(MONTH FROM event_date) as month FROM dates;
SELECT EXTRACT(DAY FROM event_date) as day FROM dates;
SELECT DATE_PART('year', event_date) as year FROM dates;
SELECT DATE_TRUNC('month', event_date) as truncated FROM dates;
SELECT DATE_TRUNC('year', event_date) as truncated FROM dates;
SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_extract_month
-- Source: date_time_functions.rs:209
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT EXTRACT(MONTH FROM event_date) as month FROM dates;
SELECT EXTRACT(DAY FROM event_date) as day FROM dates;
SELECT DATE_PART('year', event_date) as year FROM dates;
SELECT DATE_TRUNC('month', event_date) as truncated FROM dates;
SELECT DATE_TRUNC('year', event_date) as truncated FROM dates;
SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_extract_day
-- Source: date_time_functions.rs:234
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT EXTRACT(DAY FROM event_date) as day FROM dates;
SELECT DATE_PART('year', event_date) as year FROM dates;
SELECT DATE_TRUNC('month', event_date) as truncated FROM dates;
SELECT DATE_TRUNC('year', event_date) as truncated FROM dates;
SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_date_part
-- Source: date_time_functions.rs:259
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT DATE_PART('year', event_date) as year FROM dates;
SELECT DATE_TRUNC('month', event_date) as truncated FROM dates;
SELECT DATE_TRUNC('year', event_date) as truncated FROM dates;
SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_date_trunc_month
-- Source: date_time_functions.rs:284
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT DATE_TRUNC('month', event_date) as truncated FROM dates;
SELECT DATE_TRUNC('year', event_date) as truncated FROM dates;
SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_date_trunc_year
-- Source: date_time_functions.rs:310
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT DATE_TRUNC('year', event_date) as truncated FROM dates;
SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_date_format
-- Source: date_time_functions.rs:336
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT DATE_FORMAT(event_date, '%Y-%m-%d') as formatted FROM dates;
SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_to_char
-- Source: date_time_functions.rs:362
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT TO_CHAR(event_date, 'YYYY-MM-DD') as formatted FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_parse_date
-- Source: date_time_functions.rs:388
-- ============================================================================
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed FROM strings;
SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_str_to_date
-- Source: date_time_functions.rs:413
-- ============================================================================
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (date_str STRING);
INSERT INTO strings VALUES ('2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT PARSE_DATE(date_str, '%Y-%m-%d') as parsed FROM strings;
SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_timestamp_add
-- Source: date_time_functions.rs:438
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT TIMESTAMP_ADD(event_time, INTERVAL 2 HOUR) as future_time FROM events;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_timestamp_diff
-- Source: date_time_functions.rs:465
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) as hours FROM events;
SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_make_date
-- Source: date_time_functions.rs:491
-- ============================================================================
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (year INT64, month INT64, day INT64);
INSERT INTO parts VALUES (2024, 1, 15);
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT MAKE_DATE(year, month, day) as date FROM parts;
SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_make_timestamp
-- Source: date_time_functions.rs:516
-- ============================================================================
DROP TABLE IF EXISTS parts;
CREATE TABLE parts (y INT64, m INT64, d INT64, h INT64, min INT64, s INT64);
INSERT INTO parts VALUES (2024, 1, 15, 10, 30, 45);
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT MAKE_TIMESTAMP(y, m, d, h, min, s) as ts FROM parts;
SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_age_function
-- Source: date_time_functions.rs:540
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_date DATE, end_date DATE);
INSERT INTO events VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT AGE(end_date, start_date) as age FROM events;
SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_interval_arithmetic
-- Source: date_time_functions.rs:565
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (DATE '2024-01-15');
INSERT INTO events VALUES (DATE '2024-02-15');
INSERT INTO events VALUES (DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_date DATE);
INSERT INTO events VALUES (NULL);
INSERT INTO events VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (event_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (event_date DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');

SELECT event_date + INTERVAL '7 days' as future_date FROM dates;
SELECT EXTRACT(HOUR FROM event_time) as hour FROM events;
SELECT EXTRACT(MINUTE FROM event_time) as minute FROM events;
SELECT EXTRACT(SECOND FROM event_time) as second FROM events;
SELECT * FROM events WHERE event_date > DATE '2024-01-31';
SELECT * FROM events WHERE event_time > TIMESTAMP '2024-01-15 12:00:00';
SELECT * FROM events WHERE event_date IS NULL;
SELECT event_time AT TIME ZONE 'UTC' as utc_time FROM events;
SELECT EXTRACT(DOW FROM event_date) as day_of_week FROM dates;
SELECT EXTRACT(DOY FROM event_date) as day_of_year FROM dates;

-- ============================================================================
-- Test: test_date_add_days
-- Source: date_time_functions_advanced.rs:26
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (DATE '2024-01-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT DATE_ADD(dt, INTERVAL 1 MONTH) AS result FROM dates;
SELECT DATE_ADD(DATE '2020-02-29', INTERVAL 1 YEAR) AS result;
SELECT DATE_ADD(DATE '2024-03-15', INTERVAL -10 DAY) AS result;
SELECT DATE_ADD(NULL, INTERVAL 10 DAY) AS result;
SELECT DATE_SUB(DATE '2024-01-15', INTERVAL 10 DAY) AS result;
SELECT DATE_SUB(DATE '2024-03-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_SUB(DATE '2024-02-29', INTERVAL 4 YEAR) AS result;
SELECT DATE_DIFF(DATE '2024-01-20', DATE '2024-01-10', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-06-15', DATE '2024-01-15', MONTH) AS diff;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2020-01-01', YEAR) AS diff;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-20', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-01-29', DATE '2024-01-01', WEEK) AS diff;
SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_add_months
-- Source: date_time_functions_advanced.rs:42
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (DATE '2024-01-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_ADD(dt, INTERVAL 1 MONTH) AS result FROM dates;
SELECT DATE_ADD(DATE '2020-02-29', INTERVAL 1 YEAR) AS result;
SELECT DATE_ADD(DATE '2024-03-15', INTERVAL -10 DAY) AS result;
SELECT DATE_ADD(NULL, INTERVAL 10 DAY) AS result;
SELECT DATE_SUB(DATE '2024-01-15', INTERVAL 10 DAY) AS result;
SELECT DATE_SUB(DATE '2024-03-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_SUB(DATE '2024-02-29', INTERVAL 4 YEAR) AS result;
SELECT DATE_DIFF(DATE '2024-01-20', DATE '2024-01-10', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-06-15', DATE '2024-01-15', MONTH) AS diff;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2020-01-01', YEAR) AS diff;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-20', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-01-29', DATE '2024-01-01', WEEK) AS diff;
SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_add_years
-- Source: date_time_functions_advanced.rs:58
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_ADD(DATE '2020-02-29', INTERVAL 1 YEAR) AS result;
SELECT DATE_ADD(DATE '2024-03-15', INTERVAL -10 DAY) AS result;
SELECT DATE_ADD(NULL, INTERVAL 10 DAY) AS result;
SELECT DATE_SUB(DATE '2024-01-15', INTERVAL 10 DAY) AS result;
SELECT DATE_SUB(DATE '2024-03-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_SUB(DATE '2024-02-29', INTERVAL 4 YEAR) AS result;
SELECT DATE_DIFF(DATE '2024-01-20', DATE '2024-01-10', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-06-15', DATE '2024-01-15', MONTH) AS diff;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2020-01-01', YEAR) AS diff;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-20', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-01-29', DATE '2024-01-01', WEEK) AS diff;
SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_add_negative_interval
-- Source: date_time_functions_advanced.rs:68
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_ADD(DATE '2024-03-15', INTERVAL -10 DAY) AS result;
SELECT DATE_ADD(NULL, INTERVAL 10 DAY) AS result;
SELECT DATE_SUB(DATE '2024-01-15', INTERVAL 10 DAY) AS result;
SELECT DATE_SUB(DATE '2024-03-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_SUB(DATE '2024-02-29', INTERVAL 4 YEAR) AS result;
SELECT DATE_DIFF(DATE '2024-01-20', DATE '2024-01-10', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-06-15', DATE '2024-01-15', MONTH) AS diff;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2020-01-01', YEAR) AS diff;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-20', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-01-29', DATE '2024-01-01', WEEK) AS diff;
SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_add_null
-- Source: date_time_functions_advanced.rs:78
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_ADD(NULL, INTERVAL 10 DAY) AS result;
SELECT DATE_SUB(DATE '2024-01-15', INTERVAL 10 DAY) AS result;
SELECT DATE_SUB(DATE '2024-03-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_SUB(DATE '2024-02-29', INTERVAL 4 YEAR) AS result;
SELECT DATE_DIFF(DATE '2024-01-20', DATE '2024-01-10', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-06-15', DATE '2024-01-15', MONTH) AS diff;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2020-01-01', YEAR) AS diff;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-20', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-01-29', DATE '2024-01-01', WEEK) AS diff;
SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_sub_days
-- Source: date_time_functions_advanced.rs:92
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_SUB(DATE '2024-01-15', INTERVAL 10 DAY) AS result;
SELECT DATE_SUB(DATE '2024-03-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_SUB(DATE '2024-02-29', INTERVAL 4 YEAR) AS result;
SELECT DATE_DIFF(DATE '2024-01-20', DATE '2024-01-10', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-06-15', DATE '2024-01-15', MONTH) AS diff;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2020-01-01', YEAR) AS diff;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-20', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-01-29', DATE '2024-01-01', WEEK) AS diff;
SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_sub_months_end_of_month
-- Source: date_time_functions_advanced.rs:102
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_SUB(DATE '2024-03-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_SUB(DATE '2024-02-29', INTERVAL 4 YEAR) AS result;
SELECT DATE_DIFF(DATE '2024-01-20', DATE '2024-01-10', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-06-15', DATE '2024-01-15', MONTH) AS diff;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2020-01-01', YEAR) AS diff;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-20', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-01-29', DATE '2024-01-01', WEEK) AS diff;
SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_sub_years_leap_day
-- Source: date_time_functions_advanced.rs:112
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_SUB(DATE '2024-02-29', INTERVAL 4 YEAR) AS result;
SELECT DATE_DIFF(DATE '2024-01-20', DATE '2024-01-10', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-06-15', DATE '2024-01-15', MONTH) AS diff;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2020-01-01', YEAR) AS diff;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-20', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-01-29', DATE '2024-01-01', WEEK) AS diff;
SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_diff_days
-- Source: date_time_functions_advanced.rs:126
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_DIFF(DATE '2024-01-20', DATE '2024-01-10', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-06-15', DATE '2024-01-15', MONTH) AS diff;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2020-01-01', YEAR) AS diff;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-20', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-01-29', DATE '2024-01-01', WEEK) AS diff;
SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_diff_months
-- Source: date_time_functions_advanced.rs:136
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_DIFF(DATE '2024-06-15', DATE '2024-01-15', MONTH) AS diff;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2020-01-01', YEAR) AS diff;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-20', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-01-29', DATE '2024-01-01', WEEK) AS diff;
SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_diff_years
-- Source: date_time_functions_advanced.rs:146
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_DIFF(DATE '2024-12-31', DATE '2020-01-01', YEAR) AS diff;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-20', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-01-29', DATE '2024-01-01', WEEK) AS diff;
SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_diff_negative
-- Source: date_time_functions_advanced.rs:156
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-20', DAY) AS diff;
SELECT DATE_DIFF(DATE '2024-01-29', DATE '2024-01-01', WEEK) AS diff;
SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_diff_weeks
-- Source: date_time_functions_advanced.rs:166
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_DIFF(DATE '2024-01-29', DATE '2024-01-01', WEEK) AS diff;
SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_trunc_month
-- Source: date_time_functions_advanced.rs:180
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_TRUNC(DATE '2024-03-15', MONTH) AS result;
SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_trunc_year
-- Source: date_time_functions_advanced.rs:190
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_TRUNC(DATE '2024-06-15', YEAR) AS result;
SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_trunc_quarter
-- Source: date_time_functions_advanced.rs:200
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_TRUNC(DATE '2024-08-15', QUARTER) AS result;
SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_trunc_week
-- Source: date_time_functions_advanced.rs:210
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_TRUNC(DATE '2024-03-15', WEEK) AS result;
SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_extract_year
-- Source: date_time_functions_advanced.rs:224
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT EXTRACT(YEAR FROM DATE '2024-06-15') AS year;
SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_extract_month
-- Source: date_time_functions_advanced.rs:234
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT EXTRACT(MONTH FROM DATE '2024-06-15') AS month;
SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_extract_day
-- Source: date_time_functions_advanced.rs:244
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT EXTRACT(DAY FROM DATE '2024-06-15') AS day;
SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_extract_dayofweek
-- Source: date_time_functions_advanced.rs:254
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT EXTRACT(DAYOFWEEK FROM DATE '2024-01-01') AS dow;
SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_extract_dayofyear
-- Source: date_time_functions_advanced.rs:264
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT EXTRACT(DAYOFYEAR FROM DATE '2024-12-31') AS doy;
SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_extract_quarter
-- Source: date_time_functions_advanced.rs:274
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT EXTRACT(QUARTER FROM DATE '2024-08-15') AS quarter;
SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_extract_week
-- Source: date_time_functions_advanced.rs:284
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT EXTRACT(WEEK FROM DATE '2024-06-15') AS week;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_timestamp_add_hours
-- Source: date_time_functions_advanced.rs:298
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 5 HOUR) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_timestamp_add_minutes
-- Source: date_time_functions_advanced.rs:310
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 45 MINUTE) AS result;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_timestamp_add_seconds
-- Source: date_time_functions_advanced.rs:322
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 90 SECOND) AS result;
SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_timestamp_sub_hours
-- Source: date_time_functions_advanced.rs:334
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT TIMESTAMP_SUB(TIMESTAMP '2024-01-15 10:30:00', INTERVAL 3 HOUR) AS result;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_timestamp_diff_seconds
-- Source: date_time_functions_advanced.rs:346
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 10:35:00', TIMESTAMP '2024-01-15 10:30:00', SECOND) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_timestamp_diff_hours
-- Source: date_time_functions_advanced.rs:356
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-15 15:30:00', TIMESTAMP '2024-01-15 10:30:00', HOUR) AS diff;
SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_timestamp_diff_days
-- Source: date_time_functions_advanced.rs:366
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT TIMESTAMP_DIFF(TIMESTAMP '2024-01-20 10:30:00', TIMESTAMP '2024-01-15 10:30:00', DAY) AS diff;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_parse_date_iso_format
-- Source: date_time_functions_advanced.rs:380
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') AS result;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_parse_date_slash_format
-- Source: date_time_functions_advanced.rs:390
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') AS result;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_parse_timestamp
-- Source: date_time_functions_advanced.rs:400
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:45') AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_parse_date_invalid_format
-- Source: date_time_functions_advanced.rs:410
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT PARSE_DATE('%Y-%m-%d', 'invalid') AS result;
SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_format_date
-- Source: date_time_functions_advanced.rs:424
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT FORMAT_DATE('%Y-%m-%d', DATE '2024-06-15') AS result;
SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_format_date_custom
-- Source: date_time_functions_advanced.rs:434
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT FORMAT_DATE('%B %d, %Y', DATE '2024-06-15') AS result;
SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_format_timestamp
-- Source: date_time_functions_advanced.rs:444
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT FORMAT_TIMESTAMP('%Y-%m-%d %H:%M:%S', TIMESTAMP '2024-06-15 14:30:45') AS result;
SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_current_date
-- Source: date_time_functions_advanced.rs:458
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT CURRENT_DATE() AS today;
SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_current_timestamp
-- Source: date_time_functions_advanced.rs:468
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT CURRENT_TIMESTAMP() AS now;
SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_current_time
-- Source: date_time_functions_advanced.rs:478
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT CURRENT_TIME() AS now;
SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_timestamp_with_timezone
-- Source: date_time_functions_advanced.rs:492
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT TIMESTAMP(DATETIME '2024-06-15 14:30:00', 'America/New_York') AS result;
SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_timestamp_convert_timezone
-- Source: date_time_functions_advanced.rs:504
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT TIMESTAMP(TIMESTAMP '2024-06-15 14:30:00 UTC', 'America/Los_Angeles') AS result;
SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_arithmetic_in_where
-- Source: date_time_functions_advanced.rs:518
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_date DATE);
INSERT INTO events VALUES ('Event 1', DATE '2024-01-15');
INSERT INTO events VALUES ('Event 2', DATE '2024-03-20');
INSERT INTO events VALUES ('Event 3', DATE '2024-06-10');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT name FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 2 MONTH);
SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_extract_in_group_by
-- Source: date_time_functions_advanced.rs:541
-- ============================================================================
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (amount INT64, sale_date DATE);
INSERT INTO sales VALUES (100, DATE '2024-01-15');
INSERT INTO sales VALUES (200, DATE '2024-01-20');
INSERT INTO sales VALUES (150, DATE '2024-02-10');
INSERT INTO sales VALUES (300, DATE '2024-02-25');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT EXTRACT(MONTH FROM sale_date) AS month, SUM(amount) AS total
FROM sales
GROUP BY EXTRACT(MONTH FROM sale_date)
ORDER BY month;
SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_trunc_in_aggregation
-- Source: date_time_functions_advanced.rs:572
-- ============================================================================
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (message STRING, log_time TIMESTAMP);
INSERT INTO logs VALUES ('Log 1', TIMESTAMP '2024-01-15 10:30:00');
INSERT INTO logs VALUES ('Log 2', TIMESTAMP '2024-01-15 14:45:00');
INSERT INTO logs VALUES ('Log 3', TIMESTAMP '2024-01-16 09:20:00');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (name STRING, start_date DATE, duration_days INT64);
INSERT INTO projects VALUES ('Project A', DATE '2024-01-01', 90);
DROP TABLE IF EXISTS events;
CREATE TABLE events (name STRING, event_time TIMESTAMP);
INSERT INTO events VALUES ('Event C', TIMESTAMP '2024-01-15 15:00:00');
INSERT INTO events VALUES ('Event A', TIMESTAMP '2024-01-15 10:00:00');
INSERT INTO events VALUES ('Event B', TIMESTAMP '2024-01-15 12:30:00');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (dt DATE);
INSERT INTO dates VALUES (NULL);

SELECT DATE_TRUNC(log_time, DAY) AS day, COUNT(*) AS log_count
FROM logs
GROUP BY DATE_TRUNC(log_time, DAY)
ORDER BY day;
SELECT
name,
start_date,
DATE_ADD(start_date, INTERVAL duration_days DAY) AS end_date,
DATE_DIFF(DATE_ADD(start_date, INTERVAL duration_days DAY), CURRENT_DATE(), DAY) AS days_remaining
FROM projects;
SELECT name FROM events ORDER BY event_time;
SELECT DATE_ADD(DATE '2024-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2023-02-28', INTERVAL 1 DAY) AS result;
SELECT DATE_ADD(DATE '2024-01-31', INTERVAL 1 MONTH) AS result;
SELECT DATE_ADD(DATE '2023-12-31', INTERVAL 1 DAY) AS result;
SELECT DATE_DIFF(DATE '2024-12-31', DATE '2000-01-01', DAY) AS diff;
SELECT DATE_ADD(DATE '2024-01-01', INTERVAL n DAY) AS date
FROM UNNEST(GENERATE_ARRAY(0, 6)) AS n
ORDER BY date;
SELECT TIMESTAMP_ADD(TIMESTAMP '2024-01-15 10:30:00.000000', INTERVAL 500000 MICROSECOND) AS result;
SELECT DATE_ADD(dt, INTERVAL 10 DAY) AS result FROM dates;
SELECT EXTRACT(YEAR FROM dt) AS year FROM dates;
SELECT DATE_DIFF(NULL, DATE '2024-01-01', DAY) AS diff;
SELECT FORMAT_DATE('%Y-%m-%d', dt) AS formatted FROM dates;
SELECT DATE '2024-02-30' AS result;
SELECT TIMESTAMP '2024-01-15 25:00:00' AS result;
SELECT PARSE_DATE('%Y-%m-%d', 'not-a-date') AS result;
SELECT DATE_ADD(DATE '2024-01-15', INTERVAL 10 INVALID_UNIT) AS result;

-- ============================================================================
-- Test: test_date_add_days
-- Source: date_time_functions_tdd.rs:22
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, d DATE);
INSERT INTO dates VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-01', DATE '2024-01-31');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-15', DATE '2024-06-15');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-31', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_ADD(event_date, INTERVAL 10 DAY) as new_date FROM events WHERE id = 1;
SELECT DATE_ADD(d, INTERVAL 3 MONTH) FROM dates;
SELECT DATE_ADD(d, INTERVAL 1 YEAR) FROM dates;
SELECT DATE_SUB(d, INTERVAL 20 DAY) FROM dates;
SELECT DATE_ADD(d, INTERVAL -5 DAY) FROM dates;
SELECT DATE_ADD(d, INTERVAL 10 DAY) FROM dates;
SELECT TIMESTAMP_ADD(ts, INTERVAL 5 HOUR) FROM events;
SELECT TIMESTAMP_ADD(ts, INTERVAL 90 MINUTE) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM periods;
SELECT DATE_DIFF(end_date, start_date, MONTH) FROM periods;
SELECT DATE_DIFF(end_date, start_date, YEAR) FROM periods;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_DIFF(d, d, DAY) FROM dates;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_add_months
-- Source: date_time_functions_tdd.rs:43
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, d DATE);
INSERT INTO dates VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-01', DATE '2024-01-31');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-15', DATE '2024-06-15');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-31', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_ADD(d, INTERVAL 3 MONTH) FROM dates;
SELECT DATE_ADD(d, INTERVAL 1 YEAR) FROM dates;
SELECT DATE_SUB(d, INTERVAL 20 DAY) FROM dates;
SELECT DATE_ADD(d, INTERVAL -5 DAY) FROM dates;
SELECT DATE_ADD(d, INTERVAL 10 DAY) FROM dates;
SELECT TIMESTAMP_ADD(ts, INTERVAL 5 HOUR) FROM events;
SELECT TIMESTAMP_ADD(ts, INTERVAL 90 MINUTE) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM periods;
SELECT DATE_DIFF(end_date, start_date, MONTH) FROM periods;
SELECT DATE_DIFF(end_date, start_date, YEAR) FROM periods;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_DIFF(d, d, DAY) FROM dates;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_add_years
-- Source: date_time_functions_tdd.rs:62
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-01', DATE '2024-01-31');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-15', DATE '2024-06-15');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-31', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_ADD(d, INTERVAL 1 YEAR) FROM dates;
SELECT DATE_SUB(d, INTERVAL 20 DAY) FROM dates;
SELECT DATE_ADD(d, INTERVAL -5 DAY) FROM dates;
SELECT DATE_ADD(d, INTERVAL 10 DAY) FROM dates;
SELECT TIMESTAMP_ADD(ts, INTERVAL 5 HOUR) FROM events;
SELECT TIMESTAMP_ADD(ts, INTERVAL 90 MINUTE) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM periods;
SELECT DATE_DIFF(end_date, start_date, MONTH) FROM periods;
SELECT DATE_DIFF(end_date, start_date, YEAR) FROM periods;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_DIFF(d, d, DAY) FROM dates;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_sub_days
-- Source: date_time_functions_tdd.rs:79
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-01', DATE '2024-01-31');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-15', DATE '2024-06-15');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-31', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_SUB(d, INTERVAL 20 DAY) FROM dates;
SELECT DATE_ADD(d, INTERVAL -5 DAY) FROM dates;
SELECT DATE_ADD(d, INTERVAL 10 DAY) FROM dates;
SELECT TIMESTAMP_ADD(ts, INTERVAL 5 HOUR) FROM events;
SELECT TIMESTAMP_ADD(ts, INTERVAL 90 MINUTE) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM periods;
SELECT DATE_DIFF(end_date, start_date, MONTH) FROM periods;
SELECT DATE_DIFF(end_date, start_date, YEAR) FROM periods;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_DIFF(d, d, DAY) FROM dates;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_add_negative
-- Source: date_time_functions_tdd.rs:96
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-01', DATE '2024-01-31');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-15', DATE '2024-06-15');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-31', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_ADD(d, INTERVAL -5 DAY) FROM dates;
SELECT DATE_ADD(d, INTERVAL 10 DAY) FROM dates;
SELECT TIMESTAMP_ADD(ts, INTERVAL 5 HOUR) FROM events;
SELECT TIMESTAMP_ADD(ts, INTERVAL 90 MINUTE) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM periods;
SELECT DATE_DIFF(end_date, start_date, MONTH) FROM periods;
SELECT DATE_DIFF(end_date, start_date, YEAR) FROM periods;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_DIFF(d, d, DAY) FROM dates;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_add_with_null
-- Source: date_time_functions_tdd.rs:113
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-01', DATE '2024-01-31');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-15', DATE '2024-06-15');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-31', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_ADD(d, INTERVAL 10 DAY) FROM dates;
SELECT TIMESTAMP_ADD(ts, INTERVAL 5 HOUR) FROM events;
SELECT TIMESTAMP_ADD(ts, INTERVAL 90 MINUTE) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM periods;
SELECT DATE_DIFF(end_date, start_date, MONTH) FROM periods;
SELECT DATE_DIFF(end_date, start_date, YEAR) FROM periods;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_DIFF(d, d, DAY) FROM dates;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_add_hours_to_timestamp
-- Source: date_time_functions_tdd.rs:130
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-01', DATE '2024-01-31');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-15', DATE '2024-06-15');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-31', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT TIMESTAMP_ADD(ts, INTERVAL 5 HOUR) FROM events;
SELECT TIMESTAMP_ADD(ts, INTERVAL 90 MINUTE) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM periods;
SELECT DATE_DIFF(end_date, start_date, MONTH) FROM periods;
SELECT DATE_DIFF(end_date, start_date, YEAR) FROM periods;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_DIFF(d, d, DAY) FROM dates;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_add_minutes_to_timestamp
-- Source: date_time_functions_tdd.rs:149
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-01', DATE '2024-01-31');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-15', DATE '2024-06-15');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-31', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT TIMESTAMP_ADD(ts, INTERVAL 90 MINUTE) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM periods;
SELECT DATE_DIFF(end_date, start_date, MONTH) FROM periods;
SELECT DATE_DIFF(end_date, start_date, YEAR) FROM periods;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_DIFF(d, d, DAY) FROM dates;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_diff_days
-- Source: date_time_functions_tdd.rs:171
-- ============================================================================
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-01', DATE '2024-01-31');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-15', DATE '2024-06-15');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-31', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM periods;
SELECT DATE_DIFF(end_date, start_date, MONTH) FROM periods;
SELECT DATE_DIFF(end_date, start_date, YEAR) FROM periods;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_DIFF(d, d, DAY) FROM dates;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_diff_months
-- Source: date_time_functions_tdd.rs:189
-- ============================================================================
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-15', DATE '2024-06-15');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-31', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_DIFF(end_date, start_date, MONTH) FROM periods;
SELECT DATE_DIFF(end_date, start_date, YEAR) FROM periods;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_DIFF(d, d, DAY) FROM dates;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_diff_years
-- Source: date_time_functions_tdd.rs:207
-- ============================================================================
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2020-01-01', DATE '2024-01-01');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-31', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_DIFF(end_date, start_date, YEAR) FROM periods;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_DIFF(d, d, DAY) FROM dates;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_diff_negative
-- Source: date_time_functions_tdd.rs:225
-- ============================================================================
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (DATE '2024-01-31', DATE '2024-01-01');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_DIFF(d, d, DAY) FROM dates;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_diff_same_date
-- Source: date_time_functions_tdd.rs:244
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_DIFF(d, d, DAY) FROM dates;
SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_timestamp_diff_hours
-- Source: date_time_functions_tdd.rs:261
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (start_time TIMESTAMP, end_time TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 10:00:00', TIMESTAMP '2024-01-15 15:30:00');
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT TIMESTAMP_DIFF(end_time, start_time, HOUR) FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_diff_with_null
-- Source: date_time_functions_tdd.rs:279
-- ============================================================================
DROP TABLE IF EXISTS periods;
CREATE TABLE periods (start_date DATE, end_date DATE);
INSERT INTO periods VALUES (NULL, DATE '2024-01-15');
INSERT INTO periods VALUES (DATE '2024-01-01', NULL);
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_DIFF(end_date, start_date, DAY) FROM periods;
SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_trunc_to_month
-- Source: date_time_functions_tdd.rs:305
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_TRUNC(d, MONTH) FROM dates;
SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_trunc_to_year
-- Source: date_time_functions_tdd.rs:321
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_TRUNC(d, YEAR) FROM dates;
SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_trunc_to_quarter
-- Source: date_time_functions_tdd.rs:337
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_TRUNC(d, QUARTER) FROM dates;
SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_trunc_to_week
-- Source: date_time_functions_tdd.rs:353
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DATE_TRUNC(d, WEEK) FROM dates;
SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_timestamp_trunc_to_hour
-- Source: date_time_functions_tdd.rs:369
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT TIMESTAMP_TRUNC(ts, HOUR) FROM events;
SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_timestamp_trunc_to_minute
-- Source: date_time_functions_tdd.rs:387
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-01-15 14:35:42');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT TIMESTAMP_TRUNC(ts, MINUTE) FROM events;
SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_extract_year
-- Source: date_time_functions_tdd.rs:409
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT EXTRACT(YEAR FROM d) as year FROM dates;
SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_extract_month
-- Source: date_time_functions_tdd.rs:425
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT EXTRACT(MONTH FROM d) FROM dates;
SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_extract_day
-- Source: date_time_functions_tdd.rs:441
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT EXTRACT(DAY FROM d) FROM dates;
SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_extract_hour_from_timestamp
-- Source: date_time_functions_tdd.rs:457
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT EXTRACT(HOUR FROM ts) FROM events;
SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_extract_minute_from_timestamp
-- Source: date_time_functions_tdd.rs:475
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT EXTRACT(MINUTE FROM ts) FROM events;
SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_extract_second_from_timestamp
-- Source: date_time_functions_tdd.rs:493
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (ts TIMESTAMP);
INSERT INTO events VALUES (TIMESTAMP '2024-06-15 14:30:25');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT EXTRACT(SECOND FROM ts) FROM events;
SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_extract_dayofweek
-- Source: date_time_functions_tdd.rs:511
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT EXTRACT(DAYOFWEEK FROM d) FROM dates;
SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_extract_dayofyear
-- Source: date_time_functions_tdd.rs:527
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT EXTRACT(DAYOFYEAR FROM d) FROM dates;
SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_extract_week
-- Source: date_time_functions_tdd.rs:543
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-01-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT EXTRACT(WEEK FROM d) FROM dates;
SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_extract_quarter
-- Source: date_time_functions_tdd.rs:559
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (DATE '2024-08-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT EXTRACT(QUARTER FROM d) FROM dates;
SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_extract_with_null
-- Source: date_time_functions_tdd.rs:575
-- ============================================================================
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES (NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT EXTRACT(YEAR FROM d) FROM dates;
SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_parse_date_iso_format
-- Source: date_time_functions_tdd.rs:596
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT PARSE_DATE('%Y-%m-%d', '2024-06-15') as parsed FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_parse_date_us_format
-- Source: date_time_functions_tdd.rs:612
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT PARSE_DATE('%m/%d/%Y', '06/15/2024') FROM test;
SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_parse_date_with_month_name
-- Source: date_time_functions_tdd.rs:628
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT PARSE_DATE('%B %d, %Y', 'June 15, 2024') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_parse_timestamp_with_time
-- Source: date_time_functions_tdd.rs:644
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', '2024-06-15 14:30:25') FROM test;
SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_parse_timestamp_iso8601
-- Source: date_time_functions_tdd.rs:660
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT PARSE_TIMESTAMP('%Y-%m-%dT%H:%M:%S', '2024-06-15T14:30:25') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_parse_date_invalid_format
-- Source: date_time_functions_tdd.rs:675
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT PARSE_DATE('%Y-%m-%d', 'not a date') FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_parse_date_invalid_date
-- Source: date_time_functions_tdd.rs:690
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_current_date
-- Source: date_time_functions_tdd.rs:709
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT CURRENT_DATE() as today FROM test;
SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_current_timestamp
-- Source: date_time_functions_tdd.rs:725
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT CURRENT_TIMESTAMP() as now FROM test;
SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_now_function
-- Source: date_time_functions_tdd.rs:741
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT NOW() as current_time FROM test;
SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_current_date_consistency
-- Source: date_time_functions_tdd.rs:757
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1), (2), (3);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT DISTINCT CURRENT_DATE() FROM test;
SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_arithmetic_in_where_clause
-- Source: date_time_functions_tdd.rs:780
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-10');
INSERT INTO events VALUES (2, DATE '2024-01-20');
INSERT INTO events VALUES (3, DATE '2024-02-01');
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT id FROM events WHERE event_date > DATE_ADD(DATE '2024-01-01', INTERVAL 15 DAY);
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_extract_in_group_by
-- Source: date_time_functions_tdd.rs:806
-- ============================================================================
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount FLOAT64);
INSERT INTO sales VALUES (1, DATE '2024-01-15', 100.0);
INSERT INTO sales VALUES (2, DATE '2024-01-20', 150.0);
INSERT INTO sales VALUES (3, DATE '2024-02-10', 200.0);
INSERT INTO sales VALUES (4, DATE '2024-02-15', 175.0);
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales GROUP BY EXTRACT(MONTH FROM sale_date) ORDER BY month;
SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_diff_with_aggregation
-- Source: date_time_functions_tdd.rs:836
-- ============================================================================
DROP TABLE IF EXISTS subscriptions;
CREATE TABLE subscriptions (user_id INT64, start_date DATE, end_date DATE);
INSERT INTO subscriptions VALUES (1, DATE '2024-01-01', DATE '2024-01-31');
INSERT INTO subscriptions VALUES (2, DATE '2024-01-01', DATE '2024-03-31');
INSERT INTO subscriptions VALUES (3, DATE '2024-01-01', DATE '2024-06-30');
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT AVG(DATE_DIFF(end_date, start_date, DAY)) as avg_duration FROM subscriptions;
SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_complex_date_expression
-- Source: date_time_functions_tdd.rs:861
-- ============================================================================
DROP TABLE IF EXISTS projects;
CREATE TABLE projects (id INT64, start_date DATE);
INSERT INTO projects VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, log_date DATE, message STRING);
INSERT INTO logs VALUES (1, DATE '2024-01-05', 'msg1');
INSERT INTO logs VALUES (2, DATE '2024-01-15', 'msg2');
INSERT INTO logs VALUES (3, DATE '2024-01-25', 'msg3');
INSERT INTO logs VALUES (4, DATE '2024-02-05', 'msg4');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP, type STRING);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:15:30', 'click');
INSERT INTO events VALUES (2, TIMESTAMP '2024-01-15 10:45:20', 'view');
INSERT INTO events VALUES (3, TIMESTAMP '2024-01-15 11:05:10', 'click');

SELECT EXTRACT(MONTH FROM DATE_ADD(start_date, INTERVAL 30 DAY)) as future_month FROM projects;
SELECT id FROM logs \
WHERE log_date BETWEEN DATE '2024-01-10' AND DATE '2024-01-31' \
ORDER BY id;
SELECT TIMESTAMP_TRUNC(event_time, HOUR) as hour, COUNT(*) as count \
FROM events GROUP BY TIMESTAMP_TRUNC(event_time, HOUR);

-- ============================================================================
-- Test: test_date_minimum_year_0001
-- Source: datetime_extreme_edge_cases_tdd.rs:28
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '0001-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '9999-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '10000-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '0000-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '9999-12-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-02-29');
INSERT INTO events VALUES (2, DATE '2000-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2023-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '1900-02-29');
INSERT INTO events VALUES (2, DATE '2100-02-29');
INSERT INTO events VALUES (3, DATE '2000-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-13-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-00-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-32');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-04-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-00');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456789');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 00:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 23:59:59.999999');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 24:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:60:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:60');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
INSERT INTO events VALUES (2, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, date1 DATE, date2 DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);

SELECT DATE_ADD(event_date, INTERVAL 365 DAY) as future_date FROM events;
SELECT COUNT(*) as count FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL -1 YEAR) as new_date FROM events;
SELECT logged_at FROM logs;
SELECT event_time FROM events;
SELECT event_time FROM events;
SELECT DATE_ADD(event_date, INTERVAL -5 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 0 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 10000 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 30 DAY) as new_date FROM events;
SELECT DATE_DIFF(DATE '2024-01-15', DATE '2024-01-15', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-15', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2025-03-01', DATE '2024-02-28', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-03-15', DATE '2024-01-15', MONTH) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-02-20', DATE '2024-01-15', MONTH) as diff FROM test;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT id, EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events ORDER BY id;
SELECT EXTRACT(WEEK FROM event_date) as week FROM events;
SELECT EXTRACT(MICROSECOND FROM logged_at) as us FROM logs;
SELECT NOW() as current_time FROM test;
SELECT NOW() as t1, NOW() as t2 FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT DATE_ADD(event_date, INTERVAL 1 DAY) as new_date FROM events;
SELECT DATE_DIFF(date1, date2, DAY) as diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT PARSE_DATE('%Y-%m-%d', '2024-01-15') as date1 FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '01/15/2024') as date2 FROM test;
SELECT PARSE_DATE('%d.%m.%Y', '15.01.2024') as date3 FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '01/15/2024') as parsed FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') as parsed FROM test;

-- ============================================================================
-- Test: test_date_maximum_year_9999
-- Source: datetime_extreme_edge_cases_tdd.rs:46
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '9999-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '10000-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '0000-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '9999-12-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-02-29');
INSERT INTO events VALUES (2, DATE '2000-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2023-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '1900-02-29');
INSERT INTO events VALUES (2, DATE '2100-02-29');
INSERT INTO events VALUES (3, DATE '2000-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-13-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-00-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-32');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-04-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-00');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456789');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 00:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 23:59:59.999999');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 24:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:60:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:60');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
INSERT INTO events VALUES (2, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, date1 DATE, date2 DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);

SELECT DATE_ADD(event_date, INTERVAL 365 DAY) as future_date FROM events;
SELECT COUNT(*) as count FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL -1 YEAR) as new_date FROM events;
SELECT logged_at FROM logs;
SELECT event_time FROM events;
SELECT event_time FROM events;
SELECT DATE_ADD(event_date, INTERVAL -5 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 0 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 10000 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 30 DAY) as new_date FROM events;
SELECT DATE_DIFF(DATE '2024-01-15', DATE '2024-01-15', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-15', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2025-03-01', DATE '2024-02-28', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-03-15', DATE '2024-01-15', MONTH) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-02-20', DATE '2024-01-15', MONTH) as diff FROM test;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT id, EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events ORDER BY id;
SELECT EXTRACT(WEEK FROM event_date) as week FROM events;
SELECT EXTRACT(MICROSECOND FROM logged_at) as us FROM logs;
SELECT NOW() as current_time FROM test;
SELECT NOW() as t1, NOW() as t2 FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT DATE_ADD(event_date, INTERVAL 1 DAY) as new_date FROM events;
SELECT DATE_DIFF(date1, date2, DAY) as diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT PARSE_DATE('%Y-%m-%d', '2024-01-15') as date1 FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '01/15/2024') as date2 FROM test;
SELECT PARSE_DATE('%d.%m.%Y', '15.01.2024') as date3 FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '01/15/2024') as parsed FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') as parsed FROM test;

-- ============================================================================
-- Test: test_date_year_10000_overflow
-- Source: datetime_extreme_edge_cases_tdd.rs:64
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '10000-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '0000-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '9999-12-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-02-29');
INSERT INTO events VALUES (2, DATE '2000-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2023-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '1900-02-29');
INSERT INTO events VALUES (2, DATE '2100-02-29');
INSERT INTO events VALUES (3, DATE '2000-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-13-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-00-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-32');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-04-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-00');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456789');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 00:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 23:59:59.999999');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 24:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:60:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:60');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
INSERT INTO events VALUES (2, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, date1 DATE, date2 DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);

SELECT DATE_ADD(event_date, INTERVAL 365 DAY) as future_date FROM events;
SELECT COUNT(*) as count FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL -1 YEAR) as new_date FROM events;
SELECT logged_at FROM logs;
SELECT event_time FROM events;
SELECT event_time FROM events;
SELECT DATE_ADD(event_date, INTERVAL -5 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 0 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 10000 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 30 DAY) as new_date FROM events;
SELECT DATE_DIFF(DATE '2024-01-15', DATE '2024-01-15', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-15', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2025-03-01', DATE '2024-02-28', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-03-15', DATE '2024-01-15', MONTH) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-02-20', DATE '2024-01-15', MONTH) as diff FROM test;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT id, EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events ORDER BY id;
SELECT EXTRACT(WEEK FROM event_date) as week FROM events;
SELECT EXTRACT(MICROSECOND FROM logged_at) as us FROM logs;
SELECT NOW() as current_time FROM test;
SELECT NOW() as t1, NOW() as t2 FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT DATE_ADD(event_date, INTERVAL 1 DAY) as new_date FROM events;
SELECT DATE_DIFF(date1, date2, DAY) as diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT PARSE_DATE('%Y-%m-%d', '2024-01-15') as date1 FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '01/15/2024') as date2 FROM test;
SELECT PARSE_DATE('%d.%m.%Y', '15.01.2024') as date3 FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '01/15/2024') as parsed FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') as parsed FROM test;

-- ============================================================================
-- Test: test_date_year_0000_invalid
-- Source: datetime_extreme_edge_cases_tdd.rs:79
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '0000-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '9999-12-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-02-29');
INSERT INTO events VALUES (2, DATE '2000-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2023-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '1900-02-29');
INSERT INTO events VALUES (2, DATE '2100-02-29');
INSERT INTO events VALUES (3, DATE '2000-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-13-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-00-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-32');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-04-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-00');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456789');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 00:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 23:59:59.999999');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 24:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:60:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:60');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
INSERT INTO events VALUES (2, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, date1 DATE, date2 DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);

SELECT DATE_ADD(event_date, INTERVAL 365 DAY) as future_date FROM events;
SELECT COUNT(*) as count FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL -1 YEAR) as new_date FROM events;
SELECT logged_at FROM logs;
SELECT event_time FROM events;
SELECT event_time FROM events;
SELECT DATE_ADD(event_date, INTERVAL -5 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 0 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 10000 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 30 DAY) as new_date FROM events;
SELECT DATE_DIFF(DATE '2024-01-15', DATE '2024-01-15', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-15', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2025-03-01', DATE '2024-02-28', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-03-15', DATE '2024-01-15', MONTH) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-02-20', DATE '2024-01-15', MONTH) as diff FROM test;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT id, EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events ORDER BY id;
SELECT EXTRACT(WEEK FROM event_date) as week FROM events;
SELECT EXTRACT(MICROSECOND FROM logged_at) as us FROM logs;
SELECT NOW() as current_time FROM test;
SELECT NOW() as t1, NOW() as t2 FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT DATE_ADD(event_date, INTERVAL 1 DAY) as new_date FROM events;
SELECT DATE_DIFF(date1, date2, DAY) as diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT PARSE_DATE('%Y-%m-%d', '2024-01-15') as date1 FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '01/15/2024') as date2 FROM test;
SELECT PARSE_DATE('%d.%m.%Y', '15.01.2024') as date3 FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '01/15/2024') as parsed FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') as parsed FROM test;

-- ============================================================================
-- Test: test_date_add_overflow_year_boundary
-- Source: datetime_extreme_edge_cases_tdd.rs:94
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '9999-12-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-02-29');
INSERT INTO events VALUES (2, DATE '2000-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2023-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '1900-02-29');
INSERT INTO events VALUES (2, DATE '2100-02-29');
INSERT INTO events VALUES (3, DATE '2000-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-13-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-00-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-32');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-04-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-00');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456789');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 00:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 23:59:59.999999');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 24:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:60:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:60');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
INSERT INTO events VALUES (2, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, date1 DATE, date2 DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);

SELECT DATE_ADD(event_date, INTERVAL 365 DAY) as future_date FROM events;
SELECT COUNT(*) as count FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL -1 YEAR) as new_date FROM events;
SELECT logged_at FROM logs;
SELECT event_time FROM events;
SELECT event_time FROM events;
SELECT DATE_ADD(event_date, INTERVAL -5 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 0 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 10000 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 30 DAY) as new_date FROM events;
SELECT DATE_DIFF(DATE '2024-01-15', DATE '2024-01-15', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-15', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2025-03-01', DATE '2024-02-28', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-03-15', DATE '2024-01-15', MONTH) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-02-20', DATE '2024-01-15', MONTH) as diff FROM test;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT id, EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events ORDER BY id;
SELECT EXTRACT(WEEK FROM event_date) as week FROM events;
SELECT EXTRACT(MICROSECOND FROM logged_at) as us FROM logs;
SELECT NOW() as current_time FROM test;
SELECT NOW() as t1, NOW() as t2 FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT DATE_ADD(event_date, INTERVAL 1 DAY) as new_date FROM events;
SELECT DATE_DIFF(date1, date2, DAY) as diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT PARSE_DATE('%Y-%m-%d', '2024-01-15') as date1 FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '01/15/2024') as date2 FROM test;
SELECT PARSE_DATE('%d.%m.%Y', '15.01.2024') as date3 FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '01/15/2024') as parsed FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') as parsed FROM test;

-- ============================================================================
-- Test: test_leap_year_feb_29_valid
-- Source: datetime_extreme_edge_cases_tdd.rs:121
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-02-29');
INSERT INTO events VALUES (2, DATE '2000-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2023-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '1900-02-29');
INSERT INTO events VALUES (2, DATE '2100-02-29');
INSERT INTO events VALUES (3, DATE '2000-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-13-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-00-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-32');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-04-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-00');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456789');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 00:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 23:59:59.999999');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 24:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:60:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_time TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:60');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
INSERT INTO events VALUES (2, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS logs;
CREATE TABLE logs (id INT64, logged_at TIMESTAMP);
INSERT INTO logs VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, date1 DATE, date2 DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
INSERT INTO test VALUES (1);

SELECT COUNT(*) as count FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL -1 YEAR) as new_date FROM events;
SELECT logged_at FROM logs;
SELECT event_time FROM events;
SELECT event_time FROM events;
SELECT DATE_ADD(event_date, INTERVAL -5 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 0 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 10000 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 30 DAY) as new_date FROM events;
SELECT DATE_DIFF(DATE '2024-01-15', DATE '2024-01-15', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-01-10', DATE '2024-01-15', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2025-03-01', DATE '2024-02-28', DAY) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-03-15', DATE '2024-01-15', MONTH) as diff FROM test;
SELECT DATE_DIFF(DATE '2024-02-20', DATE '2024-01-15', MONTH) as diff FROM test;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT id, EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events ORDER BY id;
SELECT EXTRACT(WEEK FROM event_date) as week FROM events;
SELECT EXTRACT(MICROSECOND FROM logged_at) as us FROM logs;
SELECT NOW() as current_time FROM test;
SELECT NOW() as t1, NOW() as t2 FROM test;
SELECT CURRENT_DATE() as today FROM test;
SELECT DATE_ADD(event_date, INTERVAL 1 DAY) as new_date FROM events;
SELECT DATE_DIFF(date1, date2, DAY) as diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT PARSE_DATE('%Y-%m-%d', '2024-01-15') as date1 FROM test;
SELECT PARSE_DATE('%m/%d/%Y', '01/15/2024') as date2 FROM test;
SELECT PARSE_DATE('%d.%m.%Y', '15.01.2024') as date3 FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '01/15/2024') as parsed FROM test;
SELECT PARSE_DATE('%Y-%m-%d', '2024-02-30') as parsed FROM test;

-- ============================================================================
-- Test: test_date_add_days
-- Source: datetime_functions_comprehensive_tdd.rs:30
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2020-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-05');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-04-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2020-06-15', DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT event_date, DATE_ADD(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 YEAR) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL -5 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 13 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 5 DAY) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, MONTH) as months_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, YEAR) as years_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_add_months
-- Source: datetime_functions_comprehensive_tdd.rs:56
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2020-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-05');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-04-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2020-06-15', DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_ADD(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 1 YEAR) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL -5 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 13 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 5 DAY) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, MONTH) as months_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, YEAR) as years_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_add_years
-- Source: datetime_functions_comprehensive_tdd.rs:80
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2020-02-29');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-05');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-04-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2020-06-15', DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_ADD(event_date, INTERVAL 1 YEAR) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL -5 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 13 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 5 DAY) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, MONTH) as months_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, YEAR) as years_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_add_negative_interval
-- Source: datetime_functions_comprehensive_tdd.rs:104
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-05');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-04-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2020-06-15', DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_ADD(event_date, INTERVAL -5 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 13 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 5 DAY) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, MONTH) as months_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, YEAR) as years_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_add_null_date
-- Source: datetime_functions_comprehensive_tdd.rs:128
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-05');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-04-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2020-06-15', DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_ADD(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_ADD(event_date, INTERVAL 13 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 5 DAY) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, MONTH) as months_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, YEAR) as years_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_add_month_overflow
-- Source: datetime_functions_comprehensive_tdd.rs:150
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-05');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-04-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2020-06-15', DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_ADD(event_date, INTERVAL 13 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 5 DAY) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, MONTH) as months_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, YEAR) as years_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_sub_days
-- Source: datetime_functions_comprehensive_tdd.rs:178
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-05');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-04-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2020-06-15', DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_SUB(event_date, INTERVAL 5 DAY) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, MONTH) as months_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, YEAR) as years_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_sub_months_boundary
-- Source: datetime_functions_comprehensive_tdd.rs:202
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-05');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-04-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2020-06-15', DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_SUB(event_date, INTERVAL 1 MONTH) as new_date FROM events;
SELECT DATE_SUB(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, MONTH) as months_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, YEAR) as years_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_sub_cross_year_boundary
-- Source: datetime_functions_comprehensive_tdd.rs:226
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-05');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-04-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2020-06-15', DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_SUB(event_date, INTERVAL 10 DAY) as new_date FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, MONTH) as months_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, YEAR) as years_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_diff_days
-- Source: datetime_functions_comprehensive_tdd.rs:254
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01', DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-04-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2020-06-15', DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, MONTH) as months_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, YEAR) as years_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_diff_months
-- Source: datetime_functions_comprehensive_tdd.rs:276
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-04-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2020-06-15', DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_DIFF(end_date, start_date, MONTH) as months_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, YEAR) as years_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_diff_years
-- Source: datetime_functions_comprehensive_tdd.rs:298
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2020-06-15', DATE '2024-06-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_DIFF(end_date, start_date, YEAR) as years_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_diff_negative
-- Source: datetime_functions_comprehensive_tdd.rs:320
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15', DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_diff_same_date
-- Source: datetime_functions_comprehensive_tdd.rs:342
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_DIFF(event_date, event_date, DAY) as days_diff FROM events;
SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_diff_with_null
-- Source: datetime_functions_comprehensive_tdd.rs:364
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, start_date DATE, end_date DATE);
INSERT INTO events VALUES (1, NULL, DATE '2024-01-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_DIFF(end_date, start_date, DAY) as days_diff FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_extract_year
-- Source: datetime_functions_comprehensive_tdd.rs:390
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_extract_month
-- Source: datetime_functions_comprehensive_tdd.rs:410
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT EXTRACT(MONTH FROM event_date) as month FROM events;
SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_extract_day
-- Source: datetime_functions_comprehensive_tdd.rs:430
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT EXTRACT(DAY FROM event_date) as day FROM events;
SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_extract_quarter
-- Source: datetime_functions_comprehensive_tdd.rs:450
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES \
(1, DATE '2024-01-15'), \
(2, DATE '2024-04-15'), \
(3, DATE '2024-07-15'), \
(4, DATE '2024-10-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT EXTRACT(QUARTER FROM event_date) as quarter FROM events ORDER BY id;
SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_extract_day_of_week
-- Source: datetime_functions_comprehensive_tdd.rs:479
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT EXTRACT(DAYOFWEEK FROM event_date) as dow FROM events;
SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_extract_day_of_year
-- Source: datetime_functions_comprehensive_tdd.rs:501
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-12-31');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT EXTRACT(DAYOFYEAR FROM event_date) as doy FROM events;
SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_extract_from_timestamp
-- Source: datetime_functions_comprehensive_tdd.rs:522
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT \
EXTRACT(YEAR FROM event_ts) as year, \
EXTRACT(MONTH FROM event_ts) as month, \
EXTRACT(DAY FROM event_ts) as day, \
EXTRACT(HOUR FROM event_ts) as hour, \
EXTRACT(MINUTE FROM event_ts) as minute, \
EXTRACT(SECOND FROM event_ts) as second \
FROM events;
SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_extract_null_date
-- Source: datetime_functions_comprehensive_tdd.rs:573
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT EXTRACT(YEAR FROM event_date) as year FROM events;
SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_trunc_day
-- Source: datetime_functions_comprehensive_tdd.rs:597
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-03-15 14:30:45');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_TRUNC(event_ts, DAY) as trunc_day FROM events;
SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_trunc_month
-- Source: datetime_functions_comprehensive_tdd.rs:620
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_TRUNC(event_date, MONTH) as trunc_month FROM events;
SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_trunc_year
-- Source: datetime_functions_comprehensive_tdd.rs:643
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_TRUNC(event_date, YEAR) as trunc_year FROM events;
SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_trunc_quarter
-- Source: datetime_functions_comprehensive_tdd.rs:666
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-05-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_TRUNC(event_date, QUARTER) as trunc_quarter FROM events;
SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_trunc_week
-- Source: datetime_functions_comprehensive_tdd.rs:689
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT DATE_TRUNC(event_date, WEEK) as trunc_week FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_timestamp_add_hours
-- Source: datetime_functions_comprehensive_tdd.rs:716
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT TIMESTAMP_ADD(event_ts, INTERVAL 5 HOUR) as new_ts FROM events;
SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_timestamp_add_minutes
-- Source: datetime_functions_comprehensive_tdd.rs:738
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:00');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT TIMESTAMP_ADD(event_ts, INTERVAL 45 MINUTE) as new_ts FROM events;
SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_timestamp_sub_seconds
-- Source: datetime_functions_comprehensive_tdd.rs:760
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:00:30');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT TIMESTAMP_SUB(event_ts, INTERVAL 15 SECOND) as new_ts FROM events;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_parse_date_iso_format
-- Source: datetime_functions_comprehensive_tdd.rs:786
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '2024-03-15');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_parse_date_custom_format
-- Source: datetime_functions_comprehensive_tdd.rs:808
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, '15/03/2024');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT PARSE_DATE('%d/%m/%Y', date_str) as parsed_date FROM data;
SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_parse_timestamp_with_time
-- Source: datetime_functions_comprehensive_tdd.rs:830
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, ts_str STRING);
INSERT INTO data VALUES (1, '2024-03-15 14:30:45');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S', ts_str) as parsed_ts FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_parse_date_invalid_format
-- Source: datetime_functions_comprehensive_tdd.rs:852
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, 'invalid-date');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_parse_date_null_string
-- Source: datetime_functions_comprehensive_tdd.rs:869
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, date_str STRING);
INSERT INTO data VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT PARSE_DATE('%Y-%m-%d', date_str) as parsed_date FROM data;
SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_now_function
-- Source: datetime_functions_comprehensive_tdd.rs:893
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT NOW() as current_time FROM data;
SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_current_timestamp_consistency
-- Source: datetime_functions_comprehensive_tdd.rs:914
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64);
INSERT INTO data VALUES (1), (2);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT id, CURRENT_TIMESTAMP() as ts FROM data ORDER BY id;
SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_date_arithmetic_in_where_clause
-- Source: datetime_functions_comprehensive_tdd.rs:944
-- ============================================================================
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, order_date DATE, amount INT64);
INSERT INTO orders VALUES \
(1, DATE '2024-01-05', 100), \
(2, DATE '2024-01-15', 200), \
(3, DATE '2024-01-25', 150);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT id, amount FROM orders \
WHERE order_date >= DATE_SUB(DATE '2024-01-20', INTERVAL 15 DAY) \
ORDER BY id;
SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_extract_for_grouping
-- Source: datetime_functions_comprehensive_tdd.rs:975
-- ============================================================================
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, sale_date DATE, amount INT64);
INSERT INTO sales VALUES \
(1, DATE '2024-01-15', 100), \
(2, DATE '2024-01-20', 150), \
(3, DATE '2024-02-10', 200), \
(4, DATE '2024-02-25', 120);
DROP TABLE IF EXISTS people;
CREATE TABLE people (id INT64, name STRING, birth_date DATE);
INSERT INTO people VALUES \
(1, 'Alice', DATE '1990-06-15'), \
(2, 'Bob', DATE '1985-03-20');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-03-15');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-29');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2024-02-30');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64, date_val DATE);
INSERT INTO dates VALUES (1, DATE '2023-12-31');
DROP TABLE IF EXISTS dates;
CREATE TABLE dates (id INT64);
INSERT INTO dates VALUES (1);
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_ts TIMESTAMP);
INSERT INTO events VALUES (1, TIMESTAMP '2024-01-15 10:30:45.123456');

SELECT EXTRACT(MONTH FROM sale_date) as month, SUM(amount) as total \
FROM sales \
GROUP BY EXTRACT(MONTH FROM sale_date) \
ORDER BY month;
SELECT name, \
DATE_DIFF(DATE '2024-01-01', birth_date, YEAR) as age \
FROM people \
ORDER BY name;
SELECT EXTRACT(YEAR FROM DATE_ADD(event_date, INTERVAL 1 YEAR)) as next_year \
FROM events;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_ADD(date_val, INTERVAL 1 DAY) as next_day FROM dates;
SELECT DATE_DIFF(DATE '2024-03-01', DATE '2024-02-01', DAY) as days FROM dates;
SELECT EXTRACT(MICROSECOND FROM event_ts) as microsec FROM events;

-- ============================================================================
-- Test: test_insert_default_values_all_nullable
-- Source: insert_advanced_features_tdd.rs:24
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING, age INT64);
INSERT INTO t DEFAULT VALUES;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64, name STRING DEFAULT 'Anonymous', status STRING DEFAULT 'active', created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP() );
INSERT INTO users DEFAULT VALUES;
DROP TABLE IF EXISTS counters;
CREATE TABLE counters (id INT64, count INT64 DEFAULT 0);
INSERT INTO counters DEFAULT VALUES;
INSERT INTO counters DEFAULT VALUES;
INSERT INTO counters DEFAULT VALUES;
DROP TABLE IF EXISTS t;
CREATE TABLE t ( id INT64 NOT NULL, name STRING );
INSERT INTO t DEFAULT VALUES;
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64, name STRING, price FLOAT64 DEFAULT 9.99 );
INSERT INTO products (id, name, price) VALUES (1, 'Widget', DEFAULT);
DROP TABLE IF EXISTS settings;
CREATE TABLE settings ( id INT64, theme STRING DEFAULT 'light', language STRING DEFAULT 'en', notifications BOOL DEFAULT true );
INSERT INTO settings VALUES (1, DEFAULT, 'fr', DEFAULT);
DROP TABLE IF EXISTS items;
CREATE TABLE items ( id INT64, category STRING DEFAULT 'general' );
INSERT INTO items VALUES
(1, 'books'),
(2, DEFAULT),
(3, 'electronics');
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING );
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES
(2, 'Bob'),
(1, 'Charlie'),  -- Duplicate key!
(3, 'David');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails ( id INT64, email STRING UNIQUE );
INSERT INTO emails VALUES (1, 'alice@example.com');
INSERT INTO emails VALUES
(2, 'bob@example.com'),
(3, 'alice@example.com'),  -- Duplicate!
(4, 'charlie@example.com');
DROP TABLE IF EXISTS people;
CREATE TABLE people ( id INT64, name STRING NOT NULL );
INSERT INTO people VALUES
(1, 'Alice'),
(2, 'Bob'),
(3, NULL);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
INSERT INTO source VALUES (2, 'Bob');
INSERT INTO source VALUES (1, 'Charlie');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64 PRIMARY KEY, name STRING);
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS calculations;
CREATE TABLE calculations (id INT64, result INT64);
INSERT INTO calculations VALUES (1, 10 + 20);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, upper_name STRING);
INSERT INTO strings VALUES (1, UPPER('hello'));
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT * FROM t;
SELECT id, name, status FROM users;
SELECT count FROM counters;
SELECT id, name, price FROM products;
SELECT theme, language, notifications FROM settings;
SELECT id, category FROM items ORDER BY id;
SELECT COUNT(*) as cnt FROM users;
SELECT COUNT(*) as cnt FROM emails;
SELECT COUNT(*) as cnt FROM people;
SELECT COUNT(*) as cnt FROM dest;
SELECT result FROM calculations;
SELECT upper_name FROM strings;
SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_insert_default_values_with_explicit_defaults
-- Source: insert_advanced_features_tdd.rs:50
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64, name STRING DEFAULT 'Anonymous', status STRING DEFAULT 'active', created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP() );
INSERT INTO users DEFAULT VALUES;
DROP TABLE IF EXISTS counters;
CREATE TABLE counters (id INT64, count INT64 DEFAULT 0);
INSERT INTO counters DEFAULT VALUES;
INSERT INTO counters DEFAULT VALUES;
INSERT INTO counters DEFAULT VALUES;
DROP TABLE IF EXISTS t;
CREATE TABLE t ( id INT64 NOT NULL, name STRING );
INSERT INTO t DEFAULT VALUES;
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64, name STRING, price FLOAT64 DEFAULT 9.99 );
INSERT INTO products (id, name, price) VALUES (1, 'Widget', DEFAULT);
DROP TABLE IF EXISTS settings;
CREATE TABLE settings ( id INT64, theme STRING DEFAULT 'light', language STRING DEFAULT 'en', notifications BOOL DEFAULT true );
INSERT INTO settings VALUES (1, DEFAULT, 'fr', DEFAULT);
DROP TABLE IF EXISTS items;
CREATE TABLE items ( id INT64, category STRING DEFAULT 'general' );
INSERT INTO items VALUES
(1, 'books'),
(2, DEFAULT),
(3, 'electronics');
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING );
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES
(2, 'Bob'),
(1, 'Charlie'),  -- Duplicate key!
(3, 'David');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails ( id INT64, email STRING UNIQUE );
INSERT INTO emails VALUES (1, 'alice@example.com');
INSERT INTO emails VALUES
(2, 'bob@example.com'),
(3, 'alice@example.com'),  -- Duplicate!
(4, 'charlie@example.com');
DROP TABLE IF EXISTS people;
CREATE TABLE people ( id INT64, name STRING NOT NULL );
INSERT INTO people VALUES
(1, 'Alice'),
(2, 'Bob'),
(3, NULL);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
INSERT INTO source VALUES (2, 'Bob');
INSERT INTO source VALUES (1, 'Charlie');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64 PRIMARY KEY, name STRING);
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS calculations;
CREATE TABLE calculations (id INT64, result INT64);
INSERT INTO calculations VALUES (1, 10 + 20);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, upper_name STRING);
INSERT INTO strings VALUES (1, UPPER('hello'));
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT id, name, status FROM users;
SELECT count FROM counters;
SELECT id, name, price FROM products;
SELECT theme, language, notifications FROM settings;
SELECT id, category FROM items ORDER BY id;
SELECT COUNT(*) as cnt FROM users;
SELECT COUNT(*) as cnt FROM emails;
SELECT COUNT(*) as cnt FROM people;
SELECT COUNT(*) as cnt FROM dest;
SELECT result FROM calculations;
SELECT upper_name FROM strings;
SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_insert_default_values_multiple_times
-- Source: insert_advanced_features_tdd.rs:94
-- ============================================================================
DROP TABLE IF EXISTS counters;
CREATE TABLE counters (id INT64, count INT64 DEFAULT 0);
INSERT INTO counters DEFAULT VALUES;
INSERT INTO counters DEFAULT VALUES;
INSERT INTO counters DEFAULT VALUES;
DROP TABLE IF EXISTS t;
CREATE TABLE t ( id INT64 NOT NULL, name STRING );
INSERT INTO t DEFAULT VALUES;
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64, name STRING, price FLOAT64 DEFAULT 9.99 );
INSERT INTO products (id, name, price) VALUES (1, 'Widget', DEFAULT);
DROP TABLE IF EXISTS settings;
CREATE TABLE settings ( id INT64, theme STRING DEFAULT 'light', language STRING DEFAULT 'en', notifications BOOL DEFAULT true );
INSERT INTO settings VALUES (1, DEFAULT, 'fr', DEFAULT);
DROP TABLE IF EXISTS items;
CREATE TABLE items ( id INT64, category STRING DEFAULT 'general' );
INSERT INTO items VALUES
(1, 'books'),
(2, DEFAULT),
(3, 'electronics');
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING );
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES
(2, 'Bob'),
(1, 'Charlie'),  -- Duplicate key!
(3, 'David');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails ( id INT64, email STRING UNIQUE );
INSERT INTO emails VALUES (1, 'alice@example.com');
INSERT INTO emails VALUES
(2, 'bob@example.com'),
(3, 'alice@example.com'),  -- Duplicate!
(4, 'charlie@example.com');
DROP TABLE IF EXISTS people;
CREATE TABLE people ( id INT64, name STRING NOT NULL );
INSERT INTO people VALUES
(1, 'Alice'),
(2, 'Bob'),
(3, NULL);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
INSERT INTO source VALUES (2, 'Bob');
INSERT INTO source VALUES (1, 'Charlie');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64 PRIMARY KEY, name STRING);
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS calculations;
CREATE TABLE calculations (id INT64, result INT64);
INSERT INTO calculations VALUES (1, 10 + 20);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, upper_name STRING);
INSERT INTO strings VALUES (1, UPPER('hello'));
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT count FROM counters;
SELECT id, name, price FROM products;
SELECT theme, language, notifications FROM settings;
SELECT id, category FROM items ORDER BY id;
SELECT COUNT(*) as cnt FROM users;
SELECT COUNT(*) as cnt FROM emails;
SELECT COUNT(*) as cnt FROM people;
SELECT COUNT(*) as cnt FROM dest;
SELECT result FROM calculations;
SELECT upper_name FROM strings;
SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_insert_default_values_respects_not_null_constraint
-- Source: insert_advanced_features_tdd.rs:128
-- ============================================================================
DROP TABLE IF EXISTS t;
CREATE TABLE t ( id INT64 NOT NULL, name STRING );
INSERT INTO t DEFAULT VALUES;
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64, name STRING, price FLOAT64 DEFAULT 9.99 );
INSERT INTO products (id, name, price) VALUES (1, 'Widget', DEFAULT);
DROP TABLE IF EXISTS settings;
CREATE TABLE settings ( id INT64, theme STRING DEFAULT 'light', language STRING DEFAULT 'en', notifications BOOL DEFAULT true );
INSERT INTO settings VALUES (1, DEFAULT, 'fr', DEFAULT);
DROP TABLE IF EXISTS items;
CREATE TABLE items ( id INT64, category STRING DEFAULT 'general' );
INSERT INTO items VALUES
(1, 'books'),
(2, DEFAULT),
(3, 'electronics');
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING );
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES
(2, 'Bob'),
(1, 'Charlie'),  -- Duplicate key!
(3, 'David');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails ( id INT64, email STRING UNIQUE );
INSERT INTO emails VALUES (1, 'alice@example.com');
INSERT INTO emails VALUES
(2, 'bob@example.com'),
(3, 'alice@example.com'),  -- Duplicate!
(4, 'charlie@example.com');
DROP TABLE IF EXISTS people;
CREATE TABLE people ( id INT64, name STRING NOT NULL );
INSERT INTO people VALUES
(1, 'Alice'),
(2, 'Bob'),
(3, NULL);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
INSERT INTO source VALUES (2, 'Bob');
INSERT INTO source VALUES (1, 'Charlie');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64 PRIMARY KEY, name STRING);
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS calculations;
CREATE TABLE calculations (id INT64, result INT64);
INSERT INTO calculations VALUES (1, 10 + 20);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, upper_name STRING);
INSERT INTO strings VALUES (1, UPPER('hello'));
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT id, name, price FROM products;
SELECT theme, language, notifications FROM settings;
SELECT id, category FROM items ORDER BY id;
SELECT COUNT(*) as cnt FROM users;
SELECT COUNT(*) as cnt FROM emails;
SELECT COUNT(*) as cnt FROM people;
SELECT COUNT(*) as cnt FROM dest;
SELECT result FROM calculations;
SELECT upper_name FROM strings;
SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_insert_explicit_default_keyword_single_column
-- Source: insert_advanced_features_tdd.rs:154
-- ============================================================================
DROP TABLE IF EXISTS products;
CREATE TABLE products ( id INT64, name STRING, price FLOAT64 DEFAULT 9.99 );
INSERT INTO products (id, name, price) VALUES (1, 'Widget', DEFAULT);
DROP TABLE IF EXISTS settings;
CREATE TABLE settings ( id INT64, theme STRING DEFAULT 'light', language STRING DEFAULT 'en', notifications BOOL DEFAULT true );
INSERT INTO settings VALUES (1, DEFAULT, 'fr', DEFAULT);
DROP TABLE IF EXISTS items;
CREATE TABLE items ( id INT64, category STRING DEFAULT 'general' );
INSERT INTO items VALUES
(1, 'books'),
(2, DEFAULT),
(3, 'electronics');
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING );
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES
(2, 'Bob'),
(1, 'Charlie'),  -- Duplicate key!
(3, 'David');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails ( id INT64, email STRING UNIQUE );
INSERT INTO emails VALUES (1, 'alice@example.com');
INSERT INTO emails VALUES
(2, 'bob@example.com'),
(3, 'alice@example.com'),  -- Duplicate!
(4, 'charlie@example.com');
DROP TABLE IF EXISTS people;
CREATE TABLE people ( id INT64, name STRING NOT NULL );
INSERT INTO people VALUES
(1, 'Alice'),
(2, 'Bob'),
(3, NULL);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
INSERT INTO source VALUES (2, 'Bob');
INSERT INTO source VALUES (1, 'Charlie');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64 PRIMARY KEY, name STRING);
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS calculations;
CREATE TABLE calculations (id INT64, result INT64);
INSERT INTO calculations VALUES (1, 10 + 20);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, upper_name STRING);
INSERT INTO strings VALUES (1, UPPER('hello'));
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT id, name, price FROM products;
SELECT theme, language, notifications FROM settings;
SELECT id, category FROM items ORDER BY id;
SELECT COUNT(*) as cnt FROM users;
SELECT COUNT(*) as cnt FROM emails;
SELECT COUNT(*) as cnt FROM people;
SELECT COUNT(*) as cnt FROM dest;
SELECT result FROM calculations;
SELECT upper_name FROM strings;
SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_insert_explicit_default_multiple_columns
-- Source: insert_advanced_features_tdd.rs:187
-- ============================================================================
DROP TABLE IF EXISTS settings;
CREATE TABLE settings ( id INT64, theme STRING DEFAULT 'light', language STRING DEFAULT 'en', notifications BOOL DEFAULT true );
INSERT INTO settings VALUES (1, DEFAULT, 'fr', DEFAULT);
DROP TABLE IF EXISTS items;
CREATE TABLE items ( id INT64, category STRING DEFAULT 'general' );
INSERT INTO items VALUES
(1, 'books'),
(2, DEFAULT),
(3, 'electronics');
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING );
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES
(2, 'Bob'),
(1, 'Charlie'),  -- Duplicate key!
(3, 'David');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails ( id INT64, email STRING UNIQUE );
INSERT INTO emails VALUES (1, 'alice@example.com');
INSERT INTO emails VALUES
(2, 'bob@example.com'),
(3, 'alice@example.com'),  -- Duplicate!
(4, 'charlie@example.com');
DROP TABLE IF EXISTS people;
CREATE TABLE people ( id INT64, name STRING NOT NULL );
INSERT INTO people VALUES
(1, 'Alice'),
(2, 'Bob'),
(3, NULL);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
INSERT INTO source VALUES (2, 'Bob');
INSERT INTO source VALUES (1, 'Charlie');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64 PRIMARY KEY, name STRING);
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS calculations;
CREATE TABLE calculations (id INT64, result INT64);
INSERT INTO calculations VALUES (1, 10 + 20);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, upper_name STRING);
INSERT INTO strings VALUES (1, UPPER('hello'));
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT theme, language, notifications FROM settings;
SELECT id, category FROM items ORDER BY id;
SELECT COUNT(*) as cnt FROM users;
SELECT COUNT(*) as cnt FROM emails;
SELECT COUNT(*) as cnt FROM people;
SELECT COUNT(*) as cnt FROM dest;
SELECT result FROM calculations;
SELECT upper_name FROM strings;
SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_insert_multi_row_with_default_keyword
-- Source: insert_advanced_features_tdd.rs:233
-- ============================================================================
DROP TABLE IF EXISTS items;
CREATE TABLE items ( id INT64, category STRING DEFAULT 'general' );
INSERT INTO items VALUES
(1, 'books'),
(2, DEFAULT),
(3, 'electronics');
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING );
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES
(2, 'Bob'),
(1, 'Charlie'),  -- Duplicate key!
(3, 'David');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails ( id INT64, email STRING UNIQUE );
INSERT INTO emails VALUES (1, 'alice@example.com');
INSERT INTO emails VALUES
(2, 'bob@example.com'),
(3, 'alice@example.com'),  -- Duplicate!
(4, 'charlie@example.com');
DROP TABLE IF EXISTS people;
CREATE TABLE people ( id INT64, name STRING NOT NULL );
INSERT INTO people VALUES
(1, 'Alice'),
(2, 'Bob'),
(3, NULL);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
INSERT INTO source VALUES (2, 'Bob');
INSERT INTO source VALUES (1, 'Charlie');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64 PRIMARY KEY, name STRING);
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS calculations;
CREATE TABLE calculations (id INT64, result INT64);
INSERT INTO calculations VALUES (1, 10 + 20);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, upper_name STRING);
INSERT INTO strings VALUES (1, UPPER('hello'));
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT id, category FROM items ORDER BY id;
SELECT COUNT(*) as cnt FROM users;
SELECT COUNT(*) as cnt FROM emails;
SELECT COUNT(*) as cnt FROM people;
SELECT COUNT(*) as cnt FROM dest;
SELECT result FROM calculations;
SELECT upper_name FROM strings;
SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_multi_row_insert_atomicity_primary_key_violation
-- Source: insert_advanced_features_tdd.rs:281
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING );
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES
(2, 'Bob'),
(1, 'Charlie'),  -- Duplicate key!
(3, 'David');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails ( id INT64, email STRING UNIQUE );
INSERT INTO emails VALUES (1, 'alice@example.com');
INSERT INTO emails VALUES
(2, 'bob@example.com'),
(3, 'alice@example.com'),  -- Duplicate!
(4, 'charlie@example.com');
DROP TABLE IF EXISTS people;
CREATE TABLE people ( id INT64, name STRING NOT NULL );
INSERT INTO people VALUES
(1, 'Alice'),
(2, 'Bob'),
(3, NULL);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
INSERT INTO source VALUES (2, 'Bob');
INSERT INTO source VALUES (1, 'Charlie');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64 PRIMARY KEY, name STRING);
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS calculations;
CREATE TABLE calculations (id INT64, result INT64);
INSERT INTO calculations VALUES (1, 10 + 20);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, upper_name STRING);
INSERT INTO strings VALUES (1, UPPER('hello'));
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT COUNT(*) as cnt FROM users;
SELECT COUNT(*) as cnt FROM emails;
SELECT COUNT(*) as cnt FROM people;
SELECT COUNT(*) as cnt FROM dest;
SELECT result FROM calculations;
SELECT upper_name FROM strings;
SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_multi_row_insert_atomicity_unique_violation
-- Source: insert_advanced_features_tdd.rs:323
-- ============================================================================
DROP TABLE IF EXISTS emails;
CREATE TABLE emails ( id INT64, email STRING UNIQUE );
INSERT INTO emails VALUES (1, 'alice@example.com');
INSERT INTO emails VALUES
(2, 'bob@example.com'),
(3, 'alice@example.com'),  -- Duplicate!
(4, 'charlie@example.com');
DROP TABLE IF EXISTS people;
CREATE TABLE people ( id INT64, name STRING NOT NULL );
INSERT INTO people VALUES
(1, 'Alice'),
(2, 'Bob'),
(3, NULL);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
INSERT INTO source VALUES (2, 'Bob');
INSERT INTO source VALUES (1, 'Charlie');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64 PRIMARY KEY, name STRING);
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS calculations;
CREATE TABLE calculations (id INT64, result INT64);
INSERT INTO calculations VALUES (1, 10 + 20);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, upper_name STRING);
INSERT INTO strings VALUES (1, UPPER('hello'));
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT COUNT(*) as cnt FROM emails;
SELECT COUNT(*) as cnt FROM people;
SELECT COUNT(*) as cnt FROM dest;
SELECT result FROM calculations;
SELECT upper_name FROM strings;
SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_multi_row_insert_atomicity_not_null_violation
-- Source: insert_advanced_features_tdd.rs:362
-- ============================================================================
DROP TABLE IF EXISTS people;
CREATE TABLE people ( id INT64, name STRING NOT NULL );
INSERT INTO people VALUES
(1, 'Alice'),
(2, 'Bob'),
(3, NULL);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
INSERT INTO source VALUES (2, 'Bob');
INSERT INTO source VALUES (1, 'Charlie');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64 PRIMARY KEY, name STRING);
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS calculations;
CREATE TABLE calculations (id INT64, result INT64);
INSERT INTO calculations VALUES (1, 10 + 20);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, upper_name STRING);
INSERT INTO strings VALUES (1, UPPER('hello'));
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT COUNT(*) as cnt FROM people;
SELECT COUNT(*) as cnt FROM dest;
SELECT result FROM calculations;
SELECT upper_name FROM strings;
SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_insert_select_atomicity_on_constraint_violation
-- Source: insert_advanced_features_tdd.rs:397
-- ============================================================================
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
INSERT INTO source VALUES (2, 'Bob');
INSERT INTO source VALUES (1, 'Charlie');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64 PRIMARY KEY, name STRING);
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS calculations;
CREATE TABLE calculations (id INT64, result INT64);
INSERT INTO calculations VALUES (1, 10 + 20);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, upper_name STRING);
INSERT INTO strings VALUES (1, UPPER('hello'));
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT COUNT(*) as cnt FROM dest;
SELECT result FROM calculations;
SELECT upper_name FROM strings;
SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_insert_with_arithmetic_in_values
-- Source: insert_advanced_features_tdd.rs:440
-- ============================================================================
DROP TABLE IF EXISTS calculations;
CREATE TABLE calculations (id INT64, result INT64);
INSERT INTO calculations VALUES (1, 10 + 20);
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, upper_name STRING);
INSERT INTO strings VALUES (1, UPPER('hello'));
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT result FROM calculations;
SELECT upper_name FROM strings;
SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_insert_with_function_call_in_values
-- Source: insert_advanced_features_tdd.rs:463
-- ============================================================================
DROP TABLE IF EXISTS strings;
CREATE TABLE strings (id INT64, upper_name STRING);
INSERT INTO strings VALUES (1, UPPER('hello'));
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT upper_name FROM strings;
SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_insert_with_case_expression_in_values
-- Source: insert_advanced_features_tdd.rs:486
-- ============================================================================
DROP TABLE IF EXISTS categories;
CREATE TABLE categories (id INT64, category STRING);
INSERT INTO categories VALUES
(1, CASE WHEN 10 > 5 THEN 'high' ELSE 'low' END);
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT category FROM categories;
SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_insert_with_coalesce_in_values
-- Source: insert_advanced_features_tdd.rs:512
-- ============================================================================
DROP TABLE IF EXISTS fallbacks;
CREATE TABLE fallbacks (id INT64, value INT64);
INSERT INTO fallbacks VALUES (1, COALESCE(NULL, NULL, 42));
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT value FROM fallbacks;
SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_insert_multi_row_with_expressions
-- Source: insert_advanced_features_tdd.rs:533
-- ============================================================================
DROP TABLE IF EXISTS computed;
CREATE TABLE computed (id INT64, value INT64);
INSERT INTO computed VALUES
(1, 5 + 5),
(2, 3 * 4),
(3, 20 / 2);
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT value FROM computed ORDER BY id;
SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_insert_with_scalar_subquery_in_values
-- Source: insert_advanced_features_tdd.rs:570
-- ============================================================================
DROP TABLE IF EXISTS config;
CREATE TABLE config (max_value INT64);
INSERT INTO config VALUES (100);
DROP TABLE IF EXISTS records;
CREATE TABLE records (id INT64, limit_value INT64);
INSERT INTO records VALUES (1, (SELECT max_value FROM config));
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (id INT64, result INT64);
INSERT INTO nulls VALUES (1, NULL + 5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, result INT64);
INSERT INTO t VALUES (1, 10 / 0);
DROP TABLE IF EXISTS mixed;
CREATE TABLE mixed (id INT64, result FLOAT64);
INSERT INTO mixed VALUES (1, 5 + 2.5);
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, name STRING);
INSERT INTO t VALUES (1, 'Alice'), (2, 'Bob') RETURNING id, name;
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT64, value INT64);
INSERT INTO t VALUES (1, 10), (2, 20) RETURNING id, value * 2 as doubled;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob') ON CONFLICT (id) DO NOTHING;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64 );
INSERT INTO inventory VALUES (1, 10);
INSERT INTO inventory VALUES (1, 5)
ON CONFLICT (product_id)
DO UPDATE SET quantity = quantity + EXCLUDED.quantity;

SELECT limit_value FROM records;
SELECT result FROM nulls;
SELECT result FROM mixed;
SELECT name FROM users WHERE id = 1;
SELECT quantity FROM inventory WHERE product_id = 1;

-- ============================================================================
-- Test: test_on_conflict_where_clause_prevents_update
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:25
-- ============================================================================
DROP TABLE IF EXISTS versioned_docs;
CREATE TABLE versioned_docs (id INT64 PRIMARY KEY, content STRING, version INT64);
INSERT INTO versioned_docs VALUES (1, 'v1 content', 1);
INSERT INTO versioned_docs VALUES (1, 'v0 content', 0)
ON CONFLICT (id) DO UPDATE SET
content = EXCLUDED.content,
version = EXCLUDED.version
WHERE EXCLUDED.version > versioned_docs.version;
DROP TABLE IF EXISTS versioned_docs;
CREATE TABLE versioned_docs (id INT64 PRIMARY KEY, content STRING, version INT64);
INSERT INTO versioned_docs VALUES (1, 'v1 content', 1);
INSERT INTO versioned_docs VALUES (1, 'v2 content', 2)
ON CONFLICT (id) DO UPDATE SET
content = EXCLUDED.content,
version = EXCLUDED.version
WHERE EXCLUDED.version > versioned_docs.version;
DROP TABLE IF EXISTS nullable_data;
CREATE TABLE nullable_data (id INT64 PRIMARY KEY, value INT64);
INSERT INTO nullable_data VALUES (1, NULL);
INSERT INTO nullable_data VALUES (1, 100)
ON CONFLICT (id) DO UPDATE SET
value = EXCLUDED.value
WHERE nullable_data.value IS NOT NULL;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob'), (2, 'Charlie'), (3, 'Diana')
ON CONFLICT (id) DO NOTHING
RETURNING id, name;
DROP TABLE IF EXISTS counters;
CREATE TABLE counters (id INT64 PRIMARY KEY, count INT64);
INSERT INTO counters VALUES (1, 10), (2, 20);
INSERT INTO counters VALUES (1, 5), (2, 5), (3, 30)
ON CONFLICT (id) DO UPDATE SET count = counters.count + EXCLUDED.count
RETURNING id, count;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price INT64);
INSERT INTO products VALUES (1, 100), (2, 200)
ON CONFLICT (id) DO UPDATE SET price = EXCLUDED.price
RETURNING id, price, price * 1.1 AS price_with_tax;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64, reserved INT64 );
INSERT INTO inventory VALUES (1, 100, 20);
INSERT INTO inventory VALUES (1, 50, 30)
ON CONFLICT (product_id) DO UPDATE SET
quantity = inventory.quantity + EXCLUDED.quantity,
reserved = CASE
WHEN EXCLUDED.reserved > inventory.reserved
THEN EXCLUDED.reserved
ELSE inventory.reserved
END;
DROP TABLE IF EXISTS status_tracker;
CREATE TABLE status_tracker ( id INT64 PRIMARY KEY, status STRING, priority INT64 );
INSERT INTO status_tracker VALUES (1, 'pending', 1);
INSERT INTO status_tracker VALUES (1, 'completed', 5)
ON CONFLICT (id) DO UPDATE SET
status = CASE
WHEN EXCLUDED.priority >= 5 THEN
CASE
WHEN status_tracker.status = 'pending' THEN 'urgent'
ELSE 'completed'
END
ELSE 'pending'
END;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (1, 'bob@test.com', 'Bob'), (2, 'charlie@test.com', 'Charlie')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (2, 'alice@test.com', 'Alice Duplicate')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, age INT64, name STRING);
INSERT INTO users VALUES (1, 25, 'Alice')
ON CONFLICT (age) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice')
ON CONFLICT (nonexistent_column) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, category STRING, price INT64);
DROP TABLE IF EXISTS category_discounts;
CREATE TABLE category_discounts (category STRING, discount FLOAT64);
INSERT INTO category_discounts VALUES ('electronics', 0.1), ('books', 0.05);
INSERT INTO products VALUES (1, 'electronics', 100);
INSERT INTO products VALUES (1, 'electronics', 100)
ON CONFLICT (id) DO UPDATE SET
price = (
SELECT CAST(100 * (1 - discount) AS INT64)
FROM category_discounts
WHERE category = EXCLUDED.category
);
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT content, version FROM versioned_docs WHERE id = 1;
SELECT content, version FROM versioned_docs WHERE id = 1;
SELECT value FROM nullable_data WHERE id = 1;
SELECT quantity, reserved FROM inventory WHERE product_id = 1;
SELECT status FROM status_tracker WHERE id = 1;
SELECT COUNT(*) FROM users;
SELECT COUNT(*) FROM users;
SELECT price FROM products WHERE id = 1;
SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_on_conflict_where_clause_allows_update
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:65
-- ============================================================================
DROP TABLE IF EXISTS versioned_docs;
CREATE TABLE versioned_docs (id INT64 PRIMARY KEY, content STRING, version INT64);
INSERT INTO versioned_docs VALUES (1, 'v1 content', 1);
INSERT INTO versioned_docs VALUES (1, 'v2 content', 2)
ON CONFLICT (id) DO UPDATE SET
content = EXCLUDED.content,
version = EXCLUDED.version
WHERE EXCLUDED.version > versioned_docs.version;
DROP TABLE IF EXISTS nullable_data;
CREATE TABLE nullable_data (id INT64 PRIMARY KEY, value INT64);
INSERT INTO nullable_data VALUES (1, NULL);
INSERT INTO nullable_data VALUES (1, 100)
ON CONFLICT (id) DO UPDATE SET
value = EXCLUDED.value
WHERE nullable_data.value IS NOT NULL;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob'), (2, 'Charlie'), (3, 'Diana')
ON CONFLICT (id) DO NOTHING
RETURNING id, name;
DROP TABLE IF EXISTS counters;
CREATE TABLE counters (id INT64 PRIMARY KEY, count INT64);
INSERT INTO counters VALUES (1, 10), (2, 20);
INSERT INTO counters VALUES (1, 5), (2, 5), (3, 30)
ON CONFLICT (id) DO UPDATE SET count = counters.count + EXCLUDED.count
RETURNING id, count;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price INT64);
INSERT INTO products VALUES (1, 100), (2, 200)
ON CONFLICT (id) DO UPDATE SET price = EXCLUDED.price
RETURNING id, price, price * 1.1 AS price_with_tax;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64, reserved INT64 );
INSERT INTO inventory VALUES (1, 100, 20);
INSERT INTO inventory VALUES (1, 50, 30)
ON CONFLICT (product_id) DO UPDATE SET
quantity = inventory.quantity + EXCLUDED.quantity,
reserved = CASE
WHEN EXCLUDED.reserved > inventory.reserved
THEN EXCLUDED.reserved
ELSE inventory.reserved
END;
DROP TABLE IF EXISTS status_tracker;
CREATE TABLE status_tracker ( id INT64 PRIMARY KEY, status STRING, priority INT64 );
INSERT INTO status_tracker VALUES (1, 'pending', 1);
INSERT INTO status_tracker VALUES (1, 'completed', 5)
ON CONFLICT (id) DO UPDATE SET
status = CASE
WHEN EXCLUDED.priority >= 5 THEN
CASE
WHEN status_tracker.status = 'pending' THEN 'urgent'
ELSE 'completed'
END
ELSE 'pending'
END;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (1, 'bob@test.com', 'Bob'), (2, 'charlie@test.com', 'Charlie')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (2, 'alice@test.com', 'Alice Duplicate')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, age INT64, name STRING);
INSERT INTO users VALUES (1, 25, 'Alice')
ON CONFLICT (age) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice')
ON CONFLICT (nonexistent_column) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, category STRING, price INT64);
DROP TABLE IF EXISTS category_discounts;
CREATE TABLE category_discounts (category STRING, discount FLOAT64);
INSERT INTO category_discounts VALUES ('electronics', 0.1), ('books', 0.05);
INSERT INTO products VALUES (1, 'electronics', 100);
INSERT INTO products VALUES (1, 'electronics', 100)
ON CONFLICT (id) DO UPDATE SET
price = (
SELECT CAST(100 * (1 - discount) AS INT64)
FROM category_discounts
WHERE category = EXCLUDED.category
);
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT content, version FROM versioned_docs WHERE id = 1;
SELECT value FROM nullable_data WHERE id = 1;
SELECT quantity, reserved FROM inventory WHERE product_id = 1;
SELECT status FROM status_tracker WHERE id = 1;
SELECT COUNT(*) FROM users;
SELECT COUNT(*) FROM users;
SELECT price FROM products WHERE id = 1;
SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_on_conflict_where_clause_with_null_comparison
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:105
-- ============================================================================
DROP TABLE IF EXISTS nullable_data;
CREATE TABLE nullable_data (id INT64 PRIMARY KEY, value INT64);
INSERT INTO nullable_data VALUES (1, NULL);
INSERT INTO nullable_data VALUES (1, 100)
ON CONFLICT (id) DO UPDATE SET
value = EXCLUDED.value
WHERE nullable_data.value IS NOT NULL;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob'), (2, 'Charlie'), (3, 'Diana')
ON CONFLICT (id) DO NOTHING
RETURNING id, name;
DROP TABLE IF EXISTS counters;
CREATE TABLE counters (id INT64 PRIMARY KEY, count INT64);
INSERT INTO counters VALUES (1, 10), (2, 20);
INSERT INTO counters VALUES (1, 5), (2, 5), (3, 30)
ON CONFLICT (id) DO UPDATE SET count = counters.count + EXCLUDED.count
RETURNING id, count;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price INT64);
INSERT INTO products VALUES (1, 100), (2, 200)
ON CONFLICT (id) DO UPDATE SET price = EXCLUDED.price
RETURNING id, price, price * 1.1 AS price_with_tax;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64, reserved INT64 );
INSERT INTO inventory VALUES (1, 100, 20);
INSERT INTO inventory VALUES (1, 50, 30)
ON CONFLICT (product_id) DO UPDATE SET
quantity = inventory.quantity + EXCLUDED.quantity,
reserved = CASE
WHEN EXCLUDED.reserved > inventory.reserved
THEN EXCLUDED.reserved
ELSE inventory.reserved
END;
DROP TABLE IF EXISTS status_tracker;
CREATE TABLE status_tracker ( id INT64 PRIMARY KEY, status STRING, priority INT64 );
INSERT INTO status_tracker VALUES (1, 'pending', 1);
INSERT INTO status_tracker VALUES (1, 'completed', 5)
ON CONFLICT (id) DO UPDATE SET
status = CASE
WHEN EXCLUDED.priority >= 5 THEN
CASE
WHEN status_tracker.status = 'pending' THEN 'urgent'
ELSE 'completed'
END
ELSE 'pending'
END;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (1, 'bob@test.com', 'Bob'), (2, 'charlie@test.com', 'Charlie')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (2, 'alice@test.com', 'Alice Duplicate')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, age INT64, name STRING);
INSERT INTO users VALUES (1, 25, 'Alice')
ON CONFLICT (age) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice')
ON CONFLICT (nonexistent_column) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, category STRING, price INT64);
DROP TABLE IF EXISTS category_discounts;
CREATE TABLE category_discounts (category STRING, discount FLOAT64);
INSERT INTO category_discounts VALUES ('electronics', 0.1), ('books', 0.05);
INSERT INTO products VALUES (1, 'electronics', 100);
INSERT INTO products VALUES (1, 'electronics', 100)
ON CONFLICT (id) DO UPDATE SET
price = (
SELECT CAST(100 * (1 - discount) AS INT64)
FROM category_discounts
WHERE category = EXCLUDED.category
);
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT value FROM nullable_data WHERE id = 1;
SELECT quantity, reserved FROM inventory WHERE product_id = 1;
SELECT status FROM status_tracker WHERE id = 1;
SELECT COUNT(*) FROM users;
SELECT COUNT(*) FROM users;
SELECT price FROM products WHERE id = 1;
SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_returning_inserted_rows
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:144
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice');
INSERT INTO users VALUES (1, 'Bob'), (2, 'Charlie'), (3, 'Diana')
ON CONFLICT (id) DO NOTHING
RETURNING id, name;
DROP TABLE IF EXISTS counters;
CREATE TABLE counters (id INT64 PRIMARY KEY, count INT64);
INSERT INTO counters VALUES (1, 10), (2, 20);
INSERT INTO counters VALUES (1, 5), (2, 5), (3, 30)
ON CONFLICT (id) DO UPDATE SET count = counters.count + EXCLUDED.count
RETURNING id, count;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price INT64);
INSERT INTO products VALUES (1, 100), (2, 200)
ON CONFLICT (id) DO UPDATE SET price = EXCLUDED.price
RETURNING id, price, price * 1.1 AS price_with_tax;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64, reserved INT64 );
INSERT INTO inventory VALUES (1, 100, 20);
INSERT INTO inventory VALUES (1, 50, 30)
ON CONFLICT (product_id) DO UPDATE SET
quantity = inventory.quantity + EXCLUDED.quantity,
reserved = CASE
WHEN EXCLUDED.reserved > inventory.reserved
THEN EXCLUDED.reserved
ELSE inventory.reserved
END;
DROP TABLE IF EXISTS status_tracker;
CREATE TABLE status_tracker ( id INT64 PRIMARY KEY, status STRING, priority INT64 );
INSERT INTO status_tracker VALUES (1, 'pending', 1);
INSERT INTO status_tracker VALUES (1, 'completed', 5)
ON CONFLICT (id) DO UPDATE SET
status = CASE
WHEN EXCLUDED.priority >= 5 THEN
CASE
WHEN status_tracker.status = 'pending' THEN 'urgent'
ELSE 'completed'
END
ELSE 'pending'
END;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (1, 'bob@test.com', 'Bob'), (2, 'charlie@test.com', 'Charlie')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (2, 'alice@test.com', 'Alice Duplicate')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, age INT64, name STRING);
INSERT INTO users VALUES (1, 25, 'Alice')
ON CONFLICT (age) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice')
ON CONFLICT (nonexistent_column) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, category STRING, price INT64);
DROP TABLE IF EXISTS category_discounts;
CREATE TABLE category_discounts (category STRING, discount FLOAT64);
INSERT INTO category_discounts VALUES ('electronics', 0.1), ('books', 0.05);
INSERT INTO products VALUES (1, 'electronics', 100);
INSERT INTO products VALUES (1, 'electronics', 100)
ON CONFLICT (id) DO UPDATE SET
price = (
SELECT CAST(100 * (1 - discount) AS INT64)
FROM category_discounts
WHERE category = EXCLUDED.category
);
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT quantity, reserved FROM inventory WHERE product_id = 1;
SELECT status FROM status_tracker WHERE id = 1;
SELECT COUNT(*) FROM users;
SELECT COUNT(*) FROM users;
SELECT price FROM products WHERE id = 1;
SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_returning_updated_rows
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:175
-- ============================================================================
DROP TABLE IF EXISTS counters;
CREATE TABLE counters (id INT64 PRIMARY KEY, count INT64);
INSERT INTO counters VALUES (1, 10), (2, 20);
INSERT INTO counters VALUES (1, 5), (2, 5), (3, 30)
ON CONFLICT (id) DO UPDATE SET count = counters.count + EXCLUDED.count
RETURNING id, count;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price INT64);
INSERT INTO products VALUES (1, 100), (2, 200)
ON CONFLICT (id) DO UPDATE SET price = EXCLUDED.price
RETURNING id, price, price * 1.1 AS price_with_tax;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64, reserved INT64 );
INSERT INTO inventory VALUES (1, 100, 20);
INSERT INTO inventory VALUES (1, 50, 30)
ON CONFLICT (product_id) DO UPDATE SET
quantity = inventory.quantity + EXCLUDED.quantity,
reserved = CASE
WHEN EXCLUDED.reserved > inventory.reserved
THEN EXCLUDED.reserved
ELSE inventory.reserved
END;
DROP TABLE IF EXISTS status_tracker;
CREATE TABLE status_tracker ( id INT64 PRIMARY KEY, status STRING, priority INT64 );
INSERT INTO status_tracker VALUES (1, 'pending', 1);
INSERT INTO status_tracker VALUES (1, 'completed', 5)
ON CONFLICT (id) DO UPDATE SET
status = CASE
WHEN EXCLUDED.priority >= 5 THEN
CASE
WHEN status_tracker.status = 'pending' THEN 'urgent'
ELSE 'completed'
END
ELSE 'pending'
END;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (1, 'bob@test.com', 'Bob'), (2, 'charlie@test.com', 'Charlie')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (2, 'alice@test.com', 'Alice Duplicate')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, age INT64, name STRING);
INSERT INTO users VALUES (1, 25, 'Alice')
ON CONFLICT (age) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice')
ON CONFLICT (nonexistent_column) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, category STRING, price INT64);
DROP TABLE IF EXISTS category_discounts;
CREATE TABLE category_discounts (category STRING, discount FLOAT64);
INSERT INTO category_discounts VALUES ('electronics', 0.1), ('books', 0.05);
INSERT INTO products VALUES (1, 'electronics', 100);
INSERT INTO products VALUES (1, 'electronics', 100)
ON CONFLICT (id) DO UPDATE SET
price = (
SELECT CAST(100 * (1 - discount) AS INT64)
FROM category_discounts
WHERE category = EXCLUDED.category
);
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT quantity, reserved FROM inventory WHERE product_id = 1;
SELECT status FROM status_tracker WHERE id = 1;
SELECT COUNT(*) FROM users;
SELECT COUNT(*) FROM users;
SELECT price FROM products WHERE id = 1;
SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_returning_with_expressions
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:209
-- ============================================================================
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, price INT64);
INSERT INTO products VALUES (1, 100), (2, 200)
ON CONFLICT (id) DO UPDATE SET price = EXCLUDED.price
RETURNING id, price, price * 1.1 AS price_with_tax;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64, reserved INT64 );
INSERT INTO inventory VALUES (1, 100, 20);
INSERT INTO inventory VALUES (1, 50, 30)
ON CONFLICT (product_id) DO UPDATE SET
quantity = inventory.quantity + EXCLUDED.quantity,
reserved = CASE
WHEN EXCLUDED.reserved > inventory.reserved
THEN EXCLUDED.reserved
ELSE inventory.reserved
END;
DROP TABLE IF EXISTS status_tracker;
CREATE TABLE status_tracker ( id INT64 PRIMARY KEY, status STRING, priority INT64 );
INSERT INTO status_tracker VALUES (1, 'pending', 1);
INSERT INTO status_tracker VALUES (1, 'completed', 5)
ON CONFLICT (id) DO UPDATE SET
status = CASE
WHEN EXCLUDED.priority >= 5 THEN
CASE
WHEN status_tracker.status = 'pending' THEN 'urgent'
ELSE 'completed'
END
ELSE 'pending'
END;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (1, 'bob@test.com', 'Bob'), (2, 'charlie@test.com', 'Charlie')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (2, 'alice@test.com', 'Alice Duplicate')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, age INT64, name STRING);
INSERT INTO users VALUES (1, 25, 'Alice')
ON CONFLICT (age) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice')
ON CONFLICT (nonexistent_column) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, category STRING, price INT64);
DROP TABLE IF EXISTS category_discounts;
CREATE TABLE category_discounts (category STRING, discount FLOAT64);
INSERT INTO category_discounts VALUES ('electronics', 0.1), ('books', 0.05);
INSERT INTO products VALUES (1, 'electronics', 100);
INSERT INTO products VALUES (1, 'electronics', 100)
ON CONFLICT (id) DO UPDATE SET
price = (
SELECT CAST(100 * (1 - discount) AS INT64)
FROM category_discounts
WHERE category = EXCLUDED.category
);
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT quantity, reserved FROM inventory WHERE product_id = 1;
SELECT status FROM status_tracker WHERE id = 1;
SELECT COUNT(*) FROM users;
SELECT COUNT(*) FROM users;
SELECT price FROM products WHERE id = 1;
SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_case_expression_in_do_update
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:235
-- ============================================================================
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64, reserved INT64 );
INSERT INTO inventory VALUES (1, 100, 20);
INSERT INTO inventory VALUES (1, 50, 30)
ON CONFLICT (product_id) DO UPDATE SET
quantity = inventory.quantity + EXCLUDED.quantity,
reserved = CASE
WHEN EXCLUDED.reserved > inventory.reserved
THEN EXCLUDED.reserved
ELSE inventory.reserved
END;
DROP TABLE IF EXISTS status_tracker;
CREATE TABLE status_tracker ( id INT64 PRIMARY KEY, status STRING, priority INT64 );
INSERT INTO status_tracker VALUES (1, 'pending', 1);
INSERT INTO status_tracker VALUES (1, 'completed', 5)
ON CONFLICT (id) DO UPDATE SET
status = CASE
WHEN EXCLUDED.priority >= 5 THEN
CASE
WHEN status_tracker.status = 'pending' THEN 'urgent'
ELSE 'completed'
END
ELSE 'pending'
END;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (1, 'bob@test.com', 'Bob'), (2, 'charlie@test.com', 'Charlie')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (2, 'alice@test.com', 'Alice Duplicate')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, age INT64, name STRING);
INSERT INTO users VALUES (1, 25, 'Alice')
ON CONFLICT (age) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice')
ON CONFLICT (nonexistent_column) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, category STRING, price INT64);
DROP TABLE IF EXISTS category_discounts;
CREATE TABLE category_discounts (category STRING, discount FLOAT64);
INSERT INTO category_discounts VALUES ('electronics', 0.1), ('books', 0.05);
INSERT INTO products VALUES (1, 'electronics', 100);
INSERT INTO products VALUES (1, 'electronics', 100)
ON CONFLICT (id) DO UPDATE SET
price = (
SELECT CAST(100 * (1 - discount) AS INT64)
FROM category_discounts
WHERE category = EXCLUDED.category
);
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT quantity, reserved FROM inventory WHERE product_id = 1;
SELECT status FROM status_tracker WHERE id = 1;
SELECT COUNT(*) FROM users;
SELECT COUNT(*) FROM users;
SELECT price FROM products WHERE id = 1;
SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_nested_case_expressions
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:280
-- ============================================================================
DROP TABLE IF EXISTS status_tracker;
CREATE TABLE status_tracker ( id INT64 PRIMARY KEY, status STRING, priority INT64 );
INSERT INTO status_tracker VALUES (1, 'pending', 1);
INSERT INTO status_tracker VALUES (1, 'completed', 5)
ON CONFLICT (id) DO UPDATE SET
status = CASE
WHEN EXCLUDED.priority >= 5 THEN
CASE
WHEN status_tracker.status = 'pending' THEN 'urgent'
ELSE 'completed'
END
ELSE 'pending'
END;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (1, 'bob@test.com', 'Bob'), (2, 'charlie@test.com', 'Charlie')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (2, 'alice@test.com', 'Alice Duplicate')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, age INT64, name STRING);
INSERT INTO users VALUES (1, 25, 'Alice')
ON CONFLICT (age) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice')
ON CONFLICT (nonexistent_column) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, category STRING, price INT64);
DROP TABLE IF EXISTS category_discounts;
CREATE TABLE category_discounts (category STRING, discount FLOAT64);
INSERT INTO category_discounts VALUES ('electronics', 0.1), ('books', 0.05);
INSERT INTO products VALUES (1, 'electronics', 100);
INSERT INTO products VALUES (1, 'electronics', 100)
ON CONFLICT (id) DO UPDATE SET
price = (
SELECT CAST(100 * (1 - discount) AS INT64)
FROM category_discounts
WHERE category = EXCLUDED.category
);
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT status FROM status_tracker WHERE id = 1;
SELECT COUNT(*) FROM users;
SELECT COUNT(*) FROM users;
SELECT price FROM products WHERE id = 1;
SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_on_conflict_infers_primary_key
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:332
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (1, 'bob@test.com', 'Bob'), (2, 'charlie@test.com', 'Charlie')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (2, 'alice@test.com', 'Alice Duplicate')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, age INT64, name STRING);
INSERT INTO users VALUES (1, 25, 'Alice')
ON CONFLICT (age) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice')
ON CONFLICT (nonexistent_column) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, category STRING, price INT64);
DROP TABLE IF EXISTS category_discounts;
CREATE TABLE category_discounts (category STRING, discount FLOAT64);
INSERT INTO category_discounts VALUES ('electronics', 0.1), ('books', 0.05);
INSERT INTO products VALUES (1, 'electronics', 100);
INSERT INTO products VALUES (1, 'electronics', 100)
ON CONFLICT (id) DO UPDATE SET
price = (
SELECT CAST(100 * (1 - discount) AS INT64)
FROM category_discounts
WHERE category = EXCLUDED.category
);
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT COUNT(*) FROM users;
SELECT COUNT(*) FROM users;
SELECT price FROM products WHERE id = 1;
SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_on_conflict_infers_unique_constraint
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:366
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, email STRING UNIQUE, name STRING );
INSERT INTO users VALUES (1, 'alice@test.com', 'Alice');
INSERT INTO users VALUES (2, 'alice@test.com', 'Alice Duplicate')
ON CONFLICT DO NOTHING;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, age INT64, name STRING);
INSERT INTO users VALUES (1, 25, 'Alice')
ON CONFLICT (age) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice')
ON CONFLICT (nonexistent_column) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, category STRING, price INT64);
DROP TABLE IF EXISTS category_discounts;
CREATE TABLE category_discounts (category STRING, discount FLOAT64);
INSERT INTO category_discounts VALUES ('electronics', 0.1), ('books', 0.05);
INSERT INTO products VALUES (1, 'electronics', 100);
INSERT INTO products VALUES (1, 'electronics', 100)
ON CONFLICT (id) DO UPDATE SET
price = (
SELECT CAST(100 * (1 - discount) AS INT64)
FROM category_discounts
WHERE category = EXCLUDED.category
);
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT COUNT(*) FROM users;
SELECT price FROM products WHERE id = 1;
SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_error_on_conflict_target_not_unique
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:404
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, age INT64, name STRING);
INSERT INTO users VALUES (1, 25, 'Alice')
ON CONFLICT (age) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice')
ON CONFLICT (nonexistent_column) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, category STRING, price INT64);
DROP TABLE IF EXISTS category_discounts;
CREATE TABLE category_discounts (category STRING, discount FLOAT64);
INSERT INTO category_discounts VALUES ('electronics', 0.1), ('books', 0.05);
INSERT INTO products VALUES (1, 'electronics', 100);
INSERT INTO products VALUES (1, 'electronics', 100)
ON CONFLICT (id) DO UPDATE SET
price = (
SELECT CAST(100 * (1 - discount) AS INT64)
FROM category_discounts
WHERE category = EXCLUDED.category
);
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT price FROM products WHERE id = 1;
SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_error_on_conflict_target_column_does_not_exist
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:428
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice')
ON CONFLICT (nonexistent_column) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, category STRING, price INT64);
DROP TABLE IF EXISTS category_discounts;
CREATE TABLE category_discounts (category STRING, discount FLOAT64);
INSERT INTO category_discounts VALUES ('electronics', 0.1), ('books', 0.05);
INSERT INTO products VALUES (1, 'electronics', 100);
INSERT INTO products VALUES (1, 'electronics', 100)
ON CONFLICT (id) DO UPDATE SET
price = (
SELECT CAST(100 * (1 - discount) AS INT64)
FROM category_discounts
WHERE category = EXCLUDED.category
);
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT price FROM products WHERE id = 1;
SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_subquery_in_do_update_set_clause
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:456
-- ============================================================================
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64 PRIMARY KEY, category STRING, price INT64);
DROP TABLE IF EXISTS category_discounts;
CREATE TABLE category_discounts (category STRING, discount FLOAT64);
INSERT INTO category_discounts VALUES ('electronics', 0.1), ('books', 0.05);
INSERT INTO products VALUES (1, 'electronics', 100);
INSERT INTO products VALUES (1, 'electronics', 100)
ON CONFLICT (id) DO UPDATE SET
price = (
SELECT CAST(100 * (1 - discount) AS INT64)
FROM category_discounts
WHERE category = EXCLUDED.category
);
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT price FROM products WHERE id = 1;
SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_coalesce_in_do_update
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:503
-- ============================================================================
DROP TABLE IF EXISTS contacts;
CREATE TABLE contacts (id INT64 PRIMARY KEY, email STRING, phone STRING);
INSERT INTO contacts VALUES (1, 'alice@test.com', '555-1234');
INSERT INTO contacts VALUES (1, 'alice.new@test.com', NULL)
ON CONFLICT (id) DO UPDATE SET
email = EXCLUDED.email,
phone = COALESCE(EXCLUDED.phone, contacts.phone);
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT email, phone FROM contacts WHERE id = 1;
SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_large_batch_upsert_performance
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:548
-- ============================================================================
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT COUNT(*) FROM large_table;
SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_partial_conflict_all_or_nothing
-- Source: insert_on_conflict_advanced_edge_cases_tdd.rs:600
-- ============================================================================
DROP TABLE IF EXISTS strict_data;
CREATE TABLE strict_data (id INT64 PRIMARY KEY, value INT64 NOT NULL);
INSERT INTO strict_data VALUES (1, 100);
INSERT INTO strict_data VALUES (1, 200), (2, NULL), (3, 300)
ON CONFLICT (id) DO UPDATE SET value = EXCLUDED.value;

SELECT COUNT(*) FROM strict_data;
SELECT value FROM strict_data WHERE id = 1;

-- ============================================================================
-- Test: test_bulk_upsert_performance
-- Source: insert_on_conflict_upsert_comprehensive_tdd.rs:1040
-- ============================================================================
DROP TABLE IF EXISTS metrics;
CREATE TABLE metrics (id INT64 PRIMARY KEY, value INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, version INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users (id, name) VALUES (1, 'Alice')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice'), (1, 'Bob')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, updated BOOL);
INSERT INTO users VALUES (1, 'Alice', FALSE), (3, 'Charlie', FALSE);
INSERT INTO users VALUES (1, 'Alice Updated', TRUE), (2, 'Bob', FALSE), (3, 'Charlie Updated', TRUE)
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, updated = EXCLUDED.updated;
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (session_id UUID PRIMARY KEY, user_id INT64, active BOOL);
DROP TABLE IF EXISTS prices;
CREATE TABLE prices ( price NUMERIC(10, 2) PRIMARY KEY, product STRING, currency STRING );
INSERT INTO prices VALUES (99.99, 'Widget', 'USD');
INSERT INTO prices VALUES (99.99, 'Widget Pro', 'USD')
ON CONFLICT (price) DO UPDATE SET product = EXCLUDED.product;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64, reserved INT64, last_updated TIMESTAMP );
INSERT INTO inventory VALUES (1, 100, 10, TIMESTAMP '2024-01-01 00:00:00');
INSERT INTO inventory VALUES (1, 50, 5, TIMESTAMP '2024-01-02 00:00:00')
ON CONFLICT (product_id) DO UPDATE SET
quantity = inventory.quantity + EXCLUDED.quantity,
reserved = CASE
WHEN inventory.reserved > EXCLUDED.reserved THEN inventory.reserved
ELSE EXCLUDED.reserved
END,
last_updated = EXCLUDED.last_updated;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING, version INT64 );
INSERT INTO users VALUES (1, 'Alice', 5);
INSERT INTO users VALUES (1, 'Alice Old', 3)
ON CONFLICT (id) DO UPDATE SET
name = EXCLUDED.name,
version = EXCLUDED.version
WHERE EXCLUDED.version > users.version;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, email STRING, created_at TIMESTAMP);
INSERT INTO users VALUES (1, 'Alice', 'alice@example.com', TIMESTAMP '2024-01-01 00:00:00');
INSERT INTO users VALUES (1, 'Alice Updated', 'newemail@example.com', TIMESTAMP '2024-12-01 00:00:00')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, email STRING);
INSERT INTO users VALUES (1, 'Alice', 'alice@example.com');
INSERT INTO users VALUES (1, 'Alice Updated', NULL)
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, email = EXCLUDED.email;

SELECT COUNT(*) FROM metrics WHERE value % 20 = 0;
SELECT name, version FROM users WHERE id = 1;
SELECT name FROM users WHERE id = 1;
MERGE users T
USING (SELECT 1 as id, 'Alice Updated' as name) S
ON T.id = S.id
WHEN MATCHED THEN UPDATE SET name = S.name
WHEN NOT MATCHED THEN INSERT (id, name) VALUES (S.id, S.name);
SELECT name FROM users WHERE id = 1;
SELECT COUNT(*) FROM users WHERE updated = TRUE;
SELECT COUNT(*) FROM users;
SELECT product FROM prices WHERE price = 99.99;
SELECT quantity, reserved FROM inventory WHERE product_id = 1;
SELECT name, version FROM users WHERE id = 1;
SELECT name, email FROM users WHERE id = 1;
SELECT EXCLUDED.name FROM users;
SELECT name, email FROM users WHERE id = 1;

-- ============================================================================
-- Test: test_upsert_idempotency
-- Source: insert_on_conflict_upsert_comprehensive_tdd.rs:1085
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, version INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users (id, name) VALUES (1, 'Alice')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice'), (1, 'Bob')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, updated BOOL);
INSERT INTO users VALUES (1, 'Alice', FALSE), (3, 'Charlie', FALSE);
INSERT INTO users VALUES (1, 'Alice Updated', TRUE), (2, 'Bob', FALSE), (3, 'Charlie Updated', TRUE)
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, updated = EXCLUDED.updated;
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (session_id UUID PRIMARY KEY, user_id INT64, active BOOL);
DROP TABLE IF EXISTS prices;
CREATE TABLE prices ( price NUMERIC(10, 2) PRIMARY KEY, product STRING, currency STRING );
INSERT INTO prices VALUES (99.99, 'Widget', 'USD');
INSERT INTO prices VALUES (99.99, 'Widget Pro', 'USD')
ON CONFLICT (price) DO UPDATE SET product = EXCLUDED.product;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64, reserved INT64, last_updated TIMESTAMP );
INSERT INTO inventory VALUES (1, 100, 10, TIMESTAMP '2024-01-01 00:00:00');
INSERT INTO inventory VALUES (1, 50, 5, TIMESTAMP '2024-01-02 00:00:00')
ON CONFLICT (product_id) DO UPDATE SET
quantity = inventory.quantity + EXCLUDED.quantity,
reserved = CASE
WHEN inventory.reserved > EXCLUDED.reserved THEN inventory.reserved
ELSE EXCLUDED.reserved
END,
last_updated = EXCLUDED.last_updated;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING, version INT64 );
INSERT INTO users VALUES (1, 'Alice', 5);
INSERT INTO users VALUES (1, 'Alice Old', 3)
ON CONFLICT (id) DO UPDATE SET
name = EXCLUDED.name,
version = EXCLUDED.version
WHERE EXCLUDED.version > users.version;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, email STRING, created_at TIMESTAMP);
INSERT INTO users VALUES (1, 'Alice', 'alice@example.com', TIMESTAMP '2024-01-01 00:00:00');
INSERT INTO users VALUES (1, 'Alice Updated', 'newemail@example.com', TIMESTAMP '2024-12-01 00:00:00')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, email STRING);
INSERT INTO users VALUES (1, 'Alice', 'alice@example.com');
INSERT INTO users VALUES (1, 'Alice Updated', NULL)
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, email = EXCLUDED.email;

SELECT name, version FROM users WHERE id = 1;
SELECT name FROM users WHERE id = 1;
MERGE users T
USING (SELECT 1 as id, 'Alice Updated' as name) S
ON T.id = S.id
WHEN MATCHED THEN UPDATE SET name = S.name
WHEN NOT MATCHED THEN INSERT (id, name) VALUES (S.id, S.name);
SELECT name FROM users WHERE id = 1;
SELECT COUNT(*) FROM users WHERE updated = TRUE;
SELECT COUNT(*) FROM users;
SELECT product FROM prices WHERE price = 99.99;
SELECT quantity, reserved FROM inventory WHERE product_id = 1;
SELECT name, version FROM users WHERE id = 1;
SELECT name, email FROM users WHERE id = 1;
SELECT EXCLUDED.name FROM users;
SELECT name, email FROM users WHERE id = 1;

-- ============================================================================
-- Test: test_postgresql_syntax_compatibility
-- Source: insert_on_conflict_upsert_comprehensive_tdd.rs:1125
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users (id, name) VALUES (1, 'Alice')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice'), (1, 'Bob')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, updated BOOL);
INSERT INTO users VALUES (1, 'Alice', FALSE), (3, 'Charlie', FALSE);
INSERT INTO users VALUES (1, 'Alice Updated', TRUE), (2, 'Bob', FALSE), (3, 'Charlie Updated', TRUE)
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, updated = EXCLUDED.updated;
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (session_id UUID PRIMARY KEY, user_id INT64, active BOOL);
DROP TABLE IF EXISTS prices;
CREATE TABLE prices ( price NUMERIC(10, 2) PRIMARY KEY, product STRING, currency STRING );
INSERT INTO prices VALUES (99.99, 'Widget', 'USD');
INSERT INTO prices VALUES (99.99, 'Widget Pro', 'USD')
ON CONFLICT (price) DO UPDATE SET product = EXCLUDED.product;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64, reserved INT64, last_updated TIMESTAMP );
INSERT INTO inventory VALUES (1, 100, 10, TIMESTAMP '2024-01-01 00:00:00');
INSERT INTO inventory VALUES (1, 50, 5, TIMESTAMP '2024-01-02 00:00:00')
ON CONFLICT (product_id) DO UPDATE SET
quantity = inventory.quantity + EXCLUDED.quantity,
reserved = CASE
WHEN inventory.reserved > EXCLUDED.reserved THEN inventory.reserved
ELSE EXCLUDED.reserved
END,
last_updated = EXCLUDED.last_updated;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING, version INT64 );
INSERT INTO users VALUES (1, 'Alice', 5);
INSERT INTO users VALUES (1, 'Alice Old', 3)
ON CONFLICT (id) DO UPDATE SET
name = EXCLUDED.name,
version = EXCLUDED.version
WHERE EXCLUDED.version > users.version;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, email STRING, created_at TIMESTAMP);
INSERT INTO users VALUES (1, 'Alice', 'alice@example.com', TIMESTAMP '2024-01-01 00:00:00');
INSERT INTO users VALUES (1, 'Alice Updated', 'newemail@example.com', TIMESTAMP '2024-12-01 00:00:00')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, email STRING);
INSERT INTO users VALUES (1, 'Alice', 'alice@example.com');
INSERT INTO users VALUES (1, 'Alice Updated', NULL)
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, email = EXCLUDED.email;

SELECT name FROM users WHERE id = 1;
MERGE users T
USING (SELECT 1 as id, 'Alice Updated' as name) S
ON T.id = S.id
WHEN MATCHED THEN UPDATE SET name = S.name
WHEN NOT MATCHED THEN INSERT (id, name) VALUES (S.id, S.name);
SELECT name FROM users WHERE id = 1;
SELECT COUNT(*) FROM users WHERE updated = TRUE;
SELECT COUNT(*) FROM users;
SELECT product FROM prices WHERE price = 99.99;
SELECT quantity, reserved FROM inventory WHERE product_id = 1;
SELECT name, version FROM users WHERE id = 1;
SELECT name, email FROM users WHERE id = 1;
SELECT EXCLUDED.name FROM users;
SELECT name, email FROM users WHERE id = 1;

-- ============================================================================
-- Test: test_bigquery_merge_syntax
-- Source: insert_on_conflict_upsert_comprehensive_tdd.rs:1155
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice');
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice'), (1, 'Bob')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, updated BOOL);
INSERT INTO users VALUES (1, 'Alice', FALSE), (3, 'Charlie', FALSE);
INSERT INTO users VALUES (1, 'Alice Updated', TRUE), (2, 'Bob', FALSE), (3, 'Charlie Updated', TRUE)
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, updated = EXCLUDED.updated;
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (session_id UUID PRIMARY KEY, user_id INT64, active BOOL);
DROP TABLE IF EXISTS prices;
CREATE TABLE prices ( price NUMERIC(10, 2) PRIMARY KEY, product STRING, currency STRING );
INSERT INTO prices VALUES (99.99, 'Widget', 'USD');
INSERT INTO prices VALUES (99.99, 'Widget Pro', 'USD')
ON CONFLICT (price) DO UPDATE SET product = EXCLUDED.product;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64, reserved INT64, last_updated TIMESTAMP );
INSERT INTO inventory VALUES (1, 100, 10, TIMESTAMP '2024-01-01 00:00:00');
INSERT INTO inventory VALUES (1, 50, 5, TIMESTAMP '2024-01-02 00:00:00')
ON CONFLICT (product_id) DO UPDATE SET
quantity = inventory.quantity + EXCLUDED.quantity,
reserved = CASE
WHEN inventory.reserved > EXCLUDED.reserved THEN inventory.reserved
ELSE EXCLUDED.reserved
END,
last_updated = EXCLUDED.last_updated;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING, version INT64 );
INSERT INTO users VALUES (1, 'Alice', 5);
INSERT INTO users VALUES (1, 'Alice Old', 3)
ON CONFLICT (id) DO UPDATE SET
name = EXCLUDED.name,
version = EXCLUDED.version
WHERE EXCLUDED.version > users.version;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, email STRING, created_at TIMESTAMP);
INSERT INTO users VALUES (1, 'Alice', 'alice@example.com', TIMESTAMP '2024-01-01 00:00:00');
INSERT INTO users VALUES (1, 'Alice Updated', 'newemail@example.com', TIMESTAMP '2024-12-01 00:00:00')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, email STRING);
INSERT INTO users VALUES (1, 'Alice', 'alice@example.com');
INSERT INTO users VALUES (1, 'Alice Updated', NULL)
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, email = EXCLUDED.email;

MERGE users T
USING (SELECT 1 as id, 'Alice Updated' as name) S
ON T.id = S.id
WHEN MATCHED THEN UPDATE SET name = S.name
WHEN NOT MATCHED THEN INSERT (id, name) VALUES (S.id, S.name);
SELECT name FROM users WHERE id = 1;
SELECT COUNT(*) FROM users WHERE updated = TRUE;
SELECT COUNT(*) FROM users;
SELECT product FROM prices WHERE price = 99.99;
SELECT quantity, reserved FROM inventory WHERE product_id = 1;
SELECT name, version FROM users WHERE id = 1;
SELECT name, email FROM users WHERE id = 1;
SELECT EXCLUDED.name FROM users;
SELECT name, email FROM users WHERE id = 1;

-- ============================================================================
-- Test: test_upsert_duplicate_values_in_same_insert
-- Source: insert_on_conflict_upsert_comprehensive_tdd.rs:1197
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
INSERT INTO users VALUES (1, 'Alice'), (1, 'Bob')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, updated BOOL);
INSERT INTO users VALUES (1, 'Alice', FALSE), (3, 'Charlie', FALSE);
INSERT INTO users VALUES (1, 'Alice Updated', TRUE), (2, 'Bob', FALSE), (3, 'Charlie Updated', TRUE)
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, updated = EXCLUDED.updated;
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (session_id UUID PRIMARY KEY, user_id INT64, active BOOL);
DROP TABLE IF EXISTS prices;
CREATE TABLE prices ( price NUMERIC(10, 2) PRIMARY KEY, product STRING, currency STRING );
INSERT INTO prices VALUES (99.99, 'Widget', 'USD');
INSERT INTO prices VALUES (99.99, 'Widget Pro', 'USD')
ON CONFLICT (price) DO UPDATE SET product = EXCLUDED.product;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64, reserved INT64, last_updated TIMESTAMP );
INSERT INTO inventory VALUES (1, 100, 10, TIMESTAMP '2024-01-01 00:00:00');
INSERT INTO inventory VALUES (1, 50, 5, TIMESTAMP '2024-01-02 00:00:00')
ON CONFLICT (product_id) DO UPDATE SET
quantity = inventory.quantity + EXCLUDED.quantity,
reserved = CASE
WHEN inventory.reserved > EXCLUDED.reserved THEN inventory.reserved
ELSE EXCLUDED.reserved
END,
last_updated = EXCLUDED.last_updated;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING, version INT64 );
INSERT INTO users VALUES (1, 'Alice', 5);
INSERT INTO users VALUES (1, 'Alice Old', 3)
ON CONFLICT (id) DO UPDATE SET
name = EXCLUDED.name,
version = EXCLUDED.version
WHERE EXCLUDED.version > users.version;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, email STRING, created_at TIMESTAMP);
INSERT INTO users VALUES (1, 'Alice', 'alice@example.com', TIMESTAMP '2024-01-01 00:00:00');
INSERT INTO users VALUES (1, 'Alice Updated', 'newemail@example.com', TIMESTAMP '2024-12-01 00:00:00')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, email STRING);
INSERT INTO users VALUES (1, 'Alice', 'alice@example.com');
INSERT INTO users VALUES (1, 'Alice Updated', NULL)
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, email = EXCLUDED.email;

SELECT COUNT(*) FROM users WHERE updated = TRUE;
SELECT COUNT(*) FROM users;
SELECT product FROM prices WHERE price = 99.99;
SELECT quantity, reserved FROM inventory WHERE product_id = 1;
SELECT name, version FROM users WHERE id = 1;
SELECT name, email FROM users WHERE id = 1;
SELECT EXCLUDED.name FROM users;
SELECT name, email FROM users WHERE id = 1;

-- ============================================================================
-- Test: test_upsert_mixed_conflicts_and_inserts
-- Source: insert_on_conflict_upsert_comprehensive_tdd.rs:1221
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, updated BOOL);
INSERT INTO users VALUES (1, 'Alice', FALSE), (3, 'Charlie', FALSE);
INSERT INTO users VALUES (1, 'Alice Updated', TRUE), (2, 'Bob', FALSE), (3, 'Charlie Updated', TRUE)
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, updated = EXCLUDED.updated;
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (session_id UUID PRIMARY KEY, user_id INT64, active BOOL);
DROP TABLE IF EXISTS prices;
CREATE TABLE prices ( price NUMERIC(10, 2) PRIMARY KEY, product STRING, currency STRING );
INSERT INTO prices VALUES (99.99, 'Widget', 'USD');
INSERT INTO prices VALUES (99.99, 'Widget Pro', 'USD')
ON CONFLICT (price) DO UPDATE SET product = EXCLUDED.product;
DROP TABLE IF EXISTS inventory;
CREATE TABLE inventory ( product_id INT64 PRIMARY KEY, quantity INT64, reserved INT64, last_updated TIMESTAMP );
INSERT INTO inventory VALUES (1, 100, 10, TIMESTAMP '2024-01-01 00:00:00');
INSERT INTO inventory VALUES (1, 50, 5, TIMESTAMP '2024-01-02 00:00:00')
ON CONFLICT (product_id) DO UPDATE SET
quantity = inventory.quantity + EXCLUDED.quantity,
reserved = CASE
WHEN inventory.reserved > EXCLUDED.reserved THEN inventory.reserved
ELSE EXCLUDED.reserved
END,
last_updated = EXCLUDED.last_updated;
DROP TABLE IF EXISTS users;
CREATE TABLE users ( id INT64 PRIMARY KEY, name STRING, version INT64 );
INSERT INTO users VALUES (1, 'Alice', 5);
INSERT INTO users VALUES (1, 'Alice Old', 3)
ON CONFLICT (id) DO UPDATE SET
name = EXCLUDED.name,
version = EXCLUDED.version
WHERE EXCLUDED.version > users.version;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, email STRING, created_at TIMESTAMP);
INSERT INTO users VALUES (1, 'Alice', 'alice@example.com', TIMESTAMP '2024-01-01 00:00:00');
INSERT INTO users VALUES (1, 'Alice Updated', 'newemail@example.com', TIMESTAMP '2024-12-01 00:00:00')
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name;
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64 PRIMARY KEY, name STRING, email STRING);
INSERT INTO users VALUES (1, 'Alice', 'alice@example.com');
INSERT INTO users VALUES (1, 'Alice Updated', NULL)
ON CONFLICT (id) DO UPDATE SET name = EXCLUDED.name, email = EXCLUDED.email;

SELECT COUNT(*) FROM users WHERE updated = TRUE;
SELECT COUNT(*) FROM users;
SELECT product FROM prices WHERE price = 99.99;
SELECT quantity, reserved FROM inventory WHERE product_id = 1;
SELECT name, version FROM users WHERE id = 1;
SELECT name, email FROM users WHERE id = 1;
SELECT EXCLUDED.name FROM users;
SELECT name, email FROM users WHERE id = 1;

-- ============================================================================
-- Test: test_interval_year_month_literal
-- Source: interval_data_type_comprehensive_tdd.rs:23
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '2' YEAR AS interval_val;
SELECT INTERVAL '2' HOUR AS interval_val;
SELECT INTERVAL '1-3' YEAR TO MONTH AS interval_val;
SELECT INTERVAL '2:30:15' HOUR TO SECOND AS interval_val;
SELECT INTERVAL '1.5' SECOND AS interval_val;
SELECT DATE '2024-01-15' + INTERVAL '2' MONTH AS result_date;
SELECT DATE '2024-03-15' - INTERVAL '10' DAY AS result_date;
SELECT TIMESTAMP '2024-01-15 10:30:00' + INTERVAL '2' HOUR AS result_ts;
SELECT DATE '2024-01-31' + INTERVAL '1' MONTH AS result_date;
SELECT DATE '2024-02-29' + INTERVAL '1' YEAR AS result_date;
SELECT DATE '2024-03-15' - DATE '2024-03-10' AS day_diff;
SELECT TIMESTAMP '2024-01-15 12:00:00' - TIMESTAMP '2024-01-15 10:00:00' AS time_diff;
SELECT INTERVAL '2' HOUR + INTERVAL '30' MINUTE AS total_interval;
SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_day_time_literal
-- Source: interval_data_type_comprehensive_tdd.rs:40
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '2' HOUR AS interval_val;
SELECT INTERVAL '1-3' YEAR TO MONTH AS interval_val;
SELECT INTERVAL '2:30:15' HOUR TO SECOND AS interval_val;
SELECT INTERVAL '1.5' SECOND AS interval_val;
SELECT DATE '2024-01-15' + INTERVAL '2' MONTH AS result_date;
SELECT DATE '2024-03-15' - INTERVAL '10' DAY AS result_date;
SELECT TIMESTAMP '2024-01-15 10:30:00' + INTERVAL '2' HOUR AS result_ts;
SELECT DATE '2024-01-31' + INTERVAL '1' MONTH AS result_date;
SELECT DATE '2024-02-29' + INTERVAL '1' YEAR AS result_date;
SELECT DATE '2024-03-15' - DATE '2024-03-10' AS day_diff;
SELECT TIMESTAMP '2024-01-15 12:00:00' - TIMESTAMP '2024-01-15 10:00:00' AS time_diff;
SELECT INTERVAL '2' HOUR + INTERVAL '30' MINUTE AS total_interval;
SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_compound_year_to_month
-- Source: interval_data_type_comprehensive_tdd.rs:57
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '1-3' YEAR TO MONTH AS interval_val;
SELECT INTERVAL '2:30:15' HOUR TO SECOND AS interval_val;
SELECT INTERVAL '1.5' SECOND AS interval_val;
SELECT DATE '2024-01-15' + INTERVAL '2' MONTH AS result_date;
SELECT DATE '2024-03-15' - INTERVAL '10' DAY AS result_date;
SELECT TIMESTAMP '2024-01-15 10:30:00' + INTERVAL '2' HOUR AS result_ts;
SELECT DATE '2024-01-31' + INTERVAL '1' MONTH AS result_date;
SELECT DATE '2024-02-29' + INTERVAL '1' YEAR AS result_date;
SELECT DATE '2024-03-15' - DATE '2024-03-10' AS day_diff;
SELECT TIMESTAMP '2024-01-15 12:00:00' - TIMESTAMP '2024-01-15 10:00:00' AS time_diff;
SELECT INTERVAL '2' HOUR + INTERVAL '30' MINUTE AS total_interval;
SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_compound_hour_to_second
-- Source: interval_data_type_comprehensive_tdd.rs:74
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '2:30:15' HOUR TO SECOND AS interval_val;
SELECT INTERVAL '1.5' SECOND AS interval_val;
SELECT DATE '2024-01-15' + INTERVAL '2' MONTH AS result_date;
SELECT DATE '2024-03-15' - INTERVAL '10' DAY AS result_date;
SELECT TIMESTAMP '2024-01-15 10:30:00' + INTERVAL '2' HOUR AS result_ts;
SELECT DATE '2024-01-31' + INTERVAL '1' MONTH AS result_date;
SELECT DATE '2024-02-29' + INTERVAL '1' YEAR AS result_date;
SELECT DATE '2024-03-15' - DATE '2024-03-10' AS day_diff;
SELECT TIMESTAMP '2024-01-15 12:00:00' - TIMESTAMP '2024-01-15 10:00:00' AS time_diff;
SELECT INTERVAL '2' HOUR + INTERVAL '30' MINUTE AS total_interval;
SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_fractional_seconds
-- Source: interval_data_type_comprehensive_tdd.rs:91
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '1.5' SECOND AS interval_val;
SELECT DATE '2024-01-15' + INTERVAL '2' MONTH AS result_date;
SELECT DATE '2024-03-15' - INTERVAL '10' DAY AS result_date;
SELECT TIMESTAMP '2024-01-15 10:30:00' + INTERVAL '2' HOUR AS result_ts;
SELECT DATE '2024-01-31' + INTERVAL '1' MONTH AS result_date;
SELECT DATE '2024-02-29' + INTERVAL '1' YEAR AS result_date;
SELECT DATE '2024-03-15' - DATE '2024-03-10' AS day_diff;
SELECT TIMESTAMP '2024-01-15 12:00:00' - TIMESTAMP '2024-01-15 10:00:00' AS time_diff;
SELECT INTERVAL '2' HOUR + INTERVAL '30' MINUTE AS total_interval;
SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_date_plus_interval
-- Source: interval_data_type_comprehensive_tdd.rs:112
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT DATE '2024-01-15' + INTERVAL '2' MONTH AS result_date;
SELECT DATE '2024-03-15' - INTERVAL '10' DAY AS result_date;
SELECT TIMESTAMP '2024-01-15 10:30:00' + INTERVAL '2' HOUR AS result_ts;
SELECT DATE '2024-01-31' + INTERVAL '1' MONTH AS result_date;
SELECT DATE '2024-02-29' + INTERVAL '1' YEAR AS result_date;
SELECT DATE '2024-03-15' - DATE '2024-03-10' AS day_diff;
SELECT TIMESTAMP '2024-01-15 12:00:00' - TIMESTAMP '2024-01-15 10:00:00' AS time_diff;
SELECT INTERVAL '2' HOUR + INTERVAL '30' MINUTE AS total_interval;
SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_date_minus_interval
-- Source: interval_data_type_comprehensive_tdd.rs:127
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT DATE '2024-03-15' - INTERVAL '10' DAY AS result_date;
SELECT TIMESTAMP '2024-01-15 10:30:00' + INTERVAL '2' HOUR AS result_ts;
SELECT DATE '2024-01-31' + INTERVAL '1' MONTH AS result_date;
SELECT DATE '2024-02-29' + INTERVAL '1' YEAR AS result_date;
SELECT DATE '2024-03-15' - DATE '2024-03-10' AS day_diff;
SELECT TIMESTAMP '2024-01-15 12:00:00' - TIMESTAMP '2024-01-15 10:00:00' AS time_diff;
SELECT INTERVAL '2' HOUR + INTERVAL '30' MINUTE AS total_interval;
SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_timestamp_plus_interval
-- Source: interval_data_type_comprehensive_tdd.rs:142
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT TIMESTAMP '2024-01-15 10:30:00' + INTERVAL '2' HOUR AS result_ts;
SELECT DATE '2024-01-31' + INTERVAL '1' MONTH AS result_date;
SELECT DATE '2024-02-29' + INTERVAL '1' YEAR AS result_date;
SELECT DATE '2024-03-15' - DATE '2024-03-10' AS day_diff;
SELECT TIMESTAMP '2024-01-15 12:00:00' - TIMESTAMP '2024-01-15 10:00:00' AS time_diff;
SELECT INTERVAL '2' HOUR + INTERVAL '30' MINUTE AS total_interval;
SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_with_month_edge_case
-- Source: interval_data_type_comprehensive_tdd.rs:157
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT DATE '2024-01-31' + INTERVAL '1' MONTH AS result_date;
SELECT DATE '2024-02-29' + INTERVAL '1' YEAR AS result_date;
SELECT DATE '2024-03-15' - DATE '2024-03-10' AS day_diff;
SELECT TIMESTAMP '2024-01-15 12:00:00' - TIMESTAMP '2024-01-15 10:00:00' AS time_diff;
SELECT INTERVAL '2' HOUR + INTERVAL '30' MINUTE AS total_interval;
SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_with_leap_year
-- Source: interval_data_type_comprehensive_tdd.rs:173
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT DATE '2024-02-29' + INTERVAL '1' YEAR AS result_date;
SELECT DATE '2024-03-15' - DATE '2024-03-10' AS day_diff;
SELECT TIMESTAMP '2024-01-15 12:00:00' - TIMESTAMP '2024-01-15 10:00:00' AS time_diff;
SELECT INTERVAL '2' HOUR + INTERVAL '30' MINUTE AS total_interval;
SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_date_difference_returns_interval
-- Source: interval_data_type_comprehensive_tdd.rs:188
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT DATE '2024-03-15' - DATE '2024-03-10' AS day_diff;
SELECT TIMESTAMP '2024-01-15 12:00:00' - TIMESTAMP '2024-01-15 10:00:00' AS time_diff;
SELECT INTERVAL '2' HOUR + INTERVAL '30' MINUTE AS total_interval;
SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_timestamp_difference_returns_interval
-- Source: interval_data_type_comprehensive_tdd.rs:204
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT TIMESTAMP '2024-01-15 12:00:00' - TIMESTAMP '2024-01-15 10:00:00' AS time_diff;
SELECT INTERVAL '2' HOUR + INTERVAL '30' MINUTE AS total_interval;
SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_plus_interval
-- Source: interval_data_type_comprehensive_tdd.rs:226
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '2' HOUR + INTERVAL '30' MINUTE AS total_interval;
SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_minus_interval
-- Source: interval_data_type_comprehensive_tdd.rs:241
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '5' HOUR - INTERVAL '2' HOUR AS diff_interval;
SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_multiply_scalar
-- Source: interval_data_type_comprehensive_tdd.rs:256
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '2' HOUR * 3 AS multiplied_interval;
SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_divide_scalar
-- Source: interval_data_type_comprehensive_tdd.rs:271
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '6' HOUR / 2 AS divided_interval;
SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_equality
-- Source: interval_data_type_comprehensive_tdd.rs:290
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '60' MINUTE = INTERVAL '1' HOUR AS are_equal;
SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_less_than
-- Source: interval_data_type_comprehensive_tdd.rs:305
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '1' HOUR < INTERVAL '2' HOUR AS is_less;
SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_ordering_in_table
-- Source: interval_data_type_comprehensive_tdd.rs:320
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, duration INTERVAL);
INSERT INTO events VALUES
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR),
(3, INTERVAL '2' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT id FROM events ORDER BY duration;
SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_approximate_comparison
-- Source: interval_data_type_comprehensive_tdd.rs:349
-- ============================================================================
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '1' MONTH > INTERVAL '29' DAY AS is_greater;
SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_null_in_arithmetic
-- Source: interval_data_type_comprehensive_tdd.rs:369
-- ============================================================================
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT CAST(NULL AS DATE) + INTERVAL '1' DAY AS result;
SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_null_value
-- Source: interval_data_type_comprehensive_tdd.rs:383
-- ============================================================================
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, estimated_time INTERVAL);
INSERT INTO tasks VALUES (1, NULL);
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT estimated_time FROM tasks WHERE id = 1;
SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_null_in_comparison
-- Source: interval_data_type_comprehensive_tdd.rs:405
-- ============================================================================
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT CAST(NULL AS INTERVAL) < INTERVAL '1' HOUR AS result;
SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_negative_interval
-- Source: interval_data_type_comprehensive_tdd.rs:423
-- ============================================================================
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '-2' HOUR AS negative_interval;
SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_date_plus_negative_interval
-- Source: interval_data_type_comprehensive_tdd.rs:438
-- ============================================================================
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT DATE '2024-03-15' + INTERVAL '-5' DAY AS result_date;
SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_negate_interval
-- Source: interval_data_type_comprehensive_tdd.rs:453
-- ============================================================================
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT -(INTERVAL '3' HOUR) AS negated_interval;
SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_zero_interval
-- Source: interval_data_type_comprehensive_tdd.rs:472
-- ============================================================================
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '0' SECOND AS zero_interval;
SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_very_large_interval
-- Source: interval_data_type_comprehensive_tdd.rs:487
-- ============================================================================
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '100' YEAR AS large_interval;
SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_microsecond_precision
-- Source: interval_data_type_comprehensive_tdd.rs:502
-- ============================================================================
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '0.000001' SECOND AS microsecond_interval;
SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_invalid_unit
-- Source: interval_data_type_comprehensive_tdd.rs:521
-- ============================================================================
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '5' INVALID_UNIT;
SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_invalid_format
-- Source: interval_data_type_comprehensive_tdd.rs:532
-- ============================================================================
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL 'not-a-number' HOUR;
SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_divide_by_zero
-- Source: interval_data_type_comprehensive_tdd.rs:543
-- ============================================================================
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT INTERVAL '5' HOUR / 0;
SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_in_where_clause
-- Source: interval_data_type_comprehensive_tdd.rs:558
-- ============================================================================
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, delivery_time INTERVAL);
INSERT INTO orders VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '3' HOUR),
(3, INTERVAL '5' HOUR);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT id FROM orders WHERE delivery_time > INTERVAL '2' HOUR;
SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_in_case_expression
-- Source: interval_data_type_comprehensive_tdd.rs:586
-- ============================================================================
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT
CASE
WHEN 5 > 3 THEN INTERVAL '1' HOUR
ELSE INTERVAL '2' HOUR
END AS result_interval;
SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_in_aggregate_function
-- Source: interval_data_type_comprehensive_tdd.rs:607
-- ============================================================================
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, duration INTERVAL);
INSERT INTO tasks VALUES
(1, INTERVAL '1' HOUR),
(2, INTERVAL '2' HOUR),
(3, INTERVAL '3' HOUR);
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT SUM(duration) AS total_duration FROM tasks;
SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_interval_with_group_by
-- Source: interval_data_type_comprehensive_tdd.rs:635
-- ============================================================================
DROP TABLE IF EXISTS sessions;
CREATE TABLE sessions (user_id INT64, session_duration INTERVAL);
INSERT INTO sessions VALUES
(1, INTERVAL '2' HOUR),
(1, INTERVAL '3' HOUR),
(2, INTERVAL '1' HOUR);

SELECT user_id, SUM(session_duration) AS total_time
FROM sessions
GROUP BY user_id
ORDER BY user_id;
SELECT CAST('2 hours' AS INTERVAL) AS casted_interval;
SELECT CAST(INTERVAL '3' HOUR AS STRING) AS interval_string;
SELECT MAKE_INTERVAL(years => 1, months => 2, days => 3, hours => 4) AS made_interval;

-- ============================================================================
-- Test: test_not_in_select_projection
-- Source: logical_operators_comprehensive_tdd.rs:21
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, false), (2, false, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 10);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, sku STRING);
INSERT INTO products VALUES (1, 'PROD-001'), (2, 'TEST-002'), (3, 'PROD-003');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, email STRING);
INSERT INTO emails VALUES (1, 'user@test.com'), (2, 'admin@example.org'), (3, 'invalid');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Hello'), (2, 'WORLD'), (3, 'test');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, true, false), (2, true, false, false), (3, false, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, in_stock BOOL);
INSERT INTO products VALUES ('A', true), ('A', false), ('B', true), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 10), (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, keep BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
INSERT INTO test VALUES (1, 3.14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);

SELECT id, NOT active as inactive FROM test ORDER BY id;
SELECT id, NOT value as negated FROM test ORDER BY id;
SELECT id, NOT a as not_a, NOT b as not_b FROM test ORDER BY id;
SELECT id FROM test WHERE NOT (value < 20) ORDER BY id;
SELECT id FROM test WHERE NOT (value >= 15) ORDER BY id;
SELECT id FROM test WHERE NOT (value <> 10) ORDER BY id;
SELECT id FROM products WHERE NOT (sku SIMILAR TO 'PROD-%') ORDER BY id;
SELECT id FROM emails WHERE NOT (email ~ '^[a-z]+@test\\.com$') ORDER BY id;
SELECT id FROM words WHERE NOT (word ~* 'hello|world') ORDER BY id;
SELECT id FROM test WHERE NOT (NOT (NOT (NOT (value > 15)))) ORDER BY id;
SELECT id FROM test WHERE NOT ((a AND b) OR c) ORDER BY id;
SELECT id FROM test WHERE NOT (value > 10 AND value < 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value > 10)) OR (NOT (value < 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value < 10 OR value > 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value < 10)) AND (NOT (value > 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value = 10) ORDER BY id;
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
SELECT id FROM test WHERE NOT COALESCE(value, false) ORDER BY id;
SELECT id FROM test WHERE NOT IFNULL(active, true) ORDER BY id;
SELECT category, COUNT(*) as total, SUM(CASE WHEN NOT in_stock THEN 1 ELSE 0 END) as out_of_stock FROM products GROUP BY category ORDER BY category;
SELECT DISTINCT value FROM test WHERE NOT (value = 10) ORDER BY value;
SELECT DISTINCT NOT active as inactive FROM test ORDER BY inactive;
SELECT id FROM test ORDER BY NOT active, id;
UPDATE test SET active = true WHERE NOT active;
SELECT COUNT(*) as cnt FROM test WHERE active;
UPDATE test SET active = NOT active WHERE id = 1;
SELECT active FROM test WHERE id = 1;
DELETE FROM test WHERE NOT keep;
SELECT COUNT(*) as cnt FROM test;
SELECT COUNT(*) as cnt FROM large WHERE NOT (value > 50);
SELECT id FROM test WHERE NOT 42;
SELECT id FROM test WHERE NOT 3.14;
SELECT id, CASE WHEN active THEN NOT active ELSE active END as result FROM test ORDER BY id;
SELECT id, CASE
WHEN NOT (value < 10) AND NOT (value > 20) THEN 'medium'
WHEN NOT (value >= 10) THEN 'low'
ELSE 'high'
END as range FROM test ORDER BY id;

-- ============================================================================
-- Test: test_not_in_select_with_null
-- Source: logical_operators_comprehensive_tdd.rs:40
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, false), (2, false, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 10);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, sku STRING);
INSERT INTO products VALUES (1, 'PROD-001'), (2, 'TEST-002'), (3, 'PROD-003');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, email STRING);
INSERT INTO emails VALUES (1, 'user@test.com'), (2, 'admin@example.org'), (3, 'invalid');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Hello'), (2, 'WORLD'), (3, 'test');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, true, false), (2, true, false, false), (3, false, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, in_stock BOOL);
INSERT INTO products VALUES ('A', true), ('A', false), ('B', true), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 10), (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, keep BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
INSERT INTO test VALUES (1, 3.14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);

SELECT id, NOT value as negated FROM test ORDER BY id;
SELECT id, NOT a as not_a, NOT b as not_b FROM test ORDER BY id;
SELECT id FROM test WHERE NOT (value < 20) ORDER BY id;
SELECT id FROM test WHERE NOT (value >= 15) ORDER BY id;
SELECT id FROM test WHERE NOT (value <> 10) ORDER BY id;
SELECT id FROM products WHERE NOT (sku SIMILAR TO 'PROD-%') ORDER BY id;
SELECT id FROM emails WHERE NOT (email ~ '^[a-z]+@test\\.com$') ORDER BY id;
SELECT id FROM words WHERE NOT (word ~* 'hello|world') ORDER BY id;
SELECT id FROM test WHERE NOT (NOT (NOT (NOT (value > 15)))) ORDER BY id;
SELECT id FROM test WHERE NOT ((a AND b) OR c) ORDER BY id;
SELECT id FROM test WHERE NOT (value > 10 AND value < 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value > 10)) OR (NOT (value < 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value < 10 OR value > 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value < 10)) AND (NOT (value > 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value = 10) ORDER BY id;
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
SELECT id FROM test WHERE NOT COALESCE(value, false) ORDER BY id;
SELECT id FROM test WHERE NOT IFNULL(active, true) ORDER BY id;
SELECT category, COUNT(*) as total, SUM(CASE WHEN NOT in_stock THEN 1 ELSE 0 END) as out_of_stock FROM products GROUP BY category ORDER BY category;
SELECT DISTINCT value FROM test WHERE NOT (value = 10) ORDER BY value;
SELECT DISTINCT NOT active as inactive FROM test ORDER BY inactive;
SELECT id FROM test ORDER BY NOT active, id;
UPDATE test SET active = true WHERE NOT active;
SELECT COUNT(*) as cnt FROM test WHERE active;
UPDATE test SET active = NOT active WHERE id = 1;
SELECT active FROM test WHERE id = 1;
DELETE FROM test WHERE NOT keep;
SELECT COUNT(*) as cnt FROM test;
SELECT COUNT(*) as cnt FROM large WHERE NOT (value > 50);
SELECT id FROM test WHERE NOT 42;
SELECT id FROM test WHERE NOT 3.14;
SELECT id, CASE WHEN active THEN NOT active ELSE active END as result FROM test ORDER BY id;
SELECT id, CASE
WHEN NOT (value < 10) AND NOT (value > 20) THEN 'medium'
WHEN NOT (value >= 10) THEN 'low'
ELSE 'high'
END as range FROM test ORDER BY id;

-- ============================================================================
-- Test: test_multiple_not_in_select
-- Source: logical_operators_comprehensive_tdd.rs:58
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, false), (2, false, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 10);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, sku STRING);
INSERT INTO products VALUES (1, 'PROD-001'), (2, 'TEST-002'), (3, 'PROD-003');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, email STRING);
INSERT INTO emails VALUES (1, 'user@test.com'), (2, 'admin@example.org'), (3, 'invalid');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Hello'), (2, 'WORLD'), (3, 'test');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, true, false), (2, true, false, false), (3, false, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, in_stock BOOL);
INSERT INTO products VALUES ('A', true), ('A', false), ('B', true), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 10), (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, keep BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
INSERT INTO test VALUES (1, 3.14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);

SELECT id, NOT a as not_a, NOT b as not_b FROM test ORDER BY id;
SELECT id FROM test WHERE NOT (value < 20) ORDER BY id;
SELECT id FROM test WHERE NOT (value >= 15) ORDER BY id;
SELECT id FROM test WHERE NOT (value <> 10) ORDER BY id;
SELECT id FROM products WHERE NOT (sku SIMILAR TO 'PROD-%') ORDER BY id;
SELECT id FROM emails WHERE NOT (email ~ '^[a-z]+@test\\.com$') ORDER BY id;
SELECT id FROM words WHERE NOT (word ~* 'hello|world') ORDER BY id;
SELECT id FROM test WHERE NOT (NOT (NOT (NOT (value > 15)))) ORDER BY id;
SELECT id FROM test WHERE NOT ((a AND b) OR c) ORDER BY id;
SELECT id FROM test WHERE NOT (value > 10 AND value < 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value > 10)) OR (NOT (value < 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value < 10 OR value > 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value < 10)) AND (NOT (value > 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value = 10) ORDER BY id;
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
SELECT id FROM test WHERE NOT COALESCE(value, false) ORDER BY id;
SELECT id FROM test WHERE NOT IFNULL(active, true) ORDER BY id;
SELECT category, COUNT(*) as total, SUM(CASE WHEN NOT in_stock THEN 1 ELSE 0 END) as out_of_stock FROM products GROUP BY category ORDER BY category;
SELECT DISTINCT value FROM test WHERE NOT (value = 10) ORDER BY value;
SELECT DISTINCT NOT active as inactive FROM test ORDER BY inactive;
SELECT id FROM test ORDER BY NOT active, id;
UPDATE test SET active = true WHERE NOT active;
SELECT COUNT(*) as cnt FROM test WHERE active;
UPDATE test SET active = NOT active WHERE id = 1;
SELECT active FROM test WHERE id = 1;
DELETE FROM test WHERE NOT keep;
SELECT COUNT(*) as cnt FROM test;
SELECT COUNT(*) as cnt FROM large WHERE NOT (value > 50);
SELECT id FROM test WHERE NOT 42;
SELECT id FROM test WHERE NOT 3.14;
SELECT id, CASE WHEN active THEN NOT active ELSE active END as result FROM test ORDER BY id;
SELECT id, CASE
WHEN NOT (value < 10) AND NOT (value > 20) THEN 'medium'
WHEN NOT (value >= 10) THEN 'low'
ELSE 'high'
END as range FROM test ORDER BY id;

-- ============================================================================
-- Test: test_not_with_less_than
-- Source: logical_operators_comprehensive_tdd.rs:79
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 10);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, sku STRING);
INSERT INTO products VALUES (1, 'PROD-001'), (2, 'TEST-002'), (3, 'PROD-003');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, email STRING);
INSERT INTO emails VALUES (1, 'user@test.com'), (2, 'admin@example.org'), (3, 'invalid');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Hello'), (2, 'WORLD'), (3, 'test');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, true, false), (2, true, false, false), (3, false, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, in_stock BOOL);
INSERT INTO products VALUES ('A', true), ('A', false), ('B', true), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 10), (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, keep BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
INSERT INTO test VALUES (1, 3.14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);

SELECT id FROM test WHERE NOT (value < 20) ORDER BY id;
SELECT id FROM test WHERE NOT (value >= 15) ORDER BY id;
SELECT id FROM test WHERE NOT (value <> 10) ORDER BY id;
SELECT id FROM products WHERE NOT (sku SIMILAR TO 'PROD-%') ORDER BY id;
SELECT id FROM emails WHERE NOT (email ~ '^[a-z]+@test\\.com$') ORDER BY id;
SELECT id FROM words WHERE NOT (word ~* 'hello|world') ORDER BY id;
SELECT id FROM test WHERE NOT (NOT (NOT (NOT (value > 15)))) ORDER BY id;
SELECT id FROM test WHERE NOT ((a AND b) OR c) ORDER BY id;
SELECT id FROM test WHERE NOT (value > 10 AND value < 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value > 10)) OR (NOT (value < 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value < 10 OR value > 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value < 10)) AND (NOT (value > 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value = 10) ORDER BY id;
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
SELECT id FROM test WHERE NOT COALESCE(value, false) ORDER BY id;
SELECT id FROM test WHERE NOT IFNULL(active, true) ORDER BY id;
SELECT category, COUNT(*) as total, SUM(CASE WHEN NOT in_stock THEN 1 ELSE 0 END) as out_of_stock FROM products GROUP BY category ORDER BY category;
SELECT DISTINCT value FROM test WHERE NOT (value = 10) ORDER BY value;
SELECT DISTINCT NOT active as inactive FROM test ORDER BY inactive;
SELECT id FROM test ORDER BY NOT active, id;
UPDATE test SET active = true WHERE NOT active;
SELECT COUNT(*) as cnt FROM test WHERE active;
UPDATE test SET active = NOT active WHERE id = 1;
SELECT active FROM test WHERE id = 1;
DELETE FROM test WHERE NOT keep;
SELECT COUNT(*) as cnt FROM test;
SELECT COUNT(*) as cnt FROM large WHERE NOT (value > 50);
SELECT id FROM test WHERE NOT 42;
SELECT id FROM test WHERE NOT 3.14;
SELECT id, CASE WHEN active THEN NOT active ELSE active END as result FROM test ORDER BY id;
SELECT id, CASE
WHEN NOT (value < 10) AND NOT (value > 20) THEN 'medium'
WHEN NOT (value >= 10) THEN 'low'
ELSE 'high'
END as range FROM test ORDER BY id;

-- ============================================================================
-- Test: test_not_with_greater_than_or_equal
-- Source: logical_operators_comprehensive_tdd.rs:96
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 10);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, sku STRING);
INSERT INTO products VALUES (1, 'PROD-001'), (2, 'TEST-002'), (3, 'PROD-003');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, email STRING);
INSERT INTO emails VALUES (1, 'user@test.com'), (2, 'admin@example.org'), (3, 'invalid');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Hello'), (2, 'WORLD'), (3, 'test');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, true, false), (2, true, false, false), (3, false, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, in_stock BOOL);
INSERT INTO products VALUES ('A', true), ('A', false), ('B', true), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 10), (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, keep BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
INSERT INTO test VALUES (1, 3.14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);

SELECT id FROM test WHERE NOT (value >= 15) ORDER BY id;
SELECT id FROM test WHERE NOT (value <> 10) ORDER BY id;
SELECT id FROM products WHERE NOT (sku SIMILAR TO 'PROD-%') ORDER BY id;
SELECT id FROM emails WHERE NOT (email ~ '^[a-z]+@test\\.com$') ORDER BY id;
SELECT id FROM words WHERE NOT (word ~* 'hello|world') ORDER BY id;
SELECT id FROM test WHERE NOT (NOT (NOT (NOT (value > 15)))) ORDER BY id;
SELECT id FROM test WHERE NOT ((a AND b) OR c) ORDER BY id;
SELECT id FROM test WHERE NOT (value > 10 AND value < 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value > 10)) OR (NOT (value < 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value < 10 OR value > 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value < 10)) AND (NOT (value > 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value = 10) ORDER BY id;
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
SELECT id FROM test WHERE NOT COALESCE(value, false) ORDER BY id;
SELECT id FROM test WHERE NOT IFNULL(active, true) ORDER BY id;
SELECT category, COUNT(*) as total, SUM(CASE WHEN NOT in_stock THEN 1 ELSE 0 END) as out_of_stock FROM products GROUP BY category ORDER BY category;
SELECT DISTINCT value FROM test WHERE NOT (value = 10) ORDER BY value;
SELECT DISTINCT NOT active as inactive FROM test ORDER BY inactive;
SELECT id FROM test ORDER BY NOT active, id;
UPDATE test SET active = true WHERE NOT active;
SELECT COUNT(*) as cnt FROM test WHERE active;
UPDATE test SET active = NOT active WHERE id = 1;
SELECT active FROM test WHERE id = 1;
DELETE FROM test WHERE NOT keep;
SELECT COUNT(*) as cnt FROM test;
SELECT COUNT(*) as cnt FROM large WHERE NOT (value > 50);
SELECT id FROM test WHERE NOT 42;
SELECT id FROM test WHERE NOT 3.14;
SELECT id, CASE WHEN active THEN NOT active ELSE active END as result FROM test ORDER BY id;
SELECT id, CASE
WHEN NOT (value < 10) AND NOT (value > 20) THEN 'medium'
WHEN NOT (value >= 10) THEN 'low'
ELSE 'high'
END as range FROM test ORDER BY id;

-- ============================================================================
-- Test: test_not_with_not_equal
-- Source: logical_operators_comprehensive_tdd.rs:113
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 10);
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, sku STRING);
INSERT INTO products VALUES (1, 'PROD-001'), (2, 'TEST-002'), (3, 'PROD-003');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, email STRING);
INSERT INTO emails VALUES (1, 'user@test.com'), (2, 'admin@example.org'), (3, 'invalid');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Hello'), (2, 'WORLD'), (3, 'test');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, true, false), (2, true, false, false), (3, false, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, in_stock BOOL);
INSERT INTO products VALUES ('A', true), ('A', false), ('B', true), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 10), (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, keep BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
INSERT INTO test VALUES (1, 3.14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);

SELECT id FROM test WHERE NOT (value <> 10) ORDER BY id;
SELECT id FROM products WHERE NOT (sku SIMILAR TO 'PROD-%') ORDER BY id;
SELECT id FROM emails WHERE NOT (email ~ '^[a-z]+@test\\.com$') ORDER BY id;
SELECT id FROM words WHERE NOT (word ~* 'hello|world') ORDER BY id;
SELECT id FROM test WHERE NOT (NOT (NOT (NOT (value > 15)))) ORDER BY id;
SELECT id FROM test WHERE NOT ((a AND b) OR c) ORDER BY id;
SELECT id FROM test WHERE NOT (value > 10 AND value < 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value > 10)) OR (NOT (value < 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value < 10 OR value > 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value < 10)) AND (NOT (value > 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value = 10) ORDER BY id;
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
SELECT id FROM test WHERE NOT COALESCE(value, false) ORDER BY id;
SELECT id FROM test WHERE NOT IFNULL(active, true) ORDER BY id;
SELECT category, COUNT(*) as total, SUM(CASE WHEN NOT in_stock THEN 1 ELSE 0 END) as out_of_stock FROM products GROUP BY category ORDER BY category;
SELECT DISTINCT value FROM test WHERE NOT (value = 10) ORDER BY value;
SELECT DISTINCT NOT active as inactive FROM test ORDER BY inactive;
SELECT id FROM test ORDER BY NOT active, id;
UPDATE test SET active = true WHERE NOT active;
SELECT COUNT(*) as cnt FROM test WHERE active;
UPDATE test SET active = NOT active WHERE id = 1;
SELECT active FROM test WHERE id = 1;
DELETE FROM test WHERE NOT keep;
SELECT COUNT(*) as cnt FROM test;
SELECT COUNT(*) as cnt FROM large WHERE NOT (value > 50);
SELECT id FROM test WHERE NOT 42;
SELECT id FROM test WHERE NOT 3.14;
SELECT id, CASE WHEN active THEN NOT active ELSE active END as result FROM test ORDER BY id;
SELECT id, CASE
WHEN NOT (value < 10) AND NOT (value > 20) THEN 'medium'
WHEN NOT (value >= 10) THEN 'low'
ELSE 'high'
END as range FROM test ORDER BY id;

-- ============================================================================
-- Test: test_not_with_similar_to
-- Source: logical_operators_comprehensive_tdd.rs:134
-- ============================================================================
DROP TABLE IF EXISTS products;
CREATE TABLE products (id INT64, sku STRING);
INSERT INTO products VALUES (1, 'PROD-001'), (2, 'TEST-002'), (3, 'PROD-003');
DROP TABLE IF EXISTS emails;
CREATE TABLE emails (id INT64, email STRING);
INSERT INTO emails VALUES (1, 'user@test.com'), (2, 'admin@example.org'), (3, 'invalid');
DROP TABLE IF EXISTS words;
CREATE TABLE words (id INT64, word STRING);
INSERT INTO words VALUES (1, 'Hello'), (2, 'WORLD'), (3, 'test');
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL, c BOOL);
INSERT INTO test VALUES (1, true, true, false), (2, true, false, false), (3, false, false, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, NULL), (3, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, a BOOL, b BOOL);
INSERT INTO test VALUES (1, true, NULL), (2, false, NULL), (3, NULL, NULL);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, NULL), (3, false);
DROP TABLE IF EXISTS products;
CREATE TABLE products (category STRING, in_stock BOOL);
INSERT INTO products VALUES ('A', true), ('A', false), ('B', true), ('B', true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 10), (2, 20), (3, 10), (4, 30);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, keep BOOL);
INSERT INTO test VALUES (1, true), (2, false), (3, true), (4, false);
DROP TABLE IF EXISTS large;
CREATE TABLE large (id INT64, value INT64);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 42);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value FLOAT64);
INSERT INTO test VALUES (1, 3.14);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, active BOOL);
INSERT INTO test VALUES (1, true), (2, false);
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64, value INT64);
INSERT INTO test VALUES (1, 5), (2, 15), (3, 25);

SELECT id FROM products WHERE NOT (sku SIMILAR TO 'PROD-%') ORDER BY id;
SELECT id FROM emails WHERE NOT (email ~ '^[a-z]+@test\\.com$') ORDER BY id;
SELECT id FROM words WHERE NOT (word ~* 'hello|world') ORDER BY id;
SELECT id FROM test WHERE NOT (NOT (NOT (NOT (value > 15)))) ORDER BY id;
SELECT id FROM test WHERE NOT ((a AND b) OR c) ORDER BY id;
SELECT id FROM test WHERE NOT (value > 10 AND value < 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value > 10)) OR (NOT (value < 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value < 10 OR value > 20) ORDER BY id;
SELECT id FROM test WHERE (NOT (value < 10)) AND (NOT (value > 20)) ORDER BY id;
SELECT id FROM test WHERE NOT (value = 10) ORDER BY id;
SELECT id FROM test WHERE NOT (a AND b) ORDER BY id;
SELECT id FROM test WHERE NOT (a OR b) ORDER BY id;
SELECT id FROM test WHERE NOT COALESCE(value, false) ORDER BY id;
SELECT id FROM test WHERE NOT IFNULL(active, true) ORDER BY id;
SELECT category, COUNT(*) as total, SUM(CASE WHEN NOT in_stock THEN 1 ELSE 0 END) as out_of_stock FROM products GROUP BY category ORDER BY category;
SELECT DISTINCT value FROM test WHERE NOT (value = 10) ORDER BY value;
SELECT DISTINCT NOT active as inactive FROM test ORDER BY inactive;
SELECT id FROM test ORDER BY NOT active, id;
UPDATE test SET active = true WHERE NOT active;
SELECT COUNT(*) as cnt FROM test WHERE active;
UPDATE test SET active = NOT active WHERE id = 1;
SELECT active FROM test WHERE id = 1;
DELETE FROM test WHERE NOT keep;
SELECT COUNT(*) as cnt FROM test;
SELECT COUNT(*) as cnt FROM large WHERE NOT (value > 50);
SELECT id FROM test WHERE NOT 42;
SELECT id FROM test WHERE NOT 3.14;
SELECT id, CASE WHEN active THEN NOT active ELSE active END as result FROM test ORDER BY id;
SELECT id, CASE
WHEN NOT (value < 10) AND NOT (value > 20) THEN 'medium'
WHEN NOT (value >= 10) THEN 'low'
ELSE 'high'
END as range FROM test ORDER BY id;

-- ============================================================================
-- Test: test_materialized_view_with_subquery
-- Source: materialized_views_comprehensive_tdd.rs:648
-- ============================================================================
DROP TABLE IF EXISTS departments;
CREATE TABLE departments (dept_id INT64, dept_name STRING);
DROP TABLE IF EXISTS employees;
CREATE TABLE employees (emp_id INT64, dept_id INT64, salary FLOAT64);
INSERT INTO departments VALUES (1, 'Engineering'), (2, 'Sales');
INSERT INTO employees VALUES
(1, 1, 100000.00),
(2, 1, 120000.00),
(3, 2, 80000.00),
(4, 2, 90000.00);
DROP MATERIALIZED VIEW IF EXISTS dept_avg_salary;
CREATE MATERIALIZED VIEW dept_avg_salary AS SELECT d.dept_name, (SELECT AVG(salary) FROM employees e WHERE e.dept_id = d.dept_id) as avg_salary FROM departments d;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP MATERIALIZED VIEW IF EXISTS filtered_data;
CREATE MATERIALIZED VIEW filtered_data AS SELECT * FROM data WHERE value > 1000;
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64, value FLOAT64);
DROP MATERIALIZED VIEW IF EXISTS large_mv;
CREATE MATERIALIZED VIEW large_mv AS SELECT * FROM large_table WHERE value > 500.0;
DROP TABLE IF EXISTS nullable_data;
CREATE TABLE nullable_data (id INT64, value INT64);
INSERT INTO nullable_data VALUES (1, 10), (2, NULL), (3, 30), (4, NULL);
DROP MATERIALIZED VIEW IF EXISTS non_null_data;
CREATE MATERIALIZED VIEW non_null_data AS SELECT * FROM nullable_data WHERE value IS NOT NULL;
DROP MATERIALIZED VIEW IF EXISTS invalid_mv;
CREATE MATERIALIZED VIEW invalid_mv AS SELECT * FROM nonexistent_table;
DROP TABLE IF EXISTS shared_name;
CREATE TABLE shared_name (id INT64);
DROP MATERIALIZED VIEW IF EXISTS shared_name;
CREATE MATERIALIZED VIEW shared_name AS SELECT 1 as id;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP VIEW IF EXISTS shared_name;
CREATE VIEW shared_name AS SELECT * FROM base;
DROP MATERIALIZED VIEW IF EXISTS shared_name;
CREATE MATERIALIZED VIEW shared_name AS SELECT 1 as id;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP MATERIALIZED VIEW IF EXISTS test_mv;
CREATE MATERIALIZED VIEW test_mv AS SELECT * FROM test WHERE id > 10;
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (n INT64);
INSERT INTO numbers VALUES (1), (2), (3), (4), (5), (6), (7), (8), (9), (10);
DROP MATERIALIZED VIEW IF EXISTS even_numbers;
CREATE MATERIALIZED VIEW even_numbers AS SELECT * FROM numbers WHERE n % 2 = 0;
DROP MATERIALIZED VIEW IF EXISTS odd_numbers;
CREATE MATERIALIZED VIEW odd_numbers AS SELECT * FROM numbers WHERE n % 2 = 1;
DROP MATERIALIZED VIEW IF EXISTS large_numbers;
CREATE MATERIALIZED VIEW large_numbers AS SELECT * FROM numbers WHERE n > 5;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
INSERT INTO mv VALUES (1);
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
INSERT INTO source VALUES (1, 100), (2, 200);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM source WHERE value > 50;
CREATE TABLE copy AS SELECT * FROM mv;

SELECT dept_name, avg_salary FROM dept_avg_salary ORDER BY dept_name;
SELECT COUNT(*) FROM filtered_data;
SELECT COUNT(*) FROM large_mv;
SELECT COUNT(*) FROM non_null_data;
REFRESH MATERIALIZED VIEW test_mv;
SELECT COUNT(*) FROM even_numbers;
SELECT COUNT(*) FROM odd_numbers;
SELECT COUNT(*) FROM large_numbers;
UPDATE mv SET id = 2 WHERE id = 1;
DELETE FROM mv WHERE id = 1;
SELECT COUNT(*) FROM copy;

-- ============================================================================
-- Test: test_materialized_view_empty_result
-- Source: materialized_views_comprehensive_tdd.rs:695
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, 20);
DROP MATERIALIZED VIEW IF EXISTS filtered_data;
CREATE MATERIALIZED VIEW filtered_data AS SELECT * FROM data WHERE value > 1000;
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64, value FLOAT64);
DROP MATERIALIZED VIEW IF EXISTS large_mv;
CREATE MATERIALIZED VIEW large_mv AS SELECT * FROM large_table WHERE value > 500.0;
DROP TABLE IF EXISTS nullable_data;
CREATE TABLE nullable_data (id INT64, value INT64);
INSERT INTO nullable_data VALUES (1, 10), (2, NULL), (3, 30), (4, NULL);
DROP MATERIALIZED VIEW IF EXISTS non_null_data;
CREATE MATERIALIZED VIEW non_null_data AS SELECT * FROM nullable_data WHERE value IS NOT NULL;
DROP MATERIALIZED VIEW IF EXISTS invalid_mv;
CREATE MATERIALIZED VIEW invalid_mv AS SELECT * FROM nonexistent_table;
DROP TABLE IF EXISTS shared_name;
CREATE TABLE shared_name (id INT64);
DROP MATERIALIZED VIEW IF EXISTS shared_name;
CREATE MATERIALIZED VIEW shared_name AS SELECT 1 as id;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP VIEW IF EXISTS shared_name;
CREATE VIEW shared_name AS SELECT * FROM base;
DROP MATERIALIZED VIEW IF EXISTS shared_name;
CREATE MATERIALIZED VIEW shared_name AS SELECT 1 as id;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP MATERIALIZED VIEW IF EXISTS test_mv;
CREATE MATERIALIZED VIEW test_mv AS SELECT * FROM test WHERE id > 10;
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (n INT64);
INSERT INTO numbers VALUES (1), (2), (3), (4), (5), (6), (7), (8), (9), (10);
DROP MATERIALIZED VIEW IF EXISTS even_numbers;
CREATE MATERIALIZED VIEW even_numbers AS SELECT * FROM numbers WHERE n % 2 = 0;
DROP MATERIALIZED VIEW IF EXISTS odd_numbers;
CREATE MATERIALIZED VIEW odd_numbers AS SELECT * FROM numbers WHERE n % 2 = 1;
DROP MATERIALIZED VIEW IF EXISTS large_numbers;
CREATE MATERIALIZED VIEW large_numbers AS SELECT * FROM numbers WHERE n > 5;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
INSERT INTO mv VALUES (1);
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
INSERT INTO source VALUES (1, 100), (2, 200);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM source WHERE value > 50;
CREATE TABLE copy AS SELECT * FROM mv;

SELECT COUNT(*) FROM filtered_data;
SELECT COUNT(*) FROM large_mv;
SELECT COUNT(*) FROM non_null_data;
REFRESH MATERIALIZED VIEW test_mv;
SELECT COUNT(*) FROM even_numbers;
SELECT COUNT(*) FROM odd_numbers;
SELECT COUNT(*) FROM large_numbers;
UPDATE mv SET id = 2 WHERE id = 1;
DELETE FROM mv WHERE id = 1;
SELECT COUNT(*) FROM copy;

-- ============================================================================
-- Test: test_materialized_view_large_dataset
-- Source: materialized_views_comprehensive_tdd.rs:725
-- ============================================================================
DROP TABLE IF EXISTS large_table;
CREATE TABLE large_table (id INT64, value FLOAT64);
DROP MATERIALIZED VIEW IF EXISTS large_mv;
CREATE MATERIALIZED VIEW large_mv AS SELECT * FROM large_table WHERE value > 500.0;
DROP TABLE IF EXISTS nullable_data;
CREATE TABLE nullable_data (id INT64, value INT64);
INSERT INTO nullable_data VALUES (1, 10), (2, NULL), (3, 30), (4, NULL);
DROP MATERIALIZED VIEW IF EXISTS non_null_data;
CREATE MATERIALIZED VIEW non_null_data AS SELECT * FROM nullable_data WHERE value IS NOT NULL;
DROP MATERIALIZED VIEW IF EXISTS invalid_mv;
CREATE MATERIALIZED VIEW invalid_mv AS SELECT * FROM nonexistent_table;
DROP TABLE IF EXISTS shared_name;
CREATE TABLE shared_name (id INT64);
DROP MATERIALIZED VIEW IF EXISTS shared_name;
CREATE MATERIALIZED VIEW shared_name AS SELECT 1 as id;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP VIEW IF EXISTS shared_name;
CREATE VIEW shared_name AS SELECT * FROM base;
DROP MATERIALIZED VIEW IF EXISTS shared_name;
CREATE MATERIALIZED VIEW shared_name AS SELECT 1 as id;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP MATERIALIZED VIEW IF EXISTS test_mv;
CREATE MATERIALIZED VIEW test_mv AS SELECT * FROM test WHERE id > 10;
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (n INT64);
INSERT INTO numbers VALUES (1), (2), (3), (4), (5), (6), (7), (8), (9), (10);
DROP MATERIALIZED VIEW IF EXISTS even_numbers;
CREATE MATERIALIZED VIEW even_numbers AS SELECT * FROM numbers WHERE n % 2 = 0;
DROP MATERIALIZED VIEW IF EXISTS odd_numbers;
CREATE MATERIALIZED VIEW odd_numbers AS SELECT * FROM numbers WHERE n % 2 = 1;
DROP MATERIALIZED VIEW IF EXISTS large_numbers;
CREATE MATERIALIZED VIEW large_numbers AS SELECT * FROM numbers WHERE n > 5;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
INSERT INTO mv VALUES (1);
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
INSERT INTO source VALUES (1, 100), (2, 200);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM source WHERE value > 50;
CREATE TABLE copy AS SELECT * FROM mv;

SELECT COUNT(*) FROM large_mv;
SELECT COUNT(*) FROM non_null_data;
REFRESH MATERIALIZED VIEW test_mv;
SELECT COUNT(*) FROM even_numbers;
SELECT COUNT(*) FROM odd_numbers;
SELECT COUNT(*) FROM large_numbers;
UPDATE mv SET id = 2 WHERE id = 1;
DELETE FROM mv WHERE id = 1;
SELECT COUNT(*) FROM copy;

-- ============================================================================
-- Test: test_materialized_view_with_null_values
-- Source: materialized_views_comprehensive_tdd.rs:759
-- ============================================================================
DROP TABLE IF EXISTS nullable_data;
CREATE TABLE nullable_data (id INT64, value INT64);
INSERT INTO nullable_data VALUES (1, 10), (2, NULL), (3, 30), (4, NULL);
DROP MATERIALIZED VIEW IF EXISTS non_null_data;
CREATE MATERIALIZED VIEW non_null_data AS SELECT * FROM nullable_data WHERE value IS NOT NULL;
DROP MATERIALIZED VIEW IF EXISTS invalid_mv;
CREATE MATERIALIZED VIEW invalid_mv AS SELECT * FROM nonexistent_table;
DROP TABLE IF EXISTS shared_name;
CREATE TABLE shared_name (id INT64);
DROP MATERIALIZED VIEW IF EXISTS shared_name;
CREATE MATERIALIZED VIEW shared_name AS SELECT 1 as id;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP VIEW IF EXISTS shared_name;
CREATE VIEW shared_name AS SELECT * FROM base;
DROP MATERIALIZED VIEW IF EXISTS shared_name;
CREATE MATERIALIZED VIEW shared_name AS SELECT 1 as id;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP MATERIALIZED VIEW IF EXISTS test_mv;
CREATE MATERIALIZED VIEW test_mv AS SELECT * FROM test WHERE id > 10;
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (n INT64);
INSERT INTO numbers VALUES (1), (2), (3), (4), (5), (6), (7), (8), (9), (10);
DROP MATERIALIZED VIEW IF EXISTS even_numbers;
CREATE MATERIALIZED VIEW even_numbers AS SELECT * FROM numbers WHERE n % 2 = 0;
DROP MATERIALIZED VIEW IF EXISTS odd_numbers;
CREATE MATERIALIZED VIEW odd_numbers AS SELECT * FROM numbers WHERE n % 2 = 1;
DROP MATERIALIZED VIEW IF EXISTS large_numbers;
CREATE MATERIALIZED VIEW large_numbers AS SELECT * FROM numbers WHERE n > 5;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
INSERT INTO mv VALUES (1);
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
INSERT INTO source VALUES (1, 100), (2, 200);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM source WHERE value > 50;
CREATE TABLE copy AS SELECT * FROM mv;

SELECT COUNT(*) FROM non_null_data;
REFRESH MATERIALIZED VIEW test_mv;
SELECT COUNT(*) FROM even_numbers;
SELECT COUNT(*) FROM odd_numbers;
SELECT COUNT(*) FROM large_numbers;
UPDATE mv SET id = 2 WHERE id = 1;
DELETE FROM mv WHERE id = 1;
SELECT COUNT(*) FROM copy;

-- ============================================================================
-- Test: test_materialized_view_invalid_query
-- Source: materialized_views_comprehensive_tdd.rs:789
-- ============================================================================
DROP MATERIALIZED VIEW IF EXISTS invalid_mv;
CREATE MATERIALIZED VIEW invalid_mv AS SELECT * FROM nonexistent_table;
DROP TABLE IF EXISTS shared_name;
CREATE TABLE shared_name (id INT64);
DROP MATERIALIZED VIEW IF EXISTS shared_name;
CREATE MATERIALIZED VIEW shared_name AS SELECT 1 as id;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP VIEW IF EXISTS shared_name;
CREATE VIEW shared_name AS SELECT * FROM base;
DROP MATERIALIZED VIEW IF EXISTS shared_name;
CREATE MATERIALIZED VIEW shared_name AS SELECT 1 as id;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP MATERIALIZED VIEW IF EXISTS test_mv;
CREATE MATERIALIZED VIEW test_mv AS SELECT * FROM test WHERE id > 10;
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (n INT64);
INSERT INTO numbers VALUES (1), (2), (3), (4), (5), (6), (7), (8), (9), (10);
DROP MATERIALIZED VIEW IF EXISTS even_numbers;
CREATE MATERIALIZED VIEW even_numbers AS SELECT * FROM numbers WHERE n % 2 = 0;
DROP MATERIALIZED VIEW IF EXISTS odd_numbers;
CREATE MATERIALIZED VIEW odd_numbers AS SELECT * FROM numbers WHERE n % 2 = 1;
DROP MATERIALIZED VIEW IF EXISTS large_numbers;
CREATE MATERIALIZED VIEW large_numbers AS SELECT * FROM numbers WHERE n > 5;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
INSERT INTO mv VALUES (1);
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
INSERT INTO source VALUES (1, 100), (2, 200);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM source WHERE value > 50;
CREATE TABLE copy AS SELECT * FROM mv;

REFRESH MATERIALIZED VIEW test_mv;
SELECT COUNT(*) FROM even_numbers;
SELECT COUNT(*) FROM odd_numbers;
SELECT COUNT(*) FROM large_numbers;
UPDATE mv SET id = 2 WHERE id = 1;
DELETE FROM mv WHERE id = 1;
SELECT COUNT(*) FROM copy;

-- ============================================================================
-- Test: test_materialized_view_name_collision_with_table
-- Source: materialized_views_comprehensive_tdd.rs:803
-- ============================================================================
DROP TABLE IF EXISTS shared_name;
CREATE TABLE shared_name (id INT64);
DROP MATERIALIZED VIEW IF EXISTS shared_name;
CREATE MATERIALIZED VIEW shared_name AS SELECT 1 as id;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP VIEW IF EXISTS shared_name;
CREATE VIEW shared_name AS SELECT * FROM base;
DROP MATERIALIZED VIEW IF EXISTS shared_name;
CREATE MATERIALIZED VIEW shared_name AS SELECT 1 as id;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP MATERIALIZED VIEW IF EXISTS test_mv;
CREATE MATERIALIZED VIEW test_mv AS SELECT * FROM test WHERE id > 10;
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (n INT64);
INSERT INTO numbers VALUES (1), (2), (3), (4), (5), (6), (7), (8), (9), (10);
DROP MATERIALIZED VIEW IF EXISTS even_numbers;
CREATE MATERIALIZED VIEW even_numbers AS SELECT * FROM numbers WHERE n % 2 = 0;
DROP MATERIALIZED VIEW IF EXISTS odd_numbers;
CREATE MATERIALIZED VIEW odd_numbers AS SELECT * FROM numbers WHERE n % 2 = 1;
DROP MATERIALIZED VIEW IF EXISTS large_numbers;
CREATE MATERIALIZED VIEW large_numbers AS SELECT * FROM numbers WHERE n > 5;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
INSERT INTO mv VALUES (1);
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
INSERT INTO source VALUES (1, 100), (2, 200);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM source WHERE value > 50;
CREATE TABLE copy AS SELECT * FROM mv;

REFRESH MATERIALIZED VIEW test_mv;
SELECT COUNT(*) FROM even_numbers;
SELECT COUNT(*) FROM odd_numbers;
SELECT COUNT(*) FROM large_numbers;
UPDATE mv SET id = 2 WHERE id = 1;
DELETE FROM mv WHERE id = 1;
SELECT COUNT(*) FROM copy;

-- ============================================================================
-- Test: test_materialized_view_name_collision_with_view
-- Source: materialized_views_comprehensive_tdd.rs:817
-- ============================================================================
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP VIEW IF EXISTS shared_name;
CREATE VIEW shared_name AS SELECT * FROM base;
DROP MATERIALIZED VIEW IF EXISTS shared_name;
CREATE MATERIALIZED VIEW shared_name AS SELECT 1 as id;
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP MATERIALIZED VIEW IF EXISTS test_mv;
CREATE MATERIALIZED VIEW test_mv AS SELECT * FROM test WHERE id > 10;
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (n INT64);
INSERT INTO numbers VALUES (1), (2), (3), (4), (5), (6), (7), (8), (9), (10);
DROP MATERIALIZED VIEW IF EXISTS even_numbers;
CREATE MATERIALIZED VIEW even_numbers AS SELECT * FROM numbers WHERE n % 2 = 0;
DROP MATERIALIZED VIEW IF EXISTS odd_numbers;
CREATE MATERIALIZED VIEW odd_numbers AS SELECT * FROM numbers WHERE n % 2 = 1;
DROP MATERIALIZED VIEW IF EXISTS large_numbers;
CREATE MATERIALIZED VIEW large_numbers AS SELECT * FROM numbers WHERE n > 5;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
INSERT INTO mv VALUES (1);
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
INSERT INTO source VALUES (1, 100), (2, 200);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM source WHERE value > 50;
CREATE TABLE copy AS SELECT * FROM mv;

REFRESH MATERIALIZED VIEW test_mv;
SELECT COUNT(*) FROM even_numbers;
SELECT COUNT(*) FROM odd_numbers;
SELECT COUNT(*) FROM large_numbers;
UPDATE mv SET id = 2 WHERE id = 1;
DELETE FROM mv WHERE id = 1;
SELECT COUNT(*) FROM copy;

-- ============================================================================
-- Test: test_materialized_view_query_stored
-- Source: materialized_views_comprehensive_tdd.rs:839
-- ============================================================================
DROP TABLE IF EXISTS test;
CREATE TABLE test (id INT64);
DROP MATERIALIZED VIEW IF EXISTS test_mv;
CREATE MATERIALIZED VIEW test_mv AS SELECT * FROM test WHERE id > 10;
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (n INT64);
INSERT INTO numbers VALUES (1), (2), (3), (4), (5), (6), (7), (8), (9), (10);
DROP MATERIALIZED VIEW IF EXISTS even_numbers;
CREATE MATERIALIZED VIEW even_numbers AS SELECT * FROM numbers WHERE n % 2 = 0;
DROP MATERIALIZED VIEW IF EXISTS odd_numbers;
CREATE MATERIALIZED VIEW odd_numbers AS SELECT * FROM numbers WHERE n % 2 = 1;
DROP MATERIALIZED VIEW IF EXISTS large_numbers;
CREATE MATERIALIZED VIEW large_numbers AS SELECT * FROM numbers WHERE n > 5;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
INSERT INTO mv VALUES (1);
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
INSERT INTO source VALUES (1, 100), (2, 200);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM source WHERE value > 50;
CREATE TABLE copy AS SELECT * FROM mv;

REFRESH MATERIALIZED VIEW test_mv;
SELECT COUNT(*) FROM even_numbers;
SELECT COUNT(*) FROM odd_numbers;
SELECT COUNT(*) FROM large_numbers;
UPDATE mv SET id = 2 WHERE id = 1;
DELETE FROM mv WHERE id = 1;
SELECT COUNT(*) FROM copy;

-- ============================================================================
-- Test: test_multiple_materialized_views
-- Source: materialized_views_comprehensive_tdd.rs:858
-- ============================================================================
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (n INT64);
INSERT INTO numbers VALUES (1), (2), (3), (4), (5), (6), (7), (8), (9), (10);
DROP MATERIALIZED VIEW IF EXISTS even_numbers;
CREATE MATERIALIZED VIEW even_numbers AS SELECT * FROM numbers WHERE n % 2 = 0;
DROP MATERIALIZED VIEW IF EXISTS odd_numbers;
CREATE MATERIALIZED VIEW odd_numbers AS SELECT * FROM numbers WHERE n % 2 = 1;
DROP MATERIALIZED VIEW IF EXISTS large_numbers;
CREATE MATERIALIZED VIEW large_numbers AS SELECT * FROM numbers WHERE n > 5;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
INSERT INTO mv VALUES (1);
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
INSERT INTO source VALUES (1, 100), (2, 200);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM source WHERE value > 50;
CREATE TABLE copy AS SELECT * FROM mv;

SELECT COUNT(*) FROM even_numbers;
SELECT COUNT(*) FROM odd_numbers;
SELECT COUNT(*) FROM large_numbers;
UPDATE mv SET id = 2 WHERE id = 1;
DELETE FROM mv WHERE id = 1;
SELECT COUNT(*) FROM copy;

-- ============================================================================
-- Test: test_insert_into_materialized_view_error
-- Source: materialized_views_comprehensive_tdd.rs:909
-- ============================================================================
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
INSERT INTO mv VALUES (1);
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
INSERT INTO source VALUES (1, 100), (2, 200);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM source WHERE value > 50;
CREATE TABLE copy AS SELECT * FROM mv;

UPDATE mv SET id = 2 WHERE id = 1;
DELETE FROM mv WHERE id = 1;
SELECT COUNT(*) FROM copy;

-- ============================================================================
-- Test: test_update_materialized_view_error
-- Source: materialized_views_comprehensive_tdd.rs:927
-- ============================================================================
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
INSERT INTO source VALUES (1, 100), (2, 200);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM source WHERE value > 50;
CREATE TABLE copy AS SELECT * FROM mv;

UPDATE mv SET id = 2 WHERE id = 1;
DELETE FROM mv WHERE id = 1;
SELECT COUNT(*) FROM copy;

-- ============================================================================
-- Test: test_delete_from_materialized_view_error
-- Source: materialized_views_comprehensive_tdd.rs:947
-- ============================================================================
DROP TABLE IF EXISTS base;
CREATE TABLE base (id INT64);
INSERT INTO base VALUES (1);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM base;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
INSERT INTO source VALUES (1, 100), (2, 200);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM source WHERE value > 50;
CREATE TABLE copy AS SELECT * FROM mv;

DELETE FROM mv WHERE id = 1;
SELECT COUNT(*) FROM copy;

-- ============================================================================
-- Test: test_create_table_as_select_from_materialized_view
-- Source: materialized_views_comprehensive_tdd.rs:967
-- ============================================================================
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, value INT64);
INSERT INTO source VALUES (1, 100), (2, 200);
DROP MATERIALIZED VIEW IF EXISTS mv;
CREATE MATERIALIZED VIEW mv AS SELECT * FROM source WHERE value > 50;
CREATE TABLE copy AS SELECT * FROM mv;

SELECT COUNT(*) FROM copy;

-- ============================================================================
-- Test: test_insert_select_with_incompatible_types_clear_error
-- Source: p1_features_error_handling_stress_tdd.rs:463
-- ============================================================================
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, text_value STRING);
INSERT INTO source VALUES (1, 'not_a_number');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64, numeric_value INT64);
INSERT INTO dest SELECT id, text_value FROM source;
DROP TABLE IF EXISTS source;
CREATE TABLE source (value NUMERIC(18, 8));
INSERT INTO source VALUES (CAST(3.14159265 AS NUMERIC(18, 8)));
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (value NUMERIC(10, 2));
INSERT INTO dest SELECT CAST(value AS NUMERIC(10, 2)) FROM source;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (1e308), (1e308), (1e308);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, required STRING NOT NULL);
INSERT INTO data (id) VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2), (3), (1), (4);
DROP TABLE IF EXISTS outer_t;
CREATE TABLE outer_t (id INT64, num_value INT64);
INSERT INTO outer_t VALUES (1, 10);
DROP TABLE IF EXISTS inner_t;
CREATE TABLE inner_t (id INT64, str_value STRING);
INSERT INTO inner_t VALUES (1, 'text');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS evolving;
CREATE TABLE evolving (id INT64, name STRING);
INSERT INTO evolving VALUES (1, 'test');
ALTER TABLE evolving ADD COLUMN age INT64 DEFAULT 0;
ALTER TABLE evolving ADD COLUMN email STRING;
INSERT INTO evolving (id, name, age, email) VALUES (2, 'new', 25, 'test@example.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64);
ALTER TABLE dest ADD COLUMN name STRING;
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, nullable_col STRING);
INSERT INTO source VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64, nullable_col STRING);
INSERT INTO dest SELECT id, nullable_col FROM source;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO data VALUES (1, 10.5, NULL);
DROP TABLE IF EXISTS result;
CREATE TABLE result (id INT64, sum NUMERIC(10, 2));
INSERT INTO result SELECT id, a + b FROM data;
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);

SELECT value FROM dest;
SELECT SUM(value) as total FROM data;
SELECT id FROM outer_t WHERE num_value = ANY (SELECT str_value FROM inner_t);
SELECT EXTRACT(MILLISECOND FROM event_date) FROM events;
SELECT age FROM evolving WHERE id = 1;
SELECT COUNT(*) FROM data;
SELECT id, name FROM dest;
SELECT COUNT(*) FROM dest WHERE nullable_col IS NULL;
SELECT sum FROM result;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM events;
SELECT COUNT(*) as count_all, COUNT(value) as count_non_null, SUM(value) as sum FROM data;

-- ============================================================================
-- Test: test_numeric_precision_loss_in_insert_select
-- Source: p1_features_error_handling_stress_tdd.rs:492
-- ============================================================================
DROP TABLE IF EXISTS source;
CREATE TABLE source (value NUMERIC(18, 8));
INSERT INTO source VALUES (CAST(3.14159265 AS NUMERIC(18, 8)));
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (value NUMERIC(10, 2));
INSERT INTO dest SELECT CAST(value AS NUMERIC(10, 2)) FROM source;
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (1e308), (1e308), (1e308);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, required STRING NOT NULL);
INSERT INTO data (id) VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2), (3), (1), (4);
DROP TABLE IF EXISTS outer_t;
CREATE TABLE outer_t (id INT64, num_value INT64);
INSERT INTO outer_t VALUES (1, 10);
DROP TABLE IF EXISTS inner_t;
CREATE TABLE inner_t (id INT64, str_value STRING);
INSERT INTO inner_t VALUES (1, 'text');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS evolving;
CREATE TABLE evolving (id INT64, name STRING);
INSERT INTO evolving VALUES (1, 'test');
ALTER TABLE evolving ADD COLUMN age INT64 DEFAULT 0;
ALTER TABLE evolving ADD COLUMN email STRING;
INSERT INTO evolving (id, name, age, email) VALUES (2, 'new', 25, 'test@example.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64);
ALTER TABLE dest ADD COLUMN name STRING;
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, nullable_col STRING);
INSERT INTO source VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64, nullable_col STRING);
INSERT INTO dest SELECT id, nullable_col FROM source;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO data VALUES (1, 10.5, NULL);
DROP TABLE IF EXISTS result;
CREATE TABLE result (id INT64, sum NUMERIC(10, 2));
INSERT INTO result SELECT id, a + b FROM data;
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);

SELECT value FROM dest;
SELECT SUM(value) as total FROM data;
SELECT id FROM outer_t WHERE num_value = ANY (SELECT str_value FROM inner_t);
SELECT EXTRACT(MILLISECOND FROM event_date) FROM events;
SELECT age FROM evolving WHERE id = 1;
SELECT COUNT(*) FROM data;
SELECT id, name FROM dest;
SELECT COUNT(*) FROM dest WHERE nullable_col IS NULL;
SELECT sum FROM result;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM events;
SELECT COUNT(*) as count_all, COUNT(value) as count_non_null, SUM(value) as sum FROM data;

-- ============================================================================
-- Test: test_cast_overflow_in_aggregate_context
-- Source: p1_features_error_handling_stress_tdd.rs:527
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (value FLOAT64);
INSERT INTO data VALUES (1e308), (1e308), (1e308);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, required STRING NOT NULL);
INSERT INTO data (id) VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2), (3), (1), (4);
DROP TABLE IF EXISTS outer_t;
CREATE TABLE outer_t (id INT64, num_value INT64);
INSERT INTO outer_t VALUES (1, 10);
DROP TABLE IF EXISTS inner_t;
CREATE TABLE inner_t (id INT64, str_value STRING);
INSERT INTO inner_t VALUES (1, 'text');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS evolving;
CREATE TABLE evolving (id INT64, name STRING);
INSERT INTO evolving VALUES (1, 'test');
ALTER TABLE evolving ADD COLUMN age INT64 DEFAULT 0;
ALTER TABLE evolving ADD COLUMN email STRING;
INSERT INTO evolving (id, name, age, email) VALUES (2, 'new', 25, 'test@example.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64);
ALTER TABLE dest ADD COLUMN name STRING;
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, nullable_col STRING);
INSERT INTO source VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64, nullable_col STRING);
INSERT INTO dest SELECT id, nullable_col FROM source;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO data VALUES (1, 10.5, NULL);
DROP TABLE IF EXISTS result;
CREATE TABLE result (id INT64, sum NUMERIC(10, 2));
INSERT INTO result SELECT id, a + b FROM data;
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);

SELECT SUM(value) as total FROM data;
SELECT id FROM outer_t WHERE num_value = ANY (SELECT str_value FROM inner_t);
SELECT EXTRACT(MILLISECOND FROM event_date) FROM events;
SELECT age FROM evolving WHERE id = 1;
SELECT COUNT(*) FROM data;
SELECT id, name FROM dest;
SELECT COUNT(*) FROM dest WHERE nullable_col IS NULL;
SELECT sum FROM result;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM events;
SELECT COUNT(*) as count_all, COUNT(value) as count_non_null, SUM(value) as sum FROM data;

-- ============================================================================
-- Test: test_helpful_error_for_missing_column_in_insert
-- Source: p1_features_error_handling_stress_tdd.rs:561
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, required STRING NOT NULL);
INSERT INTO data (id) VALUES (1);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2), (3), (1), (4);
DROP TABLE IF EXISTS outer_t;
CREATE TABLE outer_t (id INT64, num_value INT64);
INSERT INTO outer_t VALUES (1, 10);
DROP TABLE IF EXISTS inner_t;
CREATE TABLE inner_t (id INT64, str_value STRING);
INSERT INTO inner_t VALUES (1, 'text');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS evolving;
CREATE TABLE evolving (id INT64, name STRING);
INSERT INTO evolving VALUES (1, 'test');
ALTER TABLE evolving ADD COLUMN age INT64 DEFAULT 0;
ALTER TABLE evolving ADD COLUMN email STRING;
INSERT INTO evolving (id, name, age, email) VALUES (2, 'new', 25, 'test@example.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64);
ALTER TABLE dest ADD COLUMN name STRING;
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, nullable_col STRING);
INSERT INTO source VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64, nullable_col STRING);
INSERT INTO dest SELECT id, nullable_col FROM source;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO data VALUES (1, 10.5, NULL);
DROP TABLE IF EXISTS result;
CREATE TABLE result (id INT64, sum NUMERIC(10, 2));
INSERT INTO result SELECT id, a + b FROM data;
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);

SELECT id FROM outer_t WHERE num_value = ANY (SELECT str_value FROM inner_t);
SELECT EXTRACT(MILLISECOND FROM event_date) FROM events;
SELECT age FROM evolving WHERE id = 1;
SELECT COUNT(*) FROM data;
SELECT id, name FROM dest;
SELECT COUNT(*) FROM dest WHERE nullable_col IS NULL;
SELECT sum FROM result;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM events;
SELECT COUNT(*) as count_all, COUNT(value) as count_non_null, SUM(value) as sum FROM data;

-- ============================================================================
-- Test: test_helpful_error_for_constraint_violation_identifies_row
-- Source: p1_features_error_handling_stress_tdd.rs:581
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2), (3), (1), (4);
DROP TABLE IF EXISTS outer_t;
CREATE TABLE outer_t (id INT64, num_value INT64);
INSERT INTO outer_t VALUES (1, 10);
DROP TABLE IF EXISTS inner_t;
CREATE TABLE inner_t (id INT64, str_value STRING);
INSERT INTO inner_t VALUES (1, 'text');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS evolving;
CREATE TABLE evolving (id INT64, name STRING);
INSERT INTO evolving VALUES (1, 'test');
ALTER TABLE evolving ADD COLUMN age INT64 DEFAULT 0;
ALTER TABLE evolving ADD COLUMN email STRING;
INSERT INTO evolving (id, name, age, email) VALUES (2, 'new', 25, 'test@example.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64);
ALTER TABLE dest ADD COLUMN name STRING;
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, nullable_col STRING);
INSERT INTO source VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64, nullable_col STRING);
INSERT INTO dest SELECT id, nullable_col FROM source;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO data VALUES (1, 10.5, NULL);
DROP TABLE IF EXISTS result;
CREATE TABLE result (id INT64, sum NUMERIC(10, 2));
INSERT INTO result SELECT id, a + b FROM data;
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);

SELECT id FROM outer_t WHERE num_value = ANY (SELECT str_value FROM inner_t);
SELECT EXTRACT(MILLISECOND FROM event_date) FROM events;
SELECT age FROM evolving WHERE id = 1;
SELECT COUNT(*) FROM data;
SELECT id, name FROM dest;
SELECT COUNT(*) FROM dest WHERE nullable_col IS NULL;
SELECT sum FROM result;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM events;
SELECT COUNT(*) as count_all, COUNT(value) as count_non_null, SUM(value) as sum FROM data;

-- ============================================================================
-- Test: test_helpful_error_for_subquery_type_mismatch
-- Source: p1_features_error_handling_stress_tdd.rs:603
-- ============================================================================
DROP TABLE IF EXISTS outer_t;
CREATE TABLE outer_t (id INT64, num_value INT64);
INSERT INTO outer_t VALUES (1, 10);
DROP TABLE IF EXISTS inner_t;
CREATE TABLE inner_t (id INT64, str_value STRING);
INSERT INTO inner_t VALUES (1, 'text');
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS evolving;
CREATE TABLE evolving (id INT64, name STRING);
INSERT INTO evolving VALUES (1, 'test');
ALTER TABLE evolving ADD COLUMN age INT64 DEFAULT 0;
ALTER TABLE evolving ADD COLUMN email STRING;
INSERT INTO evolving (id, name, age, email) VALUES (2, 'new', 25, 'test@example.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64);
ALTER TABLE dest ADD COLUMN name STRING;
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, nullable_col STRING);
INSERT INTO source VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64, nullable_col STRING);
INSERT INTO dest SELECT id, nullable_col FROM source;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO data VALUES (1, 10.5, NULL);
DROP TABLE IF EXISTS result;
CREATE TABLE result (id INT64, sum NUMERIC(10, 2));
INSERT INTO result SELECT id, a + b FROM data;
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);

SELECT id FROM outer_t WHERE num_value = ANY (SELECT str_value FROM inner_t);
SELECT EXTRACT(MILLISECOND FROM event_date) FROM events;
SELECT age FROM evolving WHERE id = 1;
SELECT COUNT(*) FROM data;
SELECT id, name FROM dest;
SELECT COUNT(*) FROM dest WHERE nullable_col IS NULL;
SELECT sum FROM result;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM events;
SELECT COUNT(*) as count_all, COUNT(value) as count_non_null, SUM(value) as sum FROM data;

-- ============================================================================
-- Test: test_helpful_error_for_date_function_invalid_argument
-- Source: p1_features_error_handling_stress_tdd.rs:635
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, DATE '2024-01-01');
DROP TABLE IF EXISTS evolving;
CREATE TABLE evolving (id INT64, name STRING);
INSERT INTO evolving VALUES (1, 'test');
ALTER TABLE evolving ADD COLUMN age INT64 DEFAULT 0;
ALTER TABLE evolving ADD COLUMN email STRING;
INSERT INTO evolving (id, name, age, email) VALUES (2, 'new', 25, 'test@example.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64);
ALTER TABLE dest ADD COLUMN name STRING;
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, nullable_col STRING);
INSERT INTO source VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64, nullable_col STRING);
INSERT INTO dest SELECT id, nullable_col FROM source;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO data VALUES (1, 10.5, NULL);
DROP TABLE IF EXISTS result;
CREATE TABLE result (id INT64, sum NUMERIC(10, 2));
INSERT INTO result SELECT id, a + b FROM data;
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);

SELECT EXTRACT(MILLISECOND FROM event_date) FROM events;
SELECT age FROM evolving WHERE id = 1;
SELECT COUNT(*) FROM data;
SELECT id, name FROM dest;
SELECT COUNT(*) FROM dest WHERE nullable_col IS NULL;
SELECT sum FROM result;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM events;
SELECT COUNT(*) as count_all, COUNT(value) as count_non_null, SUM(value) as sum FROM data;

-- ============================================================================
-- Test: test_multiple_alter_table_operations_sequence
-- Source: p1_features_error_handling_stress_tdd.rs:664
-- ============================================================================
DROP TABLE IF EXISTS evolving;
CREATE TABLE evolving (id INT64, name STRING);
INSERT INTO evolving VALUES (1, 'test');
ALTER TABLE evolving ADD COLUMN age INT64 DEFAULT 0;
ALTER TABLE evolving ADD COLUMN email STRING;
INSERT INTO evolving (id, name, age, email) VALUES (2, 'new', 25, 'test@example.com');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64);
ALTER TABLE dest ADD COLUMN name STRING;
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, nullable_col STRING);
INSERT INTO source VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64, nullable_col STRING);
INSERT INTO dest SELECT id, nullable_col FROM source;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO data VALUES (1, 10.5, NULL);
DROP TABLE IF EXISTS result;
CREATE TABLE result (id INT64, sum NUMERIC(10, 2));
INSERT INTO result SELECT id, a + b FROM data;
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);

SELECT age FROM evolving WHERE id = 1;
SELECT COUNT(*) FROM data;
SELECT id, name FROM dest;
SELECT COUNT(*) FROM dest WHERE nullable_col IS NULL;
SELECT sum FROM result;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM events;
SELECT COUNT(*) as count_all, COUNT(value) as count_non_null, SUM(value) as sum FROM data;

-- ============================================================================
-- Test: test_insert_after_failed_insert_maintains_consistency
-- Source: p1_features_error_handling_stress_tdd.rs:700
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64 PRIMARY KEY);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (1);
INSERT INTO data VALUES (2);
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64);
ALTER TABLE dest ADD COLUMN name STRING;
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, nullable_col STRING);
INSERT INTO source VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64, nullable_col STRING);
INSERT INTO dest SELECT id, nullable_col FROM source;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO data VALUES (1, 10.5, NULL);
DROP TABLE IF EXISTS result;
CREATE TABLE result (id INT64, sum NUMERIC(10, 2));
INSERT INTO result SELECT id, a + b FROM data;
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);

SELECT COUNT(*) FROM data;
SELECT id, name FROM dest;
SELECT COUNT(*) FROM dest WHERE nullable_col IS NULL;
SELECT sum FROM result;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM events;
SELECT COUNT(*) as count_all, COUNT(value) as count_non_null, SUM(value) as sum FROM data;

-- ============================================================================
-- Test: test_alter_table_followed_by_insert_select
-- Source: p1_features_error_handling_stress_tdd.rs:730
-- ============================================================================
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, name STRING);
INSERT INTO source VALUES (1, 'Alice');
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64);
ALTER TABLE dest ADD COLUMN name STRING;
INSERT INTO dest SELECT id, name FROM source;
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, nullable_col STRING);
INSERT INTO source VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64, nullable_col STRING);
INSERT INTO dest SELECT id, nullable_col FROM source;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO data VALUES (1, 10.5, NULL);
DROP TABLE IF EXISTS result;
CREATE TABLE result (id INT64, sum NUMERIC(10, 2));
INSERT INTO result SELECT id, a + b FROM data;
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);

SELECT id, name FROM dest;
SELECT COUNT(*) FROM dest WHERE nullable_col IS NULL;
SELECT sum FROM result;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM events;
SELECT COUNT(*) as count_all, COUNT(value) as count_non_null, SUM(value) as sum FROM data;

-- ============================================================================
-- Test: test_insert_select_with_all_nulls
-- Source: p1_features_error_handling_stress_tdd.rs:765
-- ============================================================================
DROP TABLE IF EXISTS source;
CREATE TABLE source (id INT64, nullable_col STRING);
INSERT INTO source VALUES (1, NULL), (2, NULL), (3, NULL);
DROP TABLE IF EXISTS dest;
CREATE TABLE dest (id INT64, nullable_col STRING);
INSERT INTO dest SELECT id, nullable_col FROM source;
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO data VALUES (1, 10.5, NULL);
DROP TABLE IF EXISTS result;
CREATE TABLE result (id INT64, sum NUMERIC(10, 2));
INSERT INTO result SELECT id, a + b FROM data;
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);

SELECT COUNT(*) FROM dest WHERE nullable_col IS NULL;
SELECT sum FROM result;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM events;
SELECT COUNT(*) as count_all, COUNT(value) as count_non_null, SUM(value) as sum FROM data;

-- ============================================================================
-- Test: test_numeric_arithmetic_with_null_propagation
-- Source: p1_features_error_handling_stress_tdd.rs:795
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, a NUMERIC(10, 2), b NUMERIC(10, 2));
INSERT INTO data VALUES (1, 10.5, NULL);
DROP TABLE IF EXISTS result;
CREATE TABLE result (id INT64, sum NUMERIC(10, 2));
INSERT INTO result SELECT id, a + b FROM data;
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);

SELECT sum FROM result;
SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM events;
SELECT COUNT(*) as count_all, COUNT(value) as count_non_null, SUM(value) as sum FROM data;

-- ============================================================================
-- Test: test_date_function_with_null_input
-- Source: p1_features_error_handling_stress_tdd.rs:823
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (id INT64, event_date DATE);
INSERT INTO events VALUES (1, NULL);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL);

SELECT DATE_ADD(event_date, INTERVAL 7 DAY) as future_date FROM events;
SELECT COUNT(*) as count_all, COUNT(value) as count_non_null, SUM(value) as sum FROM data;

-- ============================================================================
-- Test: test_returning_in_subquery
-- Source: returning_clause_comprehensive_tdd.rs:599
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
DROP TABLE IF EXISTS audit;
CREATE TABLE audit (id INT64, action STRING, row_id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice') RETURNING id;
INSERT INTO audit VALUES (1, 'created', 1);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64);
INSERT INTO users VALUES (1, 25) \
RETURNING id, CASE WHEN age < 18 THEN 'minor' ELSE 'adult' END AS age_category;
DROP TABLE IF EXISTS seq;
CREATE TABLE seq (id INT64, value STRING);
INSERT INTO seq VALUES (1, 'first'), (2, 'second'), (3, 'third') \
RETURNING id, value;
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
DROP TABLE IF EXISTS nullable;
CREATE TABLE nullable (id INT64, a STRING, b STRING, c STRING);
INSERT INTO nullable VALUES (1, NULL, NULL, NULL) RETURNING *;

SELECT * FROM (INSERT INTO users VALUES (1, 'Alice') RETURNING *) AS inserted;
UPDATE users SET name = 'Alice Updated' WHERE id = 1 RETURNING id, name;

-- ============================================================================
-- Test: test_multiple_dml_with_returning
-- Source: returning_clause_comprehensive_tdd.rs:620
-- ============================================================================
DROP TABLE IF EXISTS audit;
CREATE TABLE audit (id INT64, action STRING, row_id INT64);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, name STRING);
INSERT INTO users VALUES (1, 'Alice') RETURNING id;
INSERT INTO audit VALUES (1, 'created', 1);
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64);
INSERT INTO users VALUES (1, 25) \
RETURNING id, CASE WHEN age < 18 THEN 'minor' ELSE 'adult' END AS age_category;
DROP TABLE IF EXISTS seq;
CREATE TABLE seq (id INT64, value STRING);
INSERT INTO seq VALUES (1, 'first'), (2, 'second'), (3, 'third') \
RETURNING id, value;
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
DROP TABLE IF EXISTS nullable;
CREATE TABLE nullable (id INT64, a STRING, b STRING, c STRING);
INSERT INTO nullable VALUES (1, NULL, NULL, NULL) RETURNING *;

UPDATE users SET name = 'Alice Updated' WHERE id = 1 RETURNING id, name;

-- ============================================================================
-- Test: test_returning_with_case_expression
-- Source: returning_clause_comprehensive_tdd.rs:654
-- ============================================================================
DROP TABLE IF EXISTS users;
CREATE TABLE users (id INT64, age INT64);
INSERT INTO users VALUES (1, 25) \
RETURNING id, CASE WHEN age < 18 THEN 'minor' ELSE 'adult' END AS age_category;
DROP TABLE IF EXISTS seq;
CREATE TABLE seq (id INT64, value STRING);
INSERT INTO seq VALUES (1, 'first'), (2, 'second'), (3, 'third') \
RETURNING id, value;
DROP TABLE IF EXISTS numbers;
CREATE TABLE numbers (id INT64, value INT64);
DROP TABLE IF EXISTS nullable;
CREATE TABLE nullable (id INT64, a STRING, b STRING, c STRING);
INSERT INTO nullable VALUES (1, NULL, NULL, NULL) RETURNING *;

-- ============================================================================
-- Test: test_union_all_no_deduplication
-- Source: setops_distinct_orderby_tdd.rs:22
-- ============================================================================
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id INT64, value STRING);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (id INT64, value STRING);
INSERT INTO t1 VALUES (1, 'a'), (2, 'b');
INSERT INTO t2 VALUES (2, 'b'), (3, 'c');
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (n INT64);
INSERT INTO nums VALUES (1), (2);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO set1 VALUES (1), (2), (2), (3);
INSERT INTO set2 VALUES (2), (2), (2), (4);
DROP TABLE IF EXISTS a;
CREATE TABLE a (n INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (n INT64);
INSERT INTO a VALUES (1), (1), (2);
INSERT INTO b VALUES (1), (1), (1), (2);
DROP TABLE IF EXISTS left_set;
CREATE TABLE left_set (value INT64);
DROP TABLE IF EXISTS right_set;
CREATE TABLE right_set (value INT64);
INSERT INTO left_set VALUES (1), (1), (1), (2), (3);
INSERT INTO right_set VALUES (1), (2), (2);
DROP TABLE IF EXISTS x;
CREATE TABLE x (n INT64);
DROP TABLE IF EXISTS y;
CREATE TABLE y (n INT64);
INSERT INTO x VALUES (1), (1), (2), (2), (3);
INSERT INTO y VALUES (2);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (n INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (n INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (n INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (2), (3);
INSERT INTO t3 VALUES (2), (4);
DROP TABLE IF EXISTS odds;
CREATE TABLE odds (n INT64);
DROP TABLE IF EXISTS evens;
CREATE TABLE evens (n INT64);
INSERT INTO odds VALUES (1), (3), (5);
INSERT INTO evens VALUES (2), (4), (6);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING, name STRING, price FLOAT64);
INSERT INTO items VALUES ('A', 'item1', 100), ('A', 'item2', 200), ('B', 'item3', 150);
DROP TABLE IF EXISTS events;
CREATE TABLE events (date STRING, type STRING, user_id INT64, action STRING);
INSERT INTO events VALUES ('2024-01-01', 'A', 1, 'login'), ('2024-01-01', 'A', 1, 'logout'), ('2024-01-01', 'B', 2, 'click');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100, 50), (2, 100, 75), (3, 101, 60);
DROP TABLE IF EXISTS values;
CREATE TABLE values (n INT64);
INSERT INTO values VALUES (1), (2), (2), (3), (3), (3);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (score FLOAT64);
INSERT INTO scores VALUES (100), (100), (80), (90);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100, 50), (1, 100, 50), (2, 101, 75);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (20), (5);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, tax_rate FLOAT64);
INSERT INTO products VALUES ('A', 100, 0.1), ('B', 80, 0.15), ('C', 110, 0.05);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, priority STRING);
INSERT INTO tasks VALUES (1, 'low'), (2, 'high'), (3, 'medium'), (4, 'high');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64, c INT64);
INSERT INTO data VALUES (3, 1, 100), (1, 2, 200), (2, 3, 150);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('alice'), ('Bob'), ('CHARLIE'), ('david');
DROP TABLE IF EXISTS empty1;
CREATE TABLE empty1 (n INT64);
DROP TABLE IF EXISTS empty2;
CREATE TABLE empty2 (n INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO nulls VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS same;
CREATE TABLE same (id INT64, value INT64);
INSERT INTO same VALUES (1, 10), (2, 10), (3, 10);

SELECT * FROM t1 UNION ALL SELECT * FROM t2 ORDER BY id, value;
SELECT n FROM nums
UNION ALL SELECT n FROM nums
UNION ALL SELECT n FROM nums
ORDER BY n;
SELECT value FROM set1
INTERSECT ALL
SELECT value FROM set2
ORDER BY value;
SELECT n FROM a INTERSECT SELECT n FROM b ORDER BY n;
SELECT n FROM a INTERSECT ALL SELECT n FROM b ORDER BY n;
SELECT value FROM left_set
EXCEPT ALL
SELECT value FROM right_set
ORDER BY value;
SELECT n FROM x EXCEPT SELECT n FROM y ORDER BY n;
SELECT n FROM x EXCEPT ALL SELECT n FROM y ORDER BY n;
SELECT n FROM t1
UNION
SELECT n FROM t2
INTERSECT
SELECT n FROM t3
ORDER BY n;
(SELECT n FROM odds) UNION (SELECT n FROM evens) ORDER BY n DESC;
SELECT DISTINCT ON (category) category, name, price
FROM items
ORDER BY category, price;
SELECT DISTINCT ON (date, type) date, type, action
FROM events
ORDER BY date, type, user_id;
SELECT COUNT(DISTINCT customer_id) as unique_customers FROM orders;
SELECT SUM(DISTINCT n) as distinct_sum FROM values;
SELECT AVG(DISTINCT score) as avg_score FROM scores;
SELECT
COUNT(DISTINCT product_id) as unique_products,
COUNT(DISTINCT customer_id) as unique_customers,
COUNT(*) as total_sales
FROM sales;
SELECT value FROM data ORDER BY value NULLS FIRST;
SELECT value FROM data ORDER BY value NULLS LAST;
SELECT value FROM data ORDER BY value DESC NULLS FIRST;
SELECT name, price * (1 + tax_rate) as total
FROM products
ORDER BY price * (1 + tax_rate);
SELECT id FROM tasks
ORDER BY CASE priority
WHEN 'high' THEN 1
WHEN 'medium' THEN 2
WHEN 'low' THEN 3
END, id;
SELECT a, b, c FROM data ORDER BY 1, 3;
SELECT name FROM names ORDER BY name COLLATE NOCASE;
SELECT n FROM empty1 UNION ALL SELECT n FROM empty2;
SELECT DISTINCT value FROM nulls;
SELECT id FROM same ORDER BY value, id DESC;

-- ============================================================================
-- Test: test_union_all_multiple_times
-- Source: setops_distinct_orderby_tdd.rs:55
-- ============================================================================
DROP TABLE IF EXISTS nums;
CREATE TABLE nums (n INT64);
INSERT INTO nums VALUES (1), (2);
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO set1 VALUES (1), (2), (2), (3);
INSERT INTO set2 VALUES (2), (2), (2), (4);
DROP TABLE IF EXISTS a;
CREATE TABLE a (n INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (n INT64);
INSERT INTO a VALUES (1), (1), (2);
INSERT INTO b VALUES (1), (1), (1), (2);
DROP TABLE IF EXISTS left_set;
CREATE TABLE left_set (value INT64);
DROP TABLE IF EXISTS right_set;
CREATE TABLE right_set (value INT64);
INSERT INTO left_set VALUES (1), (1), (1), (2), (3);
INSERT INTO right_set VALUES (1), (2), (2);
DROP TABLE IF EXISTS x;
CREATE TABLE x (n INT64);
DROP TABLE IF EXISTS y;
CREATE TABLE y (n INT64);
INSERT INTO x VALUES (1), (1), (2), (2), (3);
INSERT INTO y VALUES (2);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (n INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (n INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (n INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (2), (3);
INSERT INTO t3 VALUES (2), (4);
DROP TABLE IF EXISTS odds;
CREATE TABLE odds (n INT64);
DROP TABLE IF EXISTS evens;
CREATE TABLE evens (n INT64);
INSERT INTO odds VALUES (1), (3), (5);
INSERT INTO evens VALUES (2), (4), (6);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING, name STRING, price FLOAT64);
INSERT INTO items VALUES ('A', 'item1', 100), ('A', 'item2', 200), ('B', 'item3', 150);
DROP TABLE IF EXISTS events;
CREATE TABLE events (date STRING, type STRING, user_id INT64, action STRING);
INSERT INTO events VALUES ('2024-01-01', 'A', 1, 'login'), ('2024-01-01', 'A', 1, 'logout'), ('2024-01-01', 'B', 2, 'click');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100, 50), (2, 100, 75), (3, 101, 60);
DROP TABLE IF EXISTS values;
CREATE TABLE values (n INT64);
INSERT INTO values VALUES (1), (2), (2), (3), (3), (3);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (score FLOAT64);
INSERT INTO scores VALUES (100), (100), (80), (90);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100, 50), (1, 100, 50), (2, 101, 75);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (20), (5);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, tax_rate FLOAT64);
INSERT INTO products VALUES ('A', 100, 0.1), ('B', 80, 0.15), ('C', 110, 0.05);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, priority STRING);
INSERT INTO tasks VALUES (1, 'low'), (2, 'high'), (3, 'medium'), (4, 'high');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64, c INT64);
INSERT INTO data VALUES (3, 1, 100), (1, 2, 200), (2, 3, 150);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('alice'), ('Bob'), ('CHARLIE'), ('david');
DROP TABLE IF EXISTS empty1;
CREATE TABLE empty1 (n INT64);
DROP TABLE IF EXISTS empty2;
CREATE TABLE empty2 (n INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO nulls VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS same;
CREATE TABLE same (id INT64, value INT64);
INSERT INTO same VALUES (1, 10), (2, 10), (3, 10);

SELECT n FROM nums
UNION ALL SELECT n FROM nums
UNION ALL SELECT n FROM nums
ORDER BY n;
SELECT value FROM set1
INTERSECT ALL
SELECT value FROM set2
ORDER BY value;
SELECT n FROM a INTERSECT SELECT n FROM b ORDER BY n;
SELECT n FROM a INTERSECT ALL SELECT n FROM b ORDER BY n;
SELECT value FROM left_set
EXCEPT ALL
SELECT value FROM right_set
ORDER BY value;
SELECT n FROM x EXCEPT SELECT n FROM y ORDER BY n;
SELECT n FROM x EXCEPT ALL SELECT n FROM y ORDER BY n;
SELECT n FROM t1
UNION
SELECT n FROM t2
INTERSECT
SELECT n FROM t3
ORDER BY n;
(SELECT n FROM odds) UNION (SELECT n FROM evens) ORDER BY n DESC;
SELECT DISTINCT ON (category) category, name, price
FROM items
ORDER BY category, price;
SELECT DISTINCT ON (date, type) date, type, action
FROM events
ORDER BY date, type, user_id;
SELECT COUNT(DISTINCT customer_id) as unique_customers FROM orders;
SELECT SUM(DISTINCT n) as distinct_sum FROM values;
SELECT AVG(DISTINCT score) as avg_score FROM scores;
SELECT
COUNT(DISTINCT product_id) as unique_products,
COUNT(DISTINCT customer_id) as unique_customers,
COUNT(*) as total_sales
FROM sales;
SELECT value FROM data ORDER BY value NULLS FIRST;
SELECT value FROM data ORDER BY value NULLS LAST;
SELECT value FROM data ORDER BY value DESC NULLS FIRST;
SELECT name, price * (1 + tax_rate) as total
FROM products
ORDER BY price * (1 + tax_rate);
SELECT id FROM tasks
ORDER BY CASE priority
WHEN 'high' THEN 1
WHEN 'medium' THEN 2
WHEN 'low' THEN 3
END, id;
SELECT a, b, c FROM data ORDER BY 1, 3;
SELECT name FROM names ORDER BY name COLLATE NOCASE;
SELECT n FROM empty1 UNION ALL SELECT n FROM empty2;
SELECT DISTINCT value FROM nulls;
SELECT id FROM same ORDER BY value, id DESC;

-- ============================================================================
-- Test: test_intersect_all_keeps_duplicates
-- Source: setops_distinct_orderby_tdd.rs:82
-- ============================================================================
DROP TABLE IF EXISTS set1;
CREATE TABLE set1 (value INT64);
DROP TABLE IF EXISTS set2;
CREATE TABLE set2 (value INT64);
INSERT INTO set1 VALUES (1), (2), (2), (3);
INSERT INTO set2 VALUES (2), (2), (2), (4);
DROP TABLE IF EXISTS a;
CREATE TABLE a (n INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (n INT64);
INSERT INTO a VALUES (1), (1), (2);
INSERT INTO b VALUES (1), (1), (1), (2);
DROP TABLE IF EXISTS left_set;
CREATE TABLE left_set (value INT64);
DROP TABLE IF EXISTS right_set;
CREATE TABLE right_set (value INT64);
INSERT INTO left_set VALUES (1), (1), (1), (2), (3);
INSERT INTO right_set VALUES (1), (2), (2);
DROP TABLE IF EXISTS x;
CREATE TABLE x (n INT64);
DROP TABLE IF EXISTS y;
CREATE TABLE y (n INT64);
INSERT INTO x VALUES (1), (1), (2), (2), (3);
INSERT INTO y VALUES (2);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (n INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (n INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (n INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (2), (3);
INSERT INTO t3 VALUES (2), (4);
DROP TABLE IF EXISTS odds;
CREATE TABLE odds (n INT64);
DROP TABLE IF EXISTS evens;
CREATE TABLE evens (n INT64);
INSERT INTO odds VALUES (1), (3), (5);
INSERT INTO evens VALUES (2), (4), (6);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING, name STRING, price FLOAT64);
INSERT INTO items VALUES ('A', 'item1', 100), ('A', 'item2', 200), ('B', 'item3', 150);
DROP TABLE IF EXISTS events;
CREATE TABLE events (date STRING, type STRING, user_id INT64, action STRING);
INSERT INTO events VALUES ('2024-01-01', 'A', 1, 'login'), ('2024-01-01', 'A', 1, 'logout'), ('2024-01-01', 'B', 2, 'click');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100, 50), (2, 100, 75), (3, 101, 60);
DROP TABLE IF EXISTS values;
CREATE TABLE values (n INT64);
INSERT INTO values VALUES (1), (2), (2), (3), (3), (3);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (score FLOAT64);
INSERT INTO scores VALUES (100), (100), (80), (90);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100, 50), (1, 100, 50), (2, 101, 75);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (20), (5);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, tax_rate FLOAT64);
INSERT INTO products VALUES ('A', 100, 0.1), ('B', 80, 0.15), ('C', 110, 0.05);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, priority STRING);
INSERT INTO tasks VALUES (1, 'low'), (2, 'high'), (3, 'medium'), (4, 'high');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64, c INT64);
INSERT INTO data VALUES (3, 1, 100), (1, 2, 200), (2, 3, 150);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('alice'), ('Bob'), ('CHARLIE'), ('david');
DROP TABLE IF EXISTS empty1;
CREATE TABLE empty1 (n INT64);
DROP TABLE IF EXISTS empty2;
CREATE TABLE empty2 (n INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO nulls VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS same;
CREATE TABLE same (id INT64, value INT64);
INSERT INTO same VALUES (1, 10), (2, 10), (3, 10);

SELECT value FROM set1
INTERSECT ALL
SELECT value FROM set2
ORDER BY value;
SELECT n FROM a INTERSECT SELECT n FROM b ORDER BY n;
SELECT n FROM a INTERSECT ALL SELECT n FROM b ORDER BY n;
SELECT value FROM left_set
EXCEPT ALL
SELECT value FROM right_set
ORDER BY value;
SELECT n FROM x EXCEPT SELECT n FROM y ORDER BY n;
SELECT n FROM x EXCEPT ALL SELECT n FROM y ORDER BY n;
SELECT n FROM t1
UNION
SELECT n FROM t2
INTERSECT
SELECT n FROM t3
ORDER BY n;
(SELECT n FROM odds) UNION (SELECT n FROM evens) ORDER BY n DESC;
SELECT DISTINCT ON (category) category, name, price
FROM items
ORDER BY category, price;
SELECT DISTINCT ON (date, type) date, type, action
FROM events
ORDER BY date, type, user_id;
SELECT COUNT(DISTINCT customer_id) as unique_customers FROM orders;
SELECT SUM(DISTINCT n) as distinct_sum FROM values;
SELECT AVG(DISTINCT score) as avg_score FROM scores;
SELECT
COUNT(DISTINCT product_id) as unique_products,
COUNT(DISTINCT customer_id) as unique_customers,
COUNT(*) as total_sales
FROM sales;
SELECT value FROM data ORDER BY value NULLS FIRST;
SELECT value FROM data ORDER BY value NULLS LAST;
SELECT value FROM data ORDER BY value DESC NULLS FIRST;
SELECT name, price * (1 + tax_rate) as total
FROM products
ORDER BY price * (1 + tax_rate);
SELECT id FROM tasks
ORDER BY CASE priority
WHEN 'high' THEN 1
WHEN 'medium' THEN 2
WHEN 'low' THEN 3
END, id;
SELECT a, b, c FROM data ORDER BY 1, 3;
SELECT name FROM names ORDER BY name COLLATE NOCASE;
SELECT n FROM empty1 UNION ALL SELECT n FROM empty2;
SELECT DISTINCT value FROM nulls;
SELECT id FROM same ORDER BY value, id DESC;

-- ============================================================================
-- Test: test_intersect_all_vs_intersect
-- Source: setops_distinct_orderby_tdd.rs:122
-- ============================================================================
DROP TABLE IF EXISTS a;
CREATE TABLE a (n INT64);
DROP TABLE IF EXISTS b;
CREATE TABLE b (n INT64);
INSERT INTO a VALUES (1), (1), (2);
INSERT INTO b VALUES (1), (1), (1), (2);
DROP TABLE IF EXISTS left_set;
CREATE TABLE left_set (value INT64);
DROP TABLE IF EXISTS right_set;
CREATE TABLE right_set (value INT64);
INSERT INTO left_set VALUES (1), (1), (1), (2), (3);
INSERT INTO right_set VALUES (1), (2), (2);
DROP TABLE IF EXISTS x;
CREATE TABLE x (n INT64);
DROP TABLE IF EXISTS y;
CREATE TABLE y (n INT64);
INSERT INTO x VALUES (1), (1), (2), (2), (3);
INSERT INTO y VALUES (2);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (n INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (n INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (n INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (2), (3);
INSERT INTO t3 VALUES (2), (4);
DROP TABLE IF EXISTS odds;
CREATE TABLE odds (n INT64);
DROP TABLE IF EXISTS evens;
CREATE TABLE evens (n INT64);
INSERT INTO odds VALUES (1), (3), (5);
INSERT INTO evens VALUES (2), (4), (6);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING, name STRING, price FLOAT64);
INSERT INTO items VALUES ('A', 'item1', 100), ('A', 'item2', 200), ('B', 'item3', 150);
DROP TABLE IF EXISTS events;
CREATE TABLE events (date STRING, type STRING, user_id INT64, action STRING);
INSERT INTO events VALUES ('2024-01-01', 'A', 1, 'login'), ('2024-01-01', 'A', 1, 'logout'), ('2024-01-01', 'B', 2, 'click');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100, 50), (2, 100, 75), (3, 101, 60);
DROP TABLE IF EXISTS values;
CREATE TABLE values (n INT64);
INSERT INTO values VALUES (1), (2), (2), (3), (3), (3);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (score FLOAT64);
INSERT INTO scores VALUES (100), (100), (80), (90);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100, 50), (1, 100, 50), (2, 101, 75);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (20), (5);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, tax_rate FLOAT64);
INSERT INTO products VALUES ('A', 100, 0.1), ('B', 80, 0.15), ('C', 110, 0.05);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, priority STRING);
INSERT INTO tasks VALUES (1, 'low'), (2, 'high'), (3, 'medium'), (4, 'high');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64, c INT64);
INSERT INTO data VALUES (3, 1, 100), (1, 2, 200), (2, 3, 150);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('alice'), ('Bob'), ('CHARLIE'), ('david');
DROP TABLE IF EXISTS empty1;
CREATE TABLE empty1 (n INT64);
DROP TABLE IF EXISTS empty2;
CREATE TABLE empty2 (n INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO nulls VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS same;
CREATE TABLE same (id INT64, value INT64);
INSERT INTO same VALUES (1, 10), (2, 10), (3, 10);

SELECT n FROM a INTERSECT SELECT n FROM b ORDER BY n;
SELECT n FROM a INTERSECT ALL SELECT n FROM b ORDER BY n;
SELECT value FROM left_set
EXCEPT ALL
SELECT value FROM right_set
ORDER BY value;
SELECT n FROM x EXCEPT SELECT n FROM y ORDER BY n;
SELECT n FROM x EXCEPT ALL SELECT n FROM y ORDER BY n;
SELECT n FROM t1
UNION
SELECT n FROM t2
INTERSECT
SELECT n FROM t3
ORDER BY n;
(SELECT n FROM odds) UNION (SELECT n FROM evens) ORDER BY n DESC;
SELECT DISTINCT ON (category) category, name, price
FROM items
ORDER BY category, price;
SELECT DISTINCT ON (date, type) date, type, action
FROM events
ORDER BY date, type, user_id;
SELECT COUNT(DISTINCT customer_id) as unique_customers FROM orders;
SELECT SUM(DISTINCT n) as distinct_sum FROM values;
SELECT AVG(DISTINCT score) as avg_score FROM scores;
SELECT
COUNT(DISTINCT product_id) as unique_products,
COUNT(DISTINCT customer_id) as unique_customers,
COUNT(*) as total_sales
FROM sales;
SELECT value FROM data ORDER BY value NULLS FIRST;
SELECT value FROM data ORDER BY value NULLS LAST;
SELECT value FROM data ORDER BY value DESC NULLS FIRST;
SELECT name, price * (1 + tax_rate) as total
FROM products
ORDER BY price * (1 + tax_rate);
SELECT id FROM tasks
ORDER BY CASE priority
WHEN 'high' THEN 1
WHEN 'medium' THEN 2
WHEN 'low' THEN 3
END, id;
SELECT a, b, c FROM data ORDER BY 1, 3;
SELECT name FROM names ORDER BY name COLLATE NOCASE;
SELECT n FROM empty1 UNION ALL SELECT n FROM empty2;
SELECT DISTINCT value FROM nulls;
SELECT id FROM same ORDER BY value, id DESC;

-- ============================================================================
-- Test: test_except_all_removes_minimum_duplicates
-- Source: setops_distinct_orderby_tdd.rs:153
-- ============================================================================
DROP TABLE IF EXISTS left_set;
CREATE TABLE left_set (value INT64);
DROP TABLE IF EXISTS right_set;
CREATE TABLE right_set (value INT64);
INSERT INTO left_set VALUES (1), (1), (1), (2), (3);
INSERT INTO right_set VALUES (1), (2), (2);
DROP TABLE IF EXISTS x;
CREATE TABLE x (n INT64);
DROP TABLE IF EXISTS y;
CREATE TABLE y (n INT64);
INSERT INTO x VALUES (1), (1), (2), (2), (3);
INSERT INTO y VALUES (2);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (n INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (n INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (n INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (2), (3);
INSERT INTO t3 VALUES (2), (4);
DROP TABLE IF EXISTS odds;
CREATE TABLE odds (n INT64);
DROP TABLE IF EXISTS evens;
CREATE TABLE evens (n INT64);
INSERT INTO odds VALUES (1), (3), (5);
INSERT INTO evens VALUES (2), (4), (6);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING, name STRING, price FLOAT64);
INSERT INTO items VALUES ('A', 'item1', 100), ('A', 'item2', 200), ('B', 'item3', 150);
DROP TABLE IF EXISTS events;
CREATE TABLE events (date STRING, type STRING, user_id INT64, action STRING);
INSERT INTO events VALUES ('2024-01-01', 'A', 1, 'login'), ('2024-01-01', 'A', 1, 'logout'), ('2024-01-01', 'B', 2, 'click');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100, 50), (2, 100, 75), (3, 101, 60);
DROP TABLE IF EXISTS values;
CREATE TABLE values (n INT64);
INSERT INTO values VALUES (1), (2), (2), (3), (3), (3);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (score FLOAT64);
INSERT INTO scores VALUES (100), (100), (80), (90);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100, 50), (1, 100, 50), (2, 101, 75);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (20), (5);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, tax_rate FLOAT64);
INSERT INTO products VALUES ('A', 100, 0.1), ('B', 80, 0.15), ('C', 110, 0.05);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, priority STRING);
INSERT INTO tasks VALUES (1, 'low'), (2, 'high'), (3, 'medium'), (4, 'high');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64, c INT64);
INSERT INTO data VALUES (3, 1, 100), (1, 2, 200), (2, 3, 150);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('alice'), ('Bob'), ('CHARLIE'), ('david');
DROP TABLE IF EXISTS empty1;
CREATE TABLE empty1 (n INT64);
DROP TABLE IF EXISTS empty2;
CREATE TABLE empty2 (n INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO nulls VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS same;
CREATE TABLE same (id INT64, value INT64);
INSERT INTO same VALUES (1, 10), (2, 10), (3, 10);

SELECT value FROM left_set
EXCEPT ALL
SELECT value FROM right_set
ORDER BY value;
SELECT n FROM x EXCEPT SELECT n FROM y ORDER BY n;
SELECT n FROM x EXCEPT ALL SELECT n FROM y ORDER BY n;
SELECT n FROM t1
UNION
SELECT n FROM t2
INTERSECT
SELECT n FROM t3
ORDER BY n;
(SELECT n FROM odds) UNION (SELECT n FROM evens) ORDER BY n DESC;
SELECT DISTINCT ON (category) category, name, price
FROM items
ORDER BY category, price;
SELECT DISTINCT ON (date, type) date, type, action
FROM events
ORDER BY date, type, user_id;
SELECT COUNT(DISTINCT customer_id) as unique_customers FROM orders;
SELECT SUM(DISTINCT n) as distinct_sum FROM values;
SELECT AVG(DISTINCT score) as avg_score FROM scores;
SELECT
COUNT(DISTINCT product_id) as unique_products,
COUNT(DISTINCT customer_id) as unique_customers,
COUNT(*) as total_sales
FROM sales;
SELECT value FROM data ORDER BY value NULLS FIRST;
SELECT value FROM data ORDER BY value NULLS LAST;
SELECT value FROM data ORDER BY value DESC NULLS FIRST;
SELECT name, price * (1 + tax_rate) as total
FROM products
ORDER BY price * (1 + tax_rate);
SELECT id FROM tasks
ORDER BY CASE priority
WHEN 'high' THEN 1
WHEN 'medium' THEN 2
WHEN 'low' THEN 3
END, id;
SELECT a, b, c FROM data ORDER BY 1, 3;
SELECT name FROM names ORDER BY name COLLATE NOCASE;
SELECT n FROM empty1 UNION ALL SELECT n FROM empty2;
SELECT DISTINCT value FROM nulls;
SELECT id FROM same ORDER BY value, id DESC;

-- ============================================================================
-- Test: test_except_all_vs_except
-- Source: setops_distinct_orderby_tdd.rs:197
-- ============================================================================
DROP TABLE IF EXISTS x;
CREATE TABLE x (n INT64);
DROP TABLE IF EXISTS y;
CREATE TABLE y (n INT64);
INSERT INTO x VALUES (1), (1), (2), (2), (3);
INSERT INTO y VALUES (2);
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (n INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (n INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (n INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (2), (3);
INSERT INTO t3 VALUES (2), (4);
DROP TABLE IF EXISTS odds;
CREATE TABLE odds (n INT64);
DROP TABLE IF EXISTS evens;
CREATE TABLE evens (n INT64);
INSERT INTO odds VALUES (1), (3), (5);
INSERT INTO evens VALUES (2), (4), (6);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING, name STRING, price FLOAT64);
INSERT INTO items VALUES ('A', 'item1', 100), ('A', 'item2', 200), ('B', 'item3', 150);
DROP TABLE IF EXISTS events;
CREATE TABLE events (date STRING, type STRING, user_id INT64, action STRING);
INSERT INTO events VALUES ('2024-01-01', 'A', 1, 'login'), ('2024-01-01', 'A', 1, 'logout'), ('2024-01-01', 'B', 2, 'click');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100, 50), (2, 100, 75), (3, 101, 60);
DROP TABLE IF EXISTS values;
CREATE TABLE values (n INT64);
INSERT INTO values VALUES (1), (2), (2), (3), (3), (3);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (score FLOAT64);
INSERT INTO scores VALUES (100), (100), (80), (90);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100, 50), (1, 100, 50), (2, 101, 75);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (20), (5);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, tax_rate FLOAT64);
INSERT INTO products VALUES ('A', 100, 0.1), ('B', 80, 0.15), ('C', 110, 0.05);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, priority STRING);
INSERT INTO tasks VALUES (1, 'low'), (2, 'high'), (3, 'medium'), (4, 'high');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64, c INT64);
INSERT INTO data VALUES (3, 1, 100), (1, 2, 200), (2, 3, 150);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('alice'), ('Bob'), ('CHARLIE'), ('david');
DROP TABLE IF EXISTS empty1;
CREATE TABLE empty1 (n INT64);
DROP TABLE IF EXISTS empty2;
CREATE TABLE empty2 (n INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO nulls VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS same;
CREATE TABLE same (id INT64, value INT64);
INSERT INTO same VALUES (1, 10), (2, 10), (3, 10);

SELECT n FROM x EXCEPT SELECT n FROM y ORDER BY n;
SELECT n FROM x EXCEPT ALL SELECT n FROM y ORDER BY n;
SELECT n FROM t1
UNION
SELECT n FROM t2
INTERSECT
SELECT n FROM t3
ORDER BY n;
(SELECT n FROM odds) UNION (SELECT n FROM evens) ORDER BY n DESC;
SELECT DISTINCT ON (category) category, name, price
FROM items
ORDER BY category, price;
SELECT DISTINCT ON (date, type) date, type, action
FROM events
ORDER BY date, type, user_id;
SELECT COUNT(DISTINCT customer_id) as unique_customers FROM orders;
SELECT SUM(DISTINCT n) as distinct_sum FROM values;
SELECT AVG(DISTINCT score) as avg_score FROM scores;
SELECT
COUNT(DISTINCT product_id) as unique_products,
COUNT(DISTINCT customer_id) as unique_customers,
COUNT(*) as total_sales
FROM sales;
SELECT value FROM data ORDER BY value NULLS FIRST;
SELECT value FROM data ORDER BY value NULLS LAST;
SELECT value FROM data ORDER BY value DESC NULLS FIRST;
SELECT name, price * (1 + tax_rate) as total
FROM products
ORDER BY price * (1 + tax_rate);
SELECT id FROM tasks
ORDER BY CASE priority
WHEN 'high' THEN 1
WHEN 'medium' THEN 2
WHEN 'low' THEN 3
END, id;
SELECT a, b, c FROM data ORDER BY 1, 3;
SELECT name FROM names ORDER BY name COLLATE NOCASE;
SELECT n FROM empty1 UNION ALL SELECT n FROM empty2;
SELECT DISTINCT value FROM nulls;
SELECT id FROM same ORDER BY value, id DESC;

-- ============================================================================
-- Test: test_union_intersect_precedence
-- Source: setops_distinct_orderby_tdd.rs:226
-- ============================================================================
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (n INT64);
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (n INT64);
DROP TABLE IF EXISTS t3;
CREATE TABLE t3 (n INT64);
INSERT INTO t1 VALUES (1), (2);
INSERT INTO t2 VALUES (2), (3);
INSERT INTO t3 VALUES (2), (4);
DROP TABLE IF EXISTS odds;
CREATE TABLE odds (n INT64);
DROP TABLE IF EXISTS evens;
CREATE TABLE evens (n INT64);
INSERT INTO odds VALUES (1), (3), (5);
INSERT INTO evens VALUES (2), (4), (6);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING, name STRING, price FLOAT64);
INSERT INTO items VALUES ('A', 'item1', 100), ('A', 'item2', 200), ('B', 'item3', 150);
DROP TABLE IF EXISTS events;
CREATE TABLE events (date STRING, type STRING, user_id INT64, action STRING);
INSERT INTO events VALUES ('2024-01-01', 'A', 1, 'login'), ('2024-01-01', 'A', 1, 'logout'), ('2024-01-01', 'B', 2, 'click');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100, 50), (2, 100, 75), (3, 101, 60);
DROP TABLE IF EXISTS values;
CREATE TABLE values (n INT64);
INSERT INTO values VALUES (1), (2), (2), (3), (3), (3);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (score FLOAT64);
INSERT INTO scores VALUES (100), (100), (80), (90);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100, 50), (1, 100, 50), (2, 101, 75);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (20), (5);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, tax_rate FLOAT64);
INSERT INTO products VALUES ('A', 100, 0.1), ('B', 80, 0.15), ('C', 110, 0.05);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, priority STRING);
INSERT INTO tasks VALUES (1, 'low'), (2, 'high'), (3, 'medium'), (4, 'high');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64, c INT64);
INSERT INTO data VALUES (3, 1, 100), (1, 2, 200), (2, 3, 150);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('alice'), ('Bob'), ('CHARLIE'), ('david');
DROP TABLE IF EXISTS empty1;
CREATE TABLE empty1 (n INT64);
DROP TABLE IF EXISTS empty2;
CREATE TABLE empty2 (n INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO nulls VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS same;
CREATE TABLE same (id INT64, value INT64);
INSERT INTO same VALUES (1, 10), (2, 10), (3, 10);

SELECT n FROM t1
UNION
SELECT n FROM t2
INTERSECT
SELECT n FROM t3
ORDER BY n;
(SELECT n FROM odds) UNION (SELECT n FROM evens) ORDER BY n DESC;
SELECT DISTINCT ON (category) category, name, price
FROM items
ORDER BY category, price;
SELECT DISTINCT ON (date, type) date, type, action
FROM events
ORDER BY date, type, user_id;
SELECT COUNT(DISTINCT customer_id) as unique_customers FROM orders;
SELECT SUM(DISTINCT n) as distinct_sum FROM values;
SELECT AVG(DISTINCT score) as avg_score FROM scores;
SELECT
COUNT(DISTINCT product_id) as unique_products,
COUNT(DISTINCT customer_id) as unique_customers,
COUNT(*) as total_sales
FROM sales;
SELECT value FROM data ORDER BY value NULLS FIRST;
SELECT value FROM data ORDER BY value NULLS LAST;
SELECT value FROM data ORDER BY value DESC NULLS FIRST;
SELECT name, price * (1 + tax_rate) as total
FROM products
ORDER BY price * (1 + tax_rate);
SELECT id FROM tasks
ORDER BY CASE priority
WHEN 'high' THEN 1
WHEN 'medium' THEN 2
WHEN 'low' THEN 3
END, id;
SELECT a, b, c FROM data ORDER BY 1, 3;
SELECT name FROM names ORDER BY name COLLATE NOCASE;
SELECT n FROM empty1 UNION ALL SELECT n FROM empty2;
SELECT DISTINCT value FROM nulls;
SELECT id FROM same ORDER BY value, id DESC;

-- ============================================================================
-- Test: test_union_with_order_by
-- Source: setops_distinct_orderby_tdd.rs:264
-- ============================================================================
DROP TABLE IF EXISTS odds;
CREATE TABLE odds (n INT64);
DROP TABLE IF EXISTS evens;
CREATE TABLE evens (n INT64);
INSERT INTO odds VALUES (1), (3), (5);
INSERT INTO evens VALUES (2), (4), (6);
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING, name STRING, price FLOAT64);
INSERT INTO items VALUES ('A', 'item1', 100), ('A', 'item2', 200), ('B', 'item3', 150);
DROP TABLE IF EXISTS events;
CREATE TABLE events (date STRING, type STRING, user_id INT64, action STRING);
INSERT INTO events VALUES ('2024-01-01', 'A', 1, 'login'), ('2024-01-01', 'A', 1, 'logout'), ('2024-01-01', 'B', 2, 'click');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100, 50), (2, 100, 75), (3, 101, 60);
DROP TABLE IF EXISTS values;
CREATE TABLE values (n INT64);
INSERT INTO values VALUES (1), (2), (2), (3), (3), (3);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (score FLOAT64);
INSERT INTO scores VALUES (100), (100), (80), (90);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100, 50), (1, 100, 50), (2, 101, 75);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (20), (5);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, tax_rate FLOAT64);
INSERT INTO products VALUES ('A', 100, 0.1), ('B', 80, 0.15), ('C', 110, 0.05);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, priority STRING);
INSERT INTO tasks VALUES (1, 'low'), (2, 'high'), (3, 'medium'), (4, 'high');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64, c INT64);
INSERT INTO data VALUES (3, 1, 100), (1, 2, 200), (2, 3, 150);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('alice'), ('Bob'), ('CHARLIE'), ('david');
DROP TABLE IF EXISTS empty1;
CREATE TABLE empty1 (n INT64);
DROP TABLE IF EXISTS empty2;
CREATE TABLE empty2 (n INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO nulls VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS same;
CREATE TABLE same (id INT64, value INT64);
INSERT INTO same VALUES (1, 10), (2, 10), (3, 10);

(SELECT n FROM odds) UNION (SELECT n FROM evens) ORDER BY n DESC;
SELECT DISTINCT ON (category) category, name, price
FROM items
ORDER BY category, price;
SELECT DISTINCT ON (date, type) date, type, action
FROM events
ORDER BY date, type, user_id;
SELECT COUNT(DISTINCT customer_id) as unique_customers FROM orders;
SELECT SUM(DISTINCT n) as distinct_sum FROM values;
SELECT AVG(DISTINCT score) as avg_score FROM scores;
SELECT
COUNT(DISTINCT product_id) as unique_products,
COUNT(DISTINCT customer_id) as unique_customers,
COUNT(*) as total_sales
FROM sales;
SELECT value FROM data ORDER BY value NULLS FIRST;
SELECT value FROM data ORDER BY value NULLS LAST;
SELECT value FROM data ORDER BY value DESC NULLS FIRST;
SELECT name, price * (1 + tax_rate) as total
FROM products
ORDER BY price * (1 + tax_rate);
SELECT id FROM tasks
ORDER BY CASE priority
WHEN 'high' THEN 1
WHEN 'medium' THEN 2
WHEN 'low' THEN 3
END, id;
SELECT a, b, c FROM data ORDER BY 1, 3;
SELECT name FROM names ORDER BY name COLLATE NOCASE;
SELECT n FROM empty1 UNION ALL SELECT n FROM empty2;
SELECT DISTINCT value FROM nulls;
SELECT id FROM same ORDER BY value, id DESC;

-- ============================================================================
-- Test: test_distinct_on_single_column
-- Source: setops_distinct_orderby_tdd.rs:293
-- ============================================================================
DROP TABLE IF EXISTS items;
CREATE TABLE items (category STRING, name STRING, price FLOAT64);
INSERT INTO items VALUES ('A', 'item1', 100), ('A', 'item2', 200), ('B', 'item3', 150);
DROP TABLE IF EXISTS events;
CREATE TABLE events (date STRING, type STRING, user_id INT64, action STRING);
INSERT INTO events VALUES ('2024-01-01', 'A', 1, 'login'), ('2024-01-01', 'A', 1, 'logout'), ('2024-01-01', 'B', 2, 'click');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100, 50), (2, 100, 75), (3, 101, 60);
DROP TABLE IF EXISTS values;
CREATE TABLE values (n INT64);
INSERT INTO values VALUES (1), (2), (2), (3), (3), (3);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (score FLOAT64);
INSERT INTO scores VALUES (100), (100), (80), (90);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100, 50), (1, 100, 50), (2, 101, 75);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (20), (5);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, tax_rate FLOAT64);
INSERT INTO products VALUES ('A', 100, 0.1), ('B', 80, 0.15), ('C', 110, 0.05);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, priority STRING);
INSERT INTO tasks VALUES (1, 'low'), (2, 'high'), (3, 'medium'), (4, 'high');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64, c INT64);
INSERT INTO data VALUES (3, 1, 100), (1, 2, 200), (2, 3, 150);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('alice'), ('Bob'), ('CHARLIE'), ('david');
DROP TABLE IF EXISTS empty1;
CREATE TABLE empty1 (n INT64);
DROP TABLE IF EXISTS empty2;
CREATE TABLE empty2 (n INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO nulls VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS same;
CREATE TABLE same (id INT64, value INT64);
INSERT INTO same VALUES (1, 10), (2, 10), (3, 10);

SELECT DISTINCT ON (category) category, name, price
FROM items
ORDER BY category, price;
SELECT DISTINCT ON (date, type) date, type, action
FROM events
ORDER BY date, type, user_id;
SELECT COUNT(DISTINCT customer_id) as unique_customers FROM orders;
SELECT SUM(DISTINCT n) as distinct_sum FROM values;
SELECT AVG(DISTINCT score) as avg_score FROM scores;
SELECT
COUNT(DISTINCT product_id) as unique_products,
COUNT(DISTINCT customer_id) as unique_customers,
COUNT(*) as total_sales
FROM sales;
SELECT value FROM data ORDER BY value NULLS FIRST;
SELECT value FROM data ORDER BY value NULLS LAST;
SELECT value FROM data ORDER BY value DESC NULLS FIRST;
SELECT name, price * (1 + tax_rate) as total
FROM products
ORDER BY price * (1 + tax_rate);
SELECT id FROM tasks
ORDER BY CASE priority
WHEN 'high' THEN 1
WHEN 'medium' THEN 2
WHEN 'low' THEN 3
END, id;
SELECT a, b, c FROM data ORDER BY 1, 3;
SELECT name FROM names ORDER BY name COLLATE NOCASE;
SELECT n FROM empty1 UNION ALL SELECT n FROM empty2;
SELECT DISTINCT value FROM nulls;
SELECT id FROM same ORDER BY value, id DESC;

-- ============================================================================
-- Test: test_distinct_on_multiple_columns
-- Source: setops_distinct_orderby_tdd.rs:324
-- ============================================================================
DROP TABLE IF EXISTS events;
CREATE TABLE events (date STRING, type STRING, user_id INT64, action STRING);
INSERT INTO events VALUES ('2024-01-01', 'A', 1, 'login'), ('2024-01-01', 'A', 1, 'logout'), ('2024-01-01', 'B', 2, 'click');
DROP TABLE IF EXISTS orders;
CREATE TABLE orders (id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO orders VALUES (1, 100, 50), (2, 100, 75), (3, 101, 60);
DROP TABLE IF EXISTS values;
CREATE TABLE values (n INT64);
INSERT INTO values VALUES (1), (2), (2), (3), (3), (3);
DROP TABLE IF EXISTS scores;
CREATE TABLE scores (score FLOAT64);
INSERT INTO scores VALUES (100), (100), (80), (90);
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (product_id INT64, customer_id INT64, amount FLOAT64);
INSERT INTO sales VALUES (1, 100, 50), (1, 100, 50), (2, 101, 75);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value INT64);
INSERT INTO data VALUES (1, 10), (2, NULL), (3, 20), (4, NULL), (5, 5);
DROP TABLE IF EXISTS data;
CREATE TABLE data (value INT64);
INSERT INTO data VALUES (10), (NULL), (20), (5);
DROP TABLE IF EXISTS products;
CREATE TABLE products (name STRING, price FLOAT64, tax_rate FLOAT64);
INSERT INTO products VALUES ('A', 100, 0.1), ('B', 80, 0.15), ('C', 110, 0.05);
DROP TABLE IF EXISTS tasks;
CREATE TABLE tasks (id INT64, priority STRING);
INSERT INTO tasks VALUES (1, 'low'), (2, 'high'), (3, 'medium'), (4, 'high');
DROP TABLE IF EXISTS data;
CREATE TABLE data (a INT64, b INT64, c INT64);
INSERT INTO data VALUES (3, 1, 100), (1, 2, 200), (2, 3, 150);
DROP TABLE IF EXISTS names;
CREATE TABLE names (name STRING);
INSERT INTO names VALUES ('alice'), ('Bob'), ('CHARLIE'), ('david');
DROP TABLE IF EXISTS empty1;
CREATE TABLE empty1 (n INT64);
DROP TABLE IF EXISTS empty2;
CREATE TABLE empty2 (n INT64);
DROP TABLE IF EXISTS nulls;
CREATE TABLE nulls (value INT64);
INSERT INTO nulls VALUES (NULL), (NULL), (NULL);
DROP TABLE IF EXISTS same;
CREATE TABLE same (id INT64, value INT64);
INSERT INTO same VALUES (1, 10), (2, 10), (3, 10);

SELECT DISTINCT ON (date, type) date, type, action
FROM events
ORDER BY date, type, user_id;
SELECT COUNT(DISTINCT customer_id) as unique_customers FROM orders;
SELECT SUM(DISTINCT n) as distinct_sum FROM values;
SELECT AVG(DISTINCT score) as avg_score FROM scores;
SELECT
COUNT(DISTINCT product_id) as unique_products,
COUNT(DISTINCT customer_id) as unique_customers,
COUNT(*) as total_sales
FROM sales;
SELECT value FROM data ORDER BY value NULLS FIRST;
SELECT value FROM data ORDER BY value NULLS LAST;
SELECT value FROM data ORDER BY value DESC NULLS FIRST;
SELECT name, price * (1 + tax_rate) as total
FROM products
ORDER BY price * (1 + tax_rate);
SELECT id FROM tasks
ORDER BY CASE priority
WHEN 'high' THEN 1
WHEN 'medium' THEN 2
WHEN 'low' THEN 3
END, id;
SELECT a, b, c FROM data ORDER BY 1, 3;
SELECT name FROM names ORDER BY name COLLATE NOCASE;
SELECT n FROM empty1 UNION ALL SELECT n FROM empty2;
SELECT DISTINCT value FROM nulls;
SELECT id FROM same ORDER BY value, id DESC;

-- ============================================================================
-- Test: test_similar_to_in_having_clause
-- Source: similar_to_operator_comprehensive_tdd.rs:641
-- ============================================================================
DROP TABLE IF EXISTS sales;
CREATE TABLE sales (id INT64, region STRING, amount INT64);
INSERT INTO sales VALUES (1, 'East', 100), (2, 'East', 200), (3, 'West', 150), (4, 'North', 180);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, ''), (2, 'a'), (3, 'b');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123'), (2, 'test'), (3, 'test12');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);

SELECT region, SUM(amount) as total FROM sales GROUP BY region HAVING region SIMILAR TO 'E%|W%' ORDER BY region;
SELECT value FROM data WHERE value SIMILAR TO '';
SELECT value FROM data WHERE value SIMILAR TO 'A%';
SELECT value FROM data WHERE value SIMILAR TO '[invalid';
SELECT value FROM data WHERE value SIMILAR TO 'test[0-9]+' ORDER BY value;
SELECT COUNT(*) FROM data WHERE value SIMILAR TO 'value[0-9]+';

-- ============================================================================
-- Test: test_similar_to_empty_string_pattern
-- Source: similar_to_operator_comprehensive_tdd.rs:667
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, ''), (2, 'a'), (3, 'b');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123'), (2, 'test'), (3, 'test12');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);

SELECT value FROM data WHERE value SIMILAR TO '';
SELECT value FROM data WHERE value SIMILAR TO 'A%';
SELECT value FROM data WHERE value SIMILAR TO '[invalid';
SELECT value FROM data WHERE value SIMILAR TO 'test[0-9]+' ORDER BY value;
SELECT COUNT(*) FROM data WHERE value SIMILAR TO 'value[0-9]+';

-- ============================================================================
-- Test: test_similar_to_empty_table
-- Source: similar_to_operator_comprehensive_tdd.rs:689
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123'), (2, 'test'), (3, 'test12');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);

SELECT value FROM data WHERE value SIMILAR TO 'A%';
SELECT value FROM data WHERE value SIMILAR TO '[invalid';
SELECT value FROM data WHERE value SIMILAR TO 'test[0-9]+' ORDER BY value;
SELECT COUNT(*) FROM data WHERE value SIMILAR TO 'value[0-9]+';

-- ============================================================================
-- Test: test_similar_to_invalid_pattern_syntax
-- Source: similar_to_operator_comprehensive_tdd.rs:708
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123'), (2, 'test'), (3, 'test12');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);

SELECT value FROM data WHERE value SIMILAR TO '[invalid';
SELECT value FROM data WHERE value SIMILAR TO 'test[0-9]+' ORDER BY value;
SELECT COUNT(*) FROM data WHERE value SIMILAR TO 'value[0-9]+';

-- ============================================================================
-- Test: test_similar_to_all_special_characters
-- Source: similar_to_operator_comprehensive_tdd.rs:732
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);
INSERT INTO data VALUES (1, 'test123'), (2, 'test'), (3, 'test12');
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);

SELECT value FROM data WHERE value SIMILAR TO 'test[0-9]+' ORDER BY value;
SELECT COUNT(*) FROM data WHERE value SIMILAR TO 'value[0-9]+';

-- ============================================================================
-- Test: test_similar_to_performance_large_dataset
-- Source: similar_to_operator_comprehensive_tdd.rs:754
-- ============================================================================
DROP TABLE IF EXISTS data;
CREATE TABLE data (id INT64, value STRING);

SELECT COUNT(*) FROM data WHERE value SIMILAR TO 'value[0-9]+';
